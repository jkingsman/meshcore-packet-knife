"use strict";(()=>{var sd=Object.create;var Mr=Object.defineProperty;var od=Object.getOwnPropertyDescriptor;var id=Object.getOwnPropertyNames;var ad=Object.getPrototypeOf,cd=Object.prototype.hasOwnProperty;var Ad=(r,e,t)=>e in r?Mr(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var ar=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+r+'" is not supported')});var Le=(r,e)=>()=>(r&&(e=r(r=0)),e);var Q=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),yi=(r,e)=>{for(var t in e)Mr(r,t,{get:e[t],enumerable:!0})},mi=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of id(e))!cd.call(r,s)&&s!==t&&Mr(r,s,{get:()=>e[s],enumerable:!(n=od(e,s))||n.enumerable});return r};var cr=(r,e,t)=>(t=r!=null?sd(ad(r)):{},mi(e||!r||!r.__esModule?Mr(t,"default",{value:r,enumerable:!0}):t,r)),dd=r=>mi(Mr({},"__esModule",{value:!0}),r);var Z=(r,e,t)=>Ad(r,typeof e!="symbol"?e+"":e,t);var Re=Q(Ce=>{"use strict";Object.defineProperty(Ce,"__esModule",{value:!0});Ce.RequestType=Ce.AdvertFlags=Ce.DeviceRole=Ce.PayloadVersion=Ce.ControlSubType=Ce.PayloadType=Ce.RouteType=void 0;var gi;(function(r){r[r.TransportFlood=0]="TransportFlood",r[r.Flood=1]="Flood",r[r.Direct=2]="Direct",r[r.TransportDirect=3]="TransportDirect"})(gi||(Ce.RouteType=gi={}));var Bi;(function(r){r[r.Request=0]="Request",r[r.Response=1]="Response",r[r.TextMessage=2]="TextMessage",r[r.Ack=3]="Ack",r[r.Advert=4]="Advert",r[r.GroupText=5]="GroupText",r[r.GroupData=6]="GroupData",r[r.AnonRequest=7]="AnonRequest",r[r.Path=8]="Path",r[r.Trace=9]="Trace",r[r.Multipart=10]="Multipart",r[r.Control=11]="Control",r[r.RawCustom=15]="RawCustom"})(Bi||(Ce.PayloadType=Bi={}));var Ci;(function(r){r[r.NodeDiscoverReq=128]="NodeDiscoverReq",r[r.NodeDiscoverResp=144]="NodeDiscoverResp"})(Ci||(Ce.ControlSubType=Ci={}));var vi;(function(r){r[r.Version1=0]="Version1",r[r.Version2=1]="Version2",r[r.Version3=2]="Version3",r[r.Version4=3]="Version4"})(vi||(Ce.PayloadVersion=vi={}));var Ei;(function(r){r[r.Unknown=0]="Unknown",r[r.ChatNode=1]="ChatNode",r[r.Repeater=2]="Repeater",r[r.RoomServer=3]="RoomServer",r[r.Sensor=4]="Sensor"})(Ei||(Ce.DeviceRole=Ei={}));var bi;(function(r){r[r.HasLocation=16]="HasLocation",r[r.HasFeature1=32]="HasFeature1",r[r.HasFeature2=64]="HasFeature2",r[r.HasName=128]="HasName"})(bi||(Ce.AdvertFlags=bi={}));var wi;(function(r){r[r.GetStats=1]="GetStats",r[r.Keepalive=2]="Keepalive",r[r.GetTelemetryData=3]="GetTelemetryData",r[r.GetMinMaxAvgData=4]="GetMinMaxAvgData",r[r.GetAccessList=5]="GetAccessList"})(wi||(Ce.RequestType=wi={}))});var he=Q(Ar=>{"use strict";Object.defineProperty(Ar,"__esModule",{value:!0});Ar.byteToHex=_i;Ar.bytesToHex=fd;Ar.numberToHex=ud;Ar.hexToBytes=ld;function _i(r){return r.toString(16).padStart(2,"0").toUpperCase()}function fd(r){return Array.from(r).map(_i).join("")}function ud(r,e=8){return(r>>>0).toString(16).padStart(e,"0").toUpperCase()}function ld(r){let e=r.replace(/\s/g,"").toUpperCase();if(!/^[0-9A-F]*$/.test(e))throw new Error("Invalid hex string: invalid characters at position 0");if(e.length%2!==0)throw new Error("Invalid hex string: odd length");let t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2)t[n/2]=parseInt(e.substr(n,2),16);return t}});var dr=Q(_t=>{"use strict";Object.defineProperty(_t,"__esModule",{value:!0});_t.getRouteTypeName=hd;_t.getPayloadTypeName=xd;_t.getPayloadVersionName=pd;_t.getDeviceRoleName=yd;_t.getRequestTypeName=md;_t.getControlSubTypeName=gd;var te=Re();function hd(r){switch(r){case te.RouteType.Flood:return"Flood";case te.RouteType.Direct:return"Direct";case te.RouteType.TransportFlood:return"TransportFlood";case te.RouteType.TransportDirect:return"TransportDirect";default:return`Unknown (${r})`}}function xd(r){switch(r){case te.PayloadType.RawCustom:return"RawCustom";case te.PayloadType.Trace:return"Trace";case te.PayloadType.Advert:return"Advert";case te.PayloadType.GroupText:return"GroupText";case te.PayloadType.GroupData:return"GroupData";case te.PayloadType.Request:return"Request";case te.PayloadType.Response:return"Response";case te.PayloadType.TextMessage:return"TextMessage";case te.PayloadType.AnonRequest:return"AnonRequest";case te.PayloadType.Ack:return"Ack";case te.PayloadType.Path:return"Path";case te.PayloadType.Multipart:return"Multipart";case te.PayloadType.Control:return"Control";default:return`Unknown (0x${r.toString(16)})`}}function pd(r){switch(r){case te.PayloadVersion.Version1:return"Version 1";case te.PayloadVersion.Version2:return"Version 2";case te.PayloadVersion.Version3:return"Version 3";case te.PayloadVersion.Version4:return"Version 4";default:return`Unknown (${r})`}}function yd(r){switch(r){case te.DeviceRole.Unknown:return"Unknown";case te.DeviceRole.ChatNode:return"Chat Node";case te.DeviceRole.Repeater:return"Repeater";case te.DeviceRole.RoomServer:return"Room Server";case te.DeviceRole.Sensor:return"Sensor";default:return`Unknown (${r})`}}function md(r){switch(r){case te.RequestType.GetStats:return"Get Stats";case te.RequestType.Keepalive:return"Keepalive (deprecated)";case te.RequestType.GetTelemetryData:return"Get Telemetry Data";case te.RequestType.GetMinMaxAvgData:return"Get Min/Max/Avg Data";case te.RequestType.GetAccessList:return"Get Access List";default:return`Unknown (${r})`}}function gd(r){switch(r){case te.ControlSubType.NodeDiscoverReq:return"Node Discover Request";case te.ControlSubType.NodeDiscoverResp:return"Node Discover Response";default:return`Unknown (0x${r.toString(16)})`}}});var kn=Q(()=>{});var j=Q((In,Di)=>{(function(r,e){typeof In=="object"?Di.exports=In=e():typeof define=="function"&&define.amd?define([],e):r.CryptoJS=e()})(In,function(){var r=r||function(e,t){var n;if(typeof window<"u"&&window.crypto&&(n=window.crypto),typeof self<"u"&&self.crypto&&(n=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(n=globalThis.crypto),!n&&typeof window<"u"&&window.msCrypto&&(n=window.msCrypto),!n&&typeof global<"u"&&global.crypto&&(n=global.crypto),!n&&typeof ar=="function")try{n=kn()}catch{}var s=function(){if(n){if(typeof n.getRandomValues=="function")try{return n.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof n.randomBytes=="function")try{return n.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function l(){}return function(y){var B;return l.prototype=y,B=new l,l.prototype=null,B}}(),i={},a=i.lib={},c=a.Base=function(){return{extend:function(l){var y=o(this);return l&&y.mixIn(l),(!y.hasOwnProperty("init")||this.init===y.init)&&(y.init=function(){y.$super.init.apply(this,arguments)}),y.init.prototype=y,y.$super=this,y},create:function(){var l=this.extend();return l.init.apply(l,arguments),l},init:function(){},mixIn:function(l){for(var y in l)l.hasOwnProperty(y)&&(this[y]=l[y]);l.hasOwnProperty("toString")&&(this.toString=l.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=a.WordArray=c.extend({init:function(l,y){l=this.words=l||[],y!=t?this.sigBytes=y:this.sigBytes=l.length*4},toString:function(l){return(l||u).stringify(this)},concat:function(l){var y=this.words,B=l.words,v=this.sigBytes,E=l.sigBytes;if(this.clamp(),v%4)for(var C=0;C<E;C++){var R=B[C>>>2]>>>24-C%4*8&255;y[v+C>>>2]|=R<<24-(v+C)%4*8}else for(var S=0;S<E;S+=4)y[v+S>>>2]=B[S>>>2];return this.sigBytes+=E,this},clamp:function(){var l=this.words,y=this.sigBytes;l[y>>>2]&=4294967295<<32-y%4*8,l.length=e.ceil(y/4)},clone:function(){var l=c.clone.call(this);return l.words=this.words.slice(0),l},random:function(l){for(var y=[],B=0;B<l;B+=4)y.push(s());return new f.init(y,l)}}),A=i.enc={},u=A.Hex={stringify:function(l){for(var y=l.words,B=l.sigBytes,v=[],E=0;E<B;E++){var C=y[E>>>2]>>>24-E%4*8&255;v.push((C>>>4).toString(16)),v.push((C&15).toString(16))}return v.join("")},parse:function(l){for(var y=l.length,B=[],v=0;v<y;v+=2)B[v>>>3]|=parseInt(l.substr(v,2),16)<<24-v%8*4;return new f.init(B,y/2)}},d=A.Latin1={stringify:function(l){for(var y=l.words,B=l.sigBytes,v=[],E=0;E<B;E++){var C=y[E>>>2]>>>24-E%4*8&255;v.push(String.fromCharCode(C))}return v.join("")},parse:function(l){for(var y=l.length,B=[],v=0;v<y;v++)B[v>>>2]|=(l.charCodeAt(v)&255)<<24-v%4*8;return new f.init(B,y)}},x=A.Utf8={stringify:function(l){try{return decodeURIComponent(escape(d.stringify(l)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(l){return d.parse(unescape(encodeURIComponent(l)))}},p=a.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(l){typeof l=="string"&&(l=x.parse(l)),this._data.concat(l),this._nDataBytes+=l.sigBytes},_process:function(l){var y,B=this._data,v=B.words,E=B.sigBytes,C=this.blockSize,R=C*4,S=E/R;l?S=e.ceil(S):S=e.max((S|0)-this._minBufferSize,0);var b=S*C,_=e.min(b*4,E);if(b){for(var w=0;w<b;w+=C)this._doProcessBlock(v,w);y=v.splice(0,b),B.sigBytes-=_}return new f.init(y,_)},clone:function(){var l=c.clone.call(this);return l._data=this._data.clone(),l},_minBufferSize:0}),m=a.Hasher=p.extend({cfg:c.extend(),init:function(l){this.cfg=this.cfg.extend(l),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(l){return this._append(l),this._process(),this},finalize:function(l){l&&this._append(l);var y=this._doFinalize();return y},blockSize:512/32,_createHelper:function(l){return function(y,B){return new l.init(B).finalize(y)}},_createHmacHelper:function(l){return function(y,B){return new g.HMAC.init(l,B).finalize(y)}}}),g=i.algo={};return i}(Math);return r})});var Ur=Q((Ln,Si)=>{(function(r,e){typeof Ln=="object"?Si.exports=Ln=e(j()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(Ln,function(r){return function(e){var t=r,n=t.lib,s=n.Base,o=n.WordArray,i=t.x64={},a=i.Word=s.extend({init:function(f,A){this.high=f,this.low=A}}),c=i.WordArray=s.extend({init:function(f,A){f=this.words=f||[],A!=e?this.sigBytes=A:this.sigBytes=f.length*8},toX32:function(){for(var f=this.words,A=f.length,u=[],d=0;d<A;d++){var x=f[d];u.push(x.high),u.push(x.low)}return o.create(u,this.sigBytes)},clone:function(){for(var f=s.clone.call(this),A=f.words=this.words.slice(0),u=A.length,d=0;d<u;d++)A[d]=A[d].clone();return f}})}(),r})});var Ti=Q((Hn,Ri)=>{(function(r,e){typeof Hn=="object"?Ri.exports=Hn=e(j()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(Hn,function(r){return function(){if(typeof ArrayBuffer=="function"){var e=r,t=e.lib,n=t.WordArray,s=n.init,o=n.init=function(i){if(i instanceof ArrayBuffer&&(i=new Uint8Array(i)),(i instanceof Int8Array||typeof Uint8ClampedArray<"u"&&i instanceof Uint8ClampedArray||i instanceof Int16Array||i instanceof Uint16Array||i instanceof Int32Array||i instanceof Uint32Array||i instanceof Float32Array||i instanceof Float64Array)&&(i=new Uint8Array(i.buffer,i.byteOffset,i.byteLength)),i instanceof Uint8Array){for(var a=i.byteLength,c=[],f=0;f<a;f++)c[f>>>2]|=i[f]<<24-f%4*8;s.call(this,c,a)}else s.apply(this,arguments)};o.prototype=n}}(),r.lib.WordArray})});var Pi=Q((On,Fi)=>{(function(r,e){typeof On=="object"?Fi.exports=On=e(j()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(On,function(r){return function(){var e=r,t=e.lib,n=t.WordArray,s=e.enc,o=s.Utf16=s.Utf16BE={stringify:function(a){for(var c=a.words,f=a.sigBytes,A=[],u=0;u<f;u+=2){var d=c[u>>>2]>>>16-u%4*8&65535;A.push(String.fromCharCode(d))}return A.join("")},parse:function(a){for(var c=a.length,f=[],A=0;A<c;A++)f[A>>>1]|=a.charCodeAt(A)<<16-A%2*16;return n.create(f,c*2)}};s.Utf16LE={stringify:function(a){for(var c=a.words,f=a.sigBytes,A=[],u=0;u<f;u+=2){var d=i(c[u>>>2]>>>16-u%4*8&65535);A.push(String.fromCharCode(d))}return A.join("")},parse:function(a){for(var c=a.length,f=[],A=0;A<c;A++)f[A>>>1]|=i(a.charCodeAt(A)<<16-A%2*16);return n.create(f,c*2)}};function i(a){return a<<8&4278255360|a>>>8&16711935}}(),r.enc.Utf16})});var Dt=Q((Mn,ki)=>{(function(r,e){typeof Mn=="object"?ki.exports=Mn=e(j()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(Mn,function(r){return function(){var e=r,t=e.lib,n=t.WordArray,s=e.enc,o=s.Base64={stringify:function(a){var c=a.words,f=a.sigBytes,A=this._map;a.clamp();for(var u=[],d=0;d<f;d+=3)for(var x=c[d>>>2]>>>24-d%4*8&255,p=c[d+1>>>2]>>>24-(d+1)%4*8&255,m=c[d+2>>>2]>>>24-(d+2)%4*8&255,g=x<<16|p<<8|m,l=0;l<4&&d+l*.75<f;l++)u.push(A.charAt(g>>>6*(3-l)&63));var y=A.charAt(64);if(y)for(;u.length%4;)u.push(y);return u.join("")},parse:function(a){var c=a.length,f=this._map,A=this._reverseMap;if(!A){A=this._reverseMap=[];for(var u=0;u<f.length;u++)A[f.charCodeAt(u)]=u}var d=f.charAt(64);if(d){var x=a.indexOf(d);x!==-1&&(c=x)}return i(a,c,A)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function i(a,c,f){for(var A=[],u=0,d=0;d<c;d++)if(d%4){var x=f[a.charCodeAt(d-1)]<<d%4*2,p=f[a.charCodeAt(d)]>>>6-d%4*2,m=x|p;A[u>>>2]|=m<<24-u%4*8,u++}return n.create(A,u)}}(),r.enc.Base64})});var Li=Q((Un,Ii)=>{(function(r,e){typeof Un=="object"?Ii.exports=Un=e(j()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(Un,function(r){return function(){var e=r,t=e.lib,n=t.WordArray,s=e.enc,o=s.Base64url={stringify:function(a,c){c===void 0&&(c=!0);var f=a.words,A=a.sigBytes,u=c?this._safe_map:this._map;a.clamp();for(var d=[],x=0;x<A;x+=3)for(var p=f[x>>>2]>>>24-x%4*8&255,m=f[x+1>>>2]>>>24-(x+1)%4*8&255,g=f[x+2>>>2]>>>24-(x+2)%4*8&255,l=p<<16|m<<8|g,y=0;y<4&&x+y*.75<A;y++)d.push(u.charAt(l>>>6*(3-y)&63));var B=u.charAt(64);if(B)for(;d.length%4;)d.push(B);return d.join("")},parse:function(a,c){c===void 0&&(c=!0);var f=a.length,A=c?this._safe_map:this._map,u=this._reverseMap;if(!u){u=this._reverseMap=[];for(var d=0;d<A.length;d++)u[A.charCodeAt(d)]=d}var x=A.charAt(64);if(x){var p=a.indexOf(x);p!==-1&&(f=p)}return i(a,f,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function i(a,c,f){for(var A=[],u=0,d=0;d<c;d++)if(d%4){var x=f[a.charCodeAt(d-1)]<<d%4*2,p=f[a.charCodeAt(d)]>>>6-d%4*2,m=x|p;A[u>>>2]|=m<<24-u%4*8,u++}return n.create(A,u)}}(),r.enc.Base64url})});var St=Q((qn,Hi)=>{(function(r,e){typeof qn=="object"?Hi.exports=qn=e(j()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(qn,function(r){return function(e){var t=r,n=t.lib,s=n.WordArray,o=n.Hasher,i=t.algo,a=[];(function(){for(var x=0;x<64;x++)a[x]=e.abs(e.sin(x+1))*4294967296|0})();var c=i.MD5=o.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(x,p){for(var m=0;m<16;m++){var g=p+m,l=x[g];x[g]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360}var y=this._hash.words,B=x[p+0],v=x[p+1],E=x[p+2],C=x[p+3],R=x[p+4],S=x[p+5],b=x[p+6],_=x[p+7],w=x[p+8],P=x[p+9],F=x[p+10],D=x[p+11],M=x[p+12],U=x[p+13],V=x[p+14],G=x[p+15],T=y[0],I=y[1],H=y[2],L=y[3];T=f(T,I,H,L,B,7,a[0]),L=f(L,T,I,H,v,12,a[1]),H=f(H,L,T,I,E,17,a[2]),I=f(I,H,L,T,C,22,a[3]),T=f(T,I,H,L,R,7,a[4]),L=f(L,T,I,H,S,12,a[5]),H=f(H,L,T,I,b,17,a[6]),I=f(I,H,L,T,_,22,a[7]),T=f(T,I,H,L,w,7,a[8]),L=f(L,T,I,H,P,12,a[9]),H=f(H,L,T,I,F,17,a[10]),I=f(I,H,L,T,D,22,a[11]),T=f(T,I,H,L,M,7,a[12]),L=f(L,T,I,H,U,12,a[13]),H=f(H,L,T,I,V,17,a[14]),I=f(I,H,L,T,G,22,a[15]),T=A(T,I,H,L,v,5,a[16]),L=A(L,T,I,H,b,9,a[17]),H=A(H,L,T,I,D,14,a[18]),I=A(I,H,L,T,B,20,a[19]),T=A(T,I,H,L,S,5,a[20]),L=A(L,T,I,H,F,9,a[21]),H=A(H,L,T,I,G,14,a[22]),I=A(I,H,L,T,R,20,a[23]),T=A(T,I,H,L,P,5,a[24]),L=A(L,T,I,H,V,9,a[25]),H=A(H,L,T,I,C,14,a[26]),I=A(I,H,L,T,w,20,a[27]),T=A(T,I,H,L,U,5,a[28]),L=A(L,T,I,H,E,9,a[29]),H=A(H,L,T,I,_,14,a[30]),I=A(I,H,L,T,M,20,a[31]),T=u(T,I,H,L,S,4,a[32]),L=u(L,T,I,H,w,11,a[33]),H=u(H,L,T,I,D,16,a[34]),I=u(I,H,L,T,V,23,a[35]),T=u(T,I,H,L,v,4,a[36]),L=u(L,T,I,H,R,11,a[37]),H=u(H,L,T,I,_,16,a[38]),I=u(I,H,L,T,F,23,a[39]),T=u(T,I,H,L,U,4,a[40]),L=u(L,T,I,H,B,11,a[41]),H=u(H,L,T,I,C,16,a[42]),I=u(I,H,L,T,b,23,a[43]),T=u(T,I,H,L,P,4,a[44]),L=u(L,T,I,H,M,11,a[45]),H=u(H,L,T,I,G,16,a[46]),I=u(I,H,L,T,E,23,a[47]),T=d(T,I,H,L,B,6,a[48]),L=d(L,T,I,H,_,10,a[49]),H=d(H,L,T,I,V,15,a[50]),I=d(I,H,L,T,S,21,a[51]),T=d(T,I,H,L,M,6,a[52]),L=d(L,T,I,H,C,10,a[53]),H=d(H,L,T,I,F,15,a[54]),I=d(I,H,L,T,v,21,a[55]),T=d(T,I,H,L,w,6,a[56]),L=d(L,T,I,H,G,10,a[57]),H=d(H,L,T,I,b,15,a[58]),I=d(I,H,L,T,U,21,a[59]),T=d(T,I,H,L,R,6,a[60]),L=d(L,T,I,H,D,10,a[61]),H=d(H,L,T,I,E,15,a[62]),I=d(I,H,L,T,P,21,a[63]),y[0]=y[0]+T|0,y[1]=y[1]+I|0,y[2]=y[2]+H|0,y[3]=y[3]+L|0},_doFinalize:function(){var x=this._data,p=x.words,m=this._nDataBytes*8,g=x.sigBytes*8;p[g>>>5]|=128<<24-g%32;var l=e.floor(m/4294967296),y=m;p[(g+64>>>9<<4)+15]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360,p[(g+64>>>9<<4)+14]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,x.sigBytes=(p.length+1)*4,this._process();for(var B=this._hash,v=B.words,E=0;E<4;E++){var C=v[E];v[E]=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360}return B},clone:function(){var x=o.clone.call(this);return x._hash=this._hash.clone(),x}});function f(x,p,m,g,l,y,B){var v=x+(p&m|~p&g)+l+B;return(v<<y|v>>>32-y)+p}function A(x,p,m,g,l,y,B){var v=x+(p&g|m&~g)+l+B;return(v<<y|v>>>32-y)+p}function u(x,p,m,g,l,y,B){var v=x+(p^m^g)+l+B;return(v<<y|v>>>32-y)+p}function d(x,p,m,g,l,y,B){var v=x+(m^(p|~g))+l+B;return(v<<y|v>>>32-y)+p}t.MD5=o._createHelper(c),t.HmacMD5=o._createHmacHelper(c)}(Math),r.MD5})});var E0=Q((Vn,Oi)=>{(function(r,e){typeof Vn=="object"?Oi.exports=Vn=e(j()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(Vn,function(r){return function(){var e=r,t=e.lib,n=t.WordArray,s=t.Hasher,o=e.algo,i=[],a=o.SHA1=s.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(c,f){for(var A=this._hash.words,u=A[0],d=A[1],x=A[2],p=A[3],m=A[4],g=0;g<80;g++){if(g<16)i[g]=c[f+g]|0;else{var l=i[g-3]^i[g-8]^i[g-14]^i[g-16];i[g]=l<<1|l>>>31}var y=(u<<5|u>>>27)+m+i[g];g<20?y+=(d&x|~d&p)+1518500249:g<40?y+=(d^x^p)+1859775393:g<60?y+=(d&x|d&p|x&p)-1894007588:y+=(d^x^p)-899497514,m=p,p=x,x=d<<30|d>>>2,d=u,u=y}A[0]=A[0]+u|0,A[1]=A[1]+d|0,A[2]=A[2]+x|0,A[3]=A[3]+p|0,A[4]=A[4]+m|0},_doFinalize:function(){var c=this._data,f=c.words,A=this._nDataBytes*8,u=c.sigBytes*8;return f[u>>>5]|=128<<24-u%32,f[(u+64>>>9<<4)+14]=Math.floor(A/4294967296),f[(u+64>>>9<<4)+15]=A,c.sigBytes=f.length*4,this._process(),this._hash},clone:function(){var c=s.clone.call(this);return c._hash=this._hash.clone(),c}});e.SHA1=s._createHelper(a),e.HmacSHA1=s._createHmacHelper(a)}(),r.SHA1})});var fr=Q((Nn,Mi)=>{(function(r,e){typeof Nn=="object"?Mi.exports=Nn=e(j()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(Nn,function(r){return function(e){var t=r,n=t.lib,s=n.WordArray,o=n.Hasher,i=t.algo,a=[],c=[];(function(){function u(m){for(var g=e.sqrt(m),l=2;l<=g;l++)if(!(m%l))return!1;return!0}function d(m){return(m-(m|0))*4294967296|0}for(var x=2,p=0;p<64;)u(x)&&(p<8&&(a[p]=d(e.pow(x,1/2))),c[p]=d(e.pow(x,1/3)),p++),x++})();var f=[],A=i.SHA256=o.extend({_doReset:function(){this._hash=new s.init(a.slice(0))},_doProcessBlock:function(u,d){for(var x=this._hash.words,p=x[0],m=x[1],g=x[2],l=x[3],y=x[4],B=x[5],v=x[6],E=x[7],C=0;C<64;C++){if(C<16)f[C]=u[d+C]|0;else{var R=f[C-15],S=(R<<25|R>>>7)^(R<<14|R>>>18)^R>>>3,b=f[C-2],_=(b<<15|b>>>17)^(b<<13|b>>>19)^b>>>10;f[C]=S+f[C-7]+_+f[C-16]}var w=y&B^~y&v,P=p&m^p&g^m&g,F=(p<<30|p>>>2)^(p<<19|p>>>13)^(p<<10|p>>>22),D=(y<<26|y>>>6)^(y<<21|y>>>11)^(y<<7|y>>>25),M=E+D+w+c[C]+f[C],U=F+P;E=v,v=B,B=y,y=l+M|0,l=g,g=m,m=p,p=M+U|0}x[0]=x[0]+p|0,x[1]=x[1]+m|0,x[2]=x[2]+g|0,x[3]=x[3]+l|0,x[4]=x[4]+y|0,x[5]=x[5]+B|0,x[6]=x[6]+v|0,x[7]=x[7]+E|0},_doFinalize:function(){var u=this._data,d=u.words,x=this._nDataBytes*8,p=u.sigBytes*8;return d[p>>>5]|=128<<24-p%32,d[(p+64>>>9<<4)+14]=e.floor(x/4294967296),d[(p+64>>>9<<4)+15]=x,u.sigBytes=d.length*4,this._process(),this._hash},clone:function(){var u=o.clone.call(this);return u._hash=this._hash.clone(),u}});t.SHA256=o._createHelper(A),t.HmacSHA256=o._createHmacHelper(A)}(Math),r.SHA256})});var qi=Q((Gn,Ui)=>{(function(r,e,t){typeof Gn=="object"?Ui.exports=Gn=e(j(),fr()):typeof define=="function"&&define.amd?define(["./core","./sha256"],e):e(r.CryptoJS)})(Gn,function(r){return function(){var e=r,t=e.lib,n=t.WordArray,s=e.algo,o=s.SHA256,i=s.SHA224=o.extend({_doReset:function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var a=o._doFinalize.call(this);return a.sigBytes-=4,a}});e.SHA224=o._createHelper(i),e.HmacSHA224=o._createHmacHelper(i)}(),r.SHA224})});var b0=Q((Kn,Vi)=>{(function(r,e,t){typeof Kn=="object"?Vi.exports=Kn=e(j(),Ur()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],e):e(r.CryptoJS)})(Kn,function(r){return function(){var e=r,t=e.lib,n=t.Hasher,s=e.x64,o=s.Word,i=s.WordArray,a=e.algo;function c(){return o.create.apply(o,arguments)}var f=[c(1116352408,3609767458),c(1899447441,602891725),c(3049323471,3964484399),c(3921009573,2173295548),c(961987163,4081628472),c(1508970993,3053834265),c(2453635748,2937671579),c(2870763221,3664609560),c(3624381080,2734883394),c(310598401,1164996542),c(607225278,1323610764),c(1426881987,3590304994),c(1925078388,4068182383),c(2162078206,991336113),c(2614888103,633803317),c(3248222580,3479774868),c(3835390401,2666613458),c(4022224774,944711139),c(264347078,2341262773),c(604807628,2007800933),c(770255983,1495990901),c(1249150122,1856431235),c(1555081692,3175218132),c(1996064986,2198950837),c(2554220882,3999719339),c(2821834349,766784016),c(2952996808,2566594879),c(3210313671,3203337956),c(3336571891,1034457026),c(3584528711,2466948901),c(113926993,3758326383),c(338241895,168717936),c(666307205,1188179964),c(773529912,1546045734),c(1294757372,1522805485),c(1396182291,2643833823),c(1695183700,2343527390),c(1986661051,1014477480),c(2177026350,1206759142),c(2456956037,344077627),c(2730485921,1290863460),c(2820302411,3158454273),c(3259730800,3505952657),c(3345764771,106217008),c(3516065817,3606008344),c(3600352804,1432725776),c(4094571909,1467031594),c(275423344,851169720),c(430227734,3100823752),c(506948616,1363258195),c(659060556,3750685593),c(883997877,3785050280),c(958139571,3318307427),c(1322822218,3812723403),c(1537002063,2003034995),c(1747873779,3602036899),c(1955562222,1575990012),c(2024104815,1125592928),c(2227730452,2716904306),c(2361852424,442776044),c(2428436474,593698344),c(2756734187,3733110249),c(3204031479,2999351573),c(3329325298,3815920427),c(3391569614,3928383900),c(3515267271,566280711),c(3940187606,3454069534),c(4118630271,4000239992),c(116418474,1914138554),c(174292421,2731055270),c(289380356,3203993006),c(460393269,320620315),c(685471733,587496836),c(852142971,1086792851),c(1017036298,365543100),c(1126000580,2618297676),c(1288033470,3409855158),c(1501505948,4234509866),c(1607167915,987167468),c(1816402316,1246189591)],A=[];(function(){for(var d=0;d<80;d++)A[d]=c()})();var u=a.SHA512=n.extend({_doReset:function(){this._hash=new i.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(d,x){for(var p=this._hash.words,m=p[0],g=p[1],l=p[2],y=p[3],B=p[4],v=p[5],E=p[6],C=p[7],R=m.high,S=m.low,b=g.high,_=g.low,w=l.high,P=l.low,F=y.high,D=y.low,M=B.high,U=B.low,V=v.high,G=v.low,T=E.high,I=E.low,H=C.high,L=C.low,J=R,re=S,de=b,z=_,ke=w,Ve=P,vt=F,st=D,be=M,le=U,ot=V,We=G,Et=T,bt=I,or=H,Vt=L,De=0;De<80;De++){var Se,ze,ir=A[De];if(De<16)ze=ir.high=d[x+De*2]|0,Se=ir.low=d[x+De*2+1]|0;else{var Bn=A[De-15],it=Bn.high,Nt=Bn.low,y0=(it>>>1|Nt<<31)^(it>>>8|Nt<<24)^it>>>7,Cn=(Nt>>>1|it<<31)^(Nt>>>8|it<<24)^(Nt>>>7|it<<25),vn=A[De-2],at=vn.high,Gt=vn.low,En=(at>>>19|Gt<<13)^(at<<3|Gt>>>29)^at>>>6,bn=(Gt>>>19|at<<13)^(Gt<<3|at>>>29)^(Gt>>>6|at<<26),wn=A[De-7],_n=wn.high,m0=wn.low,Dn=A[De-16],g0=Dn.high,Sn=Dn.low;Se=Cn+m0,ze=y0+_n+(Se>>>0<Cn>>>0?1:0),Se=Se+bn,ze=ze+En+(Se>>>0<bn>>>0?1:0),Se=Se+Sn,ze=ze+g0+(Se>>>0<Sn>>>0?1:0),ir.high=ze,ir.low=Se}var B0=be&ot^~be&Et,Lr=le&We^~le&bt,Rn=J&de^J&ke^de&ke,Tn=re&z^re&Ve^z&Ve,C0=(J>>>28|re<<4)^(J<<30|re>>>2)^(J<<25|re>>>7),Fn=(re>>>28|J<<4)^(re<<30|J>>>2)^(re<<25|J>>>7),Kt=(be>>>14|le<<18)^(be>>>18|le<<14)^(be<<23|le>>>9),Hr=(le>>>14|be<<18)^(le>>>18|be<<14)^(le<<23|be>>>9),Pn=f[De],k=Pn.high,O=Pn.low,K=Vt+Hr,$=or+Kt+(K>>>0<Vt>>>0?1:0),K=K+Lr,$=$+B0+(K>>>0<Lr>>>0?1:0),K=K+O,$=$+k+(K>>>0<O>>>0?1:0),K=K+Se,$=$+ze+(K>>>0<Se>>>0?1:0),ne=Fn+Tn,ie=C0+Rn+(ne>>>0<Fn>>>0?1:0);or=Et,Vt=bt,Et=ot,bt=We,ot=be,We=le,le=st+K|0,be=vt+$+(le>>>0<st>>>0?1:0)|0,vt=ke,st=Ve,ke=de,Ve=z,de=J,z=re,re=K+ne|0,J=$+ie+(re>>>0<K>>>0?1:0)|0}S=m.low=S+re,m.high=R+J+(S>>>0<re>>>0?1:0),_=g.low=_+z,g.high=b+de+(_>>>0<z>>>0?1:0),P=l.low=P+Ve,l.high=w+ke+(P>>>0<Ve>>>0?1:0),D=y.low=D+st,y.high=F+vt+(D>>>0<st>>>0?1:0),U=B.low=U+le,B.high=M+be+(U>>>0<le>>>0?1:0),G=v.low=G+We,v.high=V+ot+(G>>>0<We>>>0?1:0),I=E.low=I+bt,E.high=T+Et+(I>>>0<bt>>>0?1:0),L=C.low=L+Vt,C.high=H+or+(L>>>0<Vt>>>0?1:0)},_doFinalize:function(){var d=this._data,x=d.words,p=this._nDataBytes*8,m=d.sigBytes*8;x[m>>>5]|=128<<24-m%32,x[(m+128>>>10<<5)+30]=Math.floor(p/4294967296),x[(m+128>>>10<<5)+31]=p,d.sigBytes=x.length*4,this._process();var g=this._hash.toX32();return g},clone:function(){var d=n.clone.call(this);return d._hash=this._hash.clone(),d},blockSize:1024/32});e.SHA512=n._createHelper(u),e.HmacSHA512=n._createHmacHelper(u)}(),r.SHA512})});var Gi=Q((Qn,Ni)=>{(function(r,e,t){typeof Qn=="object"?Ni.exports=Qn=e(j(),Ur(),b0()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./sha512"],e):e(r.CryptoJS)})(Qn,function(r){return function(){var e=r,t=e.x64,n=t.Word,s=t.WordArray,o=e.algo,i=o.SHA512,a=o.SHA384=i.extend({_doReset:function(){this._hash=new s.init([new n.init(3418070365,3238371032),new n.init(1654270250,914150663),new n.init(2438529370,812702999),new n.init(355462360,4144912697),new n.init(1731405415,4290775857),new n.init(2394180231,1750603025),new n.init(3675008525,1694076839),new n.init(1203062813,3204075428)])},_doFinalize:function(){var c=i._doFinalize.call(this);return c.sigBytes-=16,c}});e.SHA384=i._createHelper(a),e.HmacSHA384=i._createHmacHelper(a)}(),r.SHA384})});var Qi=Q((Yn,Ki)=>{(function(r,e,t){typeof Yn=="object"?Ki.exports=Yn=e(j(),Ur()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],e):e(r.CryptoJS)})(Yn,function(r){return function(e){var t=r,n=t.lib,s=n.WordArray,o=n.Hasher,i=t.x64,a=i.Word,c=t.algo,f=[],A=[],u=[];(function(){for(var p=1,m=0,g=0;g<24;g++){f[p+5*m]=(g+1)*(g+2)/2%64;var l=m%5,y=(2*p+3*m)%5;p=l,m=y}for(var p=0;p<5;p++)for(var m=0;m<5;m++)A[p+5*m]=m+(2*p+3*m)%5*5;for(var B=1,v=0;v<24;v++){for(var E=0,C=0,R=0;R<7;R++){if(B&1){var S=(1<<R)-1;S<32?C^=1<<S:E^=1<<S-32}B&128?B=B<<1^113:B<<=1}u[v]=a.create(E,C)}})();var d=[];(function(){for(var p=0;p<25;p++)d[p]=a.create()})();var x=c.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var p=this._state=[],m=0;m<25;m++)p[m]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(p,m){for(var g=this._state,l=this.blockSize/2,y=0;y<l;y++){var B=p[m+2*y],v=p[m+2*y+1];B=(B<<8|B>>>24)&16711935|(B<<24|B>>>8)&4278255360,v=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360;var E=g[y];E.high^=v,E.low^=B}for(var C=0;C<24;C++){for(var R=0;R<5;R++){for(var S=0,b=0,_=0;_<5;_++){var E=g[R+5*_];S^=E.high,b^=E.low}var w=d[R];w.high=S,w.low=b}for(var R=0;R<5;R++)for(var P=d[(R+4)%5],F=d[(R+1)%5],D=F.high,M=F.low,S=P.high^(D<<1|M>>>31),b=P.low^(M<<1|D>>>31),_=0;_<5;_++){var E=g[R+5*_];E.high^=S,E.low^=b}for(var U=1;U<25;U++){var S,b,E=g[U],V=E.high,G=E.low,T=f[U];T<32?(S=V<<T|G>>>32-T,b=G<<T|V>>>32-T):(S=G<<T-32|V>>>64-T,b=V<<T-32|G>>>64-T);var I=d[A[U]];I.high=S,I.low=b}var H=d[0],L=g[0];H.high=L.high,H.low=L.low;for(var R=0;R<5;R++)for(var _=0;_<5;_++){var U=R+5*_,E=g[U],J=d[U],re=d[(R+1)%5+5*_],de=d[(R+2)%5+5*_];E.high=J.high^~re.high&de.high,E.low=J.low^~re.low&de.low}var E=g[0],z=u[C];E.high^=z.high,E.low^=z.low}},_doFinalize:function(){var p=this._data,m=p.words,g=this._nDataBytes*8,l=p.sigBytes*8,y=this.blockSize*32;m[l>>>5]|=1<<24-l%32,m[(e.ceil((l+1)/y)*y>>>5)-1]|=128,p.sigBytes=m.length*4,this._process();for(var B=this._state,v=this.cfg.outputLength/8,E=v/8,C=[],R=0;R<E;R++){var S=B[R],b=S.high,_=S.low;b=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,_=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,C.push(_),C.push(b)}return new s.init(C,v)},clone:function(){for(var p=o.clone.call(this),m=p._state=this._state.slice(0),g=0;g<25;g++)m[g]=m[g].clone();return p}});t.SHA3=o._createHelper(x),t.HmacSHA3=o._createHmacHelper(x)}(Math),r.SHA3})});var Zi=Q((Zn,Yi)=>{(function(r,e){typeof Zn=="object"?Yi.exports=Zn=e(j()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(Zn,function(r){return function(e){var t=r,n=t.lib,s=n.WordArray,o=n.Hasher,i=t.algo,a=s.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),c=s.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),f=s.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),A=s.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=s.create([0,1518500249,1859775393,2400959708,2840853838]),d=s.create([1352829926,1548603684,1836072691,2053994217,0]),x=i.RIPEMD160=o.extend({_doReset:function(){this._hash=s.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(v,E){for(var C=0;C<16;C++){var R=E+C,S=v[R];v[R]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360}var b=this._hash.words,_=u.words,w=d.words,P=a.words,F=c.words,D=f.words,M=A.words,U,V,G,T,I,H,L,J,re,de;H=U=b[0],L=V=b[1],J=G=b[2],re=T=b[3],de=I=b[4];for(var z,C=0;C<80;C+=1)z=U+v[E+P[C]]|0,C<16?z+=p(V,G,T)+_[0]:C<32?z+=m(V,G,T)+_[1]:C<48?z+=g(V,G,T)+_[2]:C<64?z+=l(V,G,T)+_[3]:z+=y(V,G,T)+_[4],z=z|0,z=B(z,D[C]),z=z+I|0,U=I,I=T,T=B(G,10),G=V,V=z,z=H+v[E+F[C]]|0,C<16?z+=y(L,J,re)+w[0]:C<32?z+=l(L,J,re)+w[1]:C<48?z+=g(L,J,re)+w[2]:C<64?z+=m(L,J,re)+w[3]:z+=p(L,J,re)+w[4],z=z|0,z=B(z,M[C]),z=z+de|0,H=de,de=re,re=B(J,10),J=L,L=z;z=b[1]+G+re|0,b[1]=b[2]+T+de|0,b[2]=b[3]+I+H|0,b[3]=b[4]+U+L|0,b[4]=b[0]+V+J|0,b[0]=z},_doFinalize:function(){var v=this._data,E=v.words,C=this._nDataBytes*8,R=v.sigBytes*8;E[R>>>5]|=128<<24-R%32,E[(R+64>>>9<<4)+14]=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,v.sigBytes=(E.length+1)*4,this._process();for(var S=this._hash,b=S.words,_=0;_<5;_++){var w=b[_];b[_]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360}return S},clone:function(){var v=o.clone.call(this);return v._hash=this._hash.clone(),v}});function p(v,E,C){return v^E^C}function m(v,E,C){return v&E|~v&C}function g(v,E,C){return(v|~E)^C}function l(v,E,C){return v&C|E&~C}function y(v,E,C){return v^(E|~C)}function B(v,E){return v<<E|v>>>32-E}t.RIPEMD160=o._createHelper(x),t.HmacRIPEMD160=o._createHmacHelper(x)}(Math),r.RIPEMD160})});var qr=Q((Wn,Wi)=>{(function(r,e){typeof Wn=="object"?Wi.exports=Wn=e(j()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(Wn,function(r){(function(){var e=r,t=e.lib,n=t.Base,s=e.enc,o=s.Utf8,i=e.algo,a=i.HMAC=n.extend({init:function(c,f){c=this._hasher=new c.init,typeof f=="string"&&(f=o.parse(f));var A=c.blockSize,u=A*4;f.sigBytes>u&&(f=c.finalize(f)),f.clamp();for(var d=this._oKey=f.clone(),x=this._iKey=f.clone(),p=d.words,m=x.words,g=0;g<A;g++)p[g]^=1549556828,m[g]^=909522486;d.sigBytes=x.sigBytes=u,this.reset()},reset:function(){var c=this._hasher;c.reset(),c.update(this._iKey)},update:function(c){return this._hasher.update(c),this},finalize:function(c){var f=this._hasher,A=f.finalize(c);f.reset();var u=f.finalize(this._oKey.clone().concat(A));return u}})})()})});var Xi=Q((zn,zi)=>{(function(r,e,t){typeof zn=="object"?zi.exports=zn=e(j(),fr(),qr()):typeof define=="function"&&define.amd?define(["./core","./sha256","./hmac"],e):e(r.CryptoJS)})(zn,function(r){return function(){var e=r,t=e.lib,n=t.Base,s=t.WordArray,o=e.algo,i=o.SHA256,a=o.HMAC,c=o.PBKDF2=n.extend({cfg:n.extend({keySize:128/32,hasher:i,iterations:25e4}),init:function(f){this.cfg=this.cfg.extend(f)},compute:function(f,A){for(var u=this.cfg,d=a.create(u.hasher,f),x=s.create(),p=s.create([1]),m=x.words,g=p.words,l=u.keySize,y=u.iterations;m.length<l;){var B=d.update(A).finalize(p);d.reset();for(var v=B.words,E=v.length,C=B,R=1;R<y;R++){C=d.finalize(C),d.reset();for(var S=C.words,b=0;b<E;b++)v[b]^=S[b]}x.concat(B),g[0]++}return x.sigBytes=l*4,x}});e.PBKDF2=function(f,A,u){return c.create(u).compute(f,A)}}(),r.PBKDF2})});var ct=Q((Xn,ji)=>{(function(r,e,t){typeof Xn=="object"?ji.exports=Xn=e(j(),E0(),qr()):typeof define=="function"&&define.amd?define(["./core","./sha1","./hmac"],e):e(r.CryptoJS)})(Xn,function(r){return function(){var e=r,t=e.lib,n=t.Base,s=t.WordArray,o=e.algo,i=o.MD5,a=o.EvpKDF=n.extend({cfg:n.extend({keySize:128/32,hasher:i,iterations:1}),init:function(c){this.cfg=this.cfg.extend(c)},compute:function(c,f){for(var A,u=this.cfg,d=u.hasher.create(),x=s.create(),p=x.words,m=u.keySize,g=u.iterations;p.length<m;){A&&d.update(A),A=d.update(c).finalize(f),d.reset();for(var l=1;l<g;l++)A=d.finalize(A),d.reset();x.concat(A)}return x.sigBytes=m*4,x}});e.EvpKDF=function(c,f,A){return a.create(A).compute(c,f)}}(),r.EvpKDF})});var fe=Q((jn,Ji)=>{(function(r,e,t){typeof jn=="object"?Ji.exports=jn=e(j(),ct()):typeof define=="function"&&define.amd?define(["./core","./evpkdf"],e):e(r.CryptoJS)})(jn,function(r){r.lib.Cipher||function(e){var t=r,n=t.lib,s=n.Base,o=n.WordArray,i=n.BufferedBlockAlgorithm,a=t.enc,c=a.Utf8,f=a.Base64,A=t.algo,u=A.EvpKDF,d=n.Cipher=i.extend({cfg:s.extend(),createEncryptor:function(w,P){return this.create(this._ENC_XFORM_MODE,w,P)},createDecryptor:function(w,P){return this.create(this._DEC_XFORM_MODE,w,P)},init:function(w,P,F){this.cfg=this.cfg.extend(F),this._xformMode=w,this._key=P,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(w){return this._append(w),this._process()},finalize:function(w){w&&this._append(w);var P=this._doFinalize();return P},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function w(P){return typeof P=="string"?_:R}return function(P){return{encrypt:function(F,D,M){return w(D).encrypt(P,F,D,M)},decrypt:function(F,D,M){return w(D).decrypt(P,F,D,M)}}}}()}),x=n.StreamCipher=d.extend({_doFinalize:function(){var w=this._process(!0);return w},blockSize:1}),p=t.mode={},m=n.BlockCipherMode=s.extend({createEncryptor:function(w,P){return this.Encryptor.create(w,P)},createDecryptor:function(w,P){return this.Decryptor.create(w,P)},init:function(w,P){this._cipher=w,this._iv=P}}),g=p.CBC=function(){var w=m.extend();w.Encryptor=w.extend({processBlock:function(F,D){var M=this._cipher,U=M.blockSize;P.call(this,F,D,U),M.encryptBlock(F,D),this._prevBlock=F.slice(D,D+U)}}),w.Decryptor=w.extend({processBlock:function(F,D){var M=this._cipher,U=M.blockSize,V=F.slice(D,D+U);M.decryptBlock(F,D),P.call(this,F,D,U),this._prevBlock=V}});function P(F,D,M){var U,V=this._iv;V?(U=V,this._iv=e):U=this._prevBlock;for(var G=0;G<M;G++)F[D+G]^=U[G]}return w}(),l=t.pad={},y=l.Pkcs7={pad:function(w,P){for(var F=P*4,D=F-w.sigBytes%F,M=D<<24|D<<16|D<<8|D,U=[],V=0;V<D;V+=4)U.push(M);var G=o.create(U,D);w.concat(G)},unpad:function(w){var P=w.words[w.sigBytes-1>>>2]&255;w.sigBytes-=P}},B=n.BlockCipher=d.extend({cfg:d.cfg.extend({mode:g,padding:y}),reset:function(){var w;d.reset.call(this);var P=this.cfg,F=P.iv,D=P.mode;this._xformMode==this._ENC_XFORM_MODE?w=D.createEncryptor:(w=D.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==w?this._mode.init(this,F&&F.words):(this._mode=w.call(D,this,F&&F.words),this._mode.__creator=w)},_doProcessBlock:function(w,P){this._mode.processBlock(w,P)},_doFinalize:function(){var w,P=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(P.pad(this._data,this.blockSize),w=this._process(!0)):(w=this._process(!0),P.unpad(w)),w},blockSize:128/32}),v=n.CipherParams=s.extend({init:function(w){this.mixIn(w)},toString:function(w){return(w||this.formatter).stringify(this)}}),E=t.format={},C=E.OpenSSL={stringify:function(w){var P,F=w.ciphertext,D=w.salt;return D?P=o.create([1398893684,1701076831]).concat(D).concat(F):P=F,P.toString(f)},parse:function(w){var P,F=f.parse(w),D=F.words;return D[0]==1398893684&&D[1]==1701076831&&(P=o.create(D.slice(2,4)),D.splice(0,4),F.sigBytes-=16),v.create({ciphertext:F,salt:P})}},R=n.SerializableCipher=s.extend({cfg:s.extend({format:C}),encrypt:function(w,P,F,D){D=this.cfg.extend(D);var M=w.createEncryptor(F,D),U=M.finalize(P),V=M.cfg;return v.create({ciphertext:U,key:F,iv:V.iv,algorithm:w,mode:V.mode,padding:V.padding,blockSize:w.blockSize,formatter:D.format})},decrypt:function(w,P,F,D){D=this.cfg.extend(D),P=this._parse(P,D.format);var M=w.createDecryptor(F,D).finalize(P.ciphertext);return M},_parse:function(w,P){return typeof w=="string"?P.parse(w,this):w}}),S=t.kdf={},b=S.OpenSSL={execute:function(w,P,F,D,M){if(D||(D=o.random(64/8)),M)var U=u.create({keySize:P+F,hasher:M}).compute(w,D);else var U=u.create({keySize:P+F}).compute(w,D);var V=o.create(U.words.slice(P),F*4);return U.sigBytes=P*4,v.create({key:U,iv:V,salt:D})}},_=n.PasswordBasedCipher=R.extend({cfg:R.cfg.extend({kdf:b}),encrypt:function(w,P,F,D){D=this.cfg.extend(D);var M=D.kdf.execute(F,w.keySize,w.ivSize,D.salt,D.hasher);D.iv=M.iv;var U=R.encrypt.call(this,w,P,M.key,D);return U.mixIn(M),U},decrypt:function(w,P,F,D){D=this.cfg.extend(D),P=this._parse(P,D.format);var M=D.kdf.execute(F,w.keySize,w.ivSize,P.salt,D.hasher);D.iv=M.iv;var U=R.decrypt.call(this,w,P,M.key,D);return U}})}()})});var ea=Q((Jn,$i)=>{(function(r,e,t){typeof Jn=="object"?$i.exports=Jn=e(j(),fe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(Jn,function(r){return r.mode.CFB=function(){var e=r.lib.BlockCipherMode.extend();e.Encryptor=e.extend({processBlock:function(n,s){var o=this._cipher,i=o.blockSize;t.call(this,n,s,i,o),this._prevBlock=n.slice(s,s+i)}}),e.Decryptor=e.extend({processBlock:function(n,s){var o=this._cipher,i=o.blockSize,a=n.slice(s,s+i);t.call(this,n,s,i,o),this._prevBlock=a}});function t(n,s,o,i){var a,c=this._iv;c?(a=c.slice(0),this._iv=void 0):a=this._prevBlock,i.encryptBlock(a,0);for(var f=0;f<o;f++)n[s+f]^=a[f]}return e}(),r.mode.CFB})});var ra=Q(($n,ta)=>{(function(r,e,t){typeof $n=="object"?ta.exports=$n=e(j(),fe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})($n,function(r){return r.mode.CTR=function(){var e=r.lib.BlockCipherMode.extend(),t=e.Encryptor=e.extend({processBlock:function(n,s){var o=this._cipher,i=o.blockSize,a=this._iv,c=this._counter;a&&(c=this._counter=a.slice(0),this._iv=void 0);var f=c.slice(0);o.encryptBlock(f,0),c[i-1]=c[i-1]+1|0;for(var A=0;A<i;A++)n[s+A]^=f[A]}});return e.Decryptor=t,e}(),r.mode.CTR})});var sa=Q((es,na)=>{(function(r,e,t){typeof es=="object"?na.exports=es=e(j(),fe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(es,function(r){return r.mode.CTRGladman=function(){var e=r.lib.BlockCipherMode.extend();function t(o){if((o>>24&255)===255){var i=o>>16&255,a=o>>8&255,c=o&255;i===255?(i=0,a===255?(a=0,c===255?c=0:++c):++a):++i,o=0,o+=i<<16,o+=a<<8,o+=c}else o+=1<<24;return o}function n(o){return(o[0]=t(o[0]))===0&&(o[1]=t(o[1])),o}var s=e.Encryptor=e.extend({processBlock:function(o,i){var a=this._cipher,c=a.blockSize,f=this._iv,A=this._counter;f&&(A=this._counter=f.slice(0),this._iv=void 0),n(A);var u=A.slice(0);a.encryptBlock(u,0);for(var d=0;d<c;d++)o[i+d]^=u[d]}});return e.Decryptor=s,e}(),r.mode.CTRGladman})});var ia=Q((ts,oa)=>{(function(r,e,t){typeof ts=="object"?oa.exports=ts=e(j(),fe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(ts,function(r){return r.mode.OFB=function(){var e=r.lib.BlockCipherMode.extend(),t=e.Encryptor=e.extend({processBlock:function(n,s){var o=this._cipher,i=o.blockSize,a=this._iv,c=this._keystream;a&&(c=this._keystream=a.slice(0),this._iv=void 0),o.encryptBlock(c,0);for(var f=0;f<i;f++)n[s+f]^=c[f]}});return e.Decryptor=t,e}(),r.mode.OFB})});var ca=Q((rs,aa)=>{(function(r,e,t){typeof rs=="object"?aa.exports=rs=e(j(),fe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(rs,function(r){return r.mode.ECB=function(){var e=r.lib.BlockCipherMode.extend();return e.Encryptor=e.extend({processBlock:function(t,n){this._cipher.encryptBlock(t,n)}}),e.Decryptor=e.extend({processBlock:function(t,n){this._cipher.decryptBlock(t,n)}}),e}(),r.mode.ECB})});var da=Q((ns,Aa)=>{(function(r,e,t){typeof ns=="object"?Aa.exports=ns=e(j(),fe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(ns,function(r){return r.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,s=t*4,o=s-n%s,i=n+o-1;e.clamp(),e.words[i>>>2]|=o<<24-i%4*8,e.sigBytes+=o},unpad:function(e){var t=e.words[e.sigBytes-1>>>2]&255;e.sigBytes-=t}},r.pad.Ansix923})});var ua=Q((ss,fa)=>{(function(r,e,t){typeof ss=="object"?fa.exports=ss=e(j(),fe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(ss,function(r){return r.pad.Iso10126={pad:function(e,t){var n=t*4,s=n-e.sigBytes%n;e.concat(r.lib.WordArray.random(s-1)).concat(r.lib.WordArray.create([s<<24],1))},unpad:function(e){var t=e.words[e.sigBytes-1>>>2]&255;e.sigBytes-=t}},r.pad.Iso10126})});var ha=Q((os,la)=>{(function(r,e,t){typeof os=="object"?la.exports=os=e(j(),fe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(os,function(r){return r.pad.Iso97971={pad:function(e,t){e.concat(r.lib.WordArray.create([2147483648],1)),r.pad.ZeroPadding.pad(e,t)},unpad:function(e){r.pad.ZeroPadding.unpad(e),e.sigBytes--}},r.pad.Iso97971})});var pa=Q((is,xa)=>{(function(r,e,t){typeof is=="object"?xa.exports=is=e(j(),fe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(is,function(r){return r.pad.ZeroPadding={pad:function(e,t){var n=t*4;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){for(var t=e.words,n=e.sigBytes-1,n=e.sigBytes-1;n>=0;n--)if(t[n>>>2]>>>24-n%4*8&255){e.sigBytes=n+1;break}}},r.pad.ZeroPadding})});var ma=Q((as,ya)=>{(function(r,e,t){typeof as=="object"?ya.exports=as=e(j(),fe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(as,function(r){return r.pad.NoPadding={pad:function(){},unpad:function(){}},r.pad.NoPadding})});var Ba=Q((cs,ga)=>{(function(r,e,t){typeof cs=="object"?ga.exports=cs=e(j(),fe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(cs,function(r){return function(e){var t=r,n=t.lib,s=n.CipherParams,o=t.enc,i=o.Hex,a=t.format,c=a.Hex={stringify:function(f){return f.ciphertext.toString(i)},parse:function(f){var A=i.parse(f);return s.create({ciphertext:A})}}}(),r.format.Hex})});var va=Q((As,Ca)=>{(function(r,e,t){typeof As=="object"?Ca.exports=As=e(j(),Dt(),St(),ct(),fe()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(r.CryptoJS)})(As,function(r){return function(){var e=r,t=e.lib,n=t.BlockCipher,s=e.algo,o=[],i=[],a=[],c=[],f=[],A=[],u=[],d=[],x=[],p=[];(function(){for(var l=[],y=0;y<256;y++)y<128?l[y]=y<<1:l[y]=y<<1^283;for(var B=0,v=0,y=0;y<256;y++){var E=v^v<<1^v<<2^v<<3^v<<4;E=E>>>8^E&255^99,o[B]=E,i[E]=B;var C=l[B],R=l[C],S=l[R],b=l[E]*257^E*16843008;a[B]=b<<24|b>>>8,c[B]=b<<16|b>>>16,f[B]=b<<8|b>>>24,A[B]=b;var b=S*16843009^R*65537^C*257^B*16843008;u[E]=b<<24|b>>>8,d[E]=b<<16|b>>>16,x[E]=b<<8|b>>>24,p[E]=b,B?(B=C^l[l[l[S^C]]],v^=l[l[v]]):B=v=1}})();var m=[0,1,2,4,8,16,32,64,128,27,54],g=s.AES=n.extend({_doReset:function(){var l;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var y=this._keyPriorReset=this._key,B=y.words,v=y.sigBytes/4,E=this._nRounds=v+6,C=(E+1)*4,R=this._keySchedule=[],S=0;S<C;S++)S<v?R[S]=B[S]:(l=R[S-1],S%v?v>6&&S%v==4&&(l=o[l>>>24]<<24|o[l>>>16&255]<<16|o[l>>>8&255]<<8|o[l&255]):(l=l<<8|l>>>24,l=o[l>>>24]<<24|o[l>>>16&255]<<16|o[l>>>8&255]<<8|o[l&255],l^=m[S/v|0]<<24),R[S]=R[S-v]^l);for(var b=this._invKeySchedule=[],_=0;_<C;_++){var S=C-_;if(_%4)var l=R[S];else var l=R[S-4];_<4||S<=4?b[_]=l:b[_]=u[o[l>>>24]]^d[o[l>>>16&255]]^x[o[l>>>8&255]]^p[o[l&255]]}}},encryptBlock:function(l,y){this._doCryptBlock(l,y,this._keySchedule,a,c,f,A,o)},decryptBlock:function(l,y){var B=l[y+1];l[y+1]=l[y+3],l[y+3]=B,this._doCryptBlock(l,y,this._invKeySchedule,u,d,x,p,i);var B=l[y+1];l[y+1]=l[y+3],l[y+3]=B},_doCryptBlock:function(l,y,B,v,E,C,R,S){for(var b=this._nRounds,_=l[y]^B[0],w=l[y+1]^B[1],P=l[y+2]^B[2],F=l[y+3]^B[3],D=4,M=1;M<b;M++){var U=v[_>>>24]^E[w>>>16&255]^C[P>>>8&255]^R[F&255]^B[D++],V=v[w>>>24]^E[P>>>16&255]^C[F>>>8&255]^R[_&255]^B[D++],G=v[P>>>24]^E[F>>>16&255]^C[_>>>8&255]^R[w&255]^B[D++],T=v[F>>>24]^E[_>>>16&255]^C[w>>>8&255]^R[P&255]^B[D++];_=U,w=V,P=G,F=T}var U=(S[_>>>24]<<24|S[w>>>16&255]<<16|S[P>>>8&255]<<8|S[F&255])^B[D++],V=(S[w>>>24]<<24|S[P>>>16&255]<<16|S[F>>>8&255]<<8|S[_&255])^B[D++],G=(S[P>>>24]<<24|S[F>>>16&255]<<16|S[_>>>8&255]<<8|S[w&255])^B[D++],T=(S[F>>>24]<<24|S[_>>>16&255]<<16|S[w>>>8&255]<<8|S[P&255])^B[D++];l[y]=U,l[y+1]=V,l[y+2]=G,l[y+3]=T},keySize:256/32});e.AES=n._createHelper(g)}(),r.AES})});var ba=Q((ds,Ea)=>{(function(r,e,t){typeof ds=="object"?Ea.exports=ds=e(j(),Dt(),St(),ct(),fe()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(r.CryptoJS)})(ds,function(r){return function(){var e=r,t=e.lib,n=t.WordArray,s=t.BlockCipher,o=e.algo,i=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],f=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],A=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],u=o.DES=s.extend({_doReset:function(){for(var m=this._key,g=m.words,l=[],y=0;y<56;y++){var B=i[y]-1;l[y]=g[B>>>5]>>>31-B%32&1}for(var v=this._subKeys=[],E=0;E<16;E++){for(var C=v[E]=[],R=c[E],y=0;y<24;y++)C[y/6|0]|=l[(a[y]-1+R)%28]<<31-y%6,C[4+(y/6|0)]|=l[28+(a[y+24]-1+R)%28]<<31-y%6;C[0]=C[0]<<1|C[0]>>>31;for(var y=1;y<7;y++)C[y]=C[y]>>>(y-1)*4+3;C[7]=C[7]<<5|C[7]>>>27}for(var S=this._invSubKeys=[],y=0;y<16;y++)S[y]=v[15-y]},encryptBlock:function(m,g){this._doCryptBlock(m,g,this._subKeys)},decryptBlock:function(m,g){this._doCryptBlock(m,g,this._invSubKeys)},_doCryptBlock:function(m,g,l){this._lBlock=m[g],this._rBlock=m[g+1],d.call(this,4,252645135),d.call(this,16,65535),x.call(this,2,858993459),x.call(this,8,16711935),d.call(this,1,1431655765);for(var y=0;y<16;y++){for(var B=l[y],v=this._lBlock,E=this._rBlock,C=0,R=0;R<8;R++)C|=f[R][((E^B[R])&A[R])>>>0];this._lBlock=E,this._rBlock=v^C}var S=this._lBlock;this._lBlock=this._rBlock,this._rBlock=S,d.call(this,1,1431655765),x.call(this,8,16711935),x.call(this,2,858993459),d.call(this,16,65535),d.call(this,4,252645135),m[g]=this._lBlock,m[g+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function d(m,g){var l=(this._lBlock>>>m^this._rBlock)&g;this._rBlock^=l,this._lBlock^=l<<m}function x(m,g){var l=(this._rBlock>>>m^this._lBlock)&g;this._lBlock^=l,this._rBlock^=l<<m}e.DES=s._createHelper(u);var p=o.TripleDES=s.extend({_doReset:function(){var m=this._key,g=m.words;if(g.length!==2&&g.length!==4&&g.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var l=g.slice(0,2),y=g.length<4?g.slice(0,2):g.slice(2,4),B=g.length<6?g.slice(0,2):g.slice(4,6);this._des1=u.createEncryptor(n.create(l)),this._des2=u.createEncryptor(n.create(y)),this._des3=u.createEncryptor(n.create(B))},encryptBlock:function(m,g){this._des1.encryptBlock(m,g),this._des2.decryptBlock(m,g),this._des3.encryptBlock(m,g)},decryptBlock:function(m,g){this._des3.decryptBlock(m,g),this._des2.encryptBlock(m,g),this._des1.decryptBlock(m,g)},keySize:192/32,ivSize:64/32,blockSize:64/32});e.TripleDES=s._createHelper(p)}(),r.TripleDES})});var _a=Q((fs,wa)=>{(function(r,e,t){typeof fs=="object"?wa.exports=fs=e(j(),Dt(),St(),ct(),fe()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(r.CryptoJS)})(fs,function(r){return function(){var e=r,t=e.lib,n=t.StreamCipher,s=e.algo,o=s.RC4=n.extend({_doReset:function(){for(var c=this._key,f=c.words,A=c.sigBytes,u=this._S=[],d=0;d<256;d++)u[d]=d;for(var d=0,x=0;d<256;d++){var p=d%A,m=f[p>>>2]>>>24-p%4*8&255;x=(x+u[d]+m)%256;var g=u[d];u[d]=u[x],u[x]=g}this._i=this._j=0},_doProcessBlock:function(c,f){c[f]^=i.call(this)},keySize:256/32,ivSize:0});function i(){for(var c=this._S,f=this._i,A=this._j,u=0,d=0;d<4;d++){f=(f+1)%256,A=(A+c[f])%256;var x=c[f];c[f]=c[A],c[A]=x,u|=c[(c[f]+c[A])%256]<<24-d*8}return this._i=f,this._j=A,u}e.RC4=n._createHelper(o);var a=s.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var c=this.cfg.drop;c>0;c--)i.call(this)}});e.RC4Drop=n._createHelper(a)}(),r.RC4})});var Sa=Q((us,Da)=>{(function(r,e,t){typeof us=="object"?Da.exports=us=e(j(),Dt(),St(),ct(),fe()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(r.CryptoJS)})(us,function(r){return function(){var e=r,t=e.lib,n=t.StreamCipher,s=e.algo,o=[],i=[],a=[],c=s.Rabbit=n.extend({_doReset:function(){for(var A=this._key.words,u=this.cfg.iv,d=0;d<4;d++)A[d]=(A[d]<<8|A[d]>>>24)&16711935|(A[d]<<24|A[d]>>>8)&4278255360;var x=this._X=[A[0],A[3]<<16|A[2]>>>16,A[1],A[0]<<16|A[3]>>>16,A[2],A[1]<<16|A[0]>>>16,A[3],A[2]<<16|A[1]>>>16],p=this._C=[A[2]<<16|A[2]>>>16,A[0]&4294901760|A[1]&65535,A[3]<<16|A[3]>>>16,A[1]&4294901760|A[2]&65535,A[0]<<16|A[0]>>>16,A[2]&4294901760|A[3]&65535,A[1]<<16|A[1]>>>16,A[3]&4294901760|A[0]&65535];this._b=0;for(var d=0;d<4;d++)f.call(this);for(var d=0;d<8;d++)p[d]^=x[d+4&7];if(u){var m=u.words,g=m[0],l=m[1],y=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,B=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360,v=y>>>16|B&4294901760,E=B<<16|y&65535;p[0]^=y,p[1]^=v,p[2]^=B,p[3]^=E,p[4]^=y,p[5]^=v,p[6]^=B,p[7]^=E;for(var d=0;d<4;d++)f.call(this)}},_doProcessBlock:function(A,u){var d=this._X;f.call(this),o[0]=d[0]^d[5]>>>16^d[3]<<16,o[1]=d[2]^d[7]>>>16^d[5]<<16,o[2]=d[4]^d[1]>>>16^d[7]<<16,o[3]=d[6]^d[3]>>>16^d[1]<<16;for(var x=0;x<4;x++)o[x]=(o[x]<<8|o[x]>>>24)&16711935|(o[x]<<24|o[x]>>>8)&4278255360,A[u+x]^=o[x]},blockSize:128/32,ivSize:64/32});function f(){for(var A=this._X,u=this._C,d=0;d<8;d++)i[d]=u[d];u[0]=u[0]+1295307597+this._b|0,u[1]=u[1]+3545052371+(u[0]>>>0<i[0]>>>0?1:0)|0,u[2]=u[2]+886263092+(u[1]>>>0<i[1]>>>0?1:0)|0,u[3]=u[3]+1295307597+(u[2]>>>0<i[2]>>>0?1:0)|0,u[4]=u[4]+3545052371+(u[3]>>>0<i[3]>>>0?1:0)|0,u[5]=u[5]+886263092+(u[4]>>>0<i[4]>>>0?1:0)|0,u[6]=u[6]+1295307597+(u[5]>>>0<i[5]>>>0?1:0)|0,u[7]=u[7]+3545052371+(u[6]>>>0<i[6]>>>0?1:0)|0,this._b=u[7]>>>0<i[7]>>>0?1:0;for(var d=0;d<8;d++){var x=A[d]+u[d],p=x&65535,m=x>>>16,g=((p*p>>>17)+p*m>>>15)+m*m,l=((x&4294901760)*x|0)+((x&65535)*x|0);a[d]=g^l}A[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,A[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,A[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,A[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,A[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,A[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,A[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,A[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.Rabbit=n._createHelper(c)}(),r.Rabbit})});var Ta=Q((ls,Ra)=>{(function(r,e,t){typeof ls=="object"?Ra.exports=ls=e(j(),Dt(),St(),ct(),fe()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(r.CryptoJS)})(ls,function(r){return function(){var e=r,t=e.lib,n=t.StreamCipher,s=e.algo,o=[],i=[],a=[],c=s.RabbitLegacy=n.extend({_doReset:function(){var A=this._key.words,u=this.cfg.iv,d=this._X=[A[0],A[3]<<16|A[2]>>>16,A[1],A[0]<<16|A[3]>>>16,A[2],A[1]<<16|A[0]>>>16,A[3],A[2]<<16|A[1]>>>16],x=this._C=[A[2]<<16|A[2]>>>16,A[0]&4294901760|A[1]&65535,A[3]<<16|A[3]>>>16,A[1]&4294901760|A[2]&65535,A[0]<<16|A[0]>>>16,A[2]&4294901760|A[3]&65535,A[1]<<16|A[1]>>>16,A[3]&4294901760|A[0]&65535];this._b=0;for(var p=0;p<4;p++)f.call(this);for(var p=0;p<8;p++)x[p]^=d[p+4&7];if(u){var m=u.words,g=m[0],l=m[1],y=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,B=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360,v=y>>>16|B&4294901760,E=B<<16|y&65535;x[0]^=y,x[1]^=v,x[2]^=B,x[3]^=E,x[4]^=y,x[5]^=v,x[6]^=B,x[7]^=E;for(var p=0;p<4;p++)f.call(this)}},_doProcessBlock:function(A,u){var d=this._X;f.call(this),o[0]=d[0]^d[5]>>>16^d[3]<<16,o[1]=d[2]^d[7]>>>16^d[5]<<16,o[2]=d[4]^d[1]>>>16^d[7]<<16,o[3]=d[6]^d[3]>>>16^d[1]<<16;for(var x=0;x<4;x++)o[x]=(o[x]<<8|o[x]>>>24)&16711935|(o[x]<<24|o[x]>>>8)&4278255360,A[u+x]^=o[x]},blockSize:128/32,ivSize:64/32});function f(){for(var A=this._X,u=this._C,d=0;d<8;d++)i[d]=u[d];u[0]=u[0]+1295307597+this._b|0,u[1]=u[1]+3545052371+(u[0]>>>0<i[0]>>>0?1:0)|0,u[2]=u[2]+886263092+(u[1]>>>0<i[1]>>>0?1:0)|0,u[3]=u[3]+1295307597+(u[2]>>>0<i[2]>>>0?1:0)|0,u[4]=u[4]+3545052371+(u[3]>>>0<i[3]>>>0?1:0)|0,u[5]=u[5]+886263092+(u[4]>>>0<i[4]>>>0?1:0)|0,u[6]=u[6]+1295307597+(u[5]>>>0<i[5]>>>0?1:0)|0,u[7]=u[7]+3545052371+(u[6]>>>0<i[6]>>>0?1:0)|0,this._b=u[7]>>>0<i[7]>>>0?1:0;for(var d=0;d<8;d++){var x=A[d]+u[d],p=x&65535,m=x>>>16,g=((p*p>>>17)+p*m>>>15)+m*m,l=((x&4294901760)*x|0)+((x&65535)*x|0);a[d]=g^l}A[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,A[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,A[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,A[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,A[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,A[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,A[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,A[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.RabbitLegacy=n._createHelper(c)}(),r.RabbitLegacy})});var Pa=Q((hs,Fa)=>{(function(r,e,t){typeof hs=="object"?Fa.exports=hs=e(j(),Dt(),St(),ct(),fe()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(r.CryptoJS)})(hs,function(r){return function(){var e=r,t=e.lib,n=t.BlockCipher,s=e.algo;let o=16,i=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],a=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var c={pbox:[],sbox:[]};function f(p,m){let g=m>>24&255,l=m>>16&255,y=m>>8&255,B=m&255,v=p.sbox[0][g]+p.sbox[1][l];return v=v^p.sbox[2][y],v=v+p.sbox[3][B],v}function A(p,m,g){let l=m,y=g,B;for(let v=0;v<o;++v)l=l^p.pbox[v],y=f(p,l)^y,B=l,l=y,y=B;return B=l,l=y,y=B,y=y^p.pbox[o],l=l^p.pbox[o+1],{left:l,right:y}}function u(p,m,g){let l=m,y=g,B;for(let v=o+1;v>1;--v)l=l^p.pbox[v],y=f(p,l)^y,B=l,l=y,y=B;return B=l,l=y,y=B,y=y^p.pbox[1],l=l^p.pbox[0],{left:l,right:y}}function d(p,m,g){for(let E=0;E<4;E++){p.sbox[E]=[];for(let C=0;C<256;C++)p.sbox[E][C]=a[E][C]}let l=0;for(let E=0;E<o+2;E++)p.pbox[E]=i[E]^m[l],l++,l>=g&&(l=0);let y=0,B=0,v=0;for(let E=0;E<o+2;E+=2)v=A(p,y,B),y=v.left,B=v.right,p.pbox[E]=y,p.pbox[E+1]=B;for(let E=0;E<4;E++)for(let C=0;C<256;C+=2)v=A(p,y,B),y=v.left,B=v.right,p.sbox[E][C]=y,p.sbox[E][C+1]=B;return!0}var x=s.Blowfish=n.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var p=this._keyPriorReset=this._key,m=p.words,g=p.sigBytes/4;d(c,m,g)}},encryptBlock:function(p,m){var g=A(c,p[m],p[m+1]);p[m]=g.left,p[m+1]=g.right},decryptBlock:function(p,m){var g=u(c,p[m],p[m+1]);p[m]=g.left,p[m+1]=g.right},blockSize:64/32,keySize:128/32,ivSize:64/32});e.Blowfish=n._createHelper(x)}(),r.Blowfish})});var w0=Q((xs,ka)=>{(function(r,e,t){typeof xs=="object"?ka.exports=xs=e(j(),Ur(),Ti(),Pi(),Dt(),Li(),St(),E0(),fr(),qi(),b0(),Gi(),Qi(),Zi(),qr(),Xi(),ct(),fe(),ea(),ra(),sa(),ia(),ca(),da(),ua(),ha(),pa(),ma(),Ba(),va(),ba(),_a(),Sa(),Ta(),Pa()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./lib-typedarrays","./enc-utf16","./enc-base64","./enc-base64url","./md5","./sha1","./sha256","./sha224","./sha512","./sha384","./sha3","./ripemd160","./hmac","./pbkdf2","./evpkdf","./cipher-core","./mode-cfb","./mode-ctr","./mode-ctr-gladman","./mode-ofb","./mode-ecb","./pad-ansix923","./pad-iso10126","./pad-iso97971","./pad-zeropadding","./pad-nopadding","./format-hex","./aes","./tripledes","./rc4","./rabbit","./rabbit-legacy","./blowfish"],e):r.CryptoJS=e(r.CryptoJS)})(xs,function(r){return r})});var ys=Q(ps=>{"use strict";Object.defineProperty(ps,"__esModule",{value:!0});ps.ChannelCrypto=void 0;var Te=w0(),ur=he(),_0=class{static decryptGroupTextMessage(e,t,n){try{let s=(0,ur.hexToBytes)(n),o=(0,ur.hexToBytes)(t),i=new Uint8Array(32);i.set(s,0);let a=(0,Te.HmacSHA256)(Te.enc.Hex.parse(e),Te.enc.Hex.parse((0,ur.bytesToHex)(i))),f=(0,ur.hexToBytes)(a.toString(Te.enc.Hex)).slice(0,2);if(f[0]!==o[0]||f[1]!==o[1])return{success:!1,error:"MAC verification failed"};let A=Te.enc.Hex.parse(n),u=Te.enc.Hex.parse(e),d=Te.AES.decrypt(Te.lib.CipherParams.create({ciphertext:u}),A,{mode:Te.mode.ECB,padding:Te.pad.NoPadding}),x=(0,ur.hexToBytes)(d.toString(Te.enc.Hex));if(!x||x.length<5)return{success:!1,error:"Decrypted content too short"};let p=x[0]|x[1]<<8|x[2]<<16|x[3]<<24,m=x[4],g=x.slice(5),y=new TextDecoder("utf-8").decode(g),B=y.indexOf("\0");B>=0&&(y=y.substring(0,B));let v=y.indexOf(": "),E,C;if(v>0&&v<50){let R=y.substring(0,v);/[:\[\]]/.test(R)?C=y:(E=R,C=y.substring(v+2))}else C=y;return{success:!0,data:{timestamp:p,flags:m,sender:E,message:C}}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Decryption failed"}}}static calculateChannelHash(e){let t=(0,Te.SHA256)(Te.enc.Hex.parse(e));return(0,ur.hexToBytes)(t.toString(Te.enc.Hex))[0].toString(16).padStart(2,"0")}};ps.ChannelCrypto=_0});var S0=Q(ms=>{"use strict";Object.defineProperty(ms,"__esModule",{value:!0});ms.MeshCoreKeyStore=void 0;var Bd=ys(),D0=class{constructor(e){this.nodeKeys=new Map,this.channelHashToKeys=new Map,e?.channelSecrets&&this.addChannelSecrets(e.channelSecrets),e?.nodeKeys&&Object.entries(e.nodeKeys).forEach(([t,n])=>{this.addNodeKey(t,n)})}addNodeKey(e,t){let n=e.toUpperCase();this.nodeKeys.set(n,t)}hasChannelKey(e){let t=e.toLowerCase();return this.channelHashToKeys.has(t)}hasNodeKey(e){let t=e.toUpperCase();return this.nodeKeys.has(t)}getChannelKeys(e){let t=e.toLowerCase();return this.channelHashToKeys.get(t)||[]}getNodeKey(e){let t=e.toUpperCase();return this.nodeKeys.get(t)}addChannelSecrets(e){for(let t of e){let n=Bd.ChannelCrypto.calculateChannelHash(t).toLowerCase();this.channelHashToKeys.has(n)||this.channelHashToKeys.set(n,[]),this.channelHashToKeys.get(n).push(t)}}};ms.MeshCoreKeyStore=D0});var tc={};yi(tc,{CURVE:()=>Va,ExtendedPoint:()=>$e,Point:()=>$e,etc:()=>N0,getPublicKey:()=>Rd,getPublicKeyAsync:()=>Sd,sign:()=>Fd,signAsync:()=>Td,utils:()=>Id,verify:()=>kd,verifyAsync:()=>Pd});var Va,ve,gs,Ia,La,R0,T0,Cd,Je,Vr,He,vd,Na,Ed,Wt,Es,k0,Ga,I0,At,Ha,L0,Rt,Ka,bd,Nr,Qa,Bs,Zt,N,Ya,Za,wd,Oa,F0,je,$e,dt,lr,Wa,H0,Xe,_d,Ma,Dd,Cs,O0,M0,za,U0,q0,Sd,Rd,Xa,ja,Ja,Td,Fd,V0,$a,Pd,kd,N0,Id,vs,Ld,ec,P0,Hd,Ua,qa,Od,rc=Le(()=>{Va={p:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffedn,n:0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3edn,h:8n,a:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffecn,d:0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3n,Gx:0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,Gy:0x6666666666666666666666666666666666666666666666666666666666666658n},{p:ve,n:gs,Gx:Ia,Gy:La,a:R0,d:T0}=Va,Cd=8n,Je=32,Vr=64,He=(r="")=>{throw new Error(r)},vd=r=>typeof r=="bigint",Na=r=>typeof r=="string",Ed=r=>r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array",Wt=(r,e)=>!Ed(r)||typeof e=="number"&&e>0&&r.length!==e?He("Uint8Array expected"):r,Es=r=>new Uint8Array(r),k0=r=>Uint8Array.from(r),Ga=(r,e)=>r.toString(16).padStart(e,"0"),I0=r=>Array.from(Wt(r)).map(e=>Ga(e,2)).join(""),At={_0:48,_9:57,A:65,F:70,a:97,f:102},Ha=r=>{if(r>=At._0&&r<=At._9)return r-At._0;if(r>=At.A&&r<=At.F)return r-(At.A-10);if(r>=At.a&&r<=At.f)return r-(At.a-10)},L0=r=>{let e="hex invalid";if(!Na(r))return He(e);let t=r.length,n=t/2;if(t%2)return He(e);let s=Es(n);for(let o=0,i=0;o<n;o++,i+=2){let a=Ha(r.charCodeAt(i)),c=Ha(r.charCodeAt(i+1));if(a===void 0||c===void 0)return He(e);s[o]=a*16+c}return s},Rt=(r,e)=>Wt(Na(r)?L0(r):k0(Wt(r)),e),Ka=()=>globalThis?.crypto,bd=()=>Ka()?.subtle??He("crypto.subtle must be defined"),Nr=(...r)=>{let e=Es(r.reduce((n,s)=>n+Wt(s).length,0)),t=0;return r.forEach(n=>{e.set(n,t),t+=n.length}),e},Qa=(r=Je)=>Ka().getRandomValues(Es(r)),Bs=BigInt,Zt=(r,e,t,n="bad number: out of range")=>vd(r)&&e<=r&&r<t?r:He(n),N=(r,e=ve)=>{let t=r%e;return t>=0n?t:e+t},Ya=r=>N(r,gs),Za=(r,e)=>{(r===0n||e<=0n)&&He("no inverse n="+r+" mod="+e);let t=N(r,e),n=e,s=0n,o=1n,i=1n,a=0n;for(;t!==0n;){let c=n/t,f=n%t,A=s-i*c,u=o-a*c;n=t,t=f,s=i,o=a,i=A,a=u}return n===1n?N(s,e):He("no inverse")},wd=r=>{let e=N0[r];return typeof e!="function"&&He("hashes."+r+" not set"),e},Oa=r=>r instanceof $e?r:He("Point expected"),F0=2n**256n,je=class je{constructor(e,t,n,s){Z(this,"ex");Z(this,"ey");Z(this,"ez");Z(this,"et");let o=F0;this.ex=Zt(e,0n,o),this.ey=Zt(t,0n,o),this.ez=Zt(n,1n,o),this.et=Zt(s,0n,o),Object.freeze(this)}static fromAffine(e){return new je(e.x,e.y,1n,N(e.x*e.y))}static fromBytes(e,t=!1){let n=T0,s=k0(Wt(e,Je)),o=e[31];s[31]=o&-129;let i=H0(s);Zt(i,0n,t?F0:ve);let c=N(i*i),f=N(c-1n),A=N(n*c+1n),{isValid:u,value:d}=Dd(f,A);u||He("bad point: y not sqrt");let x=(d&1n)===1n,p=(o&128)!==0;return!t&&d===0n&&p&&He("bad point: x==0, isLastByteOdd"),p!==x&&(d=N(-d)),new je(d,i,1n,N(d*i))}assertValidity(){let e=R0,t=T0,n=this;if(n.is0())throw new Error("bad point: ZERO");let{ex:s,ey:o,ez:i,et:a}=n,c=N(s*s),f=N(o*o),A=N(i*i),u=N(A*A),d=N(c*e),x=N(A*N(d+f)),p=N(u+N(t*N(c*f)));if(x!==p)throw new Error("bad point: equation left != right (1)");let m=N(s*o),g=N(i*a);if(m!==g)throw new Error("bad point: equation left != right (2)");return this}equals(e){let{ex:t,ey:n,ez:s}=this,{ex:o,ey:i,ez:a}=Oa(e),c=N(t*a),f=N(o*s),A=N(n*a),u=N(i*s);return c===f&&A===u}is0(){return this.equals(lr)}negate(){return new je(N(-this.ex),this.ey,this.ez,N(-this.et))}double(){let{ex:e,ey:t,ez:n}=this,s=R0,o=N(e*e),i=N(t*t),a=N(2n*N(n*n)),c=N(s*o),f=e+t,A=N(N(f*f)-o-i),u=c+i,d=u-a,x=c-i,p=N(A*d),m=N(u*x),g=N(A*x),l=N(d*u);return new je(p,m,l,g)}add(e){let{ex:t,ey:n,ez:s,et:o}=this,{ex:i,ey:a,ez:c,et:f}=Oa(e),A=R0,u=T0,d=N(t*i),x=N(n*a),p=N(o*u*f),m=N(s*c),g=N((t+n)*(i+a)-d-x),l=N(m-p),y=N(m+p),B=N(x-A*d),v=N(g*l),E=N(y*B),C=N(g*B),R=N(l*y);return new je(v,E,R,C)}multiply(e,t=!0){if(!t&&(e===0n||this.is0()))return lr;if(Zt(e,1n,gs),e===1n)return this;if(this.equals(dt))return Od(e).p;let n=lr,s=dt;for(let o=this;e>0n;o=o.double(),e>>=1n)e&1n?n=n.add(o):t&&(s=s.add(o));return n}toAffine(){let{ex:e,ey:t,ez:n}=this;if(this.equals(lr))return{x:0n,y:1n};let s=Za(n,ve);return N(n*s)!==1n&&He("invalid inverse"),{x:N(e*s),y:N(t*s)}}toBytes(){let{x:e,y:t}=this.assertValidity().toAffine(),n=Wa(t);return n[31]|=e&1n?128:0,n}toHex(){return I0(this.toBytes())}clearCofactor(){return this.multiply(Bs(Cd),!1)}isSmallOrder(){return this.clearCofactor().is0()}isTorsionFree(){let e=this.multiply(gs/2n,!1).double();return gs%2n&&(e=e.add(this)),e.is0()}static fromHex(e,t){return je.fromBytes(Rt(e),t)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}toRawBytes(){return this.toBytes()}};Z(je,"BASE"),Z(je,"ZERO");$e=je,dt=new $e(Ia,La,1n,N(Ia*La)),lr=new $e(0n,1n,1n,0n);$e.BASE=dt;$e.ZERO=lr;Wa=r=>L0(Ga(Zt(r,0n,F0),Vr)).reverse(),H0=r=>Bs("0x"+I0(k0(Wt(r)).reverse())),Xe=(r,e)=>{let t=r;for(;e-- >0n;)t*=t,t%=ve;return t},_d=r=>{let t=r*r%ve*r%ve,n=Xe(t,2n)*t%ve,s=Xe(n,1n)*r%ve,o=Xe(s,5n)*s%ve,i=Xe(o,10n)*o%ve,a=Xe(i,20n)*i%ve,c=Xe(a,40n)*a%ve,f=Xe(c,80n)*c%ve,A=Xe(f,80n)*c%ve,u=Xe(A,10n)*o%ve;return{pow_p_5_8:Xe(u,2n)*r%ve,b2:t}},Ma=0x2b8324804fc1df0b2b4d00993dfbd7a72f431806ad2fe478c4ee1b274a0ea0b0n,Dd=(r,e)=>{let t=N(e*e*e),n=N(t*t*e),s=_d(r*n).pow_p_5_8,o=N(r*t*s),i=N(e*o*o),a=o,c=N(o*Ma),f=i===r,A=i===N(-r),u=i===N(-r*Ma);return f&&(o=a),(A||u)&&(o=c),(N(o)&1n)===1n&&(o=N(-o)),{isValid:f||A,value:o}},Cs=r=>Ya(H0(r)),O0=(...r)=>N0.sha512Async(...r),M0=(...r)=>wd("sha512Sync")(...r),za=r=>{let e=r.slice(0,Je);e[0]&=248,e[31]&=127,e[31]|=64;let t=r.slice(Je,Vr),n=Cs(e),s=dt.multiply(n),o=s.toBytes();return{head:e,prefix:t,scalar:n,point:s,pointBytes:o}},U0=r=>O0(Rt(r,Je)).then(za),q0=r=>za(M0(Rt(r,Je))),Sd=r=>U0(r).then(e=>e.pointBytes),Rd=r=>q0(r).pointBytes,Xa=r=>O0(r.hashable).then(r.finish),ja=r=>r.finish(M0(r.hashable)),Ja=(r,e,t)=>{let{pointBytes:n,scalar:s}=r,o=Cs(e),i=dt.multiply(o).toBytes();return{hashable:Nr(i,n,t),finish:f=>{let A=Ya(o+Cs(f)*s);return Wt(Nr(i,Wa(A)),Vr)}}},Td=async(r,e)=>{let t=Rt(r),n=await U0(e),s=await O0(n.prefix,t);return Xa(Ja(n,s,t))},Fd=(r,e)=>{let t=Rt(r),n=q0(e),s=M0(n.prefix,t);return ja(Ja(n,s,t))},V0={zip215:!0},$a=(r,e,t,n=V0)=>{r=Rt(r,Vr),e=Rt(e),t=Rt(t,Je);let{zip215:s}=n,o,i,a,c,f=Uint8Array.of();try{o=$e.fromHex(t,s),i=$e.fromHex(r.slice(0,Je),s),a=H0(r.slice(Je,Vr)),c=dt.multiply(a,!1),f=Nr(i.toBytes(),o.toBytes(),e)}catch{}return{hashable:f,finish:u=>{if(c==null||!s&&o.isSmallOrder())return!1;let d=Cs(u);return i.add(o.multiply(d,!1)).add(c.negate()).clearCofactor().is0()}}},Pd=async(r,e,t,n=V0)=>Xa($a(r,e,t,n)),kd=(r,e,t,n=V0)=>ja($a(r,e,t,n)),N0={sha512Async:async(...r)=>{let e=bd(),t=Nr(...r);return Es(await e.digest("SHA-512",t.buffer))},sha512Sync:void 0,bytesToHex:I0,hexToBytes:L0,concatBytes:Nr,mod:N,invert:Za,randomBytes:Qa},Id={getExtendedPublicKeyAsync:U0,getExtendedPublicKey:q0,randomPrivateKey:()=>Qa(Je),precompute:(r=8,e=dt)=>(e.multiply(3n),e)},vs=8,Ld=256,ec=Math.ceil(Ld/vs)+1,P0=2**(vs-1),Hd=()=>{let r=[],e=dt,t=e;for(let n=0;n<ec;n++){t=e,r.push(t);for(let s=1;s<P0;s++)t=t.add(e),r.push(t);e=t.double()}return r},qa=(r,e)=>{let t=e.negate();return r?t:e},Od=r=>{let e=Ua||(Ua=Hd()),t=lr,n=dt,s=2**vs,o=s,i=Bs(s-1),a=Bs(vs);for(let c=0;c<ec;c++){let f=Number(r&i);r>>=a,f>P0&&(f-=o,r+=1n);let A=c*P0,u=A,d=A+Math.abs(f)-1,x=c%2!==0,p=f<0;f===0?n=n.add(qa(x,e[u])):t=t.add(qa(p,e[d]))}return{p:t,f:n}}});var sc=Q((nc,bs)=>{var G0=(()=>{var r=typeof document<"u"?document.currentScript?.src:void 0;return async function(e={}){var t,n=e,s=typeof window=="object",o=typeof WorkerGlobalScope<"u",i=typeof process=="object"&&process.versions?.node&&process.type!="renderer",a=[],c="./this.program",f=(k,O)=>{throw O};typeof __filename<"u"?r=__filename:o&&(r=self.location.href);var A="";function u(k){return n.locateFile?n.locateFile(k,A):A+k}var d,x;if(i){var p=ar("fs");A=__dirname+"/",x=k=>{k=B(k)?new URL(k):k;var O=p.readFileSync(k);return O},d=async(k,O=!0)=>{k=B(k)?new URL(k):k;var K=p.readFileSync(k,O?void 0:"utf8");return K},process.argv.length>1&&(c=process.argv[1].replace(/\\/g,"/")),a=process.argv.slice(2),f=(k,O)=>{throw process.exitCode=k,O}}else if(s||o){try{A=new URL(".",r).href}catch{}o&&(x=k=>{var O=new XMLHttpRequest;return O.open("GET",k,!1),O.responseType="arraybuffer",O.send(null),new Uint8Array(O.response)}),d=async k=>{if(B(k))return new Promise((K,$)=>{var ne=new XMLHttpRequest;ne.open("GET",k,!0),ne.responseType="arraybuffer",ne.onload=()=>{if(ne.status==200||ne.status==0&&ne.response){K(ne.response);return}$(ne.status)},ne.onerror=$,ne.send(null)});var O=await fetch(k,{credentials:"same-origin"});if(O.ok)return O.arrayBuffer();throw new Error(O.status+" : "+O.url)}}var m=console.log.bind(console),g=console.error.bind(console),l,y=!1,B=k=>k.startsWith("file://"),v,E,C,R,S,b,_,w,P,F,D,M,U,V=!1;function G(){var k=C.buffer;n.HEAP8=R=new Int8Array(k),b=new Int16Array(k),n.HEAPU8=S=new Uint8Array(k),_=new Uint16Array(k),n.HEAP32=w=new Int32Array(k),n.HEAPU32=P=new Uint32Array(k),F=new Float32Array(k),D=new Float64Array(k),M=new BigInt64Array(k),U=new BigUint64Array(k)}function T(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)Se(n.preRun.shift());bt(De)}function I(){V=!0,Kt.b()}function H(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)Vt(n.postRun.shift());bt(or)}var L=0,J=null;function re(k){L++,n.monitorRunDependencies?.(L)}function de(k){if(L--,n.monitorRunDependencies?.(L),L==0&&J){var O=J;J=null,O()}}function z(k){n.onAbort?.(k),k="Aborted("+k+")",g(k),y=!0,k+=". Build with -sASSERTIONS for more info.";var O=new WebAssembly.RuntimeError(k);throw E?.(O),O}var ke;function Ve(){return u("orlp-ed25519.wasm")}function vt(k){if(k==ke&&l)return new Uint8Array(l);if(x)return x(k);throw"both async and sync fetching of the wasm failed"}async function st(k){if(!l)try{var O=await d(k);return new Uint8Array(O)}catch{}return vt(k)}async function be(k,O){try{var K=await st(k),$=await WebAssembly.instantiate(K,O);return $}catch(ne){g(`failed to asynchronously prepare wasm: ${ne}`),z(ne)}}async function le(k,O,K){if(!k&&typeof WebAssembly.instantiateStreaming=="function"&&!B(O)&&!i)try{var $=fetch(O,{credentials:"same-origin"}),ne=await WebAssembly.instantiateStreaming($,K);return ne}catch(ie){g(`wasm streaming compile failed: ${ie}`),g("falling back to ArrayBuffer instantiation")}return be(O,K)}function ot(){return{a:Fn}}async function We(){function k(ie,se){return Kt=ie.exports,C=Kt.a,G(),C0(Kt),de("wasm-instantiate"),Kt}re("wasm-instantiate");function O(ie){return k(ie.instance)}var K=ot();if(n.instantiateWasm)return new Promise((ie,se)=>{n.instantiateWasm(K,(ce,wt)=>{ie(k(ce,wt))})});ke??(ke=Ve());var $=await le(l,ke,K),ne=O($);return ne}class Et{constructor(O){Z(this,"name","ExitStatus");this.message=`Program terminated with exit(${O})`,this.status=O}}var bt=k=>{for(;k.length>0;)k.shift()(n)},or=[],Vt=k=>or.push(k),De=[],Se=k=>De.push(k),ze=!0,ir=k=>Lr(k),Bn=()=>Tn(),it=k=>{var O=n["_"+k];return O},Nt=(k,O)=>{R.set(k,O)},y0=k=>{for(var O=0,K=0;K<k.length;++K){var $=k.charCodeAt(K);$<=127?O++:$<=2047?O+=2:$>=55296&&$<=57343?(O+=4,++K):O+=3}return O},Cn=(k,O,K,$)=>{if(!($>0))return 0;for(var ne=K,ie=K+$-1,se=0;se<k.length;++se){var ce=k.codePointAt(se);if(ce<=127){if(K>=ie)break;O[K++]=ce}else if(ce<=2047){if(K+1>=ie)break;O[K++]=192|ce>>6,O[K++]=128|ce&63}else if(ce<=65535){if(K+2>=ie)break;O[K++]=224|ce>>12,O[K++]=128|ce>>6&63,O[K++]=128|ce&63}else{if(K+3>=ie)break;O[K++]=240|ce>>18,O[K++]=128|ce>>12&63,O[K++]=128|ce>>6&63,O[K++]=128|ce&63,se++}}return O[K]=0,K-ne},vn=(k,O,K)=>Cn(k,S,O,K),at=k=>Rn(k),Gt=k=>{var O=y0(k)+1,K=at(O);return vn(k,K,O),K},En=typeof TextDecoder<"u"?new TextDecoder:void 0,bn=(k,O=0,K=NaN)=>{for(var $=O+K,ne=O;k[ne]&&!(ne>=$);)++ne;if(ne-O>16&&k.buffer&&En)return En.decode(k.subarray(O,ne));for(var ie="";O<ne;){var se=k[O++];if(!(se&128)){ie+=String.fromCharCode(se);continue}var ce=k[O++]&63;if((se&224)==192){ie+=String.fromCharCode((se&31)<<6|ce);continue}var wt=k[O++]&63;if((se&240)==224?se=(se&15)<<12|ce<<6|wt:se=(se&7)<<18|ce<<12|wt<<6|k[O++]&63,se<65536)ie+=String.fromCharCode(se);else{var Qt=se-65536;ie+=String.fromCharCode(55296|Qt>>10,56320|Qt&1023)}}return ie},wn=(k,O)=>k?bn(S,k,O):"",_n=(k,O,K,$,ne)=>{var ie={string:Ie=>{var Or=0;return Ie!=null&&Ie!==0&&(Or=Gt(Ie)),Or},array:Ie=>{var Or=at(Ie.length);return Nt(Ie,Or),Or}};function se(Ie){return O==="string"?wn(Ie):O==="boolean"?!!Ie:Ie}var ce=it(k),wt=[],Qt=0;if($)for(var Yt=0;Yt<$.length;Yt++){var pi=ie[K[Yt]];pi?(Qt===0&&(Qt=Bn()),wt[Yt]=pi($[Yt])):wt[Yt]=$[Yt]}var v0=ce(...wt);function nd(Ie){return Qt!==0&&ir(Qt),se(Ie)}return v0=nd(v0),v0},m0=(k,O,K,$)=>{var ne=!K||K.every(se=>se==="number"||se==="boolean"),ie=O!=="string";return ie&&ne&&!$?it(k):(...se)=>_n(k,O,K,se,$)};n.noExitRuntime&&(ze=n.noExitRuntime),n.print&&(m=n.print),n.printErr&&(g=n.printErr),n.wasmBinary&&(l=n.wasmBinary),n.arguments&&(a=n.arguments),n.thisProgram&&(c=n.thisProgram),n.ccall=_n,n.cwrap=m0;var Dn,g0,Sn,B0,Lr,Rn,Tn;function C0(k){n._orlp_derive_public_key=Dn=k.c,n._orlp_validate_keypair=g0=k.d,n._orlp_sign=Sn=k.e,n._orlp_verify=B0=k.f,Lr=k.g,Rn=k.h,Tn=k.i}var Fn={},Kt=await We();function Hr(){if(L>0){J=Hr;return}if(T(),L>0){J=Hr;return}function k(){n.calledRun=!0,!y&&(I(),v?.(n),n.onRuntimeInitialized?.(),H())}n.setStatus?(n.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>n.setStatus(""),1),k()},1)):k()}function Pn(){if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.shift()()}return Pn(),Hr(),V?t=n:t=new Promise((k,O)=>{v=k,E=O}),t}})();typeof nc=="object"&&typeof bs=="object"?(bs.exports=G0,bs.exports.default=G0):typeof define=="function"&&define.amd&&define([],()=>G0)});var _s=Q(hr=>{"use strict";Object.defineProperty(hr,"__esModule",{value:!0});hr.derivePublicKey=Ud;hr.validateKeyPair=qd;hr.sign=Vd;hr.verify=Nd;var Ne=he(),Md=sc();async function ws(){return await Md()}async function Ud(r){let e=await ws(),t=(0,Ne.hexToBytes)(r);if(t.length!==64)throw new Error(`Invalid private key length: expected 64 bytes, got ${t.length}`);let n=1024,s=1088;if(e.HEAPU8.set(t,n),e.ccall("orlp_derive_public_key","number",["number","number"],[s,n])!==0)throw new Error("orlp key derivation failed: invalid private key");let i=new Uint8Array(32);return i.set(e.HEAPU8.subarray(s,s+32)),(0,Ne.bytesToHex)(i)}async function qd(r,e){try{let t=await ws(),n=(0,Ne.hexToBytes)(r),s=(0,Ne.hexToBytes)(e);if(n.length!==64||s.length!==32)return!1;let o=2048,i=2112;return t.HEAPU8.set(n,o),t.HEAPU8.set(s,i),t.ccall("orlp_validate_keypair","number",["number","number"],[i,o])===1}catch{return!1}}async function Vd(r,e,t){let n=await ws(),s=(0,Ne.hexToBytes)(r),o=(0,Ne.hexToBytes)(e),i=(0,Ne.hexToBytes)(t);if(o.length!==64)throw new Error(`Invalid private key length: expected 64 bytes, got ${o.length}`);if(i.length!==32)throw new Error(`Invalid public key length: expected 32 bytes, got ${i.length}`);let a=1e5,c=2e5,f=3e5,A=4e5;n.HEAPU8.set(s,a),n.HEAPU8.set(o,c),n.HEAPU8.set(i,f),n.ccall("orlp_sign","void",["number","number","number","number","number"],[A,a,s.length,f,c]);let u=new Uint8Array(64);return u.set(n.HEAPU8.subarray(A,A+64)),(0,Ne.bytesToHex)(u)}async function Nd(r,e,t){try{let n=await ws(),s=(0,Ne.hexToBytes)(r),o=(0,Ne.hexToBytes)(e),i=(0,Ne.hexToBytes)(t);if(s.length!==64||i.length!==32)return!1;let a=5e5,c=6e5,f=7e5;return n.HEAPU8.set(s,c),n.HEAPU8.set(o,a),n.HEAPU8.set(i,f),n.ccall("orlp_verify","number",["number","number","number","number"],[c,a,o.length,f])===1}catch{return!1}}});var Y0=Q(et=>{"use strict";var Gd=et&&et.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var s=Object.getOwnPropertyDescriptor(e,t);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,s)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Kd=et&&et.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Qd=et&&et.__importStar||function(){var r=function(e){return r=Object.getOwnPropertyNames||function(t){var n=[];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[n.length]=s);return n},r(e)};return function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n=r(e),s=0;s<n.length;s++)n[s]!=="default"&&Gd(t,e,n[s]);return Kd(t,e),t}}();Object.defineProperty(et,"__esModule",{value:!0});et.Ed25519SignatureVerifier=void 0;var Q0=Qd((rc(),dd(tc))),Tt=he(),oc=_s();async function Yd(r){if(typeof globalThis<"u"&&globalThis.crypto&&globalThis.crypto.subtle){let e=await globalThis.crypto.subtle.digest("SHA-512",r);return new Uint8Array(e)}if(typeof ar<"u")try{let{createHash:e}=kn();return e("sha512").update(r).digest()}catch{}throw new Error("No SHA-512 implementation available")}function Zd(r){if(typeof ar<"u")try{let{createHash:e}=kn();return e("sha512").update(r).digest()}catch{}try{let e=w0(),t=e.lib.WordArray.create(r),n=e.SHA512(t),s=new Uint8Array(64);for(let o=0;o<16;o++){let i=n.words[o]||0;s[o*4]=i>>>24&255,s[o*4+1]=i>>>16&255,s[o*4+2]=i>>>8&255,s[o*4+3]=i&255}return s}catch{throw new Error("No SHA-512 implementation available for synchronous operation")}}Q0.etc.sha512Async=Yd;try{Q0.etc.sha512Sync=Zd}catch(r){console.debug("Could not set up synchronous SHA-512:",r)}var K0=class{static async verifyAdvertisementSignature(e,t,n,s){try{let o=(0,Tt.hexToBytes)(e),i=(0,Tt.hexToBytes)(t),a=(0,Tt.hexToBytes)(s),c=this.constructAdvertSignedMessage(e,n,a);return await Q0.verify(i,c,o)}catch(o){return console.error("Ed25519 signature verification failed:",o),!1}}static constructAdvertSignedMessage(e,t,n){let s=(0,Tt.hexToBytes)(e),o=new Uint8Array(4);o[0]=t&255,o[1]=t>>8&255,o[2]=t>>16&255,o[3]=t>>24&255;let i=new Uint8Array(36+n.length);return i.set(s,0),i.set(o,32),i.set(n,36),i}static getSignedMessageDescription(e,t,n){return`Public Key: ${e} + Timestamp: ${t} (${new Date(t*1e3).toISOString()}) + App Data: ${n}`}static getSignedMessageHex(e,t,n){let s=(0,Tt.hexToBytes)(n),o=this.constructAdvertSignedMessage(e,t,s);return(0,Tt.bytesToHex)(o)}static async derivePublicKey(e){try{let t=(0,Tt.hexToBytes)(e);if(t.length!==64)throw new Error(`Invalid private key length: expected 64 bytes, got ${t.length}`);return await(0,oc.derivePublicKey)(e)}catch(t){throw new Error(`Failed to derive public key: ${t instanceof Error?t.message:"Unknown error"}`)}}static derivePublicKeySync(e){try{let t=(0,Tt.hexToBytes)(e);throw t.length!==64?new Error(`Invalid private key length: expected 64 bytes, got ${t.length}`):new Error("Synchronous key derivation not supported with WASM. Use derivePublicKey() instead.")}catch(t){throw new Error(`Failed to derive public key: ${t instanceof Error?t.message:"Unknown error"}`)}}static async validateKeyPair(e,t){try{return await(0,oc.validateKeyPair)(e,t)}catch{return!1}}};et.Ed25519SignatureVerifier=K0});var ic=Q(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});Ds.AdvertPayloadDecoder=void 0;var Ae=Re(),Ft=he(),Wd=dr(),zd=Y0(),Z0=class{static decode(e,t){try{if(e.length<101){let d={type:Ae.PayloadType.Advert,version:Ae.PayloadVersion.Version1,isValid:!1,errors:["Advertisement payload too short"],publicKey:"",timestamp:0,signature:"",appData:{flags:0,deviceRole:Ae.DeviceRole.ChatNode,hasLocation:!1,hasName:!1}};return t?.includeSegments&&(d.segments=[{name:"Invalid Advert Data",description:"Advert payload too short (minimum 101 bytes required)",startByte:t.segmentOffset||0,endByte:(t.segmentOffset||0)+e.length-1,value:(0,Ft.bytesToHex)(e)}]),d}let n=[],s=t?.segmentOffset||0,o=0,i=(0,Ft.bytesToHex)(e.subarray(o,o+32));t?.includeSegments&&n.push({name:"Public Key",description:"Ed25519 public key",startByte:s+o,endByte:s+o+31,value:i}),o+=32;let a=this.readUint32LE(e,o);if(t?.includeSegments){let d=new Date(a*1e3);n.push({name:"Timestamp",description:`${a} (${d.toISOString().slice(0,19)}Z)`,startByte:s+o,endByte:s+o+3,value:(0,Ft.bytesToHex)(e.subarray(o,o+4))})}o+=4;let c=(0,Ft.bytesToHex)(e.subarray(o,o+64));t?.includeSegments&&n.push({name:"Signature",description:"Ed25519 signature",startByte:s+o,endByte:s+o+63,value:c}),o+=64;let f=e[o];if(t?.includeSegments){let d=f.toString(2).padStart(8,"0"),x=this.parseDeviceRole(f),m=` | Bits 0-3 (Role): ${(0,Wd.getDeviceRoleName)(x)} | Bit 4 (Location): ${f&Ae.AdvertFlags.HasLocation?"Yes":"No"} | Bit 7 (Name): ${f&Ae.AdvertFlags.HasName?"Yes":"No"}`;n.push({name:"App Flags",description:`Binary: ${d}${m}`,startByte:s+o,endByte:s+o,value:f.toString(16).padStart(2,"0").toUpperCase()})}o+=1;let A={type:Ae.PayloadType.Advert,version:Ae.PayloadVersion.Version1,isValid:!0,publicKey:i,timestamp:a,signature:c,appData:{flags:f,deviceRole:this.parseDeviceRole(f),hasLocation:!!(f&Ae.AdvertFlags.HasLocation),hasName:!!(f&Ae.AdvertFlags.HasName)}},u=o;if(f&Ae.AdvertFlags.HasLocation&&e.length>=u+8){let d=this.readInt32LE(e,u)/1e6,x=this.readInt32LE(e,u+4)/1e6;A.appData.location={latitude:Math.round(d*1e6)/1e6,longitude:Math.round(x*1e6)/1e6},t?.includeSegments&&(n.push({name:"Latitude",description:`${d}\xB0 (${d})`,startByte:s+u,endByte:s+u+3,value:(0,Ft.bytesToHex)(e.subarray(u,u+4))}),n.push({name:"Longitude",description:`${x}\xB0 (${x})`,startByte:s+u+4,endByte:s+u+7,value:(0,Ft.bytesToHex)(e.subarray(u+4,u+8))})),u+=8}if(f&Ae.AdvertFlags.HasFeature1&&(u+=2),f&Ae.AdvertFlags.HasFeature2&&(u+=2),f&Ae.AdvertFlags.HasName&&e.length>u){let d=e.subarray(u),x=new TextDecoder("utf-8").decode(d).replace(/\0.*$/,"");A.appData.name=this.sanitizeControlCharacters(x)||x,t?.includeSegments&&n.push({name:"Node Name",description:`Node name: "${A.appData.name}"`,startByte:s+u,endByte:s+e.length-1,value:(0,Ft.bytesToHex)(d)})}return t?.includeSegments&&(A.segments=n),A}catch(n){return{type:Ae.PayloadType.Advert,version:Ae.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode advertisement payload"],publicKey:"",timestamp:0,signature:"",appData:{flags:0,deviceRole:Ae.DeviceRole.ChatNode,hasLocation:!1,hasName:!1}}}}static async decodeWithVerification(e,t){let n=this.decode(e,t);if(!n||!n.isValid)return n;try{let o=e.subarray(100),i=(0,Ft.bytesToHex)(o),a=await zd.Ed25519SignatureVerifier.verifyAdvertisementSignature(n.publicKey,n.signature,n.timestamp,i);n.signatureValid=a,a||(n.signatureError="Ed25519 signature verification failed",n.isValid=!1,n.errors||(n.errors=[]),n.errors.push("Invalid Ed25519 signature"))}catch(s){n.signatureValid=!1,n.signatureError=s instanceof Error?s.message:"Signature verification error",n.isValid=!1,n.errors||(n.errors=[]),n.errors.push("Signature verification failed: "+(s instanceof Error?s.message:"Unknown error"))}return n}static parseDeviceRole(e){switch(e&15){case 1:return Ae.DeviceRole.ChatNode;case 2:return Ae.DeviceRole.Repeater;case 3:return Ae.DeviceRole.RoomServer;case 4:return Ae.DeviceRole.Sensor;default:return Ae.DeviceRole.ChatNode}}static readUint32LE(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24}static readInt32LE(e,t){let n=this.readUint32LE(e,t);return n>2147483647?n-4294967296:n}static sanitizeControlCharacters(e){return e&&e.trim().replace(/[\x00-\x1F\x7F]/g,"")||null}};Ds.AdvertPayloadDecoder=Z0});var ac=Q(Ss=>{"use strict";Object.defineProperty(Ss,"__esModule",{value:!0});Ss.TracePayloadDecoder=void 0;var xr=Re(),pr=he(),W0=class{static decode(e,t,n){try{if(e.length<9){let m={type:xr.PayloadType.Trace,version:xr.PayloadVersion.Version1,isValid:!1,errors:["Trace payload too short (need at least tag(4) + auth(4) + flags(1))"],traceTag:"00000000",authCode:0,flags:0,pathHashes:[]};return n?.includeSegments&&(m.segments=[{name:"Invalid Trace Data",description:"Trace payload too short (minimum 9 bytes required)",startByte:n.segmentOffset||0,endByte:(n.segmentOffset||0)+e.length-1,value:(0,pr.bytesToHex)(e)}]),m}let s=0,o=[],i=n?.segmentOffset||0,a=this.readUint32LE(e,s),c=(0,pr.numberToHex)(a,8);n?.includeSegments&&o.push({name:"Trace Tag",description:`Unique identifier for this trace: 0x${a.toString(16).padStart(8,"0")}`,startByte:i+s,endByte:i+s+3,value:(0,pr.bytesToHex)(e.slice(s,s+4))}),s+=4;let f=this.readUint32LE(e,s);n?.includeSegments&&o.push({name:"Auth Code",description:`Authentication/verification code: ${f}`,startByte:i+s,endByte:i+s+3,value:(0,pr.bytesToHex)(e.slice(s,s+4))}),s+=4;let A=e[s];n?.includeSegments&&o.push({name:"Flags",description:`Application-defined control flags: 0x${A.toString(16).padStart(2,"0")} (${A.toString(2).padStart(8,"0")}b)`,startByte:i+s,endByte:i+s,value:A.toString(16).padStart(2,"0").toUpperCase()}),s+=1;let u=[],d=s;for(;s<e.length;)u.push((0,pr.byteToHex)(e[s])),s++;if(n?.includeSegments&&u.length>0){let m=u.join(" ");o.push({name:"Path Hashes",description:`Node hashes in trace path: ${m}`,startByte:i+d,endByte:i+e.length-1,value:(0,pr.bytesToHex)(e.slice(d))})}let x;t&&t.length>0&&(x=t.map(m=>{let g=parseInt(m,16);return(g>127?g-256:g)/4}));let p={type:xr.PayloadType.Trace,version:xr.PayloadVersion.Version1,isValid:!0,traceTag:c,authCode:f,flags:A,pathHashes:u,snrValues:x};return n?.includeSegments&&(p.segments=o),p}catch(s){return{type:xr.PayloadType.Trace,version:xr.PayloadVersion.Version1,isValid:!1,errors:[s instanceof Error?s.message:"Failed to decode trace payload"],traceTag:"00000000",authCode:0,flags:0,pathHashes:[]}}}static readUint32LE(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24}};Ss.TracePayloadDecoder=W0});var cc=Q(Ts=>{"use strict";Object.defineProperty(Ts,"__esModule",{value:!0});Ts.GroupTextPayloadDecoder=void 0;var yr=Re(),Xd=ys(),Rs=he(),z0=class{static decode(e,t){try{if(e.length<3){let A={type:yr.PayloadType.GroupText,version:yr.PayloadVersion.Version1,isValid:!1,errors:["GroupText payload too short (need at least channel_hash(1) + MAC(2))"],channelHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0};return t?.includeSegments&&(A.segments=[{name:"Invalid GroupText Data",description:"GroupText payload too short (minimum 3 bytes required)",startByte:t.segmentOffset||0,endByte:(t.segmentOffset||0)+e.length-1,value:(0,Rs.bytesToHex)(e)}]),A}let n=[],s=t?.segmentOffset||0,o=0,i=(0,Rs.byteToHex)(e[o]);t?.includeSegments&&n.push({name:"Channel Hash",description:"First byte of SHA256 of channel's shared key",startByte:s+o,endByte:s+o,value:i}),o+=1;let a=(0,Rs.bytesToHex)(e.subarray(o,o+2));t?.includeSegments&&n.push({name:"Cipher MAC",description:"MAC for encrypted data",startByte:s+o,endByte:s+o+1,value:a}),o+=2;let c=(0,Rs.bytesToHex)(e.subarray(o));t?.includeSegments&&e.length>o&&n.push({name:"Ciphertext",description:"Encrypted message content (timestamp + flags + message)",startByte:s+o,endByte:s+e.length-1,value:c});let f={type:yr.PayloadType.GroupText,version:yr.PayloadVersion.Version1,isValid:!0,channelHash:i,cipherMac:a,ciphertext:c,ciphertextLength:e.length-3};if(t?.keyStore&&t.keyStore.hasChannelKey(i)){let A=t.keyStore.getChannelKeys(i);for(let u of A){let d=Xd.ChannelCrypto.decryptGroupTextMessage(c,a,u);if(d.success&&d.data){f.decrypted={timestamp:d.data.timestamp,flags:d.data.flags,sender:d.data.sender,message:d.data.message};break}}}return t?.includeSegments&&(f.segments=n),f}catch(n){return{type:yr.PayloadType.GroupText,version:yr.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode GroupText payload"],channelHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0}}}};Ts.GroupTextPayloadDecoder=z0});var Ac=Q(Fs=>{"use strict";Object.defineProperty(Fs,"__esModule",{value:!0});Fs.RequestPayloadDecoder=void 0;var ft=Re(),Gr=he(),X0=class{static decode(e,t){try{if(e.length<4){let u={type:ft.PayloadType.Request,version:ft.PayloadVersion.Version1,isValid:!1,errors:["Request payload too short (minimum 4 bytes: dest hash + source hash + MAC)"],timestamp:0,requestType:ft.RequestType.GetStats,requestData:"",destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:""};return t?.includeSegments&&(u.segments=[{name:"Invalid Request Data",description:"Request payload too short (minimum 4 bytes required: 1 for dest hash + 1 for source hash + 2 for MAC)",startByte:t.segmentOffset||0,endByte:(t.segmentOffset||0)+e.length-1,value:(0,Gr.bytesToHex)(e)}]),u}let n=[],s=t?.segmentOffset||0,o=0,i=(0,Gr.bytesToHex)(e.subarray(o,o+1));t?.includeSegments&&n.push({name:"Destination Hash",description:`First byte of destination node public key: 0x${i}`,startByte:s+o,endByte:s+o,value:i}),o+=1;let a=(0,Gr.bytesToHex)(e.subarray(o,o+1));t?.includeSegments&&n.push({name:"Source Hash",description:`First byte of source node public key: 0x${a}`,startByte:s+o,endByte:s+o,value:a}),o+=1;let c=(0,Gr.bytesToHex)(e.subarray(o,o+2));t?.includeSegments&&n.push({name:"Cipher MAC",description:"MAC for encrypted data verification (2 bytes)",startByte:s+o,endByte:s+o+1,value:c}),o+=2;let f=(0,Gr.bytesToHex)(e.subarray(o));t?.includeSegments&&e.length>o&&n.push({name:"Ciphertext",description:`Encrypted message data (${e.length-o} bytes). Contains encrypted plaintext with this structure:
\u2022 Timestamp (4 bytes) - send time as unix timestamp
\u2022 Request Type (1 byte) - type of request (GetStats, GetTelemetryData, etc.)
\u2022 Request Data (remaining bytes) - additional request-specific data`,startByte:s+o,endByte:s+e.length-1,value:f});let A={type:ft.PayloadType.Request,version:ft.PayloadVersion.Version1,isValid:!0,timestamp:0,requestType:ft.RequestType.GetStats,requestData:"",destinationHash:i,sourceHash:a,cipherMac:c,ciphertext:f};return t?.includeSegments&&(A.segments=n),A}catch(n){return{type:ft.PayloadType.Request,version:ft.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode request payload"],timestamp:0,requestType:ft.RequestType.GetStats,requestData:"",destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:""}}}};Fs.RequestPayloadDecoder=X0});var dc=Q(Ps=>{"use strict";Object.defineProperty(Ps,"__esModule",{value:!0});Ps.ResponsePayloadDecoder=void 0;var mr=Re(),Kr=he(),j0=class{static decode(e,t){try{if(e.length<4){let u={type:mr.PayloadType.Response,version:mr.PayloadVersion.Version1,isValid:!1,errors:["Response payload too short (minimum 4 bytes: dest + source + MAC)"],destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0};return t?.includeSegments&&(u.segments=[{name:"Invalid Response Data",description:"Response payload too short (minimum 4 bytes required)",startByte:t.segmentOffset||0,endByte:(t.segmentOffset||0)+e.length-1,value:(0,Kr.bytesToHex)(e)}]),u}let n=[],s=t?.segmentOffset||0,o=0,i=(0,Kr.byteToHex)(e[o]);t?.includeSegments&&n.push({name:"Destination Hash",description:"First byte of destination node public key",startByte:s+o,endByte:s+o,value:i}),o+=1;let a=(0,Kr.byteToHex)(e[o]);t?.includeSegments&&n.push({name:"Source Hash",description:"First byte of source node public key",startByte:s+o,endByte:s+o,value:a}),o+=1;let c=(0,Kr.bytesToHex)(e.subarray(o,o+2));t?.includeSegments&&n.push({name:"Cipher MAC",description:"MAC for encrypted data in next field",startByte:s+o,endByte:s+o+1,value:c}),o+=2;let f=(0,Kr.bytesToHex)(e.subarray(o));t?.includeSegments&&e.length>o&&n.push({name:"Ciphertext",description:"Encrypted response data (tag + content)",startByte:s+o,endByte:s+e.length-1,value:f});let A={type:mr.PayloadType.Response,version:mr.PayloadVersion.Version1,isValid:!0,destinationHash:i,sourceHash:a,cipherMac:c,ciphertext:f,ciphertextLength:e.length-4};return t?.includeSegments&&(A.segments=n),A}catch(n){return{type:mr.PayloadType.Response,version:mr.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode response payload"],destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0}}}};Ps.ResponsePayloadDecoder=j0});var fc=Q(ks=>{"use strict";Object.defineProperty(ks,"__esModule",{value:!0});ks.AnonRequestPayloadDecoder=void 0;var gr=Re(),Qr=he(),J0=class{static decode(e,t){try{if(e.length<35){let u={type:gr.PayloadType.AnonRequest,version:gr.PayloadVersion.Version1,isValid:!1,errors:["AnonRequest payload too short (minimum 35 bytes: dest + public key + MAC)"],destinationHash:"",senderPublicKey:"",cipherMac:"",ciphertext:"",ciphertextLength:0};return t?.includeSegments&&(u.segments=[{name:"Invalid AnonRequest Data",description:"AnonRequest payload too short (minimum 35 bytes required: 1 for dest hash + 32 for public key + 2 for MAC)",startByte:t.segmentOffset||0,endByte:(t.segmentOffset||0)+e.length-1,value:(0,Qr.bytesToHex)(e)}]),u}let n=[],s=t?.segmentOffset||0,o=0,i=(0,Qr.byteToHex)(e[0]);t?.includeSegments&&n.push({name:"Destination Hash",description:`First byte of destination node public key: 0x${i}`,startByte:s+o,endByte:s+o,value:i}),o+=1;let a=(0,Qr.bytesToHex)(e.subarray(1,33));t?.includeSegments&&n.push({name:"Sender Public Key",description:"Ed25519 public key of the sender (32 bytes)",startByte:s+o,endByte:s+o+31,value:a}),o+=32;let c=(0,Qr.bytesToHex)(e.subarray(33,35));t?.includeSegments&&n.push({name:"Cipher MAC",description:"MAC for encrypted data verification (2 bytes)",startByte:s+o,endByte:s+o+1,value:c}),o+=2;let f=(0,Qr.bytesToHex)(e.subarray(35));t?.includeSegments&&e.length>35&&n.push({name:"Ciphertext",description:`Encrypted message data (${e.length-35} bytes). Contains encrypted plaintext with this structure:
\u2022 Timestamp (4 bytes) - send time as unix timestamp
\u2022 Sync Timestamp (4 bytes) - room server only, sender's "sync messages SINCE x" timestamp  
\u2022 Password (remaining bytes) - password for repeater/room`,startByte:s+o,endByte:s+e.length-1,value:f});let A={type:gr.PayloadType.AnonRequest,version:gr.PayloadVersion.Version1,isValid:!0,destinationHash:i,senderPublicKey:a,cipherMac:c,ciphertext:f,ciphertextLength:e.length-35};return t?.includeSegments&&(A.segments=n),A}catch(n){return{type:gr.PayloadType.AnonRequest,version:gr.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode AnonRequest payload"],destinationHash:"",senderPublicKey:"",cipherMac:"",ciphertext:"",ciphertextLength:0}}}};ks.AnonRequestPayloadDecoder=J0});var uc=Q(Is=>{"use strict";Object.defineProperty(Is,"__esModule",{value:!0});Is.AckPayloadDecoder=void 0;var Br=Re(),$0=he(),eo=class{static decode(e,t){try{if(e.length<4){let a={type:Br.PayloadType.Ack,version:Br.PayloadVersion.Version1,isValid:!1,errors:["Ack payload too short (minimum 4 bytes for checksum)"],checksum:""};return t?.includeSegments&&(a.segments=[{name:"Invalid Ack Data",description:"Ack payload too short (minimum 4 bytes required for checksum)",startByte:t.segmentOffset||0,endByte:(t.segmentOffset||0)+e.length-1,value:(0,$0.bytesToHex)(e)}]),a}let n=[],s=t?.segmentOffset||0,o=(0,$0.bytesToHex)(e.subarray(0,4));t?.includeSegments&&n.push({name:"Checksum",description:`CRC checksum of message timestamp, text, and sender pubkey: 0x${o}`,startByte:s,endByte:s+3,value:o}),t?.includeSegments&&e.length>4&&n.push({name:"Additional Data",description:"Extra data in Ack payload",startByte:s+4,endByte:s+e.length-1,value:(0,$0.bytesToHex)(e.subarray(4))});let i={type:Br.PayloadType.Ack,version:Br.PayloadVersion.Version1,isValid:!0,checksum:o};return t?.includeSegments&&(i.segments=n),i}catch(n){return{type:Br.PayloadType.Ack,version:Br.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode Ack payload"],checksum:""}}}};Is.AckPayloadDecoder=eo});var hc=Q(Ls=>{"use strict";Object.defineProperty(Ls,"__esModule",{value:!0});Ls.PathPayloadDecoder=void 0;var Pt=Re(),lc=he(),to=class{static decode(e){try{if(e.length<2)return{type:Pt.PayloadType.Path,version:Pt.PayloadVersion.Version1,isValid:!1,errors:["Path payload too short (minimum 2 bytes: path length + extra type)"],pathLength:0,pathHashes:[],extraType:0,extraData:""};let t=e[0];if(e.length<1+t+1)return{type:Pt.PayloadType.Path,version:Pt.PayloadVersion.Version1,isValid:!1,errors:[`Path payload too short (need ${1+t+1} bytes for path length + path + extra type)`],pathLength:t,pathHashes:[],extraType:0,extraData:""};let n=[];for(let i=0;i<t;i++)n.push((0,lc.byteToHex)(e[1+i]));let s=e[1+t],o="";return e.length>1+t+1&&(o=(0,lc.bytesToHex)(e.subarray(1+t+1))),{type:Pt.PayloadType.Path,version:Pt.PayloadVersion.Version1,isValid:!0,pathLength:t,pathHashes:n,extraType:s,extraData:o}}catch(t){return{type:Pt.PayloadType.Path,version:Pt.PayloadVersion.Version1,isValid:!1,errors:[t instanceof Error?t.message:"Failed to decode Path payload"],pathLength:0,pathHashes:[],extraType:0,extraData:""}}}};Ls.PathPayloadDecoder=to});var xc=Q(Hs=>{"use strict";Object.defineProperty(Hs,"__esModule",{value:!0});Hs.TextMessagePayloadDecoder=void 0;var Cr=Re(),Yr=he(),ro=class{static decode(e,t){try{if(e.length<4){let u={type:Cr.PayloadType.TextMessage,version:Cr.PayloadVersion.Version1,isValid:!1,errors:["TextMessage payload too short (minimum 4 bytes: dest + source + MAC)"],destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0};return t?.includeSegments&&(u.segments=[{name:"Invalid TextMessage Data",description:"TextMessage payload too short (minimum 4 bytes required)",startByte:t.segmentOffset||0,endByte:(t.segmentOffset||0)+e.length-1,value:(0,Yr.bytesToHex)(e)}]),u}let n=[],s=t?.segmentOffset||0,o=0,i=(0,Yr.byteToHex)(e[o]);t?.includeSegments&&n.push({name:"Destination Hash",description:"First byte of destination node public key",startByte:s+o,endByte:s+o,value:i}),o+=1;let a=(0,Yr.byteToHex)(e[o]);t?.includeSegments&&n.push({name:"Source Hash",description:"First byte of source node public key",startByte:s+o,endByte:s+o,value:a}),o+=1;let c=(0,Yr.bytesToHex)(e.subarray(o,o+2));t?.includeSegments&&n.push({name:"Cipher MAC",description:"MAC for encrypted data in next field",startByte:s+o,endByte:s+o+1,value:c}),o+=2;let f=(0,Yr.bytesToHex)(e.subarray(o));t?.includeSegments&&e.length>o&&n.push({name:"Ciphertext",description:"Encrypted message data (timestamp + message text)",startByte:s+o,endByte:s+e.length-1,value:f});let A={type:Cr.PayloadType.TextMessage,version:Cr.PayloadVersion.Version1,isValid:!0,destinationHash:i,sourceHash:a,cipherMac:c,ciphertext:f,ciphertextLength:e.length-4};return t?.includeSegments&&(A.segments=n),A}catch(n){return{type:Cr.PayloadType.TextMessage,version:Cr.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode TextMessage payload"],destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0}}}};Hs.TextMessagePayloadDecoder=ro});var pc=Q(Os=>{"use strict";Object.defineProperty(Os,"__esModule",{value:!0});Os.ControlPayloadDecoder=void 0;var ae=Re(),zt=he(),jd=dr(),no=class{static decode(e,t){try{if(e.length<1)return this.createErrorPayload("Control payload too short (minimum 1 byte required)",e,t);let s=e[0]&240;switch(s){case ae.ControlSubType.NodeDiscoverReq:return this.decodeDiscoverReq(e,t);case ae.ControlSubType.NodeDiscoverResp:return this.decodeDiscoverResp(e,t);default:return this.createErrorPayload(`Unknown control sub-type: 0x${s.toString(16).padStart(2,"0")}`,e,t)}}catch(n){return this.createErrorPayload(n instanceof Error?n.message:"Failed to decode control payload",e,t)}}static decodeDiscoverReq(e,t){let n=[],s=t?.segmentOffset??0;if(e.length<6){let x={type:ae.PayloadType.Control,version:ae.PayloadVersion.Version1,isValid:!1,errors:["DISCOVER_REQ payload too short (minimum 6 bytes required)"],subType:ae.ControlSubType.NodeDiscoverReq,rawFlags:e[0],prefixOnly:!1,typeFilter:0,typeFilterNames:[],tag:0,since:0};return t?.includeSegments&&(x.segments=[{name:"Invalid DISCOVER_REQ Data",description:"DISCOVER_REQ payload too short (minimum 6 bytes required)",startByte:s,endByte:s+e.length-1,value:(0,zt.bytesToHex)(e)}]),x}let o=0,i=e[o],a=(i&1)!==0;t?.includeSegments&&n.push({name:"Flags",description:`Sub-type: DISCOVER_REQ (0x8) | Prefix Only: ${a}`,startByte:s+o,endByte:s+o,value:i.toString(16).padStart(2,"0").toUpperCase()}),o+=1;let c=e[o],f=this.parseTypeFilter(c);t?.includeSegments&&n.push({name:"Type Filter",description:`Filter mask: 0b${c.toString(2).padStart(8,"0")} | Types: ${f.length>0?f.join(", "):"None"}`,startByte:s+o,endByte:s+o,value:c.toString(16).padStart(2,"0").toUpperCase()}),o+=1;let A=this.readUint32LE(e,o);t?.includeSegments&&n.push({name:"Tag",description:`Random tag for response matching: 0x${A.toString(16).padStart(8,"0")}`,startByte:s+o,endByte:s+o+3,value:(0,zt.bytesToHex)(e.slice(o,o+4))}),o+=4;let u=0;if(e.length>=o+4&&(u=this.readUint32LE(e,o),t?.includeSegments)){let x=u>0?new Date(u*1e3).toISOString().slice(0,19)+"Z":"N/A";n.push({name:"Since",description:`Filter timestamp: ${u} (${x})`,startByte:s+o,endByte:s+o+3,value:(0,zt.bytesToHex)(e.slice(o,o+4))})}let d={type:ae.PayloadType.Control,version:ae.PayloadVersion.Version1,isValid:!0,subType:ae.ControlSubType.NodeDiscoverReq,rawFlags:i,prefixOnly:a,typeFilter:c,typeFilterNames:f,tag:A,since:u};return t?.includeSegments&&(d.segments=n),d}static decodeDiscoverResp(e,t){let n=[],s=t?.segmentOffset??0;if(e.length<14){let y={type:ae.PayloadType.Control,version:ae.PayloadVersion.Version1,isValid:!1,errors:["DISCOVER_RESP payload too short (minimum 14 bytes required)"],subType:ae.ControlSubType.NodeDiscoverResp,rawFlags:e.length>0?e[0]:0,nodeType:ae.DeviceRole.Unknown,nodeTypeName:"Unknown",snr:0,tag:0,publicKey:"",publicKeyLength:0};return t?.includeSegments&&(y.segments=[{name:"Invalid DISCOVER_RESP Data",description:"DISCOVER_RESP payload too short (minimum 14 bytes required)",startByte:s,endByte:s+e.length-1,value:(0,zt.bytesToHex)(e)}]),y}let o=0,i=e[o],a=i&15,c=(0,jd.getDeviceRoleName)(a);t?.includeSegments&&n.push({name:"Flags",description:`Sub-type: DISCOVER_RESP (0x9) | Node Type: ${c}`,startByte:s+o,endByte:s+o,value:i.toString(16).padStart(2,"0").toUpperCase()}),o+=1;let f=e[o],A=f>127?f-256:f,u=A/4;t?.includeSegments&&n.push({name:"SNR",description:`Inbound SNR: ${u.toFixed(2)} dB (raw: ${f}, signed: ${A})`,startByte:s+o,endByte:s+o,value:f.toString(16).padStart(2,"0").toUpperCase()}),o+=1;let d=this.readUint32LE(e,o);t?.includeSegments&&n.push({name:"Tag",description:`Reflected tag from request: 0x${d.toString(16).padStart(8,"0")}`,startByte:s+o,endByte:s+o+3,value:(0,zt.bytesToHex)(e.slice(o,o+4))}),o+=4;let p=e.length-o,m=e.slice(o,o+p),g=(0,zt.bytesToHex)(m);if(t?.includeSegments){let y=p===32?"Full Public Key":"Public Key Prefix";n.push({name:y,description:`${y} (${p} bytes)`,startByte:s+o,endByte:s+o+p-1,value:g})}let l={type:ae.PayloadType.Control,version:ae.PayloadVersion.Version1,isValid:!0,subType:ae.ControlSubType.NodeDiscoverResp,rawFlags:i,nodeType:a,nodeTypeName:c,snr:u,tag:d,publicKey:g,publicKeyLength:p};return t?.includeSegments&&(l.segments=n),l}static parseTypeFilter(e){let t=[];return e&1<<ae.DeviceRole.ChatNode&&t.push("Chat"),e&1<<ae.DeviceRole.Repeater&&t.push("Repeater"),e&1<<ae.DeviceRole.RoomServer&&t.push("Room"),e&1<<ae.DeviceRole.Sensor&&t.push("Sensor"),t}static createErrorPayload(e,t,n){let s={type:ae.PayloadType.Control,version:ae.PayloadVersion.Version1,isValid:!1,errors:[e],subType:ae.ControlSubType.NodeDiscoverReq,rawFlags:t.length>0?t[0]:0,prefixOnly:!1,typeFilter:0,typeFilterNames:[],tag:0,since:0};return n?.includeSegments&&(s.segments=[{name:"Invalid Control Data",description:e,startByte:n.segmentOffset??0,endByte:(n.segmentOffset??0)+t.length-1,value:(0,zt.bytesToHex)(t)}]),s}static readUint32LE(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}};Os.ControlPayloadDecoder=no});var oo=Q(Ms=>{"use strict";Object.defineProperty(Ms,"__esModule",{value:!0});Ms.MeshCorePacketDecoder=void 0;var ee=Re(),Ge=he(),vr=dr(),Jd=S0(),yc=ic(),$d=ac(),ef=cc(),tf=Ac(),rf=dc(),nf=fc(),sf=uc(),of=hc(),af=xc(),cf=pc(),so=class{static decode(e,t){return this.parseInternal(e,!1,t).packet}static async decodeWithVerification(e,t){return(await this.parseInternalAsync(e,!1,t)).packet}static analyzeStructure(e,t){return this.parseInternal(e,!0,t).structure}static async analyzeStructureWithVerification(e,t){return(await this.parseInternalAsync(e,!0,t)).structure}static parseInternal(e,t,n){let s=(0,Ge.hexToBytes)(e),o=[];if(s.length<2){let i={messageHash:"",routeType:ee.RouteType.Flood,payloadType:ee.PayloadType.RawCustom,payloadVersion:ee.PayloadVersion.Version1,pathLength:0,path:null,payload:{raw:"",decoded:null},totalBytes:s.length,isValid:!1,errors:["Packet too short (minimum 2 bytes required)"]},a={segments:[],totalBytes:s.length,rawHex:e.toUpperCase(),messageHash:"",payload:{segments:[],hex:"",startByte:0,type:"Unknown"}};return{packet:i,structure:a}}try{let i=0,a=s[0],c=a&3,f=a>>2&15,A=a>>6&3;t&&o.push({name:"Header",description:"Header byte breakdown",startByte:0,endByte:0,value:`0x${a.toString(16).padStart(2,"0")}`,headerBreakdown:{fullBinary:a.toString(2).padStart(8,"0"),fields:[{bits:"0-1",field:"Route Type",value:(0,vr.getRouteTypeName)(c),binary:(a&3).toString(2).padStart(2,"0")},{bits:"2-5",field:"Payload Type",value:(0,vr.getPayloadTypeName)(f),binary:(a>>2&15).toString(2).padStart(4,"0")},{bits:"6-7",field:"Version",value:A.toString(),binary:(a>>6&3).toString(2).padStart(2,"0")}]}}),i=1;let u;if(c===ee.RouteType.TransportFlood||c===ee.RouteType.TransportDirect){if(s.length<i+4)throw new Error("Packet too short for transport codes");let C=s[i]|s[i+1]<<8,R=s[i+2]|s[i+3]<<8;if(u=[C,R],t){let S=s[i]|s[i+1]<<8|s[i+2]<<16|s[i+3]<<24;o.push({name:"Transport Code",description:"Used for Direct/Response routing",startByte:i,endByte:i+3,value:`0x${S.toString(16).padStart(8,"0")}`})}i+=4}if(s.length<i+1)throw new Error("Packet too short for path length");let d=s[i];if(t){let C=`Path contains ${d} bytes`;c===ee.RouteType.Direct||c===ee.RouteType.TransportDirect?C=`For "Direct" packets, this contains routing instructions. ${d} bytes of routing instructions (decreases as packet travels)`:(c===ee.RouteType.Flood||c===ee.RouteType.TransportFlood)&&(C=`${d} bytes showing route taken (increases as packet floods)`),o.push({name:"Path Length",description:C,startByte:i,endByte:i,value:`0x${d.toString(16).padStart(2,"0")}`})}if(i+=1,s.length<i+d)throw new Error("Packet too short for path data");let x=s.subarray(i,i+d),p=d>0?Array.from(x).map(Ge.byteToHex):null;if(t&&d>0)if(f===ee.PayloadType.Trace){let C=[];for(let R=0;R<d;R++){let S=s[i+R],_=(S>127?S-256:S)/4;C.push(`${_.toFixed(2)}dB (0x${S.toString(16).padStart(2,"0")})`)}o.push({name:"Path SNR Data",description:`SNR values collected during trace: ${C.join(", ")}`,startByte:i,endByte:i+d-1,value:(0,Ge.bytesToHex)(s.slice(i,i+d))})}else{let C="Routing path information";c===ee.RouteType.Direct||c===ee.RouteType.TransportDirect?C="Routing instructions (bytes are stripped at each hop as packet travels to destination)":(c===ee.RouteType.Flood||c===ee.RouteType.TransportFlood)&&(C="Historical route taken (bytes are added as packet floods through network)"),o.push({name:"Path Data",description:C,startByte:i,endByte:i+d-1,value:(0,Ge.bytesToHex)(s.slice(i,i+d))})}i+=d;let m=s.subarray(i),g=(0,Ge.bytesToHex)(m);t&&s.length>i&&o.push({name:"Payload",description:`${(0,vr.getPayloadTypeName)(f)} payload data`,startByte:i,endByte:s.length-1,value:(0,Ge.bytesToHex)(s.slice(i))});let l=null,y=[];if(f===ee.PayloadType.Advert){let C=yc.AdvertPayloadDecoder.decode(m,{includeSegments:t,segmentOffset:0});l=C,C?.segments&&(y.push(...C.segments),delete C.segments)}else if(f===ee.PayloadType.Trace){let C=$d.TracePayloadDecoder.decode(m,p,{includeSegments:t,segmentOffset:0});l=C,C?.segments&&(y.push(...C.segments),delete C.segments)}else if(f===ee.PayloadType.GroupText){let C=ef.GroupTextPayloadDecoder.decode(m,{...n,includeSegments:t,segmentOffset:0});l=C,C?.segments&&(y.push(...C.segments),delete C.segments)}else if(f===ee.PayloadType.Request){let C=tf.RequestPayloadDecoder.decode(m,{includeSegments:t,segmentOffset:0});l=C,C?.segments&&(y.push(...C.segments),delete C.segments)}else if(f===ee.PayloadType.Response){let C=rf.ResponsePayloadDecoder.decode(m,{includeSegments:t,segmentOffset:0});l=C,C?.segments&&(y.push(...C.segments),delete C.segments)}else if(f===ee.PayloadType.AnonRequest){let C=nf.AnonRequestPayloadDecoder.decode(m,{includeSegments:t,segmentOffset:0});l=C,C?.segments&&(y.push(...C.segments),delete C.segments)}else if(f===ee.PayloadType.Ack){let C=sf.AckPayloadDecoder.decode(m,{includeSegments:t,segmentOffset:0});l=C,C?.segments&&(y.push(...C.segments),delete C.segments)}else if(f===ee.PayloadType.Path)l=of.PathPayloadDecoder.decode(m);else if(f===ee.PayloadType.TextMessage){let C=af.TextMessagePayloadDecoder.decode(m,{includeSegments:t,segmentOffset:0});l=C,C?.segments&&(y.push(...C.segments),delete C.segments)}else if(f===ee.PayloadType.Control){let C=cf.ControlPayloadDecoder.decode(m,{includeSegments:t,segmentOffset:0});l=C,C?.segments&&(y.push(...C.segments),delete C.segments)}t&&y.length===0&&s.length>i&&y.push({name:`${(0,vr.getPayloadTypeName)(f)} Payload`,description:`Raw ${(0,vr.getPayloadTypeName)(f)} payload data (${m.length} bytes)`,startByte:0,endByte:m.length-1,value:(0,Ge.bytesToHex)(m)});let B=this.calculateMessageHash(s,c,f,A),v={messageHash:B,routeType:c,payloadType:f,payloadVersion:A,transportCodes:u,pathLength:d,path:p,payload:{raw:g,decoded:l},totalBytes:s.length,isValid:!0},E={segments:o,totalBytes:s.length,rawHex:e.toUpperCase(),messageHash:B,payload:{segments:y,hex:g,startByte:i,type:(0,vr.getPayloadTypeName)(f)}};return{packet:v,structure:E}}catch(i){let a={messageHash:"",routeType:ee.RouteType.Flood,payloadType:ee.PayloadType.RawCustom,payloadVersion:ee.PayloadVersion.Version1,pathLength:0,path:null,payload:{raw:"",decoded:null},totalBytes:s.length,isValid:!1,errors:[i instanceof Error?i.message:"Unknown decoding error"]},c={segments:[],totalBytes:s.length,rawHex:e.toUpperCase(),messageHash:"",payload:{segments:[],hex:"",startByte:0,type:"Unknown"}};return{packet:a,structure:c}}}static async parseInternalAsync(e,t,n){let s=this.parseInternal(e,t,n);if(s.packet.payloadType===ee.PayloadType.Advert&&s.packet.payload.decoded)try{let o=s.packet.payload.decoded,i=await yc.AdvertPayloadDecoder.decodeWithVerification((0,Ge.hexToBytes)(s.packet.payload.raw),{includeSegments:t,segmentOffset:0});i&&(s.packet.payload.decoded=i,i.isValid||(s.packet.isValid=!1,s.packet.errors=i.errors||["Invalid advertisement signature"]),t&&i.segments&&(s.structure.payload.segments=i.segments,delete i.segments))}catch(o){console.error("Signature verification failed:",o)}return s}static validate(e){let t=(0,Ge.hexToBytes)(e),n=[];if(t.length<2)return n.push("Packet too short (minimum 2 bytes required)"),{isValid:!1,errors:n};try{let s=1,i=t[0]&3;if((i===ee.RouteType.TransportFlood||i===ee.RouteType.TransportDirect)&&(t.length<s+4&&n.push("Packet too short for transport codes"),s+=4),t.length<s+1)n.push("Packet too short for path length");else{let a=t[s];s+=1,t.length<s+a&&n.push("Packet too short for path data"),s+=a}s>=t.length&&n.push("No payload data found")}catch(s){n.push(s instanceof Error?s.message:"Validation error")}return{isValid:n.length===0,errors:n.length>0?n:void 0}}static calculateMessageHash(e,t,n,s){if(n===ee.PayloadType.Trace&&e.length>=13){let A=1;if((t===ee.RouteType.TransportFlood||t===ee.RouteType.TransportDirect)&&(A+=4),e.length>A){let u=e[A];A+=1+u}if(e.length>=A+4){let u=e[A]|e[A+1]<<8|e[A+2]<<16|e[A+3]<<24;return(0,Ge.numberToHex)(u,8)}}let o=n<<2|s<<6,i=1;if((t===ee.RouteType.TransportFlood||t===ee.RouteType.TransportDirect)&&(i+=4),e.length>i){let A=e[i];i+=1+A}let a=e.slice(i),c=[o,...Array.from(a)],f=0;for(let A=0;A<c.length;A++)f=(f<<5)-f+c[A]&4294967295;return(0,Ge.numberToHex)(f,8)}static createKeyStore(e){return new Jd.MeshCoreKeyStore(e)}};Ms.MeshCorePacketDecoder=so});var ao=Q(Er=>{"use strict";Object.defineProperty(Er,"__esModule",{value:!0});Er.createAuthToken=Af;Er.verifyAuthToken=df;Er.parseAuthToken=ff;Er.decodeAuthTokenPayload=uf;var gc=_s(),Bc=he();function mc(r){let e="";if(typeof Buffer<"u")e=Buffer.from(r).toString("base64");else{let t=String.fromCharCode(...Array.from(r));e=btoa(t)}return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function io(r){let e=r.replace(/-/g,"+").replace(/_/g,"/");for(;e.length%4;)e+="=";if(typeof Buffer<"u")return new Uint8Array(Buffer.from(e,"base64"));{let t=atob(e),n=new Uint8Array(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s);return n}}async function Af(r,e,t){let n={alg:"Ed25519",typ:"JWT"};r.publicKey?r.publicKey=r.publicKey.toUpperCase():r.publicKey=t.toUpperCase(),r.iat||(r.iat=Math.floor(Date.now()/1e3));let s=JSON.stringify(n),o=JSON.stringify(r),i=new TextEncoder().encode(s),a=new TextEncoder().encode(o),c=mc(i),f=mc(a),A=`${c}.${f}`,u=new TextEncoder().encode(A),d=(0,Bc.bytesToHex)(u),x=await(0,gc.sign)(d,e,r.publicKey);return`${c}.${f}.${x}`}async function df(r,e){try{let t=r.split(".");if(t.length!==3)return null;let[n,s,o]=t,i=io(n),a=io(s),c=new TextDecoder().decode(i),f=new TextDecoder().decode(a),A=JSON.parse(c),u=JSON.parse(f);if(A.alg!=="Ed25519"||A.typ!=="JWT"||!u.publicKey||!u.iat||e&&u.publicKey.toUpperCase()!==e.toUpperCase()||u.exp&&Math.floor(Date.now()/1e3)>u.exp)return null;let d=`${n}.${s}`,x=new TextEncoder().encode(d),p=(0,Bc.bytesToHex)(x);return await(0,gc.verify)(o,p,u.publicKey)?u:null}catch{return null}}function ff(r){try{let e=r.split(".");return e.length!==3?null:{header:e[0],payload:e[1],signature:e[2]}}catch{return null}}function uf(r){try{let e=r.split(".");if(e.length!==3)return null;let t=io(e[1]),n=new TextDecoder().decode(t);return JSON.parse(n)}catch{return null}}});var Ao=Q(Y=>{"use strict";var lf=Y&&Y.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var s=Object.getOwnPropertyDescriptor(e,t);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,s)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),hf=Y&&Y.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),co=Y&&Y.__importStar||function(){var r=function(e){return r=Object.getOwnPropertyNames||function(t){var n=[];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[n.length]=s);return n},r(e)};return function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n=r(e),s=0;s<n.length;s++)n[s]!=="default"&&lf(t,e,n[s]);return hf(t,e),t}}();Object.defineProperty(Y,"__esModule",{value:!0});Y.Utils=Y.decodeAuthTokenPayload=Y.parseAuthToken=Y.verifyAuthToken=Y.createAuthToken=Y.getControlSubTypeName=Y.getRequestTypeName=Y.getDeviceRoleName=Y.getPayloadVersionName=Y.getPayloadTypeName=Y.getRouteTypeName=Y.numberToHex=Y.byteToHex=Y.bytesToHex=Y.hexToBytes=Y.Ed25519SignatureVerifier=Y.ChannelCrypto=Y.MeshCoreKeyStore=Y.ControlSubType=Y.RequestType=Y.AdvertFlags=Y.DeviceRole=Y.PayloadVersion=Y.PayloadType=Y.RouteType=Y.MeshCoreDecoder=Y.MeshCorePacketDecoder=void 0;var xf=oo();Object.defineProperty(Y,"MeshCorePacketDecoder",{enumerable:!0,get:function(){return xf.MeshCorePacketDecoder}});var pf=oo();Object.defineProperty(Y,"MeshCoreDecoder",{enumerable:!0,get:function(){return pf.MeshCorePacketDecoder}});var Xt=Re();Object.defineProperty(Y,"RouteType",{enumerable:!0,get:function(){return Xt.RouteType}});Object.defineProperty(Y,"PayloadType",{enumerable:!0,get:function(){return Xt.PayloadType}});Object.defineProperty(Y,"PayloadVersion",{enumerable:!0,get:function(){return Xt.PayloadVersion}});Object.defineProperty(Y,"DeviceRole",{enumerable:!0,get:function(){return Xt.DeviceRole}});Object.defineProperty(Y,"AdvertFlags",{enumerable:!0,get:function(){return Xt.AdvertFlags}});Object.defineProperty(Y,"RequestType",{enumerable:!0,get:function(){return Xt.RequestType}});Object.defineProperty(Y,"ControlSubType",{enumerable:!0,get:function(){return Xt.ControlSubType}});var yf=S0();Object.defineProperty(Y,"MeshCoreKeyStore",{enumerable:!0,get:function(){return yf.MeshCoreKeyStore}});var mf=ys();Object.defineProperty(Y,"ChannelCrypto",{enumerable:!0,get:function(){return mf.ChannelCrypto}});var gf=Y0();Object.defineProperty(Y,"Ed25519SignatureVerifier",{enumerable:!0,get:function(){return gf.Ed25519SignatureVerifier}});var qs=he();Object.defineProperty(Y,"hexToBytes",{enumerable:!0,get:function(){return qs.hexToBytes}});Object.defineProperty(Y,"bytesToHex",{enumerable:!0,get:function(){return qs.bytesToHex}});Object.defineProperty(Y,"byteToHex",{enumerable:!0,get:function(){return qs.byteToHex}});Object.defineProperty(Y,"numberToHex",{enumerable:!0,get:function(){return qs.numberToHex}});var br=dr();Object.defineProperty(Y,"getRouteTypeName",{enumerable:!0,get:function(){return br.getRouteTypeName}});Object.defineProperty(Y,"getPayloadTypeName",{enumerable:!0,get:function(){return br.getPayloadTypeName}});Object.defineProperty(Y,"getPayloadVersionName",{enumerable:!0,get:function(){return br.getPayloadVersionName}});Object.defineProperty(Y,"getDeviceRoleName",{enumerable:!0,get:function(){return br.getDeviceRoleName}});Object.defineProperty(Y,"getRequestTypeName",{enumerable:!0,get:function(){return br.getRequestTypeName}});Object.defineProperty(Y,"getControlSubTypeName",{enumerable:!0,get:function(){return br.getControlSubTypeName}});var Vs=ao();Object.defineProperty(Y,"createAuthToken",{enumerable:!0,get:function(){return Vs.createAuthToken}});Object.defineProperty(Y,"verifyAuthToken",{enumerable:!0,get:function(){return Vs.verifyAuthToken}});Object.defineProperty(Y,"parseAuthToken",{enumerable:!0,get:function(){return Vs.parseAuthToken}});Object.defineProperty(Y,"decodeAuthTokenPayload",{enumerable:!0,get:function(){return Vs.decodeAuthTokenPayload}});var Bf=co(dr()),Cf=co(he()),vf=co(ao()),Us=_s();Y.Utils={...Bf,...Cf,...vf,derivePublicKey:Us.derivePublicKey,validateKeyPair:Us.validateKeyPair,sign:Us.sign,verify:Us.verify}});var jt,vc=Le(()=>{jt=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});function lt(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function xo(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function xe(r,...e){if(!lt(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function po(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function bc(r,e){xe(r);let t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function Zr(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}function Gs(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Jt(r){if(xe(r),wc)return r.toHex();let e="";for(let t=0;t<r.length;t++)e+=Ef[r[t]];return e}function Ec(r){if(r>=ut._0&&r<=ut._9)return r-ut._0;if(r>=ut.A&&r<=ut.F)return r-(ut.A-10);if(r>=ut.a&&r<=ut.f)return r-(ut.a-10)}function Ks(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);if(wc)return Uint8Array.fromHex(r);let e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(t);for(let s=0,o=0;s<t;s++,o+=2){let i=Ec(r.charCodeAt(o)),a=Ec(r.charCodeAt(o+1));if(i===void 0||a===void 0){let c=r[o]+r[o+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+o)}n[s]=i*16+a}return n}function ht(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}function yo(r){return typeof r=="string"&&(r=ht(r)),xe(r),r}function Pe(...r){let e=0;for(let n=0;n<r.length;n++){let s=r[n];xe(s),e+=s.length}let t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){let o=r[n];t.set(o,s),s+=o.length}return t}function _c(r){let e=n=>r().update(yo(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function Wr(r=32){if(jt&&typeof jt.getRandomValues=="function")return jt.getRandomValues(new Uint8Array(r));if(jt&&typeof jt.randomBytes=="function")return Uint8Array.from(jt.randomBytes(r));throw new Error("crypto.getRandomValues must be defined")}var wc,Ef,ut,Ns,wr=Le(()=>{vc();wc=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Ef=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));ut={_0:48,_9:57,A:65,F:70,a:97,f:102};Ns=class{}});function bf(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);let s=BigInt(32),o=BigInt(4294967295),i=Number(t>>s&o),a=Number(t&o),c=n?4:0,f=n?0:4;r.setUint32(e+c,i,n),r.setUint32(e+f,a,n)}var Qs,me,Dc=Le(()=>{wr();Qs=class extends Ns{constructor(e,t,n,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.buffer=new Uint8Array(e),this.view=Gs(this.buffer)}update(e){po(this),e=yo(e),xe(e);let{view:t,buffer:n,blockLen:s}=this,o=e.length;for(let i=0;i<o;){let a=Math.min(s-this.pos,o-i);if(a===s){let c=Gs(e);for(;s<=o-i;i+=s)this.process(c,i);continue}n.set(e.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){po(this),bc(e,this),this.finished=!0;let{buffer:t,view:n,blockLen:s,isLE:o}=this,{pos:i}=this;t[i++]=128,Zr(this.buffer.subarray(i)),this.padOffset>s-i&&(this.process(n,0),i=0);for(let u=i;u<s;u++)t[u]=0;bf(n,s-8,BigInt(this.length*8),o),this.process(n,0);let a=Gs(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let f=c/4,A=this.get();if(f>A.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<f;u++)a.setUint32(4*u,A[u],o)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:n,length:s,finished:o,destroyed:i,pos:a}=this;return e.destroyed=i,e.finished=o,e.length=s,e.pos=a,s%t&&e.buffer.set(n),e}clone(){return this._cloneInto()}},me=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])});function wf(r,e=!1){return e?{h:Number(r&Ys),l:Number(r>>Sc&Ys)}:{h:Number(r>>Sc&Ys)|0,l:Number(r&Ys)|0}}function Rc(r,e=!1){let t=r.length,n=new Uint32Array(t),s=new Uint32Array(t);for(let o=0;o<t;o++){let{h:i,l:a}=wf(r[o],e);[n[o],s[o]]=[i,a]}return[n,s]}function tt(r,e,t,n){let s=(e>>>0)+(n>>>0);return{h:r+t+(s/2**32|0)|0,l:s|0}}var Ys,Sc,mo,go,$t,er,zr,Xr,Tc,Fc,Pc,kc,Ic,Lc,Hc=Le(()=>{Ys=BigInt(4294967295),Sc=BigInt(32);mo=(r,e,t)=>r>>>t,go=(r,e,t)=>r<<32-t|e>>>t,$t=(r,e,t)=>r>>>t|e<<32-t,er=(r,e,t)=>r<<32-t|e>>>t,zr=(r,e,t)=>r<<64-t|e>>>t-32,Xr=(r,e,t)=>r>>>t-32|e<<64-t;Tc=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),Fc=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,Pc=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),kc=(r,e,t,n,s)=>e+t+n+s+(r/2**32|0)|0,Ic=(r,e,t,n,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),Lc=(r,e,t,n,s,o)=>e+t+n+s+o+(r/2**32|0)|0});var Oc,Df,Sf,It,Lt,Bo,_r,Mc=Le(()=>{Dc();Hc();wr();Oc=Rc(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),Df=Oc[0],Sf=Oc[1],It=new Uint32Array(80),Lt=new Uint32Array(80),Bo=class extends Qs{constructor(e=64){super(128,e,16,!1),this.Ah=me[0]|0,this.Al=me[1]|0,this.Bh=me[2]|0,this.Bl=me[3]|0,this.Ch=me[4]|0,this.Cl=me[5]|0,this.Dh=me[6]|0,this.Dl=me[7]|0,this.Eh=me[8]|0,this.El=me[9]|0,this.Fh=me[10]|0,this.Fl=me[11]|0,this.Gh=me[12]|0,this.Gl=me[13]|0,this.Hh=me[14]|0,this.Hl=me[15]|0}get(){let{Ah:e,Al:t,Bh:n,Bl:s,Ch:o,Cl:i,Dh:a,Dl:c,Eh:f,El:A,Fh:u,Fl:d,Gh:x,Gl:p,Hh:m,Hl:g}=this;return[e,t,n,s,o,i,a,c,f,A,u,d,x,p,m,g]}set(e,t,n,s,o,i,a,c,f,A,u,d,x,p,m,g){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=o|0,this.Cl=i|0,this.Dh=a|0,this.Dl=c|0,this.Eh=f|0,this.El=A|0,this.Fh=u|0,this.Fl=d|0,this.Gh=x|0,this.Gl=p|0,this.Hh=m|0,this.Hl=g|0}process(e,t){for(let B=0;B<16;B++,t+=4)It[B]=e.getUint32(t),Lt[B]=e.getUint32(t+=4);for(let B=16;B<80;B++){let v=It[B-15]|0,E=Lt[B-15]|0,C=$t(v,E,1)^$t(v,E,8)^mo(v,E,7),R=er(v,E,1)^er(v,E,8)^go(v,E,7),S=It[B-2]|0,b=Lt[B-2]|0,_=$t(S,b,19)^zr(S,b,61)^mo(S,b,6),w=er(S,b,19)^Xr(S,b,61)^go(S,b,6),P=Pc(R,w,Lt[B-7],Lt[B-16]),F=kc(P,C,_,It[B-7],It[B-16]);It[B]=F|0,Lt[B]=P|0}let{Ah:n,Al:s,Bh:o,Bl:i,Ch:a,Cl:c,Dh:f,Dl:A,Eh:u,El:d,Fh:x,Fl:p,Gh:m,Gl:g,Hh:l,Hl:y}=this;for(let B=0;B<80;B++){let v=$t(u,d,14)^$t(u,d,18)^zr(u,d,41),E=er(u,d,14)^er(u,d,18)^Xr(u,d,41),C=u&x^~u&m,R=d&p^~d&g,S=Ic(y,E,R,Sf[B],Lt[B]),b=Lc(S,l,v,C,Df[B],It[B]),_=S|0,w=$t(n,s,28)^zr(n,s,34)^zr(n,s,39),P=er(n,s,28)^Xr(n,s,34)^Xr(n,s,39),F=n&o^n&a^o&a,D=s&i^s&c^i&c;l=m|0,y=g|0,m=x|0,g=p|0,x=u|0,p=d|0,{h:u,l:d}=tt(f|0,A|0,b|0,_|0),f=a|0,A=c|0,a=o|0,c=i|0,o=n|0,i=s|0;let M=Tc(_,P,D);n=Fc(M,b,w,F),s=M|0}({h:n,l:s}=tt(this.Ah|0,this.Al|0,n|0,s|0)),{h:o,l:i}=tt(this.Bh|0,this.Bl|0,o|0,i|0),{h:a,l:c}=tt(this.Ch|0,this.Cl|0,a|0,c|0),{h:f,l:A}=tt(this.Dh|0,this.Dl|0,f|0,A|0),{h:u,l:d}=tt(this.Eh|0,this.El|0,u|0,d|0),{h:x,l:p}=tt(this.Fh|0,this.Fl|0,x|0,p|0),{h:m,l:g}=tt(this.Gh|0,this.Gl|0,m|0,g|0),{h:l,l:y}=tt(this.Hh|0,this.Hl|0,l|0,y|0),this.set(n,s,o,i,a,c,f,A,u,d,x,p,m,g,l,y)}roundClean(){Zr(It,Lt)}destroy(){Zr(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},_r=_c(()=>new Bo)});function Zs(r,e=""){if(typeof r!="boolean"){let t=e&&`"${e}"`;throw new Error(t+"expected boolean, got type="+typeof r)}return r}function jr(r,e,t=""){let n=lt(r),s=r?.length,o=e!==void 0;if(!n||o&&s!==e){let i=t&&`"${t}" `,a=o?` of length ${e}`:"",c=n?`length=${s}`:`type=${typeof r}`;throw new Error(i+"expected Uint8Array"+a+", got "+c)}return r}function Uc(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?Eo:BigInt("0x"+r)}function Ws(r){return Uc(Jt(r))}function Ue(r){return xe(r),Uc(Jt(Uint8Array.from(r).reverse()))}function bo(r,e){return Ks(r.toString(16).padStart(e*2,"0"))}function zs(r,e){return bo(r,e).reverse()}function pe(r,e,t){let n;if(typeof e=="string")try{n=Ks(e)}catch(o){throw new Error(r+" must be hex string or Uint8Array, cause: "+o)}else if(lt(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");let s=n.length;if(typeof t=="number"&&s!==t)throw new Error(r+" of length "+t+" expected, got "+s);return n}function qc(r,e){if(r.length!==e.length)return!1;let t=0;for(let n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}function wo(r){return Uint8Array.from(r)}function Rf(r,e,t){return Co(r)&&Co(e)&&Co(t)&&e<=r&&r<t}function Dr(r,e,t,n){if(!Rf(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function Vc(r){let e;for(e=0;r>Eo;r>>=vo,e+=1);return e}function Nc(r){return typeof r=="function"&&Number.isSafeInteger(r.outputLen)}function xt(r,e,t={}){if(!r||typeof r!="object")throw new Error("expected valid options object");function n(s,o,i){let a=r[s];if(i&&a===void 0)return;let c=typeof a;if(c!==o||a===null)throw new Error(`param "${s}" is invalid: expected ${o}, got ${c}`)}Object.entries(e).forEach(([s,o])=>n(s,o,!1)),Object.entries(t).forEach(([s,o])=>n(s,o,!0))}function Do(r){let e=new WeakMap;return(t,...n)=>{let s=e.get(t);if(s!==void 0)return s;let o=r(t,...n);return e.set(t,o),o}}var Eo,vo,Co,Jr,_o,tr=Le(()=>{wr();wr();Eo=BigInt(0),vo=BigInt(1);Co=r=>typeof r=="bigint"&&Eo<=r;Jr=r=>(vo<<BigInt(r))-vo;_o=()=>{throw new Error("not implemented")}});function oe(r,e){let t=r%e;return t>=we?t:e+t}function qe(r,e,t){let n=r;for(;e-- >we;)n*=n,n%=t;return n}function Gc(r,e){if(r===we)throw new Error("invert: expected non-zero number");if(e<=we)throw new Error("invert: expected positive modulus, got "+e);let t=oe(r,e),n=e,s=we,o=Ee,i=Ee,a=we;for(;t!==we;){let f=n/t,A=n%t,u=s-i*f,d=o-a*f;n=t,t=A,s=i,o=a,i=u,a=d}if(n!==Ee)throw new Error("invert: does not exist");return oe(s,e)}function So(r,e,t){if(!r.eql(r.sqr(e),t))throw new Error("Cannot find square root")}function Xc(r,e){let t=(r.ORDER+Ee)/Yc,n=r.pow(e,t);return So(r,n,e),n}function Pf(r,e){let t=(r.ORDER-Zc)/Wc,n=r.mul(e,rr),s=r.pow(n,t),o=r.mul(e,s),i=r.mul(r.mul(o,rr),s),a=r.mul(o,r.sub(i,r.ONE));return So(r,a,e),a}function kf(r){let e=yt(r),t=jc(r),n=t(e,e.neg(e.ONE)),s=t(e,n),o=t(e,e.neg(n)),i=(r+Tf)/zc;return(a,c)=>{let f=a.pow(c,i),A=a.mul(f,n),u=a.mul(f,s),d=a.mul(f,o),x=a.eql(a.sqr(A),c),p=a.eql(a.sqr(u),c);f=a.cmov(f,A,x),A=a.cmov(d,u,p);let m=a.eql(a.sqr(A),c),g=a.cmov(f,A,m);return So(a,g,c),g}}function jc(r){if(r<Qc)throw new Error("sqrt is not defined for small field");let e=r-Ee,t=0;for(;e%rr===we;)e/=rr,t++;let n=rr,s=yt(r);for(;Kc(s,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(t===1)return Xc;let o=s.pow(n,e),i=(e+Ee)/rr;return function(c,f){if(c.is0(f))return f;if(Kc(c,f)!==1)throw new Error("Cannot find square root");let A=t,u=c.mul(c.ONE,o),d=c.pow(f,e),x=c.pow(f,i);for(;!c.eql(d,c.ONE);){if(c.is0(d))return c.ZERO;let p=1,m=c.sqr(d);for(;!c.eql(m,c.ONE);)if(p++,m=c.sqr(m),p===A)throw new Error("Cannot find square root");let g=Ee<<BigInt(A-p-1),l=c.pow(u,g);A=p,u=c.sqr(l),d=c.mul(d,u),x=c.mul(x,l)}return x}}function If(r){return r%Yc===Qc?Xc:r%Wc===Zc?Pf:r%zc===Ff?kf(r):jc(r)}function Jc(r){let e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},t=Lf.reduce((n,s)=>(n[s]="function",n),e);return xt(r,t),r}function Hf(r,e,t){if(t<we)throw new Error("invalid exponent, negatives unsupported");if(t===we)return r.ONE;if(t===Ee)return e;let n=r.ONE,s=e;for(;t>we;)t&Ee&&(n=r.mul(n,s)),s=r.sqr(s),t>>=Ee;return n}function Sr(r,e,t=!1){let n=new Array(e.length).fill(t?r.ZERO:void 0),s=e.reduce((i,a,c)=>r.is0(a)?i:(n[c]=i,r.mul(i,a)),r.ONE),o=r.inv(s);return e.reduceRight((i,a,c)=>r.is0(a)?i:(n[c]=r.mul(i,n[c]),r.mul(i,a)),o),n}function Kc(r,e){let t=(r.ORDER-Ee)/rr,n=r.pow(e,t),s=r.eql(n,r.ONE),o=r.eql(n,r.ZERO),i=r.eql(n,r.neg(r.ONE));if(!s&&!o&&!i)throw new Error("invalid Legendre symbol result");return s?1:o?0:-1}function $c(r,e){e!==void 0&&xo(e);let t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function yt(r,e,t=!1,n={}){if(r<=we)throw new Error("invalid field: expected ORDER > 0, got "+r);let s,o,i=!1,a;if(typeof e=="object"&&e!=null){if(n.sqrt||t)throw new Error("cannot specify opts in two arguments");let d=e;d.BITS&&(s=d.BITS),d.sqrt&&(o=d.sqrt),typeof d.isLE=="boolean"&&(t=d.isLE),typeof d.modFromBytes=="boolean"&&(i=d.modFromBytes),a=d.allowedLengths}else typeof e=="number"&&(s=e),n.sqrt&&(o=n.sqrt);let{nBitLength:c,nByteLength:f}=$c(r,s);if(f>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let A,u=Object.freeze({ORDER:r,isLE:t,BITS:c,BYTES:f,MASK:Jr(c),ZERO:we,ONE:Ee,allowedLengths:a,create:d=>oe(d,r),isValid:d=>{if(typeof d!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof d);return we<=d&&d<r},is0:d=>d===we,isValidNot0:d=>!u.is0(d)&&u.isValid(d),isOdd:d=>(d&Ee)===Ee,neg:d=>oe(-d,r),eql:(d,x)=>d===x,sqr:d=>oe(d*d,r),add:(d,x)=>oe(d+x,r),sub:(d,x)=>oe(d-x,r),mul:(d,x)=>oe(d*x,r),pow:(d,x)=>Hf(u,d,x),div:(d,x)=>oe(d*Gc(x,r),r),sqrN:d=>d*d,addN:(d,x)=>d+x,subN:(d,x)=>d-x,mulN:(d,x)=>d*x,inv:d=>Gc(d,r),sqrt:o||(d=>(A||(A=If(r)),A(u,d))),toBytes:d=>t?zs(d,f):bo(d,f),fromBytes:(d,x=!0)=>{if(a){if(!a.includes(d.length)||d.length>f)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+d.length);let m=new Uint8Array(f);m.set(d,t?0:m.length-d.length),d=m}if(d.length!==f)throw new Error("Field.fromBytes: expected "+f+" bytes, got "+d.length);let p=t?Ue(d):Ws(d);if(i&&(p=oe(p,r)),!x&&!u.isValid(p))throw new Error("invalid field element: outside of range 0..ORDER");return p},invertBatch:d=>Sr(u,d),cmov:(d,x,p)=>p?x:d});return Object.freeze(u)}function eA(r,e){if(!r.isOdd)throw new Error("Field doesn't have isOdd");let t=r.sqrt(e);return r.isOdd(t)?r.neg(t):t}var we,Ee,rr,Qc,Yc,Zc,Tf,Wc,Ff,zc,pt,Lf,Rr=Le(()=>{tr();we=BigInt(0),Ee=BigInt(1),rr=BigInt(2),Qc=BigInt(3),Yc=BigInt(4),Zc=BigInt(5),Tf=BigInt(7),Wc=BigInt(8),Ff=BigInt(9),zc=BigInt(16);pt=(r,e)=>(oe(r,e)&Ee)===Ee,Lf=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"]});function tA(r,e){let t=e.negate();return r?t:e}function $r(r,e){let t=Sr(r.Fp,e.map(n=>n.Z));return e.map((n,s)=>r.fromAffine(n.toAffine(t[s])))}function oA(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function Ro(r,e){oA(r,e);let t=Math.ceil(e/r)+1,n=2**(r-1),s=2**r,o=Jr(r),i=BigInt(r);return{windows:t,windowSize:n,mask:o,maxNumber:s,shiftBy:i}}function rA(r,e,t){let{windowSize:n,mask:s,maxNumber:o,shiftBy:i}=t,a=Number(r&s),c=r>>i;a>n&&(a-=o,c+=Po);let f=e*n,A=f+Math.abs(a)-1,u=a===0,d=a<0,x=e%2!==0;return{nextN:c,offset:A,isZero:u,isNeg:d,isNegF:x,offsetF:f}}function Of(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function Mf(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}function Fo(r){return iA.get(r)||1}function nA(r){if(r!==Xs)throw new Error("invalid wNAF")}function Js(r,e,t,n){Of(t,r),Mf(n,e);let s=t.length,o=n.length;if(s!==o)throw new Error("arrays of points and scalars must have equal length");let i=r.ZERO,a=Vc(BigInt(s)),c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);let f=Jr(c),A=new Array(Number(f)+1).fill(i),u=Math.floor((e.BITS-1)/c)*c,d=i;for(let x=u;x>=0;x-=c){A.fill(i);for(let m=0;m<o;m++){let g=n[m],l=Number(g>>BigInt(x)&f);A[l]=A[l].add(t[m])}let p=i;for(let m=A.length-1,g=i;m>0;m--)g=g.add(A[m]),p=p.add(g);if(d=d.add(p),x!==0)for(let m=0;m<c;m++)d=d.double()}return d}function sA(r,e,t){if(e){if(e.ORDER!==r)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return Jc(e),e}else return yt(r,{isLE:t})}function aA(r,e,t={},n){if(n===void 0&&(n=r==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${r} CURVE object`);for(let c of["p","n","h"]){let f=e[c];if(!(typeof f=="bigint"&&f>Xs))throw new Error(`CURVE.${c} must be positive bigint`)}let s=sA(e.p,t.Fp,n),o=sA(e.n,t.Fn,n),a=["Gx","Gy","a",r==="weierstrass"?"b":"d"];for(let c of a)if(!s.isValid(e[c]))throw new Error(`CURVE.${c} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:s,Fn:o}}var Xs,Po,To,iA,js,ko=Le(()=>{tr();Rr();Xs=BigInt(0),Po=BigInt(1);To=new WeakMap,iA=new WeakMap;js=class{constructor(e,t){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=t}_unsafeLadder(e,t,n=this.ZERO){let s=e;for(;t>Xs;)t&Po&&(n=n.add(s)),s=s.double(),t>>=Po;return n}precomputeWindow(e,t){let{windows:n,windowSize:s}=Ro(t,this.bits),o=[],i=e,a=i;for(let c=0;c<n;c++){a=i,o.push(a);for(let f=1;f<s;f++)a=a.add(i),o.push(a);i=a.double()}return o}wNAF(e,t,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let s=this.ZERO,o=this.BASE,i=Ro(e,this.bits);for(let a=0;a<i.windows;a++){let{nextN:c,offset:f,isZero:A,isNeg:u,isNegF:d,offsetF:x}=rA(n,a,i);n=c,A?o=o.add(tA(d,t[x])):s=s.add(tA(u,t[f]))}return nA(n),{p:s,f:o}}wNAFUnsafe(e,t,n,s=this.ZERO){let o=Ro(e,this.bits);for(let i=0;i<o.windows&&n!==Xs;i++){let{nextN:a,offset:c,isZero:f,isNeg:A}=rA(n,i,o);if(n=a,!f){let u=t[c];s=s.add(A?u.negate():u)}}return nA(n),s}getPrecomputes(e,t,n){let s=To.get(t);return s||(s=this.precomputeWindow(t,e),e!==1&&(typeof n=="function"&&(s=n(s)),To.set(t,s))),s}cached(e,t,n){let s=Fo(e);return this.wNAF(s,this.getPrecomputes(s,e,n),t)}unsafe(e,t,n,s){let o=Fo(e);return o===1?this._unsafeLadder(e,t,s):this.wNAFUnsafe(o,this.getPrecomputes(o,e,n),t,s)}createCache(e,t){oA(t,this.bits),iA.set(e,t),To.delete(e)}hasCache(e){return Fo(e)!==1}}});function qf(r,e,t,n){let s=r.sqr(t),o=r.sqr(n),i=r.add(r.mul(e.a,s),o),a=r.add(r.ONE,r.mul(e.d,r.mul(s,o)));return r.eql(i,a)}function Vf(r,e={}){let t=aA("edwards",r,e,e.FpFnLE),{Fp:n,Fn:s}=t,o=t.CURVE,{h:i}=o;xt(e,{},{uvRatio:"function"});let a=Io<<BigInt(s.BYTES*8)-ye,c=g=>n.create(g),f=e.uvRatio||((g,l)=>{try{return{isValid:!0,value:n.sqrt(n.div(g,l))}}catch{return{isValid:!1,value:Ht}}});if(!qf(n,o,o.Gx,o.Gy))throw new Error("bad curve params: generator point");function A(g,l,y=!1){let B=y?ye:Ht;return Dr("coordinate "+g,l,B,a),l}function u(g){if(!(g instanceof p))throw new Error("ExtendedPoint expected")}let d=Do((g,l)=>{let{X:y,Y:B,Z:v}=g,E=g.is0();l==null&&(l=E?Uf:n.inv(v));let C=c(y*l),R=c(B*l),S=n.mul(v,l);if(E)return{x:Ht,y:ye};if(S!==ye)throw new Error("invZ was invalid");return{x:C,y:R}}),x=Do(g=>{let{a:l,d:y}=o;if(g.is0())throw new Error("bad point: ZERO");let{X:B,Y:v,Z:E,T:C}=g,R=c(B*B),S=c(v*v),b=c(E*E),_=c(b*b),w=c(R*l),P=c(b*c(w+S)),F=c(_+c(y*c(R*S)));if(P!==F)throw new Error("bad point: equation left != right (1)");let D=c(B*v),M=c(E*C);if(D!==M)throw new Error("bad point: equation left != right (2)");return!0});class p{constructor(l,y,B,v){this.X=A("x",l),this.Y=A("y",y),this.Z=A("z",B,!0),this.T=A("t",v),Object.freeze(this)}static CURVE(){return o}static fromAffine(l){if(l instanceof p)throw new Error("extended point not allowed");let{x:y,y:B}=l||{};return A("x",y),A("y",B),new p(y,B,ye,c(y*B))}static fromBytes(l,y=!1){let B=n.BYTES,{a:v,d:E}=o;l=wo(jr(l,B,"point")),Zs(y,"zip215");let C=wo(l),R=l[B-1];C[B-1]=R&-129;let S=Ue(C),b=y?a:n.ORDER;Dr("point.y",S,Ht,b);let _=c(S*S),w=c(_-ye),P=c(E*_-v),{isValid:F,value:D}=f(w,P);if(!F)throw new Error("bad point: invalid y coordinate");let M=(D&ye)===ye,U=(R&128)!==0;if(!y&&D===Ht&&U)throw new Error("bad point: x=0 and x_0=1");return U!==M&&(D=c(-D)),p.fromAffine({x:D,y:S})}static fromHex(l,y=!1){return p.fromBytes(pe("point",l),y)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(l=8,y=!0){return m.createCache(this,l),y||this.multiply(Io),this}assertValidity(){x(this)}equals(l){u(l);let{X:y,Y:B,Z:v}=this,{X:E,Y:C,Z:R}=l,S=c(y*R),b=c(E*v),_=c(B*R),w=c(C*v);return S===b&&_===w}is0(){return this.equals(p.ZERO)}negate(){return new p(c(-this.X),this.Y,this.Z,c(-this.T))}double(){let{a:l}=o,{X:y,Y:B,Z:v}=this,E=c(y*y),C=c(B*B),R=c(Io*c(v*v)),S=c(l*E),b=y+B,_=c(c(b*b)-E-C),w=S+C,P=w-R,F=S-C,D=c(_*P),M=c(w*F),U=c(_*F),V=c(P*w);return new p(D,M,V,U)}add(l){u(l);let{a:y,d:B}=o,{X:v,Y:E,Z:C,T:R}=this,{X:S,Y:b,Z:_,T:w}=l,P=c(v*S),F=c(E*b),D=c(R*B*w),M=c(C*_),U=c((v+E)*(S+b)-P-F),V=M-D,G=M+D,T=c(F-y*P),I=c(U*V),H=c(G*T),L=c(U*T),J=c(V*G);return new p(I,H,J,L)}subtract(l){return this.add(l.negate())}multiply(l){if(!s.isValidNot0(l))throw new Error("invalid scalar: expected 1 <= sc < curve.n");let{p:y,f:B}=m.cached(this,l,v=>$r(p,v));return $r(p,[y,B])[0]}multiplyUnsafe(l,y=p.ZERO){if(!s.isValid(l))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return l===Ht?p.ZERO:this.is0()||l===ye?this:m.unsafe(this,l,B=>$r(p,B),y)}isSmallOrder(){return this.multiplyUnsafe(i).is0()}isTorsionFree(){return m.unsafe(this,o.n).is0()}toAffine(l){return d(this,l)}clearCofactor(){return i===ye?this:this.multiplyUnsafe(i)}toBytes(){let{x:l,y}=this.toAffine(),B=n.toBytes(y);return B[B.length-1]|=l&ye?128:0,B}toHex(){return Jt(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(l){return $r(p,l)}static msm(l,y){return Js(p,s,l,y)}_setWindowSize(l){this.precompute(l)}toRawBytes(){return this.toBytes()}}p.BASE=new p(o.Gx,o.Gy,ye,c(o.Gx*o.Gy)),p.ZERO=new p(Ht,ye,ye,Ht),p.Fp=n,p.Fn=s;let m=new js(p,s.BITS);return p.BASE.precompute(8),p}function Nf(r,e,t={}){if(typeof e!="function")throw new Error('"hash" function param is required');xt(t,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:n}=t,{BASE:s,Fp:o,Fn:i}=r,a=t.randomBytes||Wr,c=t.adjustScalarBytes||(b=>b),f=t.domain||((b,_,w)=>{if(Zs(w,"phflag"),_.length||w)throw new Error("Contexts/pre-hash are not supported");return b});function A(b){return i.create(Ue(b))}function u(b){let _=B.secretKey;b=pe("private key",b,_);let w=pe("hashed private key",e(b),2*_),P=c(w.slice(0,_)),F=w.slice(_,2*_),D=A(P);return{head:P,prefix:F,scalar:D}}function d(b){let{head:_,prefix:w,scalar:P}=u(b),F=s.multiply(P),D=F.toBytes();return{head:_,prefix:w,scalar:P,point:F,pointBytes:D}}function x(b){return d(b).pointBytes}function p(b=Uint8Array.of(),..._){let w=Pe(..._);return A(e(f(w,pe("context",b),!!n)))}function m(b,_,w={}){b=pe("message",b),n&&(b=n(b));let{prefix:P,scalar:F,pointBytes:D}=d(_),M=p(w.context,P,b),U=s.multiply(M).toBytes(),V=p(w.context,U,D,b),G=i.create(M+V*F);if(!i.isValid(G))throw new Error("sign failed: invalid s");let T=Pe(U,i.toBytes(G));return jr(T,B.signature,"result")}let g={zip215:!0};function l(b,_,w,P=g){let{context:F,zip215:D}=P,M=B.signature;b=pe("signature",b,M),_=pe("message",_),w=pe("publicKey",w,B.publicKey),D!==void 0&&Zs(D,"zip215"),n&&(_=n(_));let U=M/2,V=b.subarray(0,U),G=Ue(b.subarray(U,M)),T,I,H;try{T=r.fromBytes(w,D),I=r.fromBytes(V,D),H=s.multiplyUnsafe(G)}catch{return!1}if(!D&&T.isSmallOrder())return!1;let L=p(F,I.toBytes(),T.toBytes(),_);return I.add(T.multiplyUnsafe(L)).subtract(H).clearCofactor().is0()}let y=o.BYTES,B={secretKey:y,publicKey:y,signature:2*y,seed:y};function v(b=a(B.seed)){return jr(b,B.seed,"seed")}function E(b){let _=S.randomSecretKey(b);return{secretKey:_,publicKey:x(_)}}function C(b){return lt(b)&&b.length===i.BYTES}function R(b,_){try{return!!r.fromBytes(b,_)}catch{return!1}}let S={getExtendedPublicKey:d,randomSecretKey:v,isValidSecretKey:C,isValidPublicKey:R,toMontgomery(b){let{y:_}=r.fromBytes(b),w=B.publicKey,P=w===32;if(!P&&w!==57)throw new Error("only defined for 25519 and 448");let F=P?o.div(ye+_,ye-_):o.div(_-ye,_+ye);return o.toBytes(F)},toMontgomerySecret(b){let _=B.secretKey;jr(b,_);let w=e(b.subarray(0,_));return c(w).subarray(0,_)},randomPrivateKey:v,precompute(b=8,_=r.BASE){return _.precompute(b,!1)}};return Object.freeze({keygen:E,getPublicKey:x,sign:m,verify:l,utils:S,Point:r,lengths:B})}function Gf(r){let e={a:r.a,d:r.d,p:r.Fp.ORDER,n:r.n,h:r.h,Gx:r.Gx,Gy:r.Gy},t=r.Fp,n=yt(e.n,r.nBitLength,!0),s={Fp:t,Fn:n,uvRatio:r.uvRatio},o={randomBytes:r.randomBytes,adjustScalarBytes:r.adjustScalarBytes,domain:r.domain,prehash:r.prehash,mapToCurve:r.mapToCurve};return{CURVE:e,curveOpts:s,hash:r.hash,eddsaOpts:o}}function Kf(r,e){let t=e.Point;return Object.assign({},e,{ExtendedPoint:t,CURVE:r,nBitLength:t.Fn.BITS,nByteLength:t.Fn.BYTES})}function e0(r){let{CURVE:e,curveOpts:t,hash:n,eddsaOpts:s}=Gf(r),o=Vf(e,t),i=Nf(o,n,s);return Kf(r,i)}var Ht,ye,Io,Uf,$s,cA=Le(()=>{tr();ko();Rr();Ht=BigInt(0),ye=BigInt(1),Io=BigInt(2),Uf=BigInt(8);$s=class{constructor(e){this.ep=e}static fromBytes(e){_o()}static fromHex(e){_o()}get x(){return this.toAffine().x}get y(){return this.toAffine().y}clearCofactor(){return this}assertValidity(){this.ep.assertValidity()}toAffine(e){return this.ep.toAffine(e)}toHex(){return Jt(this.toBytes())}toString(){return this.toHex()}isTorsionFree(){return!0}isSmallOrder(){return!1}add(e){return this.assertSame(e),this.init(this.ep.add(e.ep))}subtract(e){return this.assertSame(e),this.init(this.ep.subtract(e.ep))}multiply(e){return this.init(this.ep.multiply(e))}multiplyUnsafe(e){return this.init(this.ep.multiplyUnsafe(e))}double(){return this.init(this.ep.double())}negate(){return this.init(this.ep.negate())}precompute(e,t){return this.init(this.ep.precompute(e,t))}toRawBytes(){return this.toBytes()}}});function Ot(r,e){if(en(r),en(e),r<0||r>=1<<8*e)throw new Error("invalid I2OSP input: "+r);let t=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)t[n]=r&255,r>>>=8;return new Uint8Array(t)}function Yf(r,e){let t=new Uint8Array(r.length);for(let n=0;n<r.length;n++)t[n]=r[n]^e[n];return t}function en(r){if(!Number.isSafeInteger(r))throw new Error("number expected")}function AA(r){if(!lt(r)&&typeof r!="string")throw new Error("DST must be Uint8Array or string");return typeof r=="string"?ht(r):r}function t0(r,e,t,n){xe(r),en(t),e=AA(e),e.length>255&&(e=n(Pe(ht("H2C-OVERSIZE-DST-"),e)));let{outputLen:s,blockLen:o}=n,i=Math.ceil(t/s);if(t>65535||i>255)throw new Error("expand_message_xmd: invalid lenInBytes");let a=Pe(e,Ot(e.length,1)),c=Ot(0,o),f=Ot(t,2),A=new Array(i),u=n(Pe(c,r,f,Ot(0,1),a));A[0]=n(Pe(u,Ot(1,1),a));for(let x=1;x<=i;x++){let p=[Yf(u,A[x-1]),Ot(x+1,1),a];A[x]=n(Pe(...p))}return Pe(...A).slice(0,t)}function Zf(r,e,t,n,s){if(xe(r),en(t),e=AA(e),e.length>255){let o=Math.ceil(2*n/8);e=s.create({dkLen:o}).update(ht("H2C-OVERSIZE-DST-")).update(e).digest()}if(t>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return s.create({dkLen:t}).update(r).update(Ot(t,2)).update(e).update(Ot(e.length,1)).digest()}function Lo(r,e,t){xt(t,{p:"bigint",m:"number",k:"number",hash:"function"});let{p:n,k:s,m:o,hash:i,expand:a,DST:c}=t;if(!Nc(t.hash))throw new Error("expected valid hash");xe(r),en(e);let f=n.toString(2).length,A=Math.ceil((f+s)/8),u=e*o*A,d;if(a==="xmd")d=t0(r,c,u,i);else if(a==="xof")d=Zf(r,c,u,s,i);else if(a==="_internal_pass")d=r;else throw new Error('expand must be "xmd" or "xof"');let x=new Array(e);for(let p=0;p<e;p++){let m=new Array(o);for(let g=0;g<o;g++){let l=A*(g+p*o),y=d.subarray(l,l+A);m[g]=oe(Qf(y),n)}x[p]=m}return x}function dA(r,e,t){if(typeof e!="function")throw new Error("mapToCurve() must be defined");function n(o){return r.fromAffine(e(o))}function s(o){let i=o.clearCofactor();return i.equals(r.ZERO)?r.ZERO:(i.assertValidity(),i)}return{defaults:t,hashToCurve(o,i){let a=Object.assign({},t,i),c=Lo(o,2,a),f=n(c[0]),A=n(c[1]);return s(f.add(A))},encodeToCurve(o,i){let a=t.encodeDST?{DST:t.encodeDST}:{},c=Object.assign({},t,a,i),f=Lo(o,1,c),A=n(f[0]);return s(A)},mapToCurve(o){if(!Array.isArray(o))throw new Error("expected array of bigints");for(let i of o)if(typeof i!="bigint")throw new Error("expected array of bigints");return s(n(o))},hashToScalar(o,i){let a=r.Fn.ORDER,c=Object.assign({},t,{p:a,m:1,DST:Ho},i);return Lo(o,1,c)[0][0]}}}var Qf,Ho,fA=Le(()=>{tr();Rr();Qf=Ws;Ho=ht("HashToScalar-")});function Wf(r){return xt(r,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...r})}function uA(r){let e=Wf(r),{P:t,type:n,adjustScalarBytes:s,powPminus2:o,randomBytes:i}=e,a=n==="x25519";if(!a&&n!=="x448")throw new Error("invalid type");let c=i||Wr,f=a?255:448,A=a?32:56,u=BigInt(a?9:5),d=BigInt(a?121665:39081),x=a?r0**BigInt(254):r0**BigInt(447),p=a?BigInt(8)*r0**BigInt(251)-Tr:BigInt(4)*r0**BigInt(445)-Tr,m=x+p+Tr,g=F=>oe(F,t),l=y(u);function y(F){return zs(g(F),A)}function B(F){let D=pe("u coordinate",F,A);return a&&(D[31]&=127),g(Ue(D))}function v(F){return Ue(s(pe("scalar",F,A)))}function E(F,D){let M=S(B(D),v(F));if(M===tn)throw new Error("invalid private or public key received");return y(M)}function C(F){return E(F,l)}function R(F,D,M){let U=g(F*(D-M));return D=g(D-U),M=g(M+U),{x_2:D,x_3:M}}function S(F,D){Dr("u",F,tn,t),Dr("scalar",D,x,m);let M=D,U=F,V=Tr,G=tn,T=F,I=Tr,H=tn;for(let J=BigInt(f-1);J>=tn;J--){let re=M>>J&Tr;H^=re,{x_2:V,x_3:T}=R(H,V,T),{x_2:G,x_3:I}=R(H,G,I),H=re;let de=V+G,z=g(de*de),ke=V-G,Ve=g(ke*ke),vt=z-Ve,st=T+I,be=T-I,le=g(be*de),ot=g(st*ke),We=le+ot,Et=le-ot;T=g(We*We),I=g(U*g(Et*Et)),V=g(z*Ve),G=g(vt*(z+g(d*vt)))}({x_2:V,x_3:T}=R(H,V,T)),{x_2:G,x_3:I}=R(H,G,I);let L=o(G);return g(V*L)}let b={secretKey:A,publicKey:A,seed:A},_=(F=c(A))=>(xe(F,b.seed),F);function w(F){let D=_(F);return{secretKey:D,publicKey:C(D)}}return{keygen:w,getSharedSecret:(F,D)=>E(F,D),getPublicKey:F=>C(F),scalarMult:E,scalarMultBase:C,utils:{randomSecretKey:_,randomPrivateKey:_},GuBytes:l.slice(),lengths:b}}var tn,Tr,r0,lA=Le(()=>{tr();Rr();tn=BigInt(0),Tr=BigInt(1),r0=BigInt(2)});var wA={};yi(wA,{ED25519_TORSION_SUBGROUP:()=>du,RistrettoPoint:()=>lu,ed25519:()=>Ke,ed25519_hasher:()=>Go,ed25519ctx:()=>Xf,ed25519ph:()=>jf,edwardsToMontgomery:()=>fu,edwardsToMontgomeryPriv:()=>uu,edwardsToMontgomeryPub:()=>bA,encodeToCurve:()=>xu,hashToCurve:()=>hu,hashToRistretto255:()=>pu,hash_to_ristretto255:()=>yu,ristretto255:()=>Au,ristretto255_hasher:()=>Ko,x25519:()=>Jf});function gA(r){let e=BigInt(10),t=BigInt(20),n=BigInt(40),s=BigInt(80),o=mt,a=r*r%o*r%o,c=qe(a,n0,o)*a%o,f=qe(c,rt,o)*r%o,A=qe(f,mA,o)*f%o,u=qe(A,e,o)*A%o,d=qe(u,t,o)*u%o,x=qe(d,n,o)*d%o,p=qe(x,s,o)*x%o,m=qe(p,s,o)*x%o,g=qe(m,e,o)*A%o;return{pow_p_5_8:qe(g,n0,o)*r%o,b2:a}}function BA(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function Vo(r,e){let t=mt,n=oe(e*e*e,t),s=oe(n*n*e,t),o=gA(r*s).pow_p_5_8,i=oe(r*n*o,t),a=oe(e*i*i,t),c=i,f=oe(i*Oo,t),A=a===r,u=a===oe(-r,t),d=a===oe(-r*Oo,t);return A&&(i=c),(u||d)&&(i=f),pt(i,t)&&(i=oe(-i,t)),{isValid:A||u,value:i}}function vA(r,e,t){if(e.length>255)throw new Error("Context is too big");return Pe(ht("SigEd25519 no Ed25519 collisions"),new Uint8Array([t?1:0,e.length]),e,r)}function tu(r){let e=(mt-mA)/qo,t=BigInt(486662),n=q.sqr(r);n=q.mul(n,n0);let s=q.add(n,q.ONE),o=q.neg(t),i=q.sqr(s),a=q.mul(i,s),c=q.mul(n,t);c=q.mul(c,o),c=q.add(c,i),c=q.mul(c,o);let f=q.sqr(a);i=q.sqr(f),f=q.mul(f,a),f=q.mul(f,c),i=q.mul(i,f);let A=q.pow(i,e);A=q.mul(A,f);let u=q.mul(A,hA);i=q.sqr(A),i=q.mul(i,a);let d=q.eql(i,c),x=q.cmov(u,A,d),p=q.mul(o,n),m=q.mul(A,r);m=q.mul(m,eu);let g=q.mul(m,hA),l=q.mul(c,n);i=q.sqr(m),i=q.mul(i,a);let y=q.eql(i,l),B=q.cmov(g,m,y);i=q.sqr(x),i=q.mul(i,a);let v=q.eql(i,c),E=q.cmov(p,o,v),C=q.cmov(B,x,v),R=q.isOdd(C);return C=q.cmov(C,q.neg(C),v!==R),{xMn:E,xMd:s,yMn:C,yMd:rt}}function nu(r){let{xMn:e,xMd:t,yMn:n,yMd:s}=tu(r),o=q.mul(e,s);o=q.mul(o,ru);let i=q.mul(t,n),a=q.sub(e,t),c=q.add(e,t),f=q.mul(i,c),A=q.eql(f,q.ZERO);o=q.cmov(o,q.ZERO,A),i=q.cmov(i,q.ONE,A),a=q.cmov(a,q.ONE,A),c=q.cmov(c,q.ONE,A);let[u,d]=Sr(q,[i,c],!0);return{x:q.mul(o,u),y:q.mul(a,d)}}function pA(r){let{d:e}=rn,t=mt,n=l=>q.create(l),s=n(Mo*r*r),o=n((s+rt)*iu),i=BigInt(-1),a=n((i-e*s)*n(s+e)),{isValid:c,value:f}=Vo(o,a),A=n(f*r);pt(A,t)||(A=n(-A)),c||(f=A),c||(i=s);let u=n(i*(s-rt)*au-a),d=f*f,x=n((f+f)*a),p=n(u*su),m=n(rt-d),g=n(rt+d);return new Ke.Point(n(x*g),n(m*p),n(p*g),n(x*m))}function EA(r){xe(r,64);let e=Uo(r.subarray(0,32)),t=pA(e),n=Uo(r.subarray(32,64)),s=pA(n);return new Qe(t.add(s))}function bA(r){return Ke.utils.toMontgomery(pe("pub",r))}function uu(r){return Ke.utils.toMontgomerySecret(pe("pub",r))}var zf,rt,n0,yA,mA,qo,mt,rn,Oo,q,CA,No,Ke,Xf,jf,Jf,$f,eu,hA,ru,Go,Mo,su,ou,iu,au,xA,cu,Uo,Qe,Au,Ko,du,fu,lu,hu,xu,pu,yu,_A=Le(()=>{Mc();wr();ko();cA();fA();Rr();lA();tr();zf=BigInt(0),rt=BigInt(1),n0=BigInt(2),yA=BigInt(3),mA=BigInt(5),qo=BigInt(8),mt=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),rn={p:mt,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:qo,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};Oo=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");q=yt(rn.p,{isLE:!0}),CA=yt(rn.n,{isLE:!0}),No={...rn,Fp:q,hash:_r,adjustScalarBytes:BA,uvRatio:Vo},Ke=e0(No);Xf=e0({...No,domain:vA}),jf=e0(Object.assign({},No,{domain:vA,prehash:_r})),Jf=(()=>{let r=q.ORDER;return uA({P:r,type:"x25519",powPminus2:e=>{let{pow_p_5_8:t,b2:n}=gA(e);return oe(qe(t,yA,r)*n,r)},adjustScalarBytes:BA})})(),$f=(mt+yA)/qo,eu=q.pow(n0,$f),hA=q.sqrt(q.neg(q.ONE));ru=eA(q,q.neg(BigInt(486664)));Go=dA(Ke.Point,r=>nu(r[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:mt,m:1,k:128,expand:"xmd",hash:_r}),Mo=Oo,su=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),ou=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),iu=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),au=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),xA=r=>Vo(rt,r),cu=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Uo=r=>Ke.Point.Fp.create(Ue(r)&cu);Qe=class r extends $s{constructor(e){super(e)}static fromAffine(e){return new r(Ke.Point.fromAffine(e))}assertSame(e){if(!(e instanceof r))throw new Error("RistrettoPoint expected")}init(e){return new r(e)}static hashToCurve(e){return EA(pe("ristrettoHash",e,64))}static fromBytes(e){xe(e,32);let{a:t,d:n}=rn,s=mt,o=v=>q.create(v),i=Uo(e);if(!qc(q.toBytes(i),e)||pt(i,s))throw new Error("invalid ristretto255 encoding 1");let a=o(i*i),c=o(rt+t*a),f=o(rt-t*a),A=o(c*c),u=o(f*f),d=o(t*n*A-u),{isValid:x,value:p}=xA(o(d*u)),m=o(p*f),g=o(p*m*d),l=o((i+i)*m);pt(l,s)&&(l=o(-l));let y=o(c*g),B=o(l*y);if(!x||pt(B,s)||y===zf)throw new Error("invalid ristretto255 encoding 2");return new r(new Ke.Point(l,y,rt,B))}static fromHex(e){return r.fromBytes(pe("ristrettoHex",e,32))}static msm(e,t){return Js(r,Ke.Point.Fn,e,t)}toBytes(){let{X:e,Y:t,Z:n,T:s}=this.ep,o=mt,i=g=>q.create(g),a=i(i(n+t)*i(n-t)),c=i(e*t),f=i(c*c),{value:A}=xA(i(a*f)),u=i(A*a),d=i(A*c),x=i(u*d*s),p;if(pt(s*x,o)){let g=i(t*Mo),l=i(e*Mo);e=g,t=l,p=i(u*ou)}else p=d;pt(e*x,o)&&(t=i(-t));let m=i((n-t)*p);return pt(m,o)&&(m=i(-m)),q.toBytes(m)}equals(e){this.assertSame(e);let{X:t,Y:n}=this.ep,{X:s,Y:o}=e.ep,i=f=>q.create(f),a=i(t*o)===i(n*s),c=i(n*o)===i(t*s);return a||c}is0(){return this.equals(r.ZERO)}};Qe.BASE=new Qe(Ke.Point.BASE);Qe.ZERO=new Qe(Ke.Point.ZERO);Qe.Fp=q;Qe.Fn=CA;Au={Point:Qe},Ko={hashToCurve(r,e){let t=e?.DST||"ristretto255_XMD:SHA-512_R255MAP_RO_",n=t0(r,t,64,_r);return EA(n)},hashToScalar(r,e={DST:Ho}){let t=t0(r,e.DST,64,_r);return CA.create(Ue(t))}},du=["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"];fu=bA;lu=Qe,hu=Go.hashToCurve,xu=Go.encodeToCurve,pu=Ko.hashToCurve,yu=Ko.hashToCurve});var SA=Q((dx,DA)=>{DA.exports={webm:"data:video/webm;base64,GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4EEQoWBAhhTgGcBAAAAAAAVkhFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsghV17AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU1LjMzLjEwMFdBjUxhdmY1NS4zMy4xMDBzpJBlrrXf3DCDVB8KcgbMpcr+RImIQJBgAAAAAAAWVK5rAQAAAAAAD++uAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDiDgQEj44OEAmJaAOABAAAAAAAABrCBsLqBkK4BAAAAAAAPq9eBAnPFgQKcgQAitZyDdW5khohBX1ZPUkJJU4OBAuEBAAAAAAAAEZ+BArWIQOdwAAAAAABiZIEgY6JPbwIeVgF2b3JiaXMAAAAAAoC7AAAAAAAAgLUBAAAAAAC4AQN2b3JiaXMtAAAAWGlwaC5PcmcgbGliVm9yYmlzIEkgMjAxMDExMDEgKFNjaGF1ZmVudWdnZXQpAQAAABUAAABlbmNvZGVyPUxhdmM1NS41Mi4xMDIBBXZvcmJpcyVCQ1YBAEAAACRzGCpGpXMWhBAaQlAZ4xxCzmvsGUJMEYIcMkxbyyVzkCGkoEKIWyiB0JBVAABAAACHQXgUhIpBCCGEJT1YkoMnPQghhIg5eBSEaUEIIYQQQgghhBBCCCGERTlokoMnQQgdhOMwOAyD5Tj4HIRFOVgQgydB6CCED0K4moOsOQghhCQ1SFCDBjnoHITCLCiKgsQwuBaEBDUojILkMMjUgwtCiJqDSTX4GoRnQXgWhGlBCCGEJEFIkIMGQcgYhEZBWJKDBjm4FITLQagahCo5CB+EIDRkFQCQAACgoiiKoigKEBqyCgDIAAAQQFEUx3EcyZEcybEcCwgNWQUAAAEACAAAoEiKpEiO5EiSJFmSJVmSJVmS5omqLMuyLMuyLMsyEBqyCgBIAABQUQxFcRQHCA1ZBQBkAAAIoDiKpViKpWiK54iOCISGrAIAgAAABAAAEDRDUzxHlETPVFXXtm3btm3btm3btm3btm1blmUZCA1ZBQBAAAAQ0mlmqQaIMAMZBkJDVgEACAAAgBGKMMSA0JBVAABAAACAGEoOogmtOd+c46BZDppKsTkdnEi1eZKbirk555xzzsnmnDHOOeecopxZDJoJrTnnnMSgWQqaCa0555wnsXnQmiqtOeeccc7pYJwRxjnnnCateZCajbU555wFrWmOmkuxOeecSLl5UptLtTnnnHPOOeecc84555zqxekcnBPOOeecqL25lpvQxTnnnE/G6d6cEM4555xzzjnnnHPOOeecIDRkFQAABABAEIaNYdwpCNLnaCBGEWIaMulB9+gwCRqDnELq0ehopJQ6CCWVcVJKJwgNWQUAAAIAQAghhRRSSCGFFFJIIYUUYoghhhhyyimnoIJKKqmooowyyyyzzDLLLLPMOuyssw47DDHEEEMrrcRSU2011lhr7jnnmoO0VlprrbVSSimllFIKQkNWAQAgAAAEQgYZZJBRSCGFFGKIKaeccgoqqIDQkFUAACAAgAAAAABP8hzRER3RER3RER3RER3R8RzPESVREiVREi3TMjXTU0VVdWXXlnVZt31b2IVd933d933d+HVhWJZlWZZlWZZlWZZlWZZlWZYgNGQVAAACAAAghBBCSCGFFFJIKcYYc8w56CSUEAgNWQUAAAIACAAAAHAUR3EcyZEcSbIkS9IkzdIsT/M0TxM9URRF0zRV0RVdUTdtUTZl0zVdUzZdVVZtV5ZtW7Z125dl2/d93/d93/d93/d93/d9XQdCQ1YBABIAADqSIymSIimS4ziOJElAaMgqAEAGAEAAAIriKI7jOJIkSZIlaZJneZaomZrpmZ4qqkBoyCoAABAAQAAAAAAAAIqmeIqpeIqoeI7oiJJomZaoqZoryqbsuq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq4LhIasAgAkAAB0JEdyJEdSJEVSJEdygNCQVQCADACAAAAcwzEkRXIsy9I0T/M0TxM90RM901NFV3SB0JBVAAAgAIAAAAAAAAAMybAUy9EcTRIl1VItVVMt1VJF1VNVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVN0zRNEwgNWQkAkAEAkBBTLS3GmgmLJGLSaqugYwxS7KWxSCpntbfKMYUYtV4ah5RREHupJGOKQcwtpNApJq3WVEKFFKSYYyoVUg5SIDRkhQAQmgHgcBxAsixAsiwAAAAAAAAAkDQN0DwPsDQPAAAAAAAAACRNAyxPAzTPAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA0jRA8zxA8zwAAAAAAAAA0DwP8DwR8EQRAAAAAAAAACzPAzTRAzxRBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA0jRA8zxA8zwAAAAAAAAAsDwP8EQR0DwRAAAAAAAAACzPAzxRBDzRAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAEOAAABBgIRQasiIAiBMAcEgSJAmSBM0DSJYFTYOmwTQBkmVB06BpME0AAAAAAAAAAAAAJE2DpkHTIIoASdOgadA0iCIAAAAAAAAAAAAAkqZB06BpEEWApGnQNGgaRBEAAAAAAAAAAAAAzzQhihBFmCbAM02IIkQRpgkAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAGHAAAAgwoQwUGrIiAIgTAHA4imUBAIDjOJYFAACO41gWAABYliWKAABgWZooAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAYcAAACDChDBQashIAiAIAcCiKZQHHsSzgOJYFJMmyAJYF0DyApgFEEQAIAAAocAAACLBBU2JxgEJDVgIAUQAABsWxLE0TRZKkaZoniiRJ0zxPFGma53meacLzPM80IYqiaJoQRVE0TZimaaoqME1VFQAAUOAAABBgg6bE4gCFhqwEAEICAByKYlma5nmeJ4qmqZokSdM8TxRF0TRNU1VJkqZ5niiKommapqqyLE3zPFEURdNUVVWFpnmeKIqiaaqq6sLzPE8URdE0VdV14XmeJ4qiaJqq6roQRVE0TdNUTVV1XSCKpmmaqqqqrgtETxRNU1Vd13WB54miaaqqq7ouEE3TVFVVdV1ZBpimaaqq68oyQFVV1XVdV5YBqqqqruu6sgxQVdd1XVmWZQCu67qyLMsCAAAOHAAAAoygk4wqi7DRhAsPQKEhKwKAKAAAwBimFFPKMCYhpBAaxiSEFEImJaXSUqogpFJSKRWEVEoqJaOUUmopVRBSKamUCkIqJZVSAADYgQMA2IGFUGjISgAgDwCAMEYpxhhzTiKkFGPOOScRUoox55yTSjHmnHPOSSkZc8w556SUzjnnnHNSSuacc845KaVzzjnnnJRSSuecc05KKSWEzkEnpZTSOeecEwAAVOAAABBgo8jmBCNBhYasBABSAQAMjmNZmuZ5omialiRpmud5niiapiZJmuZ5nieKqsnzPE8URdE0VZXneZ4oiqJpqirXFUXTNE1VVV2yLIqmaZqq6rowTdNUVdd1XZimaaqq67oubFtVVdV1ZRm2raqq6rqyDFzXdWXZloEsu67s2rIAAPAEBwCgAhtWRzgpGgssNGQlAJABAEAYg5BCCCFlEEIKIYSUUggJAAAYcAAACDChDBQashIASAUAAIyx1lprrbXWQGettdZaa62AzFprrbXWWmuttdZaa6211lJrrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmstpZRSSimllFJKKaWUUkoppZRSSgUA+lU4APg/2LA6wknRWGChISsBgHAAAMAYpRhzDEIppVQIMeacdFRai7FCiDHnJKTUWmzFc85BKCGV1mIsnnMOQikpxVZjUSmEUlJKLbZYi0qho5JSSq3VWIwxqaTWWoutxmKMSSm01FqLMRYjbE2ptdhqq7EYY2sqLbQYY4zFCF9kbC2m2moNxggjWywt1VprMMYY3VuLpbaaizE++NpSLDHWXAAAd4MDAESCjTOsJJ0VjgYXGrISAAgJACAQUooxxhhzzjnnpFKMOeaccw5CCKFUijHGnHMOQgghlIwx5pxzEEIIIYRSSsaccxBCCCGEkFLqnHMQQgghhBBKKZ1zDkIIIYQQQimlgxBCCCGEEEoopaQUQgghhBBCCKmklEIIIYRSQighlZRSCCGEEEIpJaSUUgohhFJCCKGElFJKKYUQQgillJJSSimlEkoJJYQSUikppRRKCCGUUkpKKaVUSgmhhBJKKSWllFJKIYQQSikFAAAcOAAABBhBJxlVFmGjCRcegEJDVgIAZAAAkKKUUiktRYIipRikGEtGFXNQWoqocgxSzalSziDmJJaIMYSUk1Qy5hRCDELqHHVMKQYtlRhCxhik2HJLoXMOAAAAQQCAgJAAAAMEBTMAwOAA4XMQdAIERxsAgCBEZohEw0JweFAJEBFTAUBigkIuAFRYXKRdXECXAS7o4q4DIQQhCEEsDqCABByccMMTb3jCDU7QKSp1IAAAAAAADADwAACQXAAREdHMYWRobHB0eHyAhIiMkAgAAAAAABcAfAAAJCVAREQ0cxgZGhscHR4fICEiIyQBAIAAAgAAAAAggAAEBAQAAAAAAAIAAAAEBB9DtnUBAAAAAAAEPueBAKOFggAAgACjzoEAA4BwBwCdASqwAJAAAEcIhYWIhYSIAgIABhwJ7kPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99YAD+/6tQgKOFggADgAqjhYIAD4AOo4WCACSADqOZgQArADECAAEQEAAYABhYL/QACIBDmAYAAKOFggA6gA6jhYIAT4AOo5mBAFMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAGSADqOFggB6gA6jmYEAewAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIAj4AOo5mBAKMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAKSADqOFggC6gA6jmYEAywAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIAz4AOo4WCAOSADqOZgQDzADECAAEQEAAYABhYL/QACIBDmAYAAKOFggD6gA6jhYIBD4AOo5iBARsAEQIAARAQFGAAYWC/0AAiAQ5gGACjhYIBJIAOo4WCATqADqOZgQFDADECAAEQEAAYABhYL/QACIBDmAYAAKOFggFPgA6jhYIBZIAOo5mBAWsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAXqADqOFggGPgA6jmYEBkwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIBpIAOo4WCAbqADqOZgQG7ADECAAEQEAAYABhYL/QACIBDmAYAAKOFggHPgA6jmYEB4wAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIB5IAOo4WCAfqADqOZgQILADECAAEQEAAYABhYL/QACIBDmAYAAKOFggIPgA6jhYICJIAOo5mBAjMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAjqADqOFggJPgA6jmYECWwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYICZIAOo4WCAnqADqOZgQKDADECAAEQEAAYABhYL/QACIBDmAYAAKOFggKPgA6jhYICpIAOo5mBAqsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCArqADqOFggLPgA6jmIEC0wARAgABEBAUYABhYL/QACIBDmAYAKOFggLkgA6jhYIC+oAOo5mBAvsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAw+ADqOZgQMjADECAAEQEAAYABhYL/QACIBDmAYAAKOFggMkgA6jhYIDOoAOo5mBA0sAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCA0+ADqOFggNkgA6jmYEDcwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIDeoAOo4WCA4+ADqOZgQObADECAAEQEAAYABhYL/QACIBDmAYAAKOFggOkgA6jhYIDuoAOo5mBA8MAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCA8+ADqOFggPkgA6jhYID+oAOo4WCBA+ADhxTu2sBAAAAAAAAEbuPs4EDt4r3gQHxghEr8IEK",mp4:"data:video/mp4;base64,AAAAHGZ0eXBNNFYgAAACAGlzb21pc28yYXZjMQAAAAhmcmVlAAAGF21kYXTeBAAAbGliZmFhYyAxLjI4AABCAJMgBDIARwAAArEGBf//rdxF6b3m2Ui3lizYINkj7u94MjY0IC0gY29yZSAxNDIgcjIgOTU2YzhkOCAtIEguMjY0L01QRUctNCBBVkMgY29kZWMgLSBDb3B5bGVmdCAyMDAzLTIwMTQgLSBodHRwOi8vd3d3LnZpZGVvbGFuLm9yZy94MjY0Lmh0bWwgLSBvcHRpb25zOiBjYWJhYz0wIHJlZj0zIGRlYmxvY2s9MTowOjAgYW5hbHlzZT0weDE6MHgxMTEgbWU9aGV4IHN1Ym1lPTcgcHN5PTEgcHN5X3JkPTEuMDA6MC4wMCBtaXhlZF9yZWY9MSBtZV9yYW5nZT0xNiBjaHJvbWFfbWU9MSB0cmVsbGlzPTEgOHg4ZGN0PTAgY3FtPTAgZGVhZHpvbmU9MjEsMTEgZmFzdF9wc2tpcD0xIGNocm9tYV9xcF9vZmZzZXQ9LTIgdGhyZWFkcz02IGxvb2thaGVhZF90aHJlYWRzPTEgc2xpY2VkX3RocmVhZHM9MCBucj0wIGRlY2ltYXRlPTEgaW50ZXJsYWNlZD0wIGJsdXJheV9jb21wYXQ9MCBjb25zdHJhaW5lZF9pbnRyYT0wIGJmcmFtZXM9MCB3ZWlnaHRwPTAga2V5aW50PTI1MCBrZXlpbnRfbWluPTI1IHNjZW5lY3V0PTQwIGludHJhX3JlZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAuNjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCB2YnZfbWF4cmF0ZT03NjggdmJ2X2J1ZnNpemU9MzAwMCBjcmZfbWF4PTAuMCBuYWxfaHJkPW5vbmUgZmlsbGVyPTAgaXBfcmF0aW89MS40MCBhcT0xOjEuMDAAgAAAAFZliIQL8mKAAKvMnJycnJycnJycnXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXiEASZACGQAjgCEASZACGQAjgAAAAAdBmjgX4GSAIQBJkAIZACOAAAAAB0GaVAX4GSAhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGagC/AySEASZACGQAjgAAAAAZBmqAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZrAL8DJIQBJkAIZACOAAAAABkGa4C/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmwAvwMkhAEmQAhkAI4AAAAAGQZsgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGbQC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm2AvwMkhAEmQAhkAI4AAAAAGQZuAL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGboC/AySEASZACGQAjgAAAAAZBm8AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZvgL8DJIQBJkAIZACOAAAAABkGaAC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmiAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpAL8DJIQBJkAIZACOAAAAABkGaYC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmoAvwMkhAEmQAhkAI4AAAAAGQZqgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGawC/AySEASZACGQAjgAAAAAZBmuAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZsAL8DJIQBJkAIZACOAAAAABkGbIC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm0AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZtgL8DJIQBJkAIZACOAAAAABkGbgCvAySEASZACGQAjgCEASZACGQAjgAAAAAZBm6AnwMkhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AAAAhubW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAABDcAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAzB0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAABAAAAAAAAA+kAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAALAAAACQAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAPpAAAAAAABAAAAAAKobWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAB1MAAAdU5VxAAAAAAALWhkbHIAAAAAAAAAAHZpZGUAAAAAAAAAAAAAAABWaWRlb0hhbmRsZXIAAAACU21pbmYAAAAUdm1oZAAAAAEAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAhNzdGJsAAAAr3N0c2QAAAAAAAAAAQAAAJ9hdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAALAAkABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAALWF2Y0MBQsAN/+EAFWdCwA3ZAsTsBEAAAPpAADqYA8UKkgEABWjLg8sgAAAAHHV1aWRraEDyXyRPxbo5pRvPAyPzAAAAAAAAABhzdHRzAAAAAAAAAAEAAAAeAAAD6QAAABRzdHNzAAAAAAAAAAEAAAABAAAAHHN0c2MAAAAAAAAAAQAAAAEAAAABAAAAAQAAAIxzdHN6AAAAAAAAAAAAAAAeAAADDwAAAAsAAAALAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAAiHN0Y28AAAAAAAAAHgAAAEYAAANnAAADewAAA5gAAAO0AAADxwAAA+MAAAP2AAAEEgAABCUAAARBAAAEXQAABHAAAASMAAAEnwAABLsAAATOAAAE6gAABQYAAAUZAAAFNQAABUgAAAVkAAAFdwAABZMAAAWmAAAFwgAABd4AAAXxAAAGDQAABGh0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAACAAAAAAAABDcAAAAAAAAAAAAAAAEBAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAQkAAADcAABAAAAAAPgbWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAC7gAAAykBVxAAAAAAALWhkbHIAAAAAAAAAAHNvdW4AAAAAAAAAAAAAAABTb3VuZEhhbmRsZXIAAAADi21pbmYAAAAQc21oZAAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAADT3N0YmwAAABnc3RzZAAAAAAAAAABAAAAV21wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAAM2VzZHMAAAAAA4CAgCIAAgAEgICAFEAVBbjYAAu4AAAADcoFgICAAhGQBoCAgAECAAAAIHN0dHMAAAAAAAAAAgAAADIAAAQAAAAAAQAAAkAAAAFUc3RzYwAAAAAAAAAbAAAAAQAAAAEAAAABAAAAAgAAAAIAAAABAAAAAwAAAAEAAAABAAAABAAAAAIAAAABAAAABgAAAAEAAAABAAAABwAAAAIAAAABAAAACAAAAAEAAAABAAAACQAAAAIAAAABAAAACgAAAAEAAAABAAAACwAAAAIAAAABAAAADQAAAAEAAAABAAAADgAAAAIAAAABAAAADwAAAAEAAAABAAAAEAAAAAIAAAABAAAAEQAAAAEAAAABAAAAEgAAAAIAAAABAAAAFAAAAAEAAAABAAAAFQAAAAIAAAABAAAAFgAAAAEAAAABAAAAFwAAAAIAAAABAAAAGAAAAAEAAAABAAAAGQAAAAIAAAABAAAAGgAAAAEAAAABAAAAGwAAAAIAAAABAAAAHQAAAAEAAAABAAAAHgAAAAIAAAABAAAAHwAAAAQAAAABAAAA4HN0c3oAAAAAAAAAAAAAADMAAAAaAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAACMc3RjbwAAAAAAAAAfAAAALAAAA1UAAANyAAADhgAAA6IAAAO+AAAD0QAAA+0AAAQAAAAEHAAABC8AAARLAAAEZwAABHoAAASWAAAEqQAABMUAAATYAAAE9AAABRAAAAUjAAAFPwAABVIAAAVuAAAFgQAABZ0AAAWwAAAFzAAABegAAAX7AAAGFwAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTUuMzMuMTAw"}});var TA=Q((fx,RA)=>{var{webm:mu,mp4:gu}=SA(),ei=()=>typeof navigator<"u"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,ti=()=>"wakeLock"in navigator,ri=class{constructor(){if(this.enabled=!1,ti()){this._wakeLock=null;let e=()=>{this._wakeLock!==null&&document.visibilityState==="visible"&&this.enable()};document.addEventListener("visibilitychange",e),document.addEventListener("fullscreenchange",e)}else ei()?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("title","No Sleep"),this.noSleepVideo.setAttribute("playsinline",""),this._addSourceToVideo(this.noSleepVideo,"webm",mu),this._addSourceToVideo(this.noSleepVideo,"mp4",gu),this.noSleepVideo.addEventListener("loadedmetadata",()=>{this.noSleepVideo.duration<=1?this.noSleepVideo.setAttribute("loop",""):this.noSleepVideo.addEventListener("timeupdate",()=>{this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())})}))}_addSourceToVideo(e,t,n){var s=document.createElement("source");s.src=n,s.type=`video/${t}`,e.appendChild(s)}get isEnabled(){return this.enabled}enable(){return ti()?navigator.wakeLock.request("screen").then(e=>{this._wakeLock=e,this.enabled=!0,console.log("Wake Lock active."),this._wakeLock.addEventListener("release",()=>{console.log("Wake Lock released.")})}).catch(e=>{throw this.enabled=!1,console.error(`${e.name}, ${e.message}`),e}):ei()?(this.disable(),console.warn(`
        NoSleep enabled for older iOS devices. This can interrupt
        active or long-running network requests from completing successfully.
        See https://github.com/richtr/NoSleep.js/issues/15 for more details.
      `),this.noSleepTimer=window.setInterval(()=>{document.hidden||(window.location.href=window.location.href.split("#")[0],window.setTimeout(window.stop,0))},15e3),this.enabled=!0,Promise.resolve()):this.noSleepVideo.play().then(t=>(this.enabled=!0,t)).catch(t=>{throw this.enabled=!1,t})}disable(){ti()?(this._wakeLock&&this._wakeLock.release(),this._wakeLock=null):ei()?this.noSleepTimer&&(console.warn(`
          NoSleep now disabled for older iOS devices.
        `),window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause(),this.enabled=!1}};RA.exports=ri});var PA=Q((i0,FA)=>{(function(r,e,t){typeof i0=="object"?FA.exports=i0=e(j(),fr(),qr()):typeof define=="function"&&define.amd?define(["./core","./sha256","./hmac"],e):e(r.CryptoJS)})(i0,function(r){return r.HmacSHA256})});var IA=Q((a0,kA)=>{(function(r,e){typeof a0=="object"?kA.exports=a0=e(j()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(a0,function(r){return r.enc.Hex})});var qt=cr(Ao(),1);var fo=class{constructor(){this.buffer=[]}toBytes(){return new Uint8Array(this.buffer)}writeBytes(e){this.buffer=[...this.buffer,...e]}writeByte(e){this.writeBytes([e])}writeUInt16LE(e){let t=new Uint8Array(2);new DataView(t.buffer).setUint16(0,e,!0),this.writeBytes(t)}writeUInt32LE(e){let t=new Uint8Array(4);new DataView(t.buffer).setUint32(0,e,!0),this.writeBytes(t)}writeInt32LE(e){let t=new Uint8Array(4);new DataView(t.buffer).setInt32(0,e,!0),this.writeBytes(t)}writeString(e){this.writeBytes(new TextEncoder().encode(e))}writeCString(e,t){let n=new Uint8Array(new ArrayBuffer(t)),s=new TextEncoder().encode(e);for(var o=0;o<t&&o<s.length;o++)n[o]=s[o];n[n.length-1]=0,this.writeBytes(n)}},X=fo;var uo=class{constructor(e){this.pointer=0,this.buffer=new Uint8Array(e)}getRemainingBytesCount(){return this.buffer.length-this.pointer}readByte(){return this.readBytes(1)[0]}readBytes(e){let t=this.buffer.slice(this.pointer,this.pointer+e);return this.pointer+=e,t}readRemainingBytes(){return this.readBytes(this.getRemainingBytesCount())}readString(){return new TextDecoder().decode(this.readRemainingBytes())}readCString(e){let t=[],n=this.readBytes(e);for(let s of n){if(s===0)return new TextDecoder().decode(new Uint8Array(t));t.push(s)}}readInt8(){let e=this.readBytes(1);return new DataView(e.buffer).getInt8(0)}readUInt8(){let e=this.readBytes(1);return new DataView(e.buffer).getUint8(0)}readUInt16LE(){let e=this.readBytes(2);return new DataView(e.buffer).getUint16(0,!0)}readUInt16BE(){let e=this.readBytes(2);return new DataView(e.buffer).getUint16(0,!1)}readUInt32LE(){let e=this.readBytes(4);return new DataView(e.buffer).getUint32(0,!0)}readUInt32BE(){let e=this.readBytes(4);return new DataView(e.buffer).getUint32(0,!1)}readInt16LE(){let e=this.readBytes(2);return new DataView(e.buffer).getInt16(0,!0)}readInt16BE(){let e=this.readBytes(2);return new DataView(e.buffer).getInt16(0,!1)}readInt32LE(){let e=this.readBytes(4);return new DataView(e.buffer).getInt32(0,!0)}readInt24BE(){var e=this.readByte()<<16|this.readByte()<<8|this.readByte();return e&8388608&&(e-=16777216),e}},ue=uo;var Fe=class{};Z(Fe,"SupportedCompanionProtocolVersion",1),Z(Fe,"SerialFrameTypes",{Incoming:62,Outgoing:60}),Z(Fe,"Ble",{ServiceUuid:"6E400001-B5A3-F393-E0A9-E50E24DCCA9E",CharacteristicUuidRx:"6E400002-B5A3-F393-E0A9-E50E24DCCA9E",CharacteristicUuidTx:"6E400003-B5A3-F393-E0A9-E50E24DCCA9E"}),Z(Fe,"CommandCodes",{AppStart:1,SendTxtMsg:2,SendChannelTxtMsg:3,GetContacts:4,GetDeviceTime:5,SetDeviceTime:6,SendSelfAdvert:7,SetAdvertName:8,AddUpdateContact:9,SyncNextMessage:10,SetRadioParams:11,SetTxPower:12,ResetPath:13,SetAdvertLatLon:14,RemoveContact:15,ShareContact:16,ExportContact:17,ImportContact:18,Reboot:19,GetBatteryVoltage:20,SetTuningParams:21,DeviceQuery:22,ExportPrivateKey:23,ImportPrivateKey:24,SendRawData:25,SendLogin:26,SendStatusReq:27,GetChannel:31,SetChannel:32,SignStart:33,SignData:34,SignFinish:35,SendTracePath:36,SetOtherParams:38,SendTelemetryReq:39,SendBinaryReq:50}),Z(Fe,"ResponseCodes",{Ok:0,Err:1,ContactsStart:2,Contact:3,EndOfContacts:4,SelfInfo:5,Sent:6,ContactMsgRecv:7,ChannelMsgRecv:8,CurrTime:9,NoMoreMessages:10,ExportContact:11,BatteryVoltage:12,DeviceInfo:13,PrivateKey:14,Disabled:15,ChannelInfo:18,SignStart:19,Signature:20}),Z(Fe,"PushCodes",{Advert:128,PathUpdated:129,SendConfirmed:130,MsgWaiting:131,RawData:132,LoginSuccess:133,LoginFail:134,StatusResponse:135,LogRxData:136,TraceData:137,NewAdvert:138,TelemetryResponse:139,BinaryResponse:140}),Z(Fe,"ErrorCodes",{UnsupportedCmd:1,NotFound:2,TableFull:3,BadState:4,FileIoError:5,IllegalArg:6}),Z(Fe,"AdvType",{None:0,Chat:1,Repeater:2,Room:3}),Z(Fe,"SelfAdvertTypes",{ZeroHop:0,Flood:1}),Z(Fe,"TxtTypes",{Plain:0,CliData:1,SignedPlain:2}),Z(Fe,"BinaryRequestTypes",{GetTelemetryData:3,GetAvgMinMax:4,GetAccessList:5,GetNeighbours:6});var h=Fe;var lo=class{constructor(){this.eventListenersMap=new Map}on(e,t){this.eventListenersMap.has(e)||this.eventListenersMap.set(e,[]),this.eventListenersMap.get(e).push(t)}off(e,t){if(this.eventListenersMap.has(e)){let n=this.eventListenersMap.get(e).filter(s=>s!==t);this.eventListenersMap.set(e,n)}}once(e,t){let n=(...s)=>{this.off(e,n),setTimeout(()=>t(...s),0)};this.on(e,n)}emit(e,...t){if(this.eventListenersMap.has(e))for(let n of this.eventListenersMap.get(e))setTimeout(()=>n(...t),0)}},Cc=lo;var ho=class{static bytesToHex(e){return Array.from(e).map(t=>t.toString(16).padStart(2,"0")).join("")}static hexToBytes(e){return Uint8Array.from(e.match(/.{1,2}/g).map(t=>parseInt(t,16)))}static base64ToBytes(e){return Uint8Array.from(atob(e),t=>t.charCodeAt(0))}static areBuffersEqual(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}},kt=ho;var ge=class ge{constructor(e,t,n,s){this.publicKey=e,this.timestamp=t,this.signature=n,this.appData=s,this.parsed=this.parseAppData()}static fromBytes(e){let t=new ue(e),n=t.readBytes(32),s=t.readUInt32LE(),o=t.readBytes(64),i=t.readRemainingBytes();return new ge(n,s,o,i)}getFlags(){return this.appData[0]}getType(){return this.getFlags()&15}getTypeString(){let e=this.getType();return e===ge.ADV_TYPE_NONE?"NONE":e===ge.ADV_TYPE_CHAT?"CHAT":e===ge.ADV_TYPE_REPEATER?"REPEATER":e===ge.ADV_TYPE_ROOM?"ROOM":null}async isVerified(){let{ed25519:e}=await Promise.resolve().then(()=>(_A(),wA)),t=new X;return t.writeBytes(this.publicKey),t.writeUInt32LE(this.timestamp),t.writeBytes(this.appData),e.verify(this.signature,t.toBytes(),this.publicKey)}parseAppData(){let e=new ue(this.appData),t=e.readByte();var n=null,s=null;t&ge.ADV_LATLON_MASK&&(n=e.readInt32LE(),s=e.readInt32LE());var o=null;return t&ge.ADV_NAME_MASK&&(o=e.readString()),{type:this.getTypeString(),lat:n,lon:s,name:o}}};Z(ge,"ADV_TYPE_NONE",0),Z(ge,"ADV_TYPE_CHAT",1),Z(ge,"ADV_TYPE_REPEATER",2),Z(ge,"ADV_TYPE_ROOM",3),Z(ge,"ADV_LATLON_MASK",16),Z(ge,"ADV_BATTERY_MASK",32),Z(ge,"ADV_TEMPERATURE_MASK",64),Z(ge,"ADV_NAME_MASK",128);var Qo=ge,Yo=Qo;var W=class W{constructor(e,t,n){this.header=e,this.path=t,this.payload=n,this.route_type=this.getRouteType(),this.route_type_string=this.getRouteTypeString(),this.payload_type=this.getPayloadType(),this.payload_type_string=this.getPayloadTypeString(),this.payload_version=this.getPayloadVer(),this.is_marked_do_not_retransmit=this.isMarkedDoNotRetransmit()}static fromBytes(e){let t=new ue(e),n=t.readByte(),s=t.readInt8(),o=t.readBytes(s),i=t.readRemainingBytes();return new W(n,o,i)}getRouteType(){return this.header&W.PH_ROUTE_MASK}getRouteTypeString(){switch(this.getRouteType()){case W.ROUTE_TYPE_FLOOD:return"FLOOD";case W.ROUTE_TYPE_DIRECT:return"DIRECT";default:return null}}isRouteFlood(){return this.getRouteType()===W.ROUTE_TYPE_FLOOD}isRouteDirect(){return this.getRouteType()===W.ROUTE_TYPE_DIRECT}getPayloadType(){return this.header>>W.PH_TYPE_SHIFT&W.PH_TYPE_MASK}getPayloadTypeString(){switch(this.getPayloadType()){case W.PAYLOAD_TYPE_REQ:return"REQ";case W.PAYLOAD_TYPE_RESPONSE:return"RESPONSE";case W.PAYLOAD_TYPE_TXT_MSG:return"TXT_MSG";case W.PAYLOAD_TYPE_ACK:return"ACK";case W.PAYLOAD_TYPE_ADVERT:return"ADVERT";case W.PAYLOAD_TYPE_GRP_TXT:return"GRP_TXT";case W.PAYLOAD_TYPE_GRP_DATA:return"GRP_DATA";case W.PAYLOAD_TYPE_ANON_REQ:return"ANON_REQ";case W.PAYLOAD_TYPE_PATH:return"PATH";case W.PAYLOAD_TYPE_TRACE:return"TRACE";case W.PAYLOAD_TYPE_RAW_CUSTOM:return"RAW_CUSTOM";default:return null}}getPayloadVer(){return this.header>>W.PH_VER_SHIFT&W.PH_VER_MASK}markDoNotRetransmit(){this.header=255}isMarkedDoNotRetransmit(){return this.header===255}parsePayload(){switch(this.getPayloadType()){case W.PAYLOAD_TYPE_PATH:return this.parsePayloadTypePath();case W.PAYLOAD_TYPE_REQ:return this.parsePayloadTypeReq();case W.PAYLOAD_TYPE_RESPONSE:return this.parsePayloadTypeResponse();case W.PAYLOAD_TYPE_TXT_MSG:return this.parsePayloadTypeTxtMsg();case W.PAYLOAD_TYPE_ACK:return this.parsePayloadTypeAck();case W.PAYLOAD_TYPE_ADVERT:return this.parsePayloadTypeAdvert();case W.PAYLOAD_TYPE_ANON_REQ:return this.parsePayloadTypeAnonReq();default:return null}}parsePayloadTypePath(){let e=new ue(this.payload),t=e.readByte();return{src:e.readByte(),dest:t}}parsePayloadTypeReq(){let e=new ue(this.payload),t=e.readByte(),n=e.readByte(),s=e.readRemainingBytes();return{src:n,dest:t,encrypted:s}}parsePayloadTypeResponse(){let e=new ue(this.payload),t=e.readByte();return{src:e.readByte(),dest:t}}parsePayloadTypeTxtMsg(){let e=new ue(this.payload),t=e.readByte();return{src:e.readByte(),dest:t}}parsePayloadTypeAck(){return{ack_code:this.payload}}parsePayloadTypeAdvert(){let e=Yo.fromBytes(this.payload);return{public_key:e.publicKey,timestamp:e.timestamp,app_data:e.parseAppData()}}parsePayloadTypeAnonReq(){let e=new ue(this.payload),t=e.readByte();return{src:e.readBytes(32),dest:t}}};Z(W,"PH_ROUTE_MASK",3),Z(W,"PH_TYPE_SHIFT",2),Z(W,"PH_TYPE_MASK",15),Z(W,"PH_VER_SHIFT",6),Z(W,"PH_VER_MASK",3),Z(W,"ROUTE_TYPE_RESERVED1",0),Z(W,"ROUTE_TYPE_FLOOD",1),Z(W,"ROUTE_TYPE_DIRECT",2),Z(W,"ROUTE_TYPE_RESERVED2",3),Z(W,"PAYLOAD_TYPE_REQ",0),Z(W,"PAYLOAD_TYPE_RESPONSE",1),Z(W,"PAYLOAD_TYPE_TXT_MSG",2),Z(W,"PAYLOAD_TYPE_ACK",3),Z(W,"PAYLOAD_TYPE_ADVERT",4),Z(W,"PAYLOAD_TYPE_GRP_TXT",5),Z(W,"PAYLOAD_TYPE_GRP_DATA",6),Z(W,"PAYLOAD_TYPE_ANON_REQ",7),Z(W,"PAYLOAD_TYPE_PATH",8),Z(W,"PAYLOAD_TYPE_TRACE",9),Z(W,"PAYLOAD_TYPE_RAW_CUSTOM",15);var Zo=W,s0=Zo;var Wo=class{static getRandomInt(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}},zo=Wo;var Xo=class extends Cc{async onConnected(){try{await this.deviceQuery(h.SupportedCompanionProtocolVersion)}catch{}this.emit("connected")}onDisconnected(){this.emit("disconnected")}async close(){throw new Error("This method must be implemented by the subclass.")}async sendToRadioFrame(e){throw new Error("This method must be implemented by the subclass.")}async sendCommandAppStart(){let e=new X;e.writeByte(h.CommandCodes.AppStart),e.writeByte(1),e.writeBytes(new Uint8Array(6)),e.writeString("test"),await this.sendToRadioFrame(e.toBytes())}async sendCommandSendTxtMsg(e,t,n,s,o){let i=new X;i.writeByte(h.CommandCodes.SendTxtMsg),i.writeByte(e),i.writeByte(t),i.writeUInt32LE(n),i.writeBytes(s.slice(0,6)),i.writeString(o),await this.sendToRadioFrame(i.toBytes())}async sendCommandSendChannelTxtMsg(e,t,n,s){let o=new X;o.writeByte(h.CommandCodes.SendChannelTxtMsg),o.writeByte(e),o.writeByte(t),o.writeUInt32LE(n),o.writeString(s),await this.sendToRadioFrame(o.toBytes())}async sendCommandGetContacts(e){let t=new X;t.writeByte(h.CommandCodes.GetContacts),e&&t.writeUInt32LE(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandGetDeviceTime(){let e=new X;e.writeByte(h.CommandCodes.GetDeviceTime),await this.sendToRadioFrame(e.toBytes())}async sendCommandSetDeviceTime(e){let t=new X;t.writeByte(h.CommandCodes.SetDeviceTime),t.writeUInt32LE(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandSendSelfAdvert(e){let t=new X;t.writeByte(h.CommandCodes.SendSelfAdvert),t.writeByte(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandSetAdvertName(e){let t=new X;t.writeByte(h.CommandCodes.SetAdvertName),t.writeString(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandAddUpdateContact(e,t,n,s,o,i,a,c,f){let A=new X;A.writeByte(h.CommandCodes.AddUpdateContact),A.writeBytes(e),A.writeByte(t),A.writeByte(n),A.writeByte(s),A.writeBytes(o),A.writeCString(i,32),A.writeUInt32LE(a),A.writeUInt32LE(c),A.writeUInt32LE(f),await this.sendToRadioFrame(A.toBytes())}async sendCommandSyncNextMessage(){let e=new X;e.writeByte(h.CommandCodes.SyncNextMessage),await this.sendToRadioFrame(e.toBytes())}async sendCommandSetRadioParams(e,t,n,s){let o=new X;o.writeByte(h.CommandCodes.SetRadioParams),o.writeUInt32LE(e),o.writeUInt32LE(t),o.writeByte(n),o.writeByte(s),await this.sendToRadioFrame(o.toBytes())}async sendCommandSetTxPower(e){let t=new X;t.writeByte(h.CommandCodes.SetTxPower),t.writeByte(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandResetPath(e){let t=new X;t.writeByte(h.CommandCodes.ResetPath),t.writeBytes(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandSetAdvertLatLon(e,t){let n=new X;n.writeByte(h.CommandCodes.SetAdvertLatLon),n.writeInt32LE(e),n.writeInt32LE(t),await this.sendToRadioFrame(n.toBytes())}async sendCommandRemoveContact(e){let t=new X;t.writeByte(h.CommandCodes.RemoveContact),t.writeBytes(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandShareContact(e){let t=new X;t.writeByte(h.CommandCodes.ShareContact),t.writeBytes(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandExportContact(e=null){let t=new X;t.writeByte(h.CommandCodes.ExportContact),e&&t.writeBytes(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandImportContact(e){let t=new X;t.writeByte(h.CommandCodes.ImportContact),t.writeBytes(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandReboot(){let e=new X;e.writeByte(h.CommandCodes.Reboot),e.writeString("reboot"),await this.sendToRadioFrame(e.toBytes())}async sendCommandGetBatteryVoltage(){let e=new X;e.writeByte(h.CommandCodes.GetBatteryVoltage),await this.sendToRadioFrame(e.toBytes())}async sendCommandDeviceQuery(e){let t=new X;t.writeByte(h.CommandCodes.DeviceQuery),t.writeByte(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandExportPrivateKey(){let e=new X;e.writeByte(h.CommandCodes.ExportPrivateKey),await this.sendToRadioFrame(e.toBytes())}async sendCommandImportPrivateKey(e){let t=new X;t.writeByte(h.CommandCodes.ImportPrivateKey),t.writeBytes(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandSendRawData(e,t){let n=new X;n.writeByte(h.CommandCodes.SendRawData),n.writeByte(e.length),n.writeBytes(e),n.writeBytes(t),await this.sendToRadioFrame(n.toBytes())}async sendCommandSendLogin(e,t){let n=new X;n.writeByte(h.CommandCodes.SendLogin),n.writeBytes(e),n.writeString(t),await this.sendToRadioFrame(n.toBytes())}async sendCommandSendStatusReq(e){let t=new X;t.writeByte(h.CommandCodes.SendStatusReq),t.writeBytes(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandSendTelemetryReq(e){let t=new X;t.writeByte(h.CommandCodes.SendTelemetryReq),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeBytes(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandSendBinaryReq(e,t){let n=new X;n.writeByte(h.CommandCodes.SendBinaryReq),n.writeBytes(e),n.writeBytes(t),await this.sendToRadioFrame(n.toBytes())}async sendCommandGetChannel(e){let t=new X;t.writeByte(h.CommandCodes.GetChannel),t.writeByte(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandSetChannel(e,t,n){let s=new X;s.writeByte(h.CommandCodes.SetChannel),s.writeByte(e),s.writeCString(t,32),s.writeBytes(n),await this.sendToRadioFrame(s.toBytes())}async sendCommandSignStart(){let e=new X;e.writeByte(h.CommandCodes.SignStart),await this.sendToRadioFrame(e.toBytes())}async sendCommandSignData(e){let t=new X;t.writeByte(h.CommandCodes.SignData),t.writeBytes(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandSignFinish(){let e=new X;e.writeByte(h.CommandCodes.SignFinish),await this.sendToRadioFrame(e.toBytes())}async sendCommandSendTracePath(e,t,n){let s=new X;s.writeByte(h.CommandCodes.SendTracePath),s.writeUInt32LE(e),s.writeUInt32LE(t),s.writeByte(0),s.writeBytes(n),await this.sendToRadioFrame(s.toBytes())}async sendCommandSetOtherParams(e){let t=new X;t.writeByte(h.CommandCodes.SetOtherParams),t.writeByte(e),await this.sendToRadioFrame(t.toBytes())}onFrameReceived(e){this.emit("rx",e);let t=new ue(e),n=t.readByte();n===h.ResponseCodes.Ok?this.onOkResponse(t):n===h.ResponseCodes.Err?this.onErrResponse(t):n===h.ResponseCodes.SelfInfo?this.onSelfInfoResponse(t):n===h.ResponseCodes.CurrTime?this.onCurrTimeResponse(t):n===h.ResponseCodes.NoMoreMessages?this.onNoMoreMessagesResponse(t):n===h.ResponseCodes.ContactMsgRecv?this.onContactMsgRecvResponse(t):n===h.ResponseCodes.ChannelMsgRecv?this.onChannelMsgRecvResponse(t):n===h.ResponseCodes.ContactsStart?this.onContactsStartResponse(t):n===h.ResponseCodes.Contact?this.onContactResponse(t):n===h.ResponseCodes.EndOfContacts?this.onEndOfContactsResponse(t):n===h.ResponseCodes.Sent?this.onSentResponse(t):n===h.ResponseCodes.ExportContact?this.onExportContactResponse(t):n===h.ResponseCodes.BatteryVoltage?this.onBatteryVoltageResponse(t):n===h.ResponseCodes.DeviceInfo?this.onDeviceInfoResponse(t):n===h.ResponseCodes.PrivateKey?this.onPrivateKeyResponse(t):n===h.ResponseCodes.Disabled?this.onDisabledResponse(t):n===h.ResponseCodes.ChannelInfo?this.onChannelInfoResponse(t):n===h.ResponseCodes.SignStart?this.onSignStartResponse(t):n===h.ResponseCodes.Signature?this.onSignatureResponse(t):n===h.PushCodes.Advert?this.onAdvertPush(t):n===h.PushCodes.PathUpdated?this.onPathUpdatedPush(t):n===h.PushCodes.SendConfirmed?this.onSendConfirmedPush(t):n===h.PushCodes.MsgWaiting?this.onMsgWaitingPush(t):n===h.PushCodes.RawData?this.onRawDataPush(t):n===h.PushCodes.LoginSuccess?this.onLoginSuccessPush(t):n===h.PushCodes.StatusResponse?this.onStatusResponsePush(t):n===h.PushCodes.LogRxData?this.onLogRxDataPush(t):n===h.PushCodes.TelemetryResponse?this.onTelemetryResponsePush(t):n===h.PushCodes.TraceData?this.onTraceDataPush(t):n===h.PushCodes.NewAdvert?this.onNewAdvertPush(t):n===h.PushCodes.BinaryResponse?this.onBinaryResponsePush(t):console.log(`unhandled frame: code=${n}`,e)}onAdvertPush(e){this.emit(h.PushCodes.Advert,{publicKey:e.readBytes(32)})}onPathUpdatedPush(e){this.emit(h.PushCodes.PathUpdated,{publicKey:e.readBytes(32)})}onSendConfirmedPush(e){this.emit(h.PushCodes.SendConfirmed,{ackCode:e.readUInt32LE(),roundTrip:e.readUInt32LE()})}onMsgWaitingPush(e){this.emit(h.PushCodes.MsgWaiting,{})}onRawDataPush(e){this.emit(h.PushCodes.RawData,{lastSnr:e.readInt8()/4,lastRssi:e.readInt8(),reserved:e.readByte(),payload:e.readRemainingBytes()})}onLoginSuccessPush(e){this.emit(h.PushCodes.LoginSuccess,{reserved:e.readByte(),pubKeyPrefix:e.readBytes(6)})}onStatusResponsePush(e){this.emit(h.PushCodes.StatusResponse,{reserved:e.readByte(),pubKeyPrefix:e.readBytes(6),statusData:e.readRemainingBytes()})}onLogRxDataPush(e){this.emit(h.PushCodes.LogRxData,{lastSnr:e.readInt8()/4,lastRssi:e.readInt8(),raw:e.readRemainingBytes()})}onTelemetryResponsePush(e){this.emit(h.PushCodes.TelemetryResponse,{reserved:e.readByte(),pubKeyPrefix:e.readBytes(6),lppSensorData:e.readRemainingBytes()})}onBinaryResponsePush(e){this.emit(h.PushCodes.BinaryResponse,{reserved:e.readByte(),tag:e.readUInt32LE(),responseData:e.readRemainingBytes()})}onTraceDataPush(e){let t=e.readByte(),n=e.readUInt8();this.emit(h.PushCodes.TraceData,{reserved:t,pathLen:n,flags:e.readUInt8(),tag:e.readUInt32LE(),authCode:e.readUInt32LE(),pathHashes:e.readBytes(n),pathSnrs:e.readBytes(n),lastSnr:e.readInt8()/4})}onNewAdvertPush(e){this.emit(h.PushCodes.NewAdvert,{publicKey:e.readBytes(32),type:e.readByte(),flags:e.readByte(),outPathLen:e.readInt8(),outPath:e.readBytes(64),advName:e.readCString(32),lastAdvert:e.readUInt32LE(),advLat:e.readUInt32LE(),advLon:e.readUInt32LE(),lastMod:e.readUInt32LE()})}onOkResponse(e){this.emit(h.ResponseCodes.Ok,{})}onErrResponse(e){let t=e.getRemainingBytesCount()>0?e.readByte():null;this.emit(h.ResponseCodes.Err,{errCode:t})}onContactsStartResponse(e){this.emit(h.ResponseCodes.ContactsStart,{count:e.readUInt32LE()})}onContactResponse(e){this.emit(h.ResponseCodes.Contact,{publicKey:e.readBytes(32),type:e.readByte(),flags:e.readByte(),outPathLen:e.readInt8(),outPath:e.readBytes(64),advName:e.readCString(32),lastAdvert:e.readUInt32LE(),advLat:e.readUInt32LE(),advLon:e.readUInt32LE(),lastMod:e.readUInt32LE()})}onEndOfContactsResponse(e){this.emit(h.ResponseCodes.EndOfContacts,{mostRecentLastmod:e.readUInt32LE()})}onSentResponse(e){this.emit(h.ResponseCodes.Sent,{result:e.readInt8(),expectedAckCrc:e.readUInt32LE(),estTimeout:e.readUInt32LE()})}onExportContactResponse(e){this.emit(h.ResponseCodes.ExportContact,{advertPacketBytes:e.readRemainingBytes()})}onBatteryVoltageResponse(e){this.emit(h.ResponseCodes.BatteryVoltage,{batteryMilliVolts:e.readUInt16LE()})}onDeviceInfoResponse(e){this.emit(h.ResponseCodes.DeviceInfo,{firmwareVer:e.readInt8(),reserved:e.readBytes(6),firmware_build_date:e.readCString(12),manufacturerModel:e.readString()})}onPrivateKeyResponse(e){this.emit(h.ResponseCodes.PrivateKey,{privateKey:e.readBytes(64)})}onDisabledResponse(e){this.emit(h.ResponseCodes.Disabled,{})}onChannelInfoResponse(e){let t=e.readUInt8(),n=e.readCString(32),s=e.getRemainingBytesCount();s===16?this.emit(h.ResponseCodes.ChannelInfo,{channelIdx:t,name:n,secret:e.readBytes(s)}):console.log(`ChannelInfo has unexpected key length: ${s}`)}onSignStartResponse(e){this.emit(h.ResponseCodes.SignStart,{reserved:e.readByte(),maxSignDataLen:e.readUInt32LE()})}onSignatureResponse(e){this.emit(h.ResponseCodes.Signature,{signature:e.readBytes(64)})}onSelfInfoResponse(e){this.emit(h.ResponseCodes.SelfInfo,{type:e.readByte(),txPower:e.readByte(),maxTxPower:e.readByte(),publicKey:e.readBytes(32),advLat:e.readInt32LE(),advLon:e.readInt32LE(),reserved:e.readBytes(3),manualAddContacts:e.readByte(),radioFreq:e.readUInt32LE(),radioBw:e.readUInt32LE(),radioSf:e.readByte(),radioCr:e.readByte(),name:e.readString()})}onCurrTimeResponse(e){this.emit(h.ResponseCodes.CurrTime,{epochSecs:e.readUInt32LE()})}onNoMoreMessagesResponse(e){this.emit(h.ResponseCodes.NoMoreMessages,{})}onContactMsgRecvResponse(e){this.emit(h.ResponseCodes.ContactMsgRecv,{pubKeyPrefix:e.readBytes(6),pathLen:e.readByte(),txtType:e.readByte(),senderTimestamp:e.readUInt32LE(),text:e.readString()})}onChannelMsgRecvResponse(e){this.emit(h.ResponseCodes.ChannelMsgRecv,{channelIdx:e.readInt8(),pathLen:e.readByte(),txtType:e.readByte(),senderTimestamp:e.readUInt32LE(),text:e.readString()})}getSelfInfo(e=null){return new Promise(async(t,n)=>{this.once(h.ResponseCodes.SelfInfo,s=>{t(s)}),e!=null&&setTimeout(n,e),await this.sendCommandAppStart()})}async sendAdvert(e){return new Promise(async(t,n)=>{try{let s=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),t()},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandSendSelfAdvert(e)}catch(s){n(s)}})}async sendFloodAdvert(){return await this.sendAdvert(h.SelfAdvertTypes.Flood)}async sendZeroHopAdvert(){return await this.sendAdvert(h.SelfAdvertTypes.ZeroHop)}setAdvertName(e){return new Promise(async(t,n)=>{try{let s=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),t()},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandSetAdvertName(e)}catch(s){n(s)}})}setAdvertLatLong(e,t){return new Promise(async(n,s)=>{try{let o=()=>{this.off(h.ResponseCodes.Ok,o),this.off(h.ResponseCodes.Err,i),n()},i=()=>{this.off(h.ResponseCodes.Ok,o),this.off(h.ResponseCodes.Err,i),s()};this.once(h.ResponseCodes.Ok,o),this.once(h.ResponseCodes.Err,i),await this.sendCommandSetAdvertLatLon(e,t)}catch(o){s(o)}})}setTxPower(e){return new Promise(async(t,n)=>{try{let s=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),t()},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandSetTxPower(e)}catch(s){n(s)}})}setRadioParams(e,t,n,s){return new Promise(async(o,i)=>{try{let a=()=>{this.off(h.ResponseCodes.Ok,a),this.off(h.ResponseCodes.Err,c),o()},c=()=>{this.off(h.ResponseCodes.Ok,a),this.off(h.ResponseCodes.Err,c),i()};this.once(h.ResponseCodes.Ok,a),this.once(h.ResponseCodes.Err,c),await this.sendCommandSetRadioParams(e,t,n,s)}catch(a){i(a)}})}getContacts(){return new Promise(async(e,t)=>{let n=[],s=o=>{n.push(o)};this.on(h.ResponseCodes.Contact,s),this.once(h.ResponseCodes.EndOfContacts,()=>{this.off(h.ResponseCodes.Contact,s),e(n)}),await this.sendCommandGetContacts()})}async findContactByName(e){return(await this.getContacts()).find(n=>n.advName===e)}async findContactByPublicKeyPrefix(e){return(await this.getContacts()).find(n=>{let s=n.publicKey.subarray(0,e.length);return kt.areBuffersEqual(e,s)})}sendTextMessage(e,t,n){return new Promise(async(s,o)=>{try{let i=u=>{this.off(h.ResponseCodes.Sent,i),this.off(h.ResponseCodes.Err,a),s(u)},a=()=>{this.off(h.ResponseCodes.Sent,i),this.off(h.ResponseCodes.Err,a),o()};this.once(h.ResponseCodes.Sent,i),this.once(h.ResponseCodes.Err,a);let c=n??h.TxtTypes.Plain,f=0,A=Math.floor(Date.now()/1e3);await this.sendCommandSendTxtMsg(c,f,A,e,t)}catch(i){o(i)}})}sendChannelTextMessage(e,t){return new Promise(async(n,s)=>{try{let o=()=>{this.off(h.ResponseCodes.Ok,o),this.off(h.ResponseCodes.Err,i),n()},i=()=>{this.off(h.ResponseCodes.Ok,o),this.off(h.ResponseCodes.Err,i),s()};this.once(h.ResponseCodes.Ok,o),this.once(h.ResponseCodes.Err,i);let a=h.TxtTypes.Plain,c=Math.floor(Date.now()/1e3);await this.sendCommandSendChannelTxtMsg(a,e,c,t)}catch(o){s(o)}})}syncNextMessage(){return new Promise(async(e,t)=>{let n=i=>{this.off(h.ResponseCodes.ContactMsgRecv,n),this.off(h.ResponseCodes.ChannelMsgRecv,s),this.off(h.ResponseCodes.NoMoreMessages,o),e({contactMessage:i})},s=i=>{this.off(h.ResponseCodes.ContactMsgRecv,n),this.off(h.ResponseCodes.ChannelMsgRecv,s),this.off(h.ResponseCodes.NoMoreMessages,o),e({channelMessage:i})},o=()=>{this.off(h.ResponseCodes.ContactMsgRecv,n),this.off(h.ResponseCodes.ChannelMsgRecv,s),this.off(h.ResponseCodes.NoMoreMessages,o),e(null)};this.once(h.ResponseCodes.ContactMsgRecv,n),this.once(h.ResponseCodes.ChannelMsgRecv,s),this.once(h.ResponseCodes.NoMoreMessages,o),await this.sendCommandSyncNextMessage()})}async getWaitingMessages(){let e=[];for(;;){let t=await this.syncNextMessage();if(!t)break;e.push(t)}return e}getDeviceTime(){return new Promise(async(e,t)=>{try{let n=o=>{this.off(h.ResponseCodes.CurrTime,n),this.off(h.ResponseCodes.Err,s),e(o)},s=()=>{this.off(h.ResponseCodes.CurrTime,n),this.off(h.ResponseCodes.Err,s),t()};this.once(h.ResponseCodes.CurrTime,n),this.once(h.ResponseCodes.Err,s),await this.sendCommandGetDeviceTime()}catch(n){t(n)}})}setDeviceTime(e){return new Promise(async(t,n)=>{try{let s=i=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),t(i)},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandSetDeviceTime(e)}catch(s){n(s)}})}async syncDeviceTime(){await this.setDeviceTime(Math.floor(Date.now()/1e3))}importContact(e){return new Promise(async(t,n)=>{try{let s=i=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),t(i)},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandImportContact(e)}catch(s){n(s)}})}exportContact(e=null){return new Promise(async(t,n)=>{try{let s=i=>{this.off(h.ResponseCodes.ExportContact,s),this.off(h.ResponseCodes.Err,o),t(i)},o=()=>{this.off(h.ResponseCodes.ExportContact,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.ExportContact,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandExportContact(e)}catch(s){n(s)}})}shareContact(e){return new Promise(async(t,n)=>{try{let s=i=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),t(i)},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandShareContact(e)}catch(s){n(s)}})}removeContact(e){return new Promise(async(t,n)=>{try{let s=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),t()},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandRemoveContact(e)}catch(s){n(s)}})}addOrUpdateContact(e,t,n,s,o,i,a,c,f){return new Promise(async(A,u)=>{try{let d=()=>{this.off(h.ResponseCodes.Ok,d),this.off(h.ResponseCodes.Err,x),A()},x=()=>{this.off(h.ResponseCodes.Ok,d),this.off(h.ResponseCodes.Err,x),u()};this.once(h.ResponseCodes.Ok,d),this.once(h.ResponseCodes.Err,x),await this.sendCommandAddUpdateContact(e,t,n,s,o,i,a,c,f)}catch(d){u(d)}})}setContactPath(e,t){return new Promise(async(n,s)=>{try{let a=new Uint8Array(64);for(var o=0;o<t.length&&o<64;o++)a[o]=t[o];return e.outPathLen=t.length,e.outPath=a,await this.addOrUpdateContact(e.publicKey,e.type,e.flags,e.outPathLen,e.outPath,e.advName,e.lastAdvert,e.advLat,e.advLon)}catch(i){s(i)}})}resetPath(e){return new Promise(async(t,n)=>{try{let s=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),t()},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandResetPath(e)}catch(s){n(s)}})}reboot(){return new Promise(async(e,t)=>{try{let n=()=>{this.off(h.ResponseCodes.Err,n),t()};setTimeout(()=>{this.off(h.ResponseCodes.Err,n),e()},1e3),this.once(h.ResponseCodes.Err,n),await this.sendCommandReboot()}catch(n){t(n)}})}getBatteryVoltage(){return new Promise(async(e,t)=>{try{let n=o=>{this.off(h.ResponseCodes.BatteryVoltage,n),this.off(h.ResponseCodes.Err,s),e(o)},s=()=>{this.off(h.ResponseCodes.BatteryVoltage,n),this.off(h.ResponseCodes.Err,s),t()};this.once(h.ResponseCodes.BatteryVoltage,n),this.once(h.ResponseCodes.Err,s),await this.sendCommandGetBatteryVoltage()}catch(n){t(n)}})}deviceQuery(e){return new Promise(async(t,n)=>{try{let s=i=>{this.off(h.ResponseCodes.DeviceInfo,s),this.off(h.ResponseCodes.Err,o),t(i)},o=()=>{this.off(h.ResponseCodes.DeviceInfo,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.DeviceInfo,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandDeviceQuery(e)}catch(s){n(s)}})}exportPrivateKey(){return new Promise(async(e,t)=>{try{let n=i=>{this.off(h.ResponseCodes.PrivateKey,n),this.off(h.ResponseCodes.Err,s),this.off(h.ResponseCodes.Disabled,o),e(i)},s=()=>{this.off(h.ResponseCodes.PrivateKey,n),this.off(h.ResponseCodes.Err,s),this.off(h.ResponseCodes.Disabled,o),t()},o=()=>{this.off(h.ResponseCodes.PrivateKey,n),this.off(h.ResponseCodes.Err,s),this.off(h.ResponseCodes.Disabled,o),t("disabled")};this.once(h.ResponseCodes.PrivateKey,n),this.once(h.ResponseCodes.Err,s),this.once(h.ResponseCodes.Disabled,o),await this.sendCommandExportPrivateKey()}catch(n){t(n)}})}importPrivateKey(e){return new Promise(async(t,n)=>{try{let s=a=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),this.off(h.ResponseCodes.Disabled,i),t(a)},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),this.off(h.ResponseCodes.Disabled,i),n()},i=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),this.off(h.ResponseCodes.Disabled,i),n("disabled")};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),this.once(h.ResponseCodes.Disabled,i),await this.sendCommandImportPrivateKey(e)}catch(s){n(s)}})}login(e,t,n=1e3){return new Promise(async(s,o)=>{try{let a=e.subarray(0,6);var i=null;let c=u=>{this.off(h.ResponseCodes.Err,A);let d=u.estTimeout+n;i=setTimeout(()=>{this.off(h.ResponseCodes.Err,A),this.off(h.ResponseCodes.Sent,c),this.off(h.PushCodes.LoginSuccess,f),o("timeout")},d)},f=u=>{if(!kt.areBuffersEqual(a,u.pubKeyPrefix)){console.log("onLoginSuccess is not for this login request, ignoring...");return}clearTimeout(i),this.off(h.ResponseCodes.Err,A),this.off(h.ResponseCodes.Sent,c),this.off(h.PushCodes.LoginSuccess,f),s(u)},A=()=>{clearTimeout(i),this.off(h.ResponseCodes.Err,A),this.off(h.ResponseCodes.Sent,c),this.off(h.PushCodes.LoginSuccess,f),o()};this.once(h.ResponseCodes.Err,A),this.once(h.ResponseCodes.Sent,c),this.once(h.PushCodes.LoginSuccess,f),await this.sendCommandSendLogin(e,t)}catch(a){o(a)}})}getStatus(e,t=1e3){return new Promise(async(n,s)=>{try{let i=e.subarray(0,6);var o=null;let a=A=>{this.off(h.ResponseCodes.Err,f);let u=A.estTimeout+t;o=setTimeout(()=>{this.off(h.ResponseCodes.Err,f),this.off(h.ResponseCodes.Sent,a),this.off(h.PushCodes.StatusResponse,c),s("timeout")},u)},c=A=>{if(!kt.areBuffersEqual(i,A.pubKeyPrefix)){console.log("onStatusResponsePush is not for this status request, ignoring...");return}clearTimeout(o),this.off(h.ResponseCodes.Err,f),this.off(h.ResponseCodes.Sent,a),this.off(h.PushCodes.StatusResponse,c);let u=new ue(A.statusData),d={batt_milli_volts:u.readUInt16LE(),curr_tx_queue_len:u.readUInt16LE(),noise_floor:u.readInt16LE(),last_rssi:u.readInt16LE(),n_packets_recv:u.readUInt32LE(),n_packets_sent:u.readUInt32LE(),total_air_time_secs:u.readUInt32LE(),total_up_time_secs:u.readUInt32LE(),n_sent_flood:u.readUInt32LE(),n_sent_direct:u.readUInt32LE(),n_recv_flood:u.readUInt32LE(),n_recv_direct:u.readUInt32LE(),err_events:u.readUInt16LE(),last_snr:u.readInt16LE(),n_direct_dups:u.readUInt16LE(),n_flood_dups:u.readUInt16LE()};n(d)},f=()=>{clearTimeout(o),this.off(h.ResponseCodes.Err,f),this.off(h.ResponseCodes.Sent,a),this.off(h.PushCodes.StatusResponse,c),s()};this.once(h.ResponseCodes.Err,f),this.once(h.ResponseCodes.Sent,a),this.once(h.PushCodes.StatusResponse,c),await this.sendCommandSendStatusReq(e)}catch(i){s(i)}})}getTelemetry(e,t=1e3){return new Promise(async(n,s)=>{try{let i=e.subarray(0,6);var o=null;let a=A=>{this.off(h.ResponseCodes.Err,f);let u=A.estTimeout+t;o=setTimeout(()=>{this.off(h.ResponseCodes.Err,f),this.off(h.ResponseCodes.Sent,a),this.off(h.PushCodes.TelemetryResponse,c),s("timeout")},u)},c=A=>{if(!kt.areBuffersEqual(i,A.pubKeyPrefix)){console.log("onTelemetryResponsePush is not for this telemetry request, ignoring...");return}clearTimeout(o),this.off(h.ResponseCodes.Err,f),this.off(h.ResponseCodes.Sent,a),this.off(h.PushCodes.TelemetryResponse,c),n(A)},f=()=>{clearTimeout(o),this.off(h.ResponseCodes.Err,f),this.off(h.ResponseCodes.Sent,a),this.off(h.PushCodes.TelemetryResponse,c),s()};this.once(h.ResponseCodes.Err,f),this.once(h.ResponseCodes.Sent,a),this.once(h.PushCodes.TelemetryResponse,c),await this.sendCommandSendTelemetryReq(e)}catch(i){s(i)}})}sendBinaryRequest(e,t,n=1e3){return new Promise(async(s,o)=>{try{var i=null,a=null;let c=u=>{i=u.expectedAckCrc,this.off(h.ResponseCodes.Err,A);let d=u.estTimeout+n;a=setTimeout(()=>{this.off(h.ResponseCodes.Err,A),this.off(h.ResponseCodes.Sent,c),this.off(h.PushCodes.BinaryResponse,f),o("timeout")},d)},f=u=>{if(i!==u.tag){console.log("onBinaryResponse is not for this request tag, ignoring...");return}clearTimeout(a),this.off(h.ResponseCodes.Err,A),this.off(h.ResponseCodes.Sent,c),this.off(h.PushCodes.BinaryResponse,f),s(u.responseData)},A=()=>{clearTimeout(a),this.off(h.ResponseCodes.Err,A),this.off(h.ResponseCodes.Sent,c),this.off(h.PushCodes.BinaryResponse,f),o()};this.once(h.ResponseCodes.Err,A),this.once(h.ResponseCodes.Sent,c),this.once(h.PushCodes.BinaryResponse,f),await this.sendCommandSendBinaryReq(e,t)}catch(c){o(c)}})}pingRepeaterZeroHop(e,t){return new Promise(async(n,s)=>{try{let i=new X;i.writeUInt32LE(Date.now()),i.writeBytes([112,105,110,103]),i.writeBytes(e.subarray(0,2));let a=i.toBytes();var o=Date.now();let c=A=>{let d=Date.now()-o,x=s0.fromBytes(A.raw);x.payload_type===s0.PAYLOAD_TYPE_RAW_CUSTOM&&kt.areBuffersEqual(x.payload,a)&&(this.off(h.ResponseCodes.Err,f),this.off(h.PushCodes.LogRxData,c),n({rtt:d,snr:A.lastSnr,rssi:A.lastRssi}))},f=()=>{this.off(h.ResponseCodes.Err,f),this.off(h.PushCodes.LogRxData,c),s()};this.once(h.ResponseCodes.Err,f),this.on(h.PushCodes.LogRxData,c),t!=null&&setTimeout(()=>{this.off(h.ResponseCodes.Err,f),this.off(h.PushCodes.LogRxData,c),s("timeout")},t),await this.sendCommandSendRawData([e.subarray(0,1)],a)}catch(i){s(i)}})}getChannel(e){return new Promise(async(t,n)=>{try{let s=i=>{this.off(h.ResponseCodes.ChannelInfo,s),this.off(h.ResponseCodes.Err,o),t(i)},o=()=>{this.off(h.ResponseCodes.ChannelInfo,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.ChannelInfo,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandGetChannel(e)}catch(s){n(s)}})}setChannel(e,t,n){return new Promise(async(s,o)=>{try{let i=()=>{this.off(h.ResponseCodes.Ok,i),this.off(h.ResponseCodes.Err,a),s()},a=()=>{this.off(h.ResponseCodes.Ok,i),this.off(h.ResponseCodes.Err,a),o()};this.once(h.ResponseCodes.Ok,i),this.once(h.ResponseCodes.Err,a),await this.sendCommandSetChannel(e,t,n)}catch(i){o(i)}})}async deleteChannel(e){return await this.setChannel(e,"",new Uint8Array(16))}getChannels(){return new Promise(async(e,t)=>{var n=0;let s=[];for(;;){try{let o=await this.getChannel(n);s.push(o)}catch{break}n++}return e(s)})}async findChannelByName(e){return(await this.getChannels()).find(n=>n.name===e)}async findChannelBySecret(e){return(await this.getChannels()).find(n=>kt.areBuffersEqual(e,n.secret))}async sign(e){return new Promise(async(t,n)=>{try{let o=new ue(e),i=async()=>{var u;o.getRemainingBytesCount()>=128?u=o.readBytes(128):u=o.readRemainingBytes(),await this.sendCommandSignData(u)},a=async u=>{if(o.getRemainingBytesCount()>0){await i();return}await this.sendCommandSignFinish()},c=async u=>{if(this.off(h.ResponseCodes.SignStart,c),o.getRemainingBytesCount()>u.maxSignDataLen){this.off(h.ResponseCodes.ok,a),this.off(h.ResponseCodes.err,A),this.off(h.ResponseCodes.SignStart,c),this.off(h.ResponseCodes.Signature,f),n("data_too_long");return}await i()},f=u=>{this.off(h.ResponseCodes.ok,a),this.off(h.ResponseCodes.err,A),this.off(h.ResponseCodes.SignStart,c),this.off(h.ResponseCodes.Signature,f),t(u.signature)},A=u=>{this.off(h.ResponseCodes.ok,a),this.off(h.ResponseCodes.err,A),this.off(h.ResponseCodes.SignStart,c),this.off(h.ResponseCodes.Signature,f),n(u)};this.on(h.ResponseCodes.Ok,a),this.on(h.ResponseCodes.SignStart,c),this.on(h.ResponseCodes.Signature,f),this.once(h.ResponseCodes.Err,A),await this.sendCommandSignStart()}catch(s){n(s)}})}tracePath(e,t=0){return new Promise(async(n,s)=>{try{let i=zo.getRandomInt(0,4294967295);var o=null;let a=A=>{this.off(h.ResponseCodes.Err,f);let u=A.estTimeout+t;o=setTimeout(()=>{this.off(h.ResponseCodes.Sent,a),this.off(h.PushCodes.TraceData,c),this.off(h.ResponseCodes.Err,f),s("timeout")},u)},c=A=>{if(A.tag!==i){console.log("ignoring trace data for a different trace request");return}clearTimeout(o),this.off(h.ResponseCodes.Sent,a),this.off(h.PushCodes.TraceData,c),this.off(h.ResponseCodes.Err,f),n(A)},f=()=>{clearTimeout(o),this.off(h.ResponseCodes.Sent,a),this.off(h.PushCodes.TraceData,c),this.off(h.ResponseCodes.Err,f),s()};this.once(h.ResponseCodes.Sent,a),this.on(h.PushCodes.TraceData,c),this.once(h.ResponseCodes.Err,f),await this.sendCommandSendTracePath(i,0,e)}catch(i){s(i)}})}setOtherParams(e){return new Promise(async(t,n)=>{try{let s=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),t()},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandSetOtherParams(e)}catch(s){n(s)}})}async setAutoAddContacts(){return await this.setOtherParams(!1)}async setManualAddContacts(){return await this.setOtherParams(!0)}async getNeighbours(e,t=10,n=0,s=0,o=8){let i=new X;i.writeByte(h.BinaryRequestTypes.GetNeighbours),i.writeByte(0),i.writeByte(t),i.writeUInt16LE(n),i.writeByte(s),i.writeByte(o),i.writeUInt32LE(zo.getRandomInt(0,4294967295));let a=await this.sendBinaryRequest(e,i.toBytes()),c=new ue(a),f=c.readUInt16LE(),A=c.readUInt16LE(),u=[];for(var d=0;d<A;d++){let x=c.readBytes(o),p=c.readUInt32LE(),m=c.readInt8()/4;u.push({publicKeyPrefix:x,heardSecondsAgo:p,snr:m})}return{totalNeighboursCount:f,neighbours:u}}},nn=Xo;var jo=class r extends nn{constructor(){if(super(),this.readBuffer=[],this.constructor===r)throw new Error("SerialConnection is an abstract class and can't be instantiated.")}async write(e){throw new Error("Not Implemented: write must be implemented by SerialConnection sub class.")}async writeFrame(e,t){let n=new X;n.writeByte(e),n.writeUInt16LE(t.length),n.writeBytes(t),await this.write(n.toBytes())}async sendToRadioFrame(e){this.emit("tx",e),await this.writeFrame(60,e)}async onDataReceived(e){this.readBuffer=[...this.readBuffer,...e];let t=3;for(;this.readBuffer.length>=t;)try{let n=new ue(this.readBuffer.slice(0,t)),s=n.readByte();if(s!==h.SerialFrameTypes.Incoming&&s!==h.SerialFrameTypes.Outgoing){this.readBuffer=this.readBuffer.slice(1);continue}let o=n.readUInt16LE();if(!o){this.readBuffer=this.readBuffer.slice(1);continue}let i=t+o;if(this.readBuffer.length<i)break;let a=this.readBuffer.slice(t,i);this.readBuffer=this.readBuffer.slice(i),this.onFrameReceived(a)}catch(n){console.error("Failed to process frame",n);break}}},o0=jo;var Jo=class r extends o0{constructor(e){super(),this.serialPort=e,this.reader=e.readable.getReader(),this.writable=e.writable,this.readLoop(),this.serialPort.addEventListener("disconnect",()=>{this.onDisconnected()}),setTimeout(async()=>{await this.onConnected()},0)}static async open(){if(!navigator.serial)return alert("Web Serial is not supported in this browser"),null;let e=await navigator.serial.requestPort({filters:[]});return await e.open({baudRate:115200}),new r(e)}async close(){try{this.reader.releaseLock()}catch{}try{await this.serialPort.close()}catch{}}async write(e){let t=this.writable.getWriter();try{await t.write(new Uint8Array(e))}finally{t.releaseLock()}}async readLoop(){try{for(;;){let{value:e,done:t}=await this.reader.read();if(t)break;await this.onDataReceived(e)}}catch(e){if(e instanceof TypeError)return;console.error("Error reading from serial port: ",e)}finally{this.reader.releaseLock()}}},$o=Jo;var GA=cr(TA(),1);var c0=cr(Ao(),1);var ni=cr(fr(),1),LA=cr(PA(),1),sr=cr(IA(),1),HA="abcdefghijklmnopqrstuvwxyz0123456789",nr=HA.length,OA=HA+"-",Be="[[public room]]",_e="8b3387e9c5cdea6ac9e5edbaa115cd72",sn=30*24*60*60;function on(r){if(!r||r.length===0)return null;let e=r.length,t=0,n=1;for(let s=0;s<e;s++){let o=r[s],i=OA.indexOf(o);if(i===-1)return null;let a=s===0,c=s===e-1,f=a||c?36:37;if((a||c)&&i===36)return null;t+=i*n,n*=f}return{length:e,index:t}}function Oe(r,e){if(r<=0)return null;let t="",n=e,s=!1;for(let o=0;o<r;o++){let i=o===0,a=o===r-1,c=i||a?36:37,f=n%c;n=Math.floor(n/c);let A=f===36;if(A&&s)return null;s=A,t+=OA[f]}return t}function Ye(r){return r===Be?_e:(0,ni.default)(r).toString(sr.default).substring(0,32)}function Ze(r){return(0,ni.default)(sr.default.parse(r)).toString(sr.default).substring(0,2)}function Mt(r,e,t){let n=t.padEnd(64,"0");return(0,LA.default)(sr.default.parse(r),sr.default.parse(n)).toString(sr.default).substring(0,4).toLowerCase()===e.toLowerCase()}function nt(r){if(r===1)return nr;if(r===2)return nr*nr;let e=nr,t=1;for(let s=2;s<=r-2;s++){let o=(e+t)*nr,i=e;e=o,t=i}let n=r>2?e+t:1;return nr*n*nr}function an(r,e=sn,t){let n=t??Math.floor(Date.now()/1e3);return r<=n&&r>=n-e}function cn(r){return!r.includes("\uFFFD")}var An=class r{constructor(){this.device=null,this.pipeline=null,this.bindGroupLayout=null,this.paramsBuffer=null,this.matchCountBuffer=null,this.matchIndicesBuffer=null,this.ciphertextBuffer=null,this.ciphertextBufferSize=0,this.matchCountReadBuffers=[null,null],this.matchIndicesReadBuffers=[null,null],this.currentReadBufferIndex=0,this.bindGroup=null,this.bindGroupDirty=!0,this.shaderCode=`
// SHA256 round constants
const K: array<u32, 64> = array<u32, 64>(
  0x428a2f98u, 0x71374491u, 0xb5c0fbcfu, 0xe9b5dba5u, 0x3956c25bu, 0x59f111f1u, 0x923f82a4u, 0xab1c5ed5u,
  0xd807aa98u, 0x12835b01u, 0x243185beu, 0x550c7dc3u, 0x72be5d74u, 0x80deb1feu, 0x9bdc06a7u, 0xc19bf174u,
  0xe49b69c1u, 0xefbe4786u, 0x0fc19dc6u, 0x240ca1ccu, 0x2de92c6fu, 0x4a7484aau, 0x5cb0a9dcu, 0x76f988dau,
  0x983e5152u, 0xa831c66du, 0xb00327c8u, 0xbf597fc7u, 0xc6e00bf3u, 0xd5a79147u, 0x06ca6351u, 0x14292967u,
  0x27b70a85u, 0x2e1b2138u, 0x4d2c6dfcu, 0x53380d13u, 0x650a7354u, 0x766a0abbu, 0x81c2c92eu, 0x92722c85u,
  0xa2bfe8a1u, 0xa81a664bu, 0xc24b8b70u, 0xc76c51a3u, 0xd192e819u, 0xd6990624u, 0xf40e3585u, 0x106aa070u,
  0x19a4c116u, 0x1e376c08u, 0x2748774cu, 0x34b0bcb5u, 0x391c0cb3u, 0x4ed8aa4au, 0x5b9cca4fu, 0x682e6ff3u,
  0x748f82eeu, 0x78a5636fu, 0x84c87814u, 0x8cc70208u, 0x90befffau, 0xa4506cebu, 0xbef9a3f7u, 0xc67178f2u
);

// Character lookup table (a-z = 0-25, 0-9 = 26-35, dash = 36)
const CHARS: array<u32, 37> = array<u32, 37>(
  0x61u, 0x62u, 0x63u, 0x64u, 0x65u, 0x66u, 0x67u, 0x68u, 0x69u, 0x6au, // a-j
  0x6bu, 0x6cu, 0x6du, 0x6eu, 0x6fu, 0x70u, 0x71u, 0x72u, 0x73u, 0x74u, // k-t
  0x75u, 0x76u, 0x77u, 0x78u, 0x79u, 0x7au,                             // u-z
  0x30u, 0x31u, 0x32u, 0x33u, 0x34u, 0x35u, 0x36u, 0x37u, 0x38u, 0x39u, // 0-9
  0x2du                                                                  // dash
);

struct Params {
  target_channel_hash: u32,
  batch_offset: u32,
  name_length: u32,
  batch_size: u32,
  target_mac: u32,           // First 2 bytes of target MAC (in high 16 bits)
  ciphertext_words: u32,     // Number of 32-bit words in ciphertext
  ciphertext_len_bits: u32,  // Length of ciphertext in bits
  verify_mac: u32,           // 1 to verify MAC, 0 to skip
}

@group(0) @binding(0) var<uniform> params: Params;
@group(0) @binding(1) var<storage, read_write> match_count: atomic<u32>;
@group(0) @binding(2) var<storage, read_write> match_indices: array<u32>;
@group(0) @binding(3) var<storage, read> ciphertext: array<u32>; // Ciphertext data

fn rotr(x: u32, n: u32) -> u32 {
  return (x >> n) | (x << (32u - n));
}

fn ch(x: u32, y: u32, z: u32) -> u32 {
  return (x & y) ^ (~x & z);
}

fn maj(x: u32, y: u32, z: u32) -> u32 {
  return (x & y) ^ (x & z) ^ (y & z);
}

fn sigma0(x: u32) -> u32 {
  return rotr(x, 2u) ^ rotr(x, 13u) ^ rotr(x, 22u);
}

fn sigma1(x: u32) -> u32 {
  return rotr(x, 6u) ^ rotr(x, 11u) ^ rotr(x, 25u);
}

fn gamma0(x: u32) -> u32 {
  return rotr(x, 7u) ^ rotr(x, 18u) ^ (x >> 3u);
}

fn gamma1(x: u32) -> u32 {
  return rotr(x, 17u) ^ rotr(x, 19u) ^ (x >> 10u);
}

// Convert index to room name bytes, returns the hash as a u32 for the first byte check
fn index_to_room_name(idx: u32, length: u32, msg: ptr<function, array<u32, 16>>) -> bool {
  // Message starts with '#' (0x23)
  var byte_pos = 0u;
  var word_idx = 0u;
  var current_word = 0x23000000u; // '#' in big-endian position 0
  byte_pos = 1u;

  var remaining = idx;
  var prev_was_dash = false;

  // Generate room name from index
  for (var i = 0u; i < length; i++) {
    let char_count = select(37u, 36u, i == 0u || i == length - 1u); // no dash at start/end
    var char_idx = remaining % char_count;
    remaining = remaining / char_count;

    // Check for consecutive dashes (invalid)
    let is_dash = char_idx == 36u && i > 0u && i < length - 1u;
    if (is_dash && prev_was_dash) {
      return false; // Invalid: consecutive dashes
    }
    prev_was_dash = is_dash;

    // Map char index to actual character
    let c = CHARS[char_idx];

    // Pack byte into current word (big-endian)
    let shift = (3u - byte_pos % 4u) * 8u;
    if (byte_pos % 4u == 0u && byte_pos > 0u) {
      (*msg)[word_idx] = current_word;
      word_idx = word_idx + 1u;
      current_word = 0u;
    }
    current_word = current_word | (c << shift);
    byte_pos = byte_pos + 1u;
  }

  // Add padding: 0x80 followed by zeros, then length in bits
  let msg_len_bits = (length + 1u) * 8u; // +1 for '#'

  // Add 0x80 padding byte
  let shift = (3u - byte_pos % 4u) * 8u;
  if (byte_pos % 4u == 0u) {
    (*msg)[word_idx] = current_word;
    word_idx = word_idx + 1u;
    current_word = 0x80000000u;
  } else {
    current_word = current_word | (0x80u << shift);
  }
  byte_pos = byte_pos + 1u;

  // Store current word
  if (byte_pos % 4u == 0u || word_idx < 14u) {
    (*msg)[word_idx] = current_word;
    word_idx = word_idx + 1u;
  }

  // Zero-fill until word 14
  for (var i = word_idx; i < 14u; i++) {
    (*msg)[i] = 0u;
  }

  // Length in bits (64-bit, but we only use lower 32 bits for short messages)
  (*msg)[14u] = 0u;
  (*msg)[15u] = msg_len_bits;

  return true;
}

fn sha256_block(msg: ptr<function, array<u32, 16>>) -> array<u32, 8> {
  // Initialize hash values
  var h: array<u32, 8> = array<u32, 8>(
    0x6a09e667u, 0xbb67ae85u, 0x3c6ef372u, 0xa54ff53au,
    0x510e527fu, 0x9b05688cu, 0x1f83d9abu, 0x5be0cd19u
  );

  // Message schedule
  var w: array<u32, 64>;
  for (var i = 0u; i < 16u; i++) {
    w[i] = (*msg)[i];
  }
  for (var i = 16u; i < 64u; i++) {
    w[i] = gamma1(w[i-2u]) + w[i-7u] + gamma0(w[i-15u]) + w[i-16u];
  }

  // Compression
  var a = h[0]; var b = h[1]; var c = h[2]; var d = h[3];
  var e = h[4]; var f = h[5]; var g = h[6]; var hh = h[7];

  for (var i = 0u; i < 64u; i++) {
    let t1 = hh + sigma1(e) + ch(e, f, g) + K[i] + w[i];
    let t2 = sigma0(a) + maj(a, b, c);
    hh = g; g = f; f = e; e = d + t1;
    d = c; c = b; b = a; a = t1 + t2;
  }

  h[0] = h[0] + a; h[1] = h[1] + b; h[2] = h[2] + c; h[3] = h[3] + d;
  h[4] = h[4] + e; h[5] = h[5] + f; h[6] = h[6] + g; h[7] = h[7] + hh;

  return h;
}

// Compute SHA256 of the key (16 bytes) to get channel hash
fn sha256_key(key: array<u32, 4>) -> u32 {
  var msg: array<u32, 16>;

  // Key bytes (16 bytes = 4 words)
  msg[0] = key[0];
  msg[1] = key[1];
  msg[2] = key[2];
  msg[3] = key[3];

  // Padding: 0x80 followed by zeros
  msg[4] = 0x80000000u;
  for (var i = 5u; i < 14u; i++) {
    msg[i] = 0u;
  }

  // Length: 128 bits
  msg[14] = 0u;
  msg[15] = 128u;

  let hash = sha256_block(&msg);

  // Return first byte of hash (big-endian)
  return hash[0] >> 24u;
}

// HMAC-SHA256 for MAC verification
// Key is 16 bytes (4 words), padded to 32 bytes with zeros for MeshCore
// Returns first 2 bytes of HMAC (as u32 in high 16 bits)
fn hmac_sha256_mac(key: array<u32, 4>, ciphertext_len: u32) -> u32 {
  // HMAC: H((K' ^ opad) || H((K' ^ ipad) || message))
  // K' is 64 bytes (32 bytes key + 32 bytes zero padding for MeshCore, then padded to 64)
  // ipad = 0x36 repeated, opad = 0x5c repeated

  // Build padded key (64 bytes = 16 words)
  // MeshCore uses 32-byte secret: 16-byte key + 16 zero bytes
  var k_pad: array<u32, 16>;
  k_pad[0] = key[0];
  k_pad[1] = key[1];
  k_pad[2] = key[2];
  k_pad[3] = key[3];
  for (var i = 4u; i < 16u; i++) {
    k_pad[i] = 0u;
  }

  // Inner hash: SHA256((K' ^ ipad) || message)
  // First block: K' ^ ipad (64 bytes)
  var inner_block: array<u32, 16>;
  for (var i = 0u; i < 16u; i++) {
    inner_block[i] = k_pad[i] ^ 0x36363636u;
  }

  // Initialize hash state with first block
  var h: array<u32, 8> = sha256_block(&inner_block);

  // Process ciphertext blocks (continuing from h state)
  let ciphertext_words = params.ciphertext_words;
  var word_idx = 0u;

  // Process full 64-byte blocks of ciphertext
  while (word_idx + 16u <= ciphertext_words) {
    var block: array<u32, 16>;
    for (var i = 0u; i < 16u; i++) {
      block[i] = ciphertext[word_idx + i];
    }
    h = sha256_block_continue(&block, h);
    word_idx = word_idx + 16u;
  }

  // Final block with remaining ciphertext + padding
  var final_block: array<u32, 16>;
  var remaining = ciphertext_words - word_idx;
  for (var i = 0u; i < 16u; i++) {
    if (i < remaining) {
      final_block[i] = ciphertext[word_idx + i];
    } else if (i == remaining) {
      // Add 0x80 padding
      final_block[i] = 0x80000000u;
    } else {
      final_block[i] = 0u;
    }
  }

  // Add length (64 bytes of ipad + ciphertext length)
  let total_bits = 512u + params.ciphertext_len_bits;
  if (remaining < 14u) {
    final_block[14] = 0u;
    final_block[15] = total_bits;
    h = sha256_block_continue(&final_block, h);
  } else {
    // Need extra block for length
    h = sha256_block_continue(&final_block, h);
    var len_block: array<u32, 16>;
    for (var i = 0u; i < 14u; i++) {
      len_block[i] = 0u;
    }
    len_block[14] = 0u;
    len_block[15] = total_bits;
    h = sha256_block_continue(&len_block, h);
  }

  let inner_hash = h;

  // Outer hash: SHA256((K' ^ opad) || inner_hash)
  var outer_block: array<u32, 16>;
  for (var i = 0u; i < 16u; i++) {
    outer_block[i] = k_pad[i] ^ 0x5c5c5c5cu;
  }
  h = sha256_block(&outer_block);

  // Second block: inner_hash (32 bytes) + padding
  var hash_block: array<u32, 16>;
  for (var i = 0u; i < 8u; i++) {
    hash_block[i] = inner_hash[i];
  }
  hash_block[8] = 0x80000000u;
  for (var i = 9u; i < 14u; i++) {
    hash_block[i] = 0u;
  }
  hash_block[14] = 0u;
  hash_block[15] = 512u + 256u; // 64 bytes opad + 32 bytes inner hash

  h = sha256_block_continue(&hash_block, h);

  // Return first 2 bytes (high 16 bits of first word)
  return h[0] & 0xFFFF0000u;
}

// SHA256 block computation continuing from existing state
fn sha256_block_continue(msg: ptr<function, array<u32, 16>>, h_in: array<u32, 8>) -> array<u32, 8> {
  var h = h_in;

  // Message schedule
  var w: array<u32, 64>;
  for (var i = 0u; i < 16u; i++) {
    w[i] = (*msg)[i];
  }
  for (var i = 16u; i < 64u; i++) {
    w[i] = gamma1(w[i-2u]) + w[i-7u] + gamma0(w[i-15u]) + w[i-16u];
  }

  // Compression
  var a = h[0]; var b = h[1]; var c = h[2]; var d = h[3];
  var e = h[4]; var f = h[5]; var g = h[6]; var hh = h[7];

  for (var i = 0u; i < 64u; i++) {
    let t1 = hh + sigma1(e) + ch(e, f, g) + K[i] + w[i];
    let t2 = sigma0(a) + maj(a, b, c);
    hh = g; g = f; f = e; e = d + t1;
    d = c; c = b; b = a; a = t1 + t2;
  }

  h[0] = h[0] + a; h[1] = h[1] + b; h[2] = h[2] + c; h[3] = h[3] + d;
  h[4] = h[4] + e; h[5] = h[5] + f; h[6] = h[6] + g; h[7] = h[7] + hh;

  return h;
}

// Process a single candidate and record match if found
fn process_candidate(name_idx: u32) {
  // Generate message for this room name
  var msg: array<u32, 16>;
  let valid = index_to_room_name(name_idx, params.name_length, &msg);

  if (!valid) {
    return;
  }

  // Compute SHA256("#roomname") - this gives us the key
  let key_hash = sha256_block(&msg);

  // Take first 16 bytes (4 words) as the key
  var key: array<u32, 4>;
  key[0] = key_hash[0];
  key[1] = key_hash[1];
  key[2] = key_hash[2];
  key[3] = key_hash[3];

  // Compute SHA256(key) to get channel hash
  let channel_hash = sha256_key(key);

  // Check if channel hash matches target
  if (channel_hash != params.target_channel_hash) {
    return;
  }

  // Channel hash matches - verify MAC if enabled
  if (params.verify_mac == 1u) {
    let computed_mac = hmac_sha256_mac(key, params.ciphertext_len_bits);
    if (computed_mac != params.target_mac) {
      return;
    }
  }

  // Found a match - record the index
  let match_idx = atomicAdd(&match_count, 1u);
  if (match_idx < 1024u) { // Limit stored matches
    match_indices[match_idx] = name_idx;
  }
}

// Each thread processes 16 candidates to amortize thread overhead
const CANDIDATES_PER_THREAD: u32 = 16u;

@compute @workgroup_size(256)
fn main(@builtin(global_invocation_id) global_id: vec3<u32>) {
  let base_idx = global_id.x * CANDIDATES_PER_THREAD;

  for (var i = 0u; i < CANDIDATES_PER_THREAD; i++) {
    let idx = base_idx + i;
    if (idx >= params.batch_size) {
      return;
    }
    let name_idx = params.batch_offset + idx;
    process_candidate(name_idx);
  }
}
`}async init(){if(!navigator.gpu)return console.warn("WebGPU not supported"),!1;try{let e=await navigator.gpu.requestAdapter();if(!e)return console.warn("No GPU adapter found"),!1;this.device=await e.requestDevice(),this.bindGroupLayout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}},{binding:2,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}},{binding:3,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}}]}),this.paramsBuffer=this.device.createBuffer({size:32,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.matchCountBuffer=this.device.createBuffer({size:4,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST}),this.matchIndicesBuffer=this.device.createBuffer({size:1024*4,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC});for(let s=0;s<2;s++)this.matchCountReadBuffers[s]=this.device.createBuffer({size:4,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.matchIndicesReadBuffers[s]=this.device.createBuffer({size:1024*4,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST});let t=this.device.createShaderModule({code:this.shaderCode}),n=this.device.createPipelineLayout({bindGroupLayouts:[this.bindGroupLayout]});return this.pipeline=this.device.createComputePipeline({layout:n,compute:{module:t,entryPoint:"main"}}),!0}catch(e){return console.error("WebGPU initialization failed:",e),!1}}isAvailable(){return this.device!==null&&this.pipeline!==null}indexToRoomName(e,t){return Oe(t,e)}countNamesForLength(e){return nt(e)}async runBatch(e,t,n,s,o,i){if(!this.device||!this.pipeline||!this.bindGroupLayout||!this.paramsBuffer||!this.matchCountBuffer||!this.matchIndicesBuffer||!this.matchCountReadBuffers[0]||!this.matchCountReadBuffers[1]||!this.matchIndicesReadBuffers[0]||!this.matchIndicesReadBuffers[1])throw new Error("GPU not initialized");let a=this.currentReadBufferIndex;this.currentReadBufferIndex=1-this.currentReadBufferIndex;let c=this.matchCountReadBuffers[a],f=this.matchIndicesReadBuffers[a],A=o&&i?1:0,u,d=0,x=0;if(A){let E=new Uint8Array(o.length/2);for(let _=0;_<E.length;_++)E[_]=parseInt(o.substr(_*2,2),16);d=E.length*8;let C=Math.ceil(E.length/4)*4,R=new Uint8Array(C);R.set(E),u=new Uint32Array(C/4);for(let _=0;_<u.length;_++)u[_]=R[_*4]<<24|R[_*4+1]<<16|R[_*4+2]<<8|R[_*4+3];let S=parseInt(i.substr(0,2),16),b=parseInt(i.substr(2,2),16);x=S<<24|b<<16}else u=new Uint32Array([0]);let p=Math.max(u.length*4,4);(!this.ciphertextBuffer||this.ciphertextBufferSize<p)&&(this.ciphertextBuffer&&this.ciphertextBuffer.destroy(),this.ciphertextBuffer=this.device.createBuffer({size:p,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),this.ciphertextBufferSize=p,this.bindGroupDirty=!0);let m=new Uint32Array([e,n,t,s,x,u.length,d,A]);this.device.queue.writeBuffer(this.paramsBuffer,0,m),this.device.queue.writeBuffer(this.ciphertextBuffer,0,u),this.device.queue.writeBuffer(this.matchCountBuffer,0,r.ZERO_DATA),(this.bindGroupDirty||!this.bindGroup)&&(this.bindGroup=this.device.createBindGroup({layout:this.bindGroupLayout,entries:[{binding:0,resource:{buffer:this.paramsBuffer}},{binding:1,resource:{buffer:this.matchCountBuffer}},{binding:2,resource:{buffer:this.matchIndicesBuffer}},{binding:3,resource:{buffer:this.ciphertextBuffer}}]}),this.bindGroupDirty=!1);let g=this.device.createCommandEncoder(),l=g.beginComputePass();l.setPipeline(this.pipeline),l.setBindGroup(0,this.bindGroup),l.dispatchWorkgroups(Math.ceil(s/(256*16))),l.end(),g.copyBufferToBuffer(this.matchCountBuffer,0,c,0,4),g.copyBufferToBuffer(this.matchIndicesBuffer,0,f,0,1024*4),this.device.queue.submit([g.finish()]),await c.mapAsync(GPUMapMode.READ);let B=new Uint32Array(c.getMappedRange())[0];c.unmap();let v=[];if(B>0){await f.mapAsync(GPUMapMode.READ);let E=new Uint32Array(f.getMappedRange());for(let C=0;C<Math.min(B,1024);C++)v.push(E[C]);f.unmap()}return v}destroy(){this.paramsBuffer?.destroy(),this.matchCountBuffer?.destroy(),this.matchIndicesBuffer?.destroy(),this.ciphertextBuffer?.destroy(),this.matchCountReadBuffers[0]?.destroy(),this.matchCountReadBuffers[1]?.destroy(),this.matchIndicesReadBuffers[0]?.destroy(),this.matchIndicesReadBuffers[1]?.destroy(),this.paramsBuffer=null,this.matchCountBuffer=null,this.matchIndicesBuffer=null,this.ciphertextBuffer=null,this.ciphertextBufferSize=0,this.matchCountReadBuffers=[null,null],this.matchIndicesReadBuffers=[null,null],this.currentReadBufferIndex=0,this.bindGroup=null,this.bindGroupDirty=!0,this.device&&(this.device.destroy(),this.device=null),this.pipeline=null,this.bindGroupLayout=null}};An.ZERO_DATA=new Uint32Array([0]);function si(){return typeof navigator<"u"&&"gpu"in navigator}var dn=class{runBatch(e,t,n,s,o,i){let a=[],c=e.toString(16).padStart(2,"0"),f=!!(o&&i);for(let A=0;A<s;A++){let u=n+A,d=Oe(t,u);if(!d)continue;let x=Ye("#"+d);Ze(x)===c&&(f&&!Mt(o,i,x)||a.push(u))}return a}destroy(){}};var Bu=/^[a-z0-9-]+$/,Cu=/^[a-z0-9].*[a-z0-9]$|^[a-z0-9]$/,vu=/--/;function MA(r){return!(!r||r.length===0||!Bu.test(r)||r.length>1&&!Cu.test(r)||vu.test(r))}var fn=class{constructor(){this.gpuInstance=null,this.cpuInstance=null,this.wordlist=[],this.abortFlag=!1,this.useTimestampFilter=!0,this.useUtf8Filter=!0,this.validSeconds=sn,this.useCpu=!1}async loadWordlist(e){let t=await fetch(e);if(!t.ok)throw new Error(`Failed to load wordlist: ${t.status} ${t.statusText}`);let s=(await t.text()).split(`
`).map(o=>o.trim().toLowerCase()).filter(o=>o.length>0);this.wordlist=s.filter(MA)}setWordlist(e){this.wordlist=e.map(t=>t.trim().toLowerCase()).filter(MA)}abort(){this.abortFlag=!0}isGpuAvailable(){return si()}async decodePacket(e){let t=e.trim().replace(/\s+/g,"").replace(/^0x/i,"");if(!t||!/^[0-9a-fA-F]+$/.test(t))return null;try{let s=(await c0.MeshCorePacketDecoder.decodeWithVerification(t,{})).payload?.decoded;return!s?.channelHash||!s?.ciphertext||!s?.cipherMac?null:{channelHash:s.channelHash,ciphertext:s.ciphertext,cipherMac:s.cipherMac,isGroupText:!0}}catch{return null}}async crack(e,t,n){this.abortFlag=!1,this.useTimestampFilter=t?.useTimestampFilter??!0,this.useUtf8Filter=t?.useUtf8Filter??!0,this.validSeconds=t?.validSeconds??sn,this.useCpu=t?.forceCpu??!1;let s=t?.maxLength??8,o=t?.startingLength??1,i=t?.useDictionary??!0,a=await this.decodePacket(e);if(!a)return{found:!1,error:"Invalid packet or not a GroupText packet"};let{channelHash:c,ciphertext:f,cipherMac:A}=a,u=parseInt(c,16);this.useCpu?this.cpuInstance||(this.cpuInstance=new dn):this.gpuInstance||(this.gpuInstance=new An,await this.gpuInstance.init()||(this.useCpu=!0,this.cpuInstance=new dn));let d=performance.now(),x=0,p=performance.now(),m=o,g=0;if(t?.startFrom){let b=on(t.startFrom);b&&(m=Math.max(o,b.length),g=b.index+1,g>=nt(m)&&(m++,g=0))}let l=0;for(let b=m;b<=s;b++)l+=nt(b);l-=g;let y=(b,_,w)=>{if(!n)return;let F=(performance.now()-d)/1e3,D=F>0?Math.round(x/F):0,M=l-x,U=D>0?M/D:0;n({checked:x,total:l,percent:l>0?Math.min(100,x/l*100):0,rateKeysPerSec:D,etaSeconds:U,elapsedSeconds:F,currentLength:_,currentPosition:w,phase:b})},B=b=>{if(!Mt(f,A,b))return{valid:!1};let _=c0.ChannelCrypto.decryptGroupTextMessage(f,A,b);return!_.success||!_.data?{valid:!1}:this.useTimestampFilter&&!an(_.data.timestamp,this.validSeconds)?{valid:!1}:this.useUtf8Filter&&!cn(_.data.message)?{valid:!1}:{valid:!0,message:_.data.message}};if(m===1&&g===0){y("public-key",0,Be);let b=Ze(_e);if(c===b){let _=B(_e);if(_.valid)return{found:!0,roomName:Be,key:_e,decryptedMessage:_.message}}}if(i&&this.wordlist.length>0&&m===1&&g===0)for(let b=0;b<this.wordlist.length;b++){if(this.abortFlag)return{found:!1,aborted:!0,resumeFrom:this.wordlist[b]};let _=this.wordlist[b],w=Ye("#"+_),P=Ze(w);if(parseInt(P,16)===u){let D=B(w);if(D.valid)return{found:!0,roomName:_,key:w,decryptedMessage:D.message}}let F=performance.now();F-p>=200&&(y("wordlist",_.length,_),p=F,await new Promise(D=>setTimeout(D,0)))}let v=this.useCpu?1024:32768,E=1e3,C=v,R=!1;for(let b=m;b<=s;b++){if(this.abortFlag)return{found:!1,aborted:!0,resumeFrom:Oe(b,0)||void 0};let _=nt(b),w=b===m?g:0;for(;w<_;){if(this.abortFlag)return{found:!1,aborted:!0,resumeFrom:Oe(b,w)||void 0};let P=Math.min(C,_-w),F=performance.now(),D;this.useCpu?D=this.cpuInstance.runBatch(u,b,w,P,f,A):D=await this.gpuInstance.runBatch(u,b,w,P,f,A);let M=performance.now()-F;if(x+=P,!this.useCpu&&!R&&P>=v&&M>0){let V=E/M,G=Math.round(P*V),T=Math.pow(2,Math.round(Math.log2(Math.max(v,G))));C=Math.max(v,T),R=!0}for(let V of D){let G=Oe(b,V);if(!G)continue;let T=Ye("#"+G),I=B(T);if(I.valid)return{found:!0,roomName:G,key:T,decryptedMessage:I.message}}w+=P;let U=performance.now();if(U-p>=200){let V=Oe(b,Math.min(w,_-1))||"";y("bruteforce",b,V),p=U,await new Promise(G=>setTimeout(G,0))}}}return{found:!1,resumeFrom:Oe(s,nt(s)-1)||void 0}}destroy(){this.gpuInstance&&(this.gpuInstance.destroy(),this.gpuInstance=null),this.cpuInstance&&(this.cpuInstance.destroy(),this.cpuInstance=null)}};function gt(r){return String(r).replace(/[&<>"']/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[e]||e)}var Bt=[],Ct=new Map,UA=new Set,KA="meshcore-known-room-keys";function Eu(){try{let r=localStorage.getItem(KA);if(r){let e=JSON.parse(r);for(let[t,n]of e)Ct.set(t,n)}}catch{}}function QA(){try{let r=Array.from(Ct.entries());localStorage.setItem(KA,JSON.stringify(r))}catch{}}function hi(r,e,t){Ct.set(r,{roomName:e,key:t}),QA(),p0()}function YA(r){Ct.delete(r),QA(),p0()}var bu=1,oi=!1,f0=null,mn=0,pn=0,ln=0,Ir=0,ci=0,ii=null,ai=!1,Me=null,d0=null,u0=null,l0=!0,h0=!0,hn=!1,un=null,Ai=new Map;function qA(r){Ai.clear();let e=r.split(",").map(t=>t.trim()).filter(t=>t.length>0);for(let t of e){let n,s;if(t==="[[public room]]"||t===Be)n=_e,s=Be;else{let i=t.startsWith("#")?t:"#"+t;n=Ye(i),s=t.startsWith("#")?t:"#"+t}let o=Ze(n);Ai.set(o,s)}}function wu(r,e,t){let n=Ai.get(r);if(!n)return!1;let s;return n===Be?s=_e:s=Ye(n),Mt(e,t,s)}var gn,ZA,di,WA,zA,x0,XA,fi,jA,JA,A0,Pr,yn,xn,ui,li;function _u(r){return!l0||an(r)}function Du(r){return!h0||cn(r)}function VA(r,e,t){if(!Mt(r,e,t))return{valid:!1};let n=qt.ChannelCrypto.decryptGroupTextMessage(r,e,t);return!n.success||!n.data?{valid:!1}:_u(n.data.timestamp)?Du(n.data.message)?{valid:!0,sender:n.data.sender,message:n.data.message}:{valid:!1}:{valid:!1}}function Su(r){if(r<60)return`${Math.round(r)}s`;if(r<3600){let n=Math.floor(r/60),s=Math.round(r%60);return`${n}m ${s}s`}let e=Math.floor(r/3600),t=Math.round(r%3600/60);return`${e}h ${t}m`}function Ru(r){return r>=1e9?`${(r/1e9).toFixed(2)} Gkeys/s`:r>=1e6?`${(r/1e6).toFixed(2)} Mkeys/s`:r>=1e3?`${(r/1e3).toFixed(1)} kkeys/s`:`${r} keys/s`}function p0(){if(Ct.size===0){fi.style.display="none";return}fi.style.display="block",jA.innerHTML=Array.from(Ct.values()).map(r=>`<div class="known-key-item"><span class="known-room-name">${r.roomName===Be?r.roomName:`#${gt(r.roomName)}`}</span> <span class="known-room-key">${r.key}</span></div>`).join("")}function Tu(r){if(!r||typeof r!="string"){console.error('Usage: addRoomName("roomname") - provide room name without leading #');return}let e,t;r==="[[public room]]"||r===Be?(e=Be,t=_e):(e=r.startsWith("#")?r.slice(1):r,t=Ye("#"+e));let n=Ze(t);if(Ct.get(n)){console.log(`Room #${e} already exists with key ${t}`);return}hi(n,e,t),console.log(`Added room #${e} with key ${t} (channel hash: ${n})`)}function Fu(r){if(!r||typeof r!="string"){console.error('Usage: removeRoomName("roomname") - provide room name without leading #');return}let e,t;r==="[[public room]]"||r===Be?(e=Be,t=_e):(e=r.startsWith("#")?r.slice(1):r,t=Ye("#"+e));let n=Ze(t);if(!Ct.get(n)){console.log(`Room #${e} not found in known keys`);return}YA(n),console.log(`Removed room #${e} with key ${t} (channel hash: ${n})`)}window.addRoomName=Tu;window.removeRoomName=Fu;function Pu(r){return r.testedUpToLength?r.testedUpToLength:r.roomName?r.roomName===Be?0:r.roomName.length:0}function Ut(){ZA.textContent=String(Bt.filter(o=>o.status==="pending").length),x0.textContent=String(ln),XA.textContent=Ir>0?Ru(Ir):"-";let r=Bt.filter(o=>o.status==="found"),e=Bt.filter(o=>o.status==="failed"),t=r.length+e.length,n=String(mn);if(t>0&&r.length>0){let o=new Map;for(let c of r){let f=Pu(c);o.set(f,(o.get(f)||0)+1)}let i=[],a=Array.from(o.keys()).sort((c,f)=>c-f);for(let c of a){let A=(o.get(c)/t*100).toFixed(0);c===0?i.push(`${A}% dict`):i.push(`${A}% len ${c}`)}i.length>0&&(n+=` (${i.join(", ")})`)}WA.textContent=n;let s=String(pn);if(t>0&&e.length>0){let o=new Map;for(let c of e){let f=c.testedUpToLength||0;o.set(f,(o.get(f)||0)+1)}let i=[],a=Array.from(o.keys()).sort((c,f)=>c-f);for(let c of a){let A=(o.get(c)/t*100).toFixed(0);i.push(`${A}% len ${c}`)}i.length>0&&(s+=` (${i.join(", ")})`)}zA.textContent=s}function ku(){ci>0?ui.textContent=`${ci} GroupText packets received`:ui.textContent=""}function $A(){if(u0){let r=u0.toLocaleTimeString("en-US",{hour12:!1});li.textContent=`Last packet: ${r}`}else li.textContent=""}function ed(r){let e="",t="",n="",s="";switch(r.status){case"pending":e="status-pending",t=`Pending (max ${r.maxLength})`,n="-";break;case"processing":{if(e="status-processing",t=`Processing ${(r.progressPercent??0).toFixed(1)}%`,r.phase==="wordlist")n=`dict: ${gt(r.testedUpTo||"")}`;else{let a="";if(Ir>0&&r.totalCandidates&&r.checkedCount!==void 0&&r.checkedCount>0){let A=(r.totalCandidates-r.checkedCount)/Ir;a=`; ETA ${Su(A)}`}n=`${r.testedUpToLength?`GPU length ${r.testedUpToLength}`:"Starting"}${a}`}break}case"found":e="status-found",t="Found",n=r.sender?`<strong>${gt(r.sender)}:</strong> ${gt(r.message||"")}`:gt(r.message||""),s=`
        <button class="action-btn skip-btn" data-id="${r.id}" title="Skip this result (MAC collision) and continue searching">Skip this match and keep looking</button>
      `;break;case"failed":e="status-failed",t="Not found",n=`No key found of length ${r.testedUpToLength||"?"}`,s=`
        <button class="action-btn retry-btn" data-id="${r.id}" title="Retry with higher max length">Retry +1</button>
      `;break}let o=r.packetHex.substring(0,32)+(r.packetHex.length>32?"...":"");return`
    <tr data-id="${r.id}">
      <td>${r.id}</td>
      <td class="${e}">${t}</td>
      <td class="mono packet-preview" title="${gt(r.packetHex)}">${gt(o)}</td>
      <td class="mono">${r.roomName?"#"+gt(r.roomName):"-"}</td>
      <td class="message-cell">${n}${s?'<div class="action-btns">'+s+"</div>":""}</td>
    </tr>
  `}function kr(r){let e=gn.querySelector(`tr[data-id="${r.id}"]`);e&&(e.outerHTML=ed(r),td(r))}function td(r){let e=gn.querySelector(`tr[data-id="${r.id}"]`);if(!e)return;let t=e.querySelector(".retry-btn"),n=e.querySelector(".skip-btn");t&&t.addEventListener("click",()=>rd(r.id)),n&&n.addEventListener("click",()=>Lu(r.id))}function Iu(r){let e=gn.querySelector(".empty-state-row");e&&e.remove(),gn.insertAdjacentHTML("beforeend",ed(r)),td(r)}function rd(r){let e=Bt.find(n=>n.id===r);if(!e||e.status!=="failed")return;let t=(e.testedUpToLength||1)+1;e.maxLength=(e.testedUpToLength||e.maxLength)+1,e.startFrom="a".repeat(t),e.status="pending",e.testedUpTo=void 0,e.progressPercent=void 0,e.totalCandidates=void 0,e.checkedCount=void 0,e.skipDictionary=!0,pn--,kr(e),Ut(),xi()}function Lu(r){let e=Bt.find(t=>t.id===r);if(!(!e||e.status!=="found")){if(e.channelHash&&YA(e.channelHash),e.roomName){let t=on(e.roomName);if(t){let n=t.index+1,s=t.length;n>=nt(t.length)&&(s=t.length+1,n=0);let o=Oe(s,n);e.startFrom=o||"a".repeat(s)}}e.status="pending",e.roomName=void 0,e.key=void 0,e.sender=void 0,e.message=void 0,e.progressPercent=void 0,e.totalCandidates=void 0,e.checkedCount=void 0,e.skipDictionary=!0,mn--,kr(e),Ut(),xi()}}var Hu=8;function NA(){if(!hn||Bt.some(o=>o.status==="pending"||o.status==="processing"))return;let e=Bt.filter(o=>o.status==="failed");if(e.length===0)return;e.sort((o,i)=>(o.testedUpToLength||0)-(i.testedUpToLength||0));let t=e[0].testedUpToLength||0;if(t>=Hu)return;let n=e.filter(o=>(o.testedUpToLength||0)===t),s=n[Math.floor(Math.random()*n.length)];rd(s.id)}function Ou(r){if(!r.channelHash||!r.ciphertext||!r.cipherMac)return!1;let e=Ct.get(r.channelHash);if(e){let n=VA(r.ciphertext,r.cipherMac,e.key);if(n.valid)return r.status="found",r.roomName=e.roomName,r.key=e.key,r.sender=n.sender,r.message=n.message,mn++,!0}let t=Ze(_e);if(r.channelHash===t){let n=VA(r.ciphertext,r.cipherMac,_e);if(n.valid)return r.status="found",r.roomName=Be,r.key=_e,r.sender=n.sender,r.message=n.message,mn++,hi(r.channelHash,Be,_e),!0}return!1}async function Mu(r){if(!f0){r.status="failed",r.error="Cracker not available",r.testedUpTo="N/A",pn++;return}try{let e=await f0.crack(r.packetHex,{maxLength:r.maxLength,useTimestampFilter:l0,useUtf8Filter:h0,startFrom:r.startFrom,useDictionary:!r.skipDictionary},t=>{Ir=t.rateKeysPerSec,r.progressPercent=t.percent,r.checkedCount=t.checked,r.totalCandidates=t.total,r.testedUpToLength=t.currentLength,r.testedUpTo=t.currentPosition,r.phase=t.phase,kr(r),Ut()});if(e.found&&e.roomName&&e.key){if(r.status="found",r.roomName=e.roomName,r.key=e.key,r.testedUpToLength=e.roomName.length,r.ciphertext&&r.cipherMac){let t=qt.ChannelCrypto.decryptGroupTextMessage(r.ciphertext,r.cipherMac,e.key);t.success&&t.data&&(r.sender=t.data.sender,r.message=t.data.message)}mn++,r.channelHash&&hi(r.channelHash,e.roomName,e.key)}else r.status="failed",r.testedUpToLength=r.maxLength,pn++}catch(e){r.status="failed",r.error=e instanceof Error?e.message:"Unknown error",pn++}}async function xi(){if(!oi){for(oi=!0;;){let r=Bt.find(e=>e.status==="pending");if(!r)break;if(r.status="processing",di.textContent=`#${r.id}`,kr(r),Ut(),Ou(r)){kr(r),Ut(),p0();continue}await Mu(r),kr(r),Ut()}di.textContent="Idle",Ir=0,Ut(),oi=!1}}function Uu(r){return Array.from(r).map(e=>e.toString(16).padStart(2,"0")).join("")}async function qu(r,e){let t=r.trim().replace(/\s+/g,"").replace(/^0x/i,"").toLowerCase();if(!(!t||!/^[0-9a-fA-F]+$/.test(t)))try{let s=(await qt.MeshCorePacketDecoder.decodeWithVerification(t,{})).payload?.decoded;if(!s?.channelHash||!s?.ciphertext||!s?.cipherMac)return;if(UA.has(s.ciphertext)){ln++,x0.textContent=String(ln);return}if(UA.add(s.ciphertext),wu(s.channelHash.toLowerCase(),s.ciphertext,s.cipherMac)){ln++,x0.textContent=String(ln);return}ci++,ku();let o={id:bu++,packetHex:t,status:"pending",channelHash:s.channelHash.toLowerCase(),ciphertext:s.ciphertext,cipherMac:s.cipherMac,maxLength:e};Bt.push(o),Iu(o),Ut(),xi()}catch{}}function Fr(r){switch(xn.className=`connection-status ${r}`,r){case"disconnected":xn.textContent="Disconnected",Pr.disabled=!1,yn.disabled=!0,d0=null,u0=null,$A();break;case"connecting":xn.textContent="Connecting...",Pr.disabled=!0,yn.disabled=!0;break;case"connected":xn.textContent=d0?`Connected: ${d0}`:"Connected",Pr.disabled=!0,yn.disabled=!1;break}}function Vu(r){r.on(h.PushCodes.LogRxData,async e=>{u0=new Date,$A();try{let t=Uu(e.raw);if(qt.MeshCorePacketDecoder.decode(t).payloadType===qt.PayloadType.GroupText){let s=parseInt(JA.value)||7;await qu(t,s)}}catch{}}),r.on("disconnected",()=>{Fr("disconnected"),Me=null})}async function Nu(){try{if(Fr("connecting"),Me=await $o.open(),!Me){Fr("disconnected");return}Vu(Me),await new Promise((r,e)=>{let t=setTimeout(()=>e(new Error("Timeout")),1e4);Me.on("connected",async()=>{clearTimeout(t);try{let n=await Me.getSelfInfo();n?.name&&(d0=n.name)}catch{}Fr("connected");try{await Me.syncDeviceTime()}catch{}r()})})}catch(r){if(console.error("Connection error:",r),Fr("disconnected"),Me){try{Me.close()}catch{}Me=null}}}function Gu(){Me&&(Me.close(),Me=null),Fr("disconnected")}document.addEventListener("DOMContentLoaded",async()=>{gn=document.getElementById("results-body"),ZA=document.getElementById("queue-count"),di=document.getElementById("current-status"),WA=document.getElementById("found-count"),zA=document.getElementById("failed-count"),x0=document.getElementById("filtered-count"),XA=document.getElementById("current-rate"),fi=document.getElementById("known-keys"),jA=document.getElementById("known-keys-list"),JA=document.getElementById("max-length"),A0=document.getElementById("nosleep-btn"),Pr=document.getElementById("connect-btn"),yn=document.getElementById("disconnect-btn"),xn=document.getElementById("connection-status"),ui=document.getElementById("packets-received"),li=document.getElementById("last-packet-time"),Eu(),p0();let r=document.getElementById("cracker-status"),e=document.getElementById("serial-not-supported");navigator.serial||(e.style.display="block",Pr.disabled=!0);let t=document.getElementById("timestamp-filter"),n=document.getElementById("unicode-filter");t&&(t.checked=l0,t.addEventListener("change",()=>{l0=t.checked})),n&&(n.checked=h0,n.addEventListener("change",()=>{h0=n.checked}));let s=document.getElementById("ignore-rooms");s&&(qA(s.value),s.addEventListener("input",()=>{qA(s.value)}));let o=document.getElementById("auto-retry");o&&(o.checked=hn,o.addEventListener("change",()=>{hn=o.checked,hn&&un===null?(un=window.setInterval(NA,2e3),NA()):!hn&&un!==null&&(clearInterval(un),un=null)}));try{f0=new fn,await f0.loadWordlist("./words_alpha.txt"),r.textContent="Cracker: Ready",r.classList.add("success")}catch(i){console.error("Failed to initialize cracker:",i),r.textContent="Cracker: Init failed",r.classList.add("warning")}Pr.addEventListener("click",Nu),yn.addEventListener("click",Gu),ii=new GA.default,A0.addEventListener("click",()=>{ai?(ii.disable(),ai=!1,A0.textContent="Prevent Sleep"):(ii.enable(),ai=!0,A0.textContent="Allow Sleep")})});})();
/*! Bundled license information:

crypto-js/ripemd160.js:
  (** @preserve
  	(c) 2012 by Cdric Mesnil. All rights reserved.
  
  	Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
  
  	    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
  	    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
  
  	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  	*)

crypto-js/mode-ctr-gladman.js:
  (** @preserve
   * Counter block mode compatible with  Dr Brian Gladman fileenc.c
   * derived from CryptoJS.mode.CTR
   * Jan Hruby jhruby.web@gmail.com
   *)

@noble/ed25519/index.js:
  (*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=bulk-serial-bundle.js.map
