"use strict";(()=>{var Ja=Object.create;var O0=Object.defineProperty;var Qa=Object.getOwnPropertyDescriptor;var ei=Object.getOwnPropertyNames;var ti=Object.getPrototypeOf,ri=Object.prototype.hasOwnProperty;var ni=(t,e,r)=>e in t?O0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var L0=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var si=(t,e)=>()=>(t&&(e=t(t=0)),e);var U=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),ai=(t,e)=>{for(var r in e)O0(t,r,{get:e[r],enumerable:!0})},Mn=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of ei(e))!ri.call(t,a)&&a!==r&&O0(t,a,{get:()=>e[a],enumerable:!(n=Qa(e,a))||n.enumerable});return t};var N0=(t,e,r)=>(r=t!=null?Ja(ti(t)):{},Mn(e||!t||!t.__esModule?O0(r,"default",{value:t,enumerable:!0}):r,t)),ii=t=>Mn(O0({},"__esModule",{value:!0}),t);var Re=(t,e,r)=>ni(t,typeof e!="symbol"?e+"":e,r);var le=U(ce=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.RequestType=ce.AdvertFlags=ce.DeviceRole=ce.PayloadVersion=ce.ControlSubType=ce.PayloadType=ce.RouteType=void 0;var In;(function(t){t[t.TransportFlood=0]="TransportFlood",t[t.Flood=1]="Flood",t[t.Direct=2]="Direct",t[t.TransportDirect=3]="TransportDirect"})(In||(ce.RouteType=In={}));var On;(function(t){t[t.Request=0]="Request",t[t.Response=1]="Response",t[t.TextMessage=2]="TextMessage",t[t.Ack=3]="Ack",t[t.Advert=4]="Advert",t[t.GroupText=5]="GroupText",t[t.GroupData=6]="GroupData",t[t.AnonRequest=7]="AnonRequest",t[t.Path=8]="Path",t[t.Trace=9]="Trace",t[t.Multipart=10]="Multipart",t[t.Control=11]="Control",t[t.RawCustom=15]="RawCustom"})(On||(ce.PayloadType=On={}));var Ln;(function(t){t[t.NodeDiscoverReq=128]="NodeDiscoverReq",t[t.NodeDiscoverResp=144]="NodeDiscoverResp"})(Ln||(ce.ControlSubType=Ln={}));var Nn;(function(t){t[t.Version1=0]="Version1",t[t.Version2=1]="Version2",t[t.Version3=2]="Version3",t[t.Version4=3]="Version4"})(Nn||(ce.PayloadVersion=Nn={}));var Un;(function(t){t[t.Unknown=0]="Unknown",t[t.ChatNode=1]="ChatNode",t[t.Repeater=2]="Repeater",t[t.RoomServer=3]="RoomServer",t[t.Sensor=4]="Sensor"})(Un||(ce.DeviceRole=Un={}));var Vn;(function(t){t[t.HasLocation=16]="HasLocation",t[t.HasFeature1=32]="HasFeature1",t[t.HasFeature2=64]="HasFeature2",t[t.HasName=128]="HasName"})(Vn||(ce.AdvertFlags=Vn={}));var zn;(function(t){t[t.GetStats=1]="GetStats",t[t.Keepalive=2]="Keepalive",t[t.GetTelemetryData=3]="GetTelemetryData",t[t.GetMinMaxAvgData=4]="GetMinMaxAvgData",t[t.GetAccessList=5]="GetAccessList"})(zn||(ce.RequestType=zn={}))});var ie=U(h0=>{"use strict";Object.defineProperty(h0,"__esModule",{value:!0});h0.byteToHex=$n;h0.bytesToHex=oi;h0.numberToHex=ci;h0.hexToBytes=ui;function $n(t){return t.toString(16).padStart(2,"0").toUpperCase()}function oi(t){return Array.from(t).map($n).join("")}function ci(t,e=8){return(t>>>0).toString(16).padStart(e,"0").toUpperCase()}function ui(t){let e=t.replace(/\s/g,"").toUpperCase();if(!/^[0-9A-F]*$/.test(e))throw new Error("Invalid hex string: invalid characters at position 0");if(e.length%2!==0)throw new Error("Invalid hex string: odd length");let r=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2)r[n/2]=parseInt(e.substr(n,2),16);return r}});var p0=U(ze=>{"use strict";Object.defineProperty(ze,"__esModule",{value:!0});ze.getRouteTypeName=xi;ze.getPayloadTypeName=fi;ze.getPayloadVersionName=di;ze.getDeviceRoleName=li;ze.getRequestTypeName=hi;ze.getControlSubTypeName=pi;var Z=le();function xi(t){switch(t){case Z.RouteType.Flood:return"Flood";case Z.RouteType.Direct:return"Direct";case Z.RouteType.TransportFlood:return"TransportFlood";case Z.RouteType.TransportDirect:return"TransportDirect";default:return`Unknown (${t})`}}function fi(t){switch(t){case Z.PayloadType.RawCustom:return"RawCustom";case Z.PayloadType.Trace:return"Trace";case Z.PayloadType.Advert:return"Advert";case Z.PayloadType.GroupText:return"GroupText";case Z.PayloadType.GroupData:return"GroupData";case Z.PayloadType.Request:return"Request";case Z.PayloadType.Response:return"Response";case Z.PayloadType.TextMessage:return"TextMessage";case Z.PayloadType.AnonRequest:return"AnonRequest";case Z.PayloadType.Ack:return"Ack";case Z.PayloadType.Path:return"Path";case Z.PayloadType.Multipart:return"Multipart";case Z.PayloadType.Control:return"Control";default:return`Unknown (0x${t.toString(16)})`}}function di(t){switch(t){case Z.PayloadVersion.Version1:return"Version 1";case Z.PayloadVersion.Version2:return"Version 2";case Z.PayloadVersion.Version3:return"Version 3";case Z.PayloadVersion.Version4:return"Version 4";default:return`Unknown (${t})`}}function li(t){switch(t){case Z.DeviceRole.Unknown:return"Unknown";case Z.DeviceRole.ChatNode:return"Chat Node";case Z.DeviceRole.Repeater:return"Repeater";case Z.DeviceRole.RoomServer:return"Room Server";case Z.DeviceRole.Sensor:return"Sensor";default:return`Unknown (${t})`}}function hi(t){switch(t){case Z.RequestType.GetStats:return"Get Stats";case Z.RequestType.Keepalive:return"Keepalive (deprecated)";case Z.RequestType.GetTelemetryData:return"Get Telemetry Data";case Z.RequestType.GetMinMaxAvgData:return"Get Min/Max/Avg Data";case Z.RequestType.GetAccessList:return"Get Access List";default:return`Unknown (${t})`}}function pi(t){switch(t){case Z.ControlSubType.NodeDiscoverReq:return"Node Discover Request";case Z.ControlSubType.NodeDiscoverResp:return"Node Discover Response";default:return`Unknown (0x${t.toString(16)})`}}});var yt=U(()=>{});var G=U((vt,Kn)=>{(function(t,e){typeof vt=="object"?Kn.exports=vt=e():typeof define=="function"&&define.amd?define([],e):t.CryptoJS=e()})(vt,function(){var t=t||function(e,r){var n;if(typeof window<"u"&&window.crypto&&(n=window.crypto),typeof self<"u"&&self.crypto&&(n=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(n=globalThis.crypto),!n&&typeof window<"u"&&window.msCrypto&&(n=window.msCrypto),!n&&typeof global<"u"&&global.crypto&&(n=global.crypto),!n&&typeof L0=="function")try{n=yt()}catch{}var a=function(){if(n){if(typeof n.getRandomValues=="function")try{return n.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof n.randomBytes=="function")try{return n.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},s=Object.create||function(){function l(){}return function(p){var b;return l.prototype=p,b=new l,l.prototype=null,b}}(),c={},i=c.lib={},u=i.Base=function(){return{extend:function(l){var p=s(this);return l&&p.mixIn(l),(!p.hasOwnProperty("init")||this.init===p.init)&&(p.init=function(){p.$super.init.apply(this,arguments)}),p.init.prototype=p,p.$super=this,p},create:function(){var l=this.extend();return l.init.apply(l,arguments),l},init:function(){},mixIn:function(l){for(var p in l)l.hasOwnProperty(p)&&(this[p]=l[p]);l.hasOwnProperty("toString")&&(this.toString=l.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),d=i.WordArray=u.extend({init:function(l,p){l=this.words=l||[],p!=r?this.sigBytes=p:this.sigBytes=l.length*4},toString:function(l){return(l||f).stringify(this)},concat:function(l){var p=this.words,b=l.words,B=this.sigBytes,C=l.sigBytes;if(this.clamp(),B%4)for(var m=0;m<C;m++){var S=b[m>>>2]>>>24-m%4*8&255;p[B+m>>>2]|=S<<24-(B+m)%4*8}else for(var T=0;T<C;T+=4)p[B+T>>>2]=b[T>>>2];return this.sigBytes+=C,this},clamp:function(){var l=this.words,p=this.sigBytes;l[p>>>2]&=4294967295<<32-p%4*8,l.length=e.ceil(p/4)},clone:function(){var l=u.clone.call(this);return l.words=this.words.slice(0),l},random:function(l){for(var p=[],b=0;b<l;b+=4)p.push(a());return new d.init(p,l)}}),o=c.enc={},f=o.Hex={stringify:function(l){for(var p=l.words,b=l.sigBytes,B=[],C=0;C<b;C++){var m=p[C>>>2]>>>24-C%4*8&255;B.push((m>>>4).toString(16)),B.push((m&15).toString(16))}return B.join("")},parse:function(l){for(var p=l.length,b=[],B=0;B<p;B+=2)b[B>>>3]|=parseInt(l.substr(B,2),16)<<24-B%8*4;return new d.init(b,p/2)}},x=o.Latin1={stringify:function(l){for(var p=l.words,b=l.sigBytes,B=[],C=0;C<b;C++){var m=p[C>>>2]>>>24-C%4*8&255;B.push(String.fromCharCode(m))}return B.join("")},parse:function(l){for(var p=l.length,b=[],B=0;B<p;B++)b[B>>>2]|=(l.charCodeAt(B)&255)<<24-B%4*8;return new d.init(b,p)}},h=o.Utf8={stringify:function(l){try{return decodeURIComponent(escape(x.stringify(l)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(l){return x.parse(unescape(encodeURIComponent(l)))}},y=i.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(l){typeof l=="string"&&(l=h.parse(l)),this._data.concat(l),this._nDataBytes+=l.sigBytes},_process:function(l){var p,b=this._data,B=b.words,C=b.sigBytes,m=this.blockSize,S=m*4,T=C/S;l?T=e.ceil(T):T=e.max((T|0)-this._minBufferSize,0);var R=T*m,q=e.min(R*4,C);if(R){for(var E=0;E<R;E+=m)this._doProcessBlock(B,E);p=B.splice(0,R),b.sigBytes-=q}return new d.init(p,q)},clone:function(){var l=u.clone.call(this);return l._data=this._data.clone(),l},_minBufferSize:0}),g=i.Hasher=y.extend({cfg:u.extend(),init:function(l){this.cfg=this.cfg.extend(l),this.reset()},reset:function(){y.reset.call(this),this._doReset()},update:function(l){return this._append(l),this._process(),this},finalize:function(l){l&&this._append(l);var p=this._doFinalize();return p},blockSize:512/32,_createHelper:function(l){return function(p,b){return new l.init(b).finalize(p)}},_createHmacHelper:function(l){return function(p,b){return new v.HMAC.init(l,b).finalize(p)}}}),v=c.algo={};return c}(Math);return t})});var U0=U((mt,Gn)=>{(function(t,e){typeof mt=="object"?Gn.exports=mt=e(G()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(mt,function(t){return function(e){var r=t,n=r.lib,a=n.Base,s=n.WordArray,c=r.x64={},i=c.Word=a.extend({init:function(d,o){this.high=d,this.low=o}}),u=c.WordArray=a.extend({init:function(d,o){d=this.words=d||[],o!=e?this.sigBytes=o:this.sigBytes=d.length*8},toX32:function(){for(var d=this.words,o=d.length,f=[],x=0;x<o;x++){var h=d[x];f.push(h.high),f.push(h.low)}return s.create(f,this.sigBytes)},clone:function(){for(var d=a.clone.call(this),o=d.words=this.words.slice(0),f=o.length,x=0;x<f;x++)o[x]=o[x].clone();return d}})}(),t})});var Wn=U((gt,jn)=>{(function(t,e){typeof gt=="object"?jn.exports=gt=e(G()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(gt,function(t){return function(){if(typeof ArrayBuffer=="function"){var e=t,r=e.lib,n=r.WordArray,a=n.init,s=n.init=function(c){if(c instanceof ArrayBuffer&&(c=new Uint8Array(c)),(c instanceof Int8Array||typeof Uint8ClampedArray<"u"&&c instanceof Uint8ClampedArray||c instanceof Int16Array||c instanceof Uint16Array||c instanceof Int32Array||c instanceof Uint32Array||c instanceof Float32Array||c instanceof Float64Array)&&(c=new Uint8Array(c.buffer,c.byteOffset,c.byteLength)),c instanceof Uint8Array){for(var i=c.byteLength,u=[],d=0;d<i;d++)u[d>>>2]|=c[d]<<24-d%4*8;a.call(this,u,i)}else a.apply(this,arguments)};s.prototype=n}}(),t.lib.WordArray})});var Zn=U((Bt,Xn)=>{(function(t,e){typeof Bt=="object"?Xn.exports=Bt=e(G()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(Bt,function(t){return function(){var e=t,r=e.lib,n=r.WordArray,a=e.enc,s=a.Utf16=a.Utf16BE={stringify:function(i){for(var u=i.words,d=i.sigBytes,o=[],f=0;f<d;f+=2){var x=u[f>>>2]>>>16-f%4*8&65535;o.push(String.fromCharCode(x))}return o.join("")},parse:function(i){for(var u=i.length,d=[],o=0;o<u;o++)d[o>>>1]|=i.charCodeAt(o)<<16-o%2*16;return n.create(d,u*2)}};a.Utf16LE={stringify:function(i){for(var u=i.words,d=i.sigBytes,o=[],f=0;f<d;f+=2){var x=c(u[f>>>2]>>>16-f%4*8&65535);o.push(String.fromCharCode(x))}return o.join("")},parse:function(i){for(var u=i.length,d=[],o=0;o<u;o++)d[o>>>1]|=c(i.charCodeAt(o)<<16-o%2*16);return n.create(d,u*2)}};function c(i){return i<<8&4278255360|i>>>8&16711935}}(),t.enc.Utf16})});var $e=U((bt,Yn)=>{(function(t,e){typeof bt=="object"?Yn.exports=bt=e(G()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(bt,function(t){return function(){var e=t,r=e.lib,n=r.WordArray,a=e.enc,s=a.Base64={stringify:function(i){var u=i.words,d=i.sigBytes,o=this._map;i.clamp();for(var f=[],x=0;x<d;x+=3)for(var h=u[x>>>2]>>>24-x%4*8&255,y=u[x+1>>>2]>>>24-(x+1)%4*8&255,g=u[x+2>>>2]>>>24-(x+2)%4*8&255,v=h<<16|y<<8|g,l=0;l<4&&x+l*.75<d;l++)f.push(o.charAt(v>>>6*(3-l)&63));var p=o.charAt(64);if(p)for(;f.length%4;)f.push(p);return f.join("")},parse:function(i){var u=i.length,d=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var f=0;f<d.length;f++)o[d.charCodeAt(f)]=f}var x=d.charAt(64);if(x){var h=i.indexOf(x);h!==-1&&(u=h)}return c(i,u,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function c(i,u,d){for(var o=[],f=0,x=0;x<u;x++)if(x%4){var h=d[i.charCodeAt(x-1)]<<x%4*2,y=d[i.charCodeAt(x)]>>>6-x%4*2,g=h|y;o[f>>>2]|=g<<24-f%4*8,f++}return n.create(o,f)}}(),t.enc.Base64})});var Qn=U((Ct,Jn)=>{(function(t,e){typeof Ct=="object"?Jn.exports=Ct=e(G()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(Ct,function(t){return function(){var e=t,r=e.lib,n=r.WordArray,a=e.enc,s=a.Base64url={stringify:function(i,u){u===void 0&&(u=!0);var d=i.words,o=i.sigBytes,f=u?this._safe_map:this._map;i.clamp();for(var x=[],h=0;h<o;h+=3)for(var y=d[h>>>2]>>>24-h%4*8&255,g=d[h+1>>>2]>>>24-(h+1)%4*8&255,v=d[h+2>>>2]>>>24-(h+2)%4*8&255,l=y<<16|g<<8|v,p=0;p<4&&h+p*.75<o;p++)x.push(f.charAt(l>>>6*(3-p)&63));var b=f.charAt(64);if(b)for(;x.length%4;)x.push(b);return x.join("")},parse:function(i,u){u===void 0&&(u=!0);var d=i.length,o=u?this._safe_map:this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var x=0;x<o.length;x++)f[o.charCodeAt(x)]=x}var h=o.charAt(64);if(h){var y=i.indexOf(h);y!==-1&&(d=y)}return c(i,d,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function c(i,u,d){for(var o=[],f=0,x=0;x<u;x++)if(x%4){var h=d[i.charCodeAt(x-1)]<<x%4*2,y=d[i.charCodeAt(x)]>>>6-x%4*2,g=h|y;o[f>>>2]|=g<<24-f%4*8,f++}return n.create(o,f)}}(),t.enc.Base64url})});var Ke=U((At,es)=>{(function(t,e){typeof At=="object"?es.exports=At=e(G()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(At,function(t){return function(e){var r=t,n=r.lib,a=n.WordArray,s=n.Hasher,c=r.algo,i=[];(function(){for(var h=0;h<64;h++)i[h]=e.abs(e.sin(h+1))*4294967296|0})();var u=c.MD5=s.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(h,y){for(var g=0;g<16;g++){var v=y+g,l=h[v];h[v]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360}var p=this._hash.words,b=h[y+0],B=h[y+1],C=h[y+2],m=h[y+3],S=h[y+4],T=h[y+5],R=h[y+6],q=h[y+7],E=h[y+8],A=h[y+9],H=h[y+10],w=h[y+11],V=h[y+12],I=h[y+13],z=h[y+14],$=h[y+15],D=p[0],k=p[1],P=p[2],F=p[3];D=d(D,k,P,F,b,7,i[0]),F=d(F,D,k,P,B,12,i[1]),P=d(P,F,D,k,C,17,i[2]),k=d(k,P,F,D,m,22,i[3]),D=d(D,k,P,F,S,7,i[4]),F=d(F,D,k,P,T,12,i[5]),P=d(P,F,D,k,R,17,i[6]),k=d(k,P,F,D,q,22,i[7]),D=d(D,k,P,F,E,7,i[8]),F=d(F,D,k,P,A,12,i[9]),P=d(P,F,D,k,H,17,i[10]),k=d(k,P,F,D,w,22,i[11]),D=d(D,k,P,F,V,7,i[12]),F=d(F,D,k,P,I,12,i[13]),P=d(P,F,D,k,z,17,i[14]),k=d(k,P,F,D,$,22,i[15]),D=o(D,k,P,F,B,5,i[16]),F=o(F,D,k,P,R,9,i[17]),P=o(P,F,D,k,w,14,i[18]),k=o(k,P,F,D,b,20,i[19]),D=o(D,k,P,F,T,5,i[20]),F=o(F,D,k,P,H,9,i[21]),P=o(P,F,D,k,$,14,i[22]),k=o(k,P,F,D,S,20,i[23]),D=o(D,k,P,F,A,5,i[24]),F=o(F,D,k,P,z,9,i[25]),P=o(P,F,D,k,m,14,i[26]),k=o(k,P,F,D,E,20,i[27]),D=o(D,k,P,F,I,5,i[28]),F=o(F,D,k,P,C,9,i[29]),P=o(P,F,D,k,q,14,i[30]),k=o(k,P,F,D,V,20,i[31]),D=f(D,k,P,F,T,4,i[32]),F=f(F,D,k,P,E,11,i[33]),P=f(P,F,D,k,w,16,i[34]),k=f(k,P,F,D,z,23,i[35]),D=f(D,k,P,F,B,4,i[36]),F=f(F,D,k,P,S,11,i[37]),P=f(P,F,D,k,q,16,i[38]),k=f(k,P,F,D,H,23,i[39]),D=f(D,k,P,F,I,4,i[40]),F=f(F,D,k,P,b,11,i[41]),P=f(P,F,D,k,m,16,i[42]),k=f(k,P,F,D,R,23,i[43]),D=f(D,k,P,F,A,4,i[44]),F=f(F,D,k,P,V,11,i[45]),P=f(P,F,D,k,$,16,i[46]),k=f(k,P,F,D,C,23,i[47]),D=x(D,k,P,F,b,6,i[48]),F=x(F,D,k,P,q,10,i[49]),P=x(P,F,D,k,z,15,i[50]),k=x(k,P,F,D,T,21,i[51]),D=x(D,k,P,F,V,6,i[52]),F=x(F,D,k,P,m,10,i[53]),P=x(P,F,D,k,H,15,i[54]),k=x(k,P,F,D,B,21,i[55]),D=x(D,k,P,F,E,6,i[56]),F=x(F,D,k,P,$,10,i[57]),P=x(P,F,D,k,R,15,i[58]),k=x(k,P,F,D,I,21,i[59]),D=x(D,k,P,F,S,6,i[60]),F=x(F,D,k,P,w,10,i[61]),P=x(P,F,D,k,C,15,i[62]),k=x(k,P,F,D,A,21,i[63]),p[0]=p[0]+D|0,p[1]=p[1]+k|0,p[2]=p[2]+P|0,p[3]=p[3]+F|0},_doFinalize:function(){var h=this._data,y=h.words,g=this._nDataBytes*8,v=h.sigBytes*8;y[v>>>5]|=128<<24-v%32;var l=e.floor(g/4294967296),p=g;y[(v+64>>>9<<4)+15]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360,y[(v+64>>>9<<4)+14]=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360,h.sigBytes=(y.length+1)*4,this._process();for(var b=this._hash,B=b.words,C=0;C<4;C++){var m=B[C];B[C]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360}return b},clone:function(){var h=s.clone.call(this);return h._hash=this._hash.clone(),h}});function d(h,y,g,v,l,p,b){var B=h+(y&g|~y&v)+l+b;return(B<<p|B>>>32-p)+y}function o(h,y,g,v,l,p,b){var B=h+(y&v|g&~v)+l+b;return(B<<p|B>>>32-p)+y}function f(h,y,g,v,l,p,b){var B=h+(y^g^v)+l+b;return(B<<p|B>>>32-p)+y}function x(h,y,g,v,l,p,b){var B=h+(g^(y|~v))+l+b;return(B<<p|B>>>32-p)+y}r.MD5=s._createHelper(u),r.HmacMD5=s._createHmacHelper(u)}(Math),t.MD5})});var Ir=U((Et,ts)=>{(function(t,e){typeof Et=="object"?ts.exports=Et=e(G()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(Et,function(t){return function(){var e=t,r=e.lib,n=r.WordArray,a=r.Hasher,s=e.algo,c=[],i=s.SHA1=a.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,d){for(var o=this._hash.words,f=o[0],x=o[1],h=o[2],y=o[3],g=o[4],v=0;v<80;v++){if(v<16)c[v]=u[d+v]|0;else{var l=c[v-3]^c[v-8]^c[v-14]^c[v-16];c[v]=l<<1|l>>>31}var p=(f<<5|f>>>27)+g+c[v];v<20?p+=(x&h|~x&y)+1518500249:v<40?p+=(x^h^y)+1859775393:v<60?p+=(x&h|x&y|h&y)-1894007588:p+=(x^h^y)-899497514,g=y,y=h,h=x<<30|x>>>2,x=f,f=p}o[0]=o[0]+f|0,o[1]=o[1]+x|0,o[2]=o[2]+h|0,o[3]=o[3]+y|0,o[4]=o[4]+g|0},_doFinalize:function(){var u=this._data,d=u.words,o=this._nDataBytes*8,f=u.sigBytes*8;return d[f>>>5]|=128<<24-f%32,d[(f+64>>>9<<4)+14]=Math.floor(o/4294967296),d[(f+64>>>9<<4)+15]=o,u.sigBytes=d.length*4,this._process(),this._hash},clone:function(){var u=a.clone.call(this);return u._hash=this._hash.clone(),u}});e.SHA1=a._createHelper(i),e.HmacSHA1=a._createHmacHelper(i)}(),t.SHA1})});var y0=U((_t,rs)=>{(function(t,e){typeof _t=="object"?rs.exports=_t=e(G()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(_t,function(t){return function(e){var r=t,n=r.lib,a=n.WordArray,s=n.Hasher,c=r.algo,i=[],u=[];(function(){function f(g){for(var v=e.sqrt(g),l=2;l<=v;l++)if(!(g%l))return!1;return!0}function x(g){return(g-(g|0))*4294967296|0}for(var h=2,y=0;y<64;)f(h)&&(y<8&&(i[y]=x(e.pow(h,1/2))),u[y]=x(e.pow(h,1/3)),y++),h++})();var d=[],o=c.SHA256=s.extend({_doReset:function(){this._hash=new a.init(i.slice(0))},_doProcessBlock:function(f,x){for(var h=this._hash.words,y=h[0],g=h[1],v=h[2],l=h[3],p=h[4],b=h[5],B=h[6],C=h[7],m=0;m<64;m++){if(m<16)d[m]=f[x+m]|0;else{var S=d[m-15],T=(S<<25|S>>>7)^(S<<14|S>>>18)^S>>>3,R=d[m-2],q=(R<<15|R>>>17)^(R<<13|R>>>19)^R>>>10;d[m]=T+d[m-7]+q+d[m-16]}var E=p&b^~p&B,A=y&g^y&v^g&v,H=(y<<30|y>>>2)^(y<<19|y>>>13)^(y<<10|y>>>22),w=(p<<26|p>>>6)^(p<<21|p>>>11)^(p<<7|p>>>25),V=C+w+E+u[m]+d[m],I=H+A;C=B,B=b,b=p,p=l+V|0,l=v,v=g,g=y,y=V+I|0}h[0]=h[0]+y|0,h[1]=h[1]+g|0,h[2]=h[2]+v|0,h[3]=h[3]+l|0,h[4]=h[4]+p|0,h[5]=h[5]+b|0,h[6]=h[6]+B|0,h[7]=h[7]+C|0},_doFinalize:function(){var f=this._data,x=f.words,h=this._nDataBytes*8,y=f.sigBytes*8;return x[y>>>5]|=128<<24-y%32,x[(y+64>>>9<<4)+14]=e.floor(h/4294967296),x[(y+64>>>9<<4)+15]=h,f.sigBytes=x.length*4,this._process(),this._hash},clone:function(){var f=s.clone.call(this);return f._hash=this._hash.clone(),f}});r.SHA256=s._createHelper(o),r.HmacSHA256=s._createHmacHelper(o)}(Math),t.SHA256})});var ss=U((Dt,ns)=>{(function(t,e,r){typeof Dt=="object"?ns.exports=Dt=e(G(),y0()):typeof define=="function"&&define.amd?define(["./core","./sha256"],e):e(t.CryptoJS)})(Dt,function(t){return function(){var e=t,r=e.lib,n=r.WordArray,a=e.algo,s=a.SHA256,c=a.SHA224=s.extend({_doReset:function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var i=s._doFinalize.call(this);return i.sigBytes-=4,i}});e.SHA224=s._createHelper(c),e.HmacSHA224=s._createHmacHelper(c)}(),t.SHA224})});var Or=U((Ft,as)=>{(function(t,e,r){typeof Ft=="object"?as.exports=Ft=e(G(),U0()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],e):e(t.CryptoJS)})(Ft,function(t){return function(){var e=t,r=e.lib,n=r.Hasher,a=e.x64,s=a.Word,c=a.WordArray,i=e.algo;function u(){return s.create.apply(s,arguments)}var d=[u(1116352408,3609767458),u(1899447441,602891725),u(3049323471,3964484399),u(3921009573,2173295548),u(961987163,4081628472),u(1508970993,3053834265),u(2453635748,2937671579),u(2870763221,3664609560),u(3624381080,2734883394),u(310598401,1164996542),u(607225278,1323610764),u(1426881987,3590304994),u(1925078388,4068182383),u(2162078206,991336113),u(2614888103,633803317),u(3248222580,3479774868),u(3835390401,2666613458),u(4022224774,944711139),u(264347078,2341262773),u(604807628,2007800933),u(770255983,1495990901),u(1249150122,1856431235),u(1555081692,3175218132),u(1996064986,2198950837),u(2554220882,3999719339),u(2821834349,766784016),u(2952996808,2566594879),u(3210313671,3203337956),u(3336571891,1034457026),u(3584528711,2466948901),u(113926993,3758326383),u(338241895,168717936),u(666307205,1188179964),u(773529912,1546045734),u(1294757372,1522805485),u(1396182291,2643833823),u(1695183700,2343527390),u(1986661051,1014477480),u(2177026350,1206759142),u(2456956037,344077627),u(2730485921,1290863460),u(2820302411,3158454273),u(3259730800,3505952657),u(3345764771,106217008),u(3516065817,3606008344),u(3600352804,1432725776),u(4094571909,1467031594),u(275423344,851169720),u(430227734,3100823752),u(506948616,1363258195),u(659060556,3750685593),u(883997877,3785050280),u(958139571,3318307427),u(1322822218,3812723403),u(1537002063,2003034995),u(1747873779,3602036899),u(1955562222,1575990012),u(2024104815,1125592928),u(2227730452,2716904306),u(2361852424,442776044),u(2428436474,593698344),u(2756734187,3733110249),u(3204031479,2999351573),u(3329325298,3815920427),u(3391569614,3928383900),u(3515267271,566280711),u(3940187606,3454069534),u(4118630271,4000239992),u(116418474,1914138554),u(174292421,2731055270),u(289380356,3203993006),u(460393269,320620315),u(685471733,587496836),u(852142971,1086792851),u(1017036298,365543100),u(1126000580,2618297676),u(1288033470,3409855158),u(1501505948,4234509866),u(1607167915,987167468),u(1816402316,1246189591)],o=[];(function(){for(var x=0;x<80;x++)o[x]=u()})();var f=i.SHA512=n.extend({_doReset:function(){this._hash=new c.init([new s.init(1779033703,4089235720),new s.init(3144134277,2227873595),new s.init(1013904242,4271175723),new s.init(2773480762,1595750129),new s.init(1359893119,2917565137),new s.init(2600822924,725511199),new s.init(528734635,4215389547),new s.init(1541459225,327033209)])},_doProcessBlock:function(x,h){for(var y=this._hash.words,g=y[0],v=y[1],l=y[2],p=y[3],b=y[4],B=y[5],C=y[6],m=y[7],S=g.high,T=g.low,R=v.high,q=v.low,E=l.high,A=l.low,H=p.high,w=p.low,V=b.high,I=b.low,z=B.high,$=B.low,D=C.high,k=C.low,P=m.high,F=m.low,X=S,J=T,oe=R,K=q,ke=E,Ne=A,H0=H,Ye=w,pe=V,xe=I,f0=z,Je=$,R0=D,Ue=k,d0=P,Qe=F,fe=0;fe<80;fe++){var de,Ee,l0=o[fe];if(fe<16)Ee=l0.high=x[h+fe*2]|0,de=l0.low=x[h+fe*2+1]|0;else{var nt=o[fe-15],Pe=nt.high,e0=nt.low,kr=(Pe>>>1|e0<<31)^(Pe>>>8|e0<<24)^Pe>>>7,st=(e0>>>1|Pe<<31)^(e0>>>8|Pe<<24)^(e0>>>7|Pe<<25),at=o[fe-2],He=at.high,t0=at.low,it=(He>>>19|t0<<13)^(He<<3|t0>>>29)^He>>>6,ot=(t0>>>19|He<<13)^(t0<<3|He>>>29)^(t0>>>6|He<<26),ct=o[fe-7],ut=ct.high,Pr=ct.low,xt=o[fe-16],Hr=xt.high,ft=xt.low;de=st+Pr,Ee=kr+ut+(de>>>0<st>>>0?1:0),de=de+ot,Ee=Ee+it+(de>>>0<ot>>>0?1:0),de=de+ft,Ee=Ee+Hr+(de>>>0<ft>>>0?1:0),l0.high=Ee,l0.low=de}var Rr=pe&f0^~pe&R0,q0=xe&Je^~xe&Ue,dt=X&oe^X&ke^oe&ke,lt=J&K^J&Ne^K&Ne,qr=(X>>>28|J<<4)^(X<<30|J>>>2)^(X<<25|J>>>7),ht=(J>>>28|X<<4)^(J<<30|X>>>2)^(J<<25|X>>>7),r0=(pe>>>14|xe<<18)^(pe>>>18|xe<<14)^(pe<<23|xe>>>9),M0=(xe>>>14|pe<<18)^(xe>>>18|pe<<14)^(xe<<23|pe>>>9),pt=d[fe],_=pt.high,M=pt.low,L=Qe+M0,j=d0+r0+(L>>>0<Qe>>>0?1:0),L=L+q0,j=j+Rr+(L>>>0<q0>>>0?1:0),L=L+M,j=j+_+(L>>>0<M>>>0?1:0),L=L+de,j=j+Ee+(L>>>0<de>>>0?1:0),Y=ht+lt,ee=qr+dt+(Y>>>0<ht>>>0?1:0);d0=R0,Qe=Ue,R0=f0,Ue=Je,f0=pe,Je=xe,xe=Ye+L|0,pe=H0+j+(xe>>>0<Ye>>>0?1:0)|0,H0=ke,Ye=Ne,ke=oe,Ne=K,oe=X,K=J,J=L+Y|0,X=j+ee+(J>>>0<L>>>0?1:0)|0}T=g.low=T+J,g.high=S+X+(T>>>0<J>>>0?1:0),q=v.low=q+K,v.high=R+oe+(q>>>0<K>>>0?1:0),A=l.low=A+Ne,l.high=E+ke+(A>>>0<Ne>>>0?1:0),w=p.low=w+Ye,p.high=H+H0+(w>>>0<Ye>>>0?1:0),I=b.low=I+xe,b.high=V+pe+(I>>>0<xe>>>0?1:0),$=B.low=$+Je,B.high=z+f0+($>>>0<Je>>>0?1:0),k=C.low=k+Ue,C.high=D+R0+(k>>>0<Ue>>>0?1:0),F=m.low=F+Qe,m.high=P+d0+(F>>>0<Qe>>>0?1:0)},_doFinalize:function(){var x=this._data,h=x.words,y=this._nDataBytes*8,g=x.sigBytes*8;h[g>>>5]|=128<<24-g%32,h[(g+128>>>10<<5)+30]=Math.floor(y/4294967296),h[(g+128>>>10<<5)+31]=y,x.sigBytes=h.length*4,this._process();var v=this._hash.toX32();return v},clone:function(){var x=n.clone.call(this);return x._hash=this._hash.clone(),x},blockSize:1024/32});e.SHA512=n._createHelper(f),e.HmacSHA512=n._createHmacHelper(f)}(),t.SHA512})});var os=U((wt,is)=>{(function(t,e,r){typeof wt=="object"?is.exports=wt=e(G(),U0(),Or()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./sha512"],e):e(t.CryptoJS)})(wt,function(t){return function(){var e=t,r=e.x64,n=r.Word,a=r.WordArray,s=e.algo,c=s.SHA512,i=s.SHA384=c.extend({_doReset:function(){this._hash=new a.init([new n.init(3418070365,3238371032),new n.init(1654270250,914150663),new n.init(2438529370,812702999),new n.init(355462360,4144912697),new n.init(1731405415,4290775857),new n.init(2394180231,1750603025),new n.init(3675008525,1694076839),new n.init(1203062813,3204075428)])},_doFinalize:function(){var u=c._doFinalize.call(this);return u.sigBytes-=16,u}});e.SHA384=c._createHelper(i),e.HmacSHA384=c._createHmacHelper(i)}(),t.SHA384})});var us=U((St,cs)=>{(function(t,e,r){typeof St=="object"?cs.exports=St=e(G(),U0()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],e):e(t.CryptoJS)})(St,function(t){return function(e){var r=t,n=r.lib,a=n.WordArray,s=n.Hasher,c=r.x64,i=c.Word,u=r.algo,d=[],o=[],f=[];(function(){for(var y=1,g=0,v=0;v<24;v++){d[y+5*g]=(v+1)*(v+2)/2%64;var l=g%5,p=(2*y+3*g)%5;y=l,g=p}for(var y=0;y<5;y++)for(var g=0;g<5;g++)o[y+5*g]=g+(2*y+3*g)%5*5;for(var b=1,B=0;B<24;B++){for(var C=0,m=0,S=0;S<7;S++){if(b&1){var T=(1<<S)-1;T<32?m^=1<<T:C^=1<<T-32}b&128?b=b<<1^113:b<<=1}f[B]=i.create(C,m)}})();var x=[];(function(){for(var y=0;y<25;y++)x[y]=i.create()})();var h=u.SHA3=s.extend({cfg:s.cfg.extend({outputLength:512}),_doReset:function(){for(var y=this._state=[],g=0;g<25;g++)y[g]=new i.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(y,g){for(var v=this._state,l=this.blockSize/2,p=0;p<l;p++){var b=y[g+2*p],B=y[g+2*p+1];b=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,B=(B<<8|B>>>24)&16711935|(B<<24|B>>>8)&4278255360;var C=v[p];C.high^=B,C.low^=b}for(var m=0;m<24;m++){for(var S=0;S<5;S++){for(var T=0,R=0,q=0;q<5;q++){var C=v[S+5*q];T^=C.high,R^=C.low}var E=x[S];E.high=T,E.low=R}for(var S=0;S<5;S++)for(var A=x[(S+4)%5],H=x[(S+1)%5],w=H.high,V=H.low,T=A.high^(w<<1|V>>>31),R=A.low^(V<<1|w>>>31),q=0;q<5;q++){var C=v[S+5*q];C.high^=T,C.low^=R}for(var I=1;I<25;I++){var T,R,C=v[I],z=C.high,$=C.low,D=d[I];D<32?(T=z<<D|$>>>32-D,R=$<<D|z>>>32-D):(T=$<<D-32|z>>>64-D,R=z<<D-32|$>>>64-D);var k=x[o[I]];k.high=T,k.low=R}var P=x[0],F=v[0];P.high=F.high,P.low=F.low;for(var S=0;S<5;S++)for(var q=0;q<5;q++){var I=S+5*q,C=v[I],X=x[I],J=x[(S+1)%5+5*q],oe=x[(S+2)%5+5*q];C.high=X.high^~J.high&oe.high,C.low=X.low^~J.low&oe.low}var C=v[0],K=f[m];C.high^=K.high,C.low^=K.low}},_doFinalize:function(){var y=this._data,g=y.words,v=this._nDataBytes*8,l=y.sigBytes*8,p=this.blockSize*32;g[l>>>5]|=1<<24-l%32,g[(e.ceil((l+1)/p)*p>>>5)-1]|=128,y.sigBytes=g.length*4,this._process();for(var b=this._state,B=this.cfg.outputLength/8,C=B/8,m=[],S=0;S<C;S++){var T=b[S],R=T.high,q=T.low;R=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360,q=(q<<8|q>>>24)&16711935|(q<<24|q>>>8)&4278255360,m.push(q),m.push(R)}return new a.init(m,B)},clone:function(){for(var y=s.clone.call(this),g=y._state=this._state.slice(0),v=0;v<25;v++)g[v]=g[v].clone();return y}});r.SHA3=s._createHelper(h),r.HmacSHA3=s._createHmacHelper(h)}(Math),t.SHA3})});var fs=U((Tt,xs)=>{(function(t,e){typeof Tt=="object"?xs.exports=Tt=e(G()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(Tt,function(t){return function(e){var r=t,n=r.lib,a=n.WordArray,s=n.Hasher,c=r.algo,i=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),d=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),o=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),f=a.create([0,1518500249,1859775393,2400959708,2840853838]),x=a.create([1352829926,1548603684,1836072691,2053994217,0]),h=c.RIPEMD160=s.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(B,C){for(var m=0;m<16;m++){var S=C+m,T=B[S];B[S]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360}var R=this._hash.words,q=f.words,E=x.words,A=i.words,H=u.words,w=d.words,V=o.words,I,z,$,D,k,P,F,X,J,oe;P=I=R[0],F=z=R[1],X=$=R[2],J=D=R[3],oe=k=R[4];for(var K,m=0;m<80;m+=1)K=I+B[C+A[m]]|0,m<16?K+=y(z,$,D)+q[0]:m<32?K+=g(z,$,D)+q[1]:m<48?K+=v(z,$,D)+q[2]:m<64?K+=l(z,$,D)+q[3]:K+=p(z,$,D)+q[4],K=K|0,K=b(K,w[m]),K=K+k|0,I=k,k=D,D=b($,10),$=z,z=K,K=P+B[C+H[m]]|0,m<16?K+=p(F,X,J)+E[0]:m<32?K+=l(F,X,J)+E[1]:m<48?K+=v(F,X,J)+E[2]:m<64?K+=g(F,X,J)+E[3]:K+=y(F,X,J)+E[4],K=K|0,K=b(K,V[m]),K=K+oe|0,P=oe,oe=J,J=b(X,10),X=F,F=K;K=R[1]+$+J|0,R[1]=R[2]+D+oe|0,R[2]=R[3]+k+P|0,R[3]=R[4]+I+F|0,R[4]=R[0]+z+X|0,R[0]=K},_doFinalize:function(){var B=this._data,C=B.words,m=this._nDataBytes*8,S=B.sigBytes*8;C[S>>>5]|=128<<24-S%32,C[(S+64>>>9<<4)+14]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,B.sigBytes=(C.length+1)*4,this._process();for(var T=this._hash,R=T.words,q=0;q<5;q++){var E=R[q];R[q]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360}return T},clone:function(){var B=s.clone.call(this);return B._hash=this._hash.clone(),B}});function y(B,C,m){return B^C^m}function g(B,C,m){return B&C|~B&m}function v(B,C,m){return(B|~C)^m}function l(B,C,m){return B&m|C&~m}function p(B,C,m){return B^(C|~m)}function b(B,C){return B<<C|B>>>32-C}r.RIPEMD160=s._createHelper(h),r.HmacRIPEMD160=s._createHmacHelper(h)}(Math),t.RIPEMD160})});var V0=U((kt,ds)=>{(function(t,e){typeof kt=="object"?ds.exports=kt=e(G()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(kt,function(t){(function(){var e=t,r=e.lib,n=r.Base,a=e.enc,s=a.Utf8,c=e.algo,i=c.HMAC=n.extend({init:function(u,d){u=this._hasher=new u.init,typeof d=="string"&&(d=s.parse(d));var o=u.blockSize,f=o*4;d.sigBytes>f&&(d=u.finalize(d)),d.clamp();for(var x=this._oKey=d.clone(),h=this._iKey=d.clone(),y=x.words,g=h.words,v=0;v<o;v++)y[v]^=1549556828,g[v]^=909522486;x.sigBytes=h.sigBytes=f,this.reset()},reset:function(){var u=this._hasher;u.reset(),u.update(this._iKey)},update:function(u){return this._hasher.update(u),this},finalize:function(u){var d=this._hasher,o=d.finalize(u);d.reset();var f=d.finalize(this._oKey.clone().concat(o));return f}})})()})});var hs=U((Pt,ls)=>{(function(t,e,r){typeof Pt=="object"?ls.exports=Pt=e(G(),y0(),V0()):typeof define=="function"&&define.amd?define(["./core","./sha256","./hmac"],e):e(t.CryptoJS)})(Pt,function(t){return function(){var e=t,r=e.lib,n=r.Base,a=r.WordArray,s=e.algo,c=s.SHA256,i=s.HMAC,u=s.PBKDF2=n.extend({cfg:n.extend({keySize:128/32,hasher:c,iterations:25e4}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,o){for(var f=this.cfg,x=i.create(f.hasher,d),h=a.create(),y=a.create([1]),g=h.words,v=y.words,l=f.keySize,p=f.iterations;g.length<l;){var b=x.update(o).finalize(y);x.reset();for(var B=b.words,C=B.length,m=b,S=1;S<p;S++){m=x.finalize(m),x.reset();for(var T=m.words,R=0;R<C;R++)B[R]^=T[R]}h.concat(b),v[0]++}return h.sigBytes=l*4,h}});e.PBKDF2=function(d,o,f){return u.create(f).compute(d,o)}}(),t.PBKDF2})});var qe=U((Ht,ps)=>{(function(t,e,r){typeof Ht=="object"?ps.exports=Ht=e(G(),Ir(),V0()):typeof define=="function"&&define.amd?define(["./core","./sha1","./hmac"],e):e(t.CryptoJS)})(Ht,function(t){return function(){var e=t,r=e.lib,n=r.Base,a=r.WordArray,s=e.algo,c=s.MD5,i=s.EvpKDF=n.extend({cfg:n.extend({keySize:128/32,hasher:c,iterations:1}),init:function(u){this.cfg=this.cfg.extend(u)},compute:function(u,d){for(var o,f=this.cfg,x=f.hasher.create(),h=a.create(),y=h.words,g=f.keySize,v=f.iterations;y.length<g;){o&&x.update(o),o=x.update(u).finalize(d),x.reset();for(var l=1;l<v;l++)o=x.finalize(o),x.reset();h.concat(o)}return h.sigBytes=g*4,h}});e.EvpKDF=function(u,d,o){return i.create(o).compute(u,d)}}(),t.EvpKDF})});var se=U((Rt,ys)=>{(function(t,e,r){typeof Rt=="object"?ys.exports=Rt=e(G(),qe()):typeof define=="function"&&define.amd?define(["./core","./evpkdf"],e):e(t.CryptoJS)})(Rt,function(t){t.lib.Cipher||function(e){var r=t,n=r.lib,a=n.Base,s=n.WordArray,c=n.BufferedBlockAlgorithm,i=r.enc,u=i.Utf8,d=i.Base64,o=r.algo,f=o.EvpKDF,x=n.Cipher=c.extend({cfg:a.extend(),createEncryptor:function(E,A){return this.create(this._ENC_XFORM_MODE,E,A)},createDecryptor:function(E,A){return this.create(this._DEC_XFORM_MODE,E,A)},init:function(E,A,H){this.cfg=this.cfg.extend(H),this._xformMode=E,this._key=A,this.reset()},reset:function(){c.reset.call(this),this._doReset()},process:function(E){return this._append(E),this._process()},finalize:function(E){E&&this._append(E);var A=this._doFinalize();return A},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function E(A){return typeof A=="string"?q:S}return function(A){return{encrypt:function(H,w,V){return E(w).encrypt(A,H,w,V)},decrypt:function(H,w,V){return E(w).decrypt(A,H,w,V)}}}}()}),h=n.StreamCipher=x.extend({_doFinalize:function(){var E=this._process(!0);return E},blockSize:1}),y=r.mode={},g=n.BlockCipherMode=a.extend({createEncryptor:function(E,A){return this.Encryptor.create(E,A)},createDecryptor:function(E,A){return this.Decryptor.create(E,A)},init:function(E,A){this._cipher=E,this._iv=A}}),v=y.CBC=function(){var E=g.extend();E.Encryptor=E.extend({processBlock:function(H,w){var V=this._cipher,I=V.blockSize;A.call(this,H,w,I),V.encryptBlock(H,w),this._prevBlock=H.slice(w,w+I)}}),E.Decryptor=E.extend({processBlock:function(H,w){var V=this._cipher,I=V.blockSize,z=H.slice(w,w+I);V.decryptBlock(H,w),A.call(this,H,w,I),this._prevBlock=z}});function A(H,w,V){var I,z=this._iv;z?(I=z,this._iv=e):I=this._prevBlock;for(var $=0;$<V;$++)H[w+$]^=I[$]}return E}(),l=r.pad={},p=l.Pkcs7={pad:function(E,A){for(var H=A*4,w=H-E.sigBytes%H,V=w<<24|w<<16|w<<8|w,I=[],z=0;z<w;z+=4)I.push(V);var $=s.create(I,w);E.concat($)},unpad:function(E){var A=E.words[E.sigBytes-1>>>2]&255;E.sigBytes-=A}},b=n.BlockCipher=x.extend({cfg:x.cfg.extend({mode:v,padding:p}),reset:function(){var E;x.reset.call(this);var A=this.cfg,H=A.iv,w=A.mode;this._xformMode==this._ENC_XFORM_MODE?E=w.createEncryptor:(E=w.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==E?this._mode.init(this,H&&H.words):(this._mode=E.call(w,this,H&&H.words),this._mode.__creator=E)},_doProcessBlock:function(E,A){this._mode.processBlock(E,A)},_doFinalize:function(){var E,A=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(A.pad(this._data,this.blockSize),E=this._process(!0)):(E=this._process(!0),A.unpad(E)),E},blockSize:128/32}),B=n.CipherParams=a.extend({init:function(E){this.mixIn(E)},toString:function(E){return(E||this.formatter).stringify(this)}}),C=r.format={},m=C.OpenSSL={stringify:function(E){var A,H=E.ciphertext,w=E.salt;return w?A=s.create([1398893684,1701076831]).concat(w).concat(H):A=H,A.toString(d)},parse:function(E){var A,H=d.parse(E),w=H.words;return w[0]==1398893684&&w[1]==1701076831&&(A=s.create(w.slice(2,4)),w.splice(0,4),H.sigBytes-=16),B.create({ciphertext:H,salt:A})}},S=n.SerializableCipher=a.extend({cfg:a.extend({format:m}),encrypt:function(E,A,H,w){w=this.cfg.extend(w);var V=E.createEncryptor(H,w),I=V.finalize(A),z=V.cfg;return B.create({ciphertext:I,key:H,iv:z.iv,algorithm:E,mode:z.mode,padding:z.padding,blockSize:E.blockSize,formatter:w.format})},decrypt:function(E,A,H,w){w=this.cfg.extend(w),A=this._parse(A,w.format);var V=E.createDecryptor(H,w).finalize(A.ciphertext);return V},_parse:function(E,A){return typeof E=="string"?A.parse(E,this):E}}),T=r.kdf={},R=T.OpenSSL={execute:function(E,A,H,w,V){if(w||(w=s.random(64/8)),V)var I=f.create({keySize:A+H,hasher:V}).compute(E,w);else var I=f.create({keySize:A+H}).compute(E,w);var z=s.create(I.words.slice(A),H*4);return I.sigBytes=A*4,B.create({key:I,iv:z,salt:w})}},q=n.PasswordBasedCipher=S.extend({cfg:S.cfg.extend({kdf:R}),encrypt:function(E,A,H,w){w=this.cfg.extend(w);var V=w.kdf.execute(H,E.keySize,E.ivSize,w.salt,w.hasher);w.iv=V.iv;var I=S.encrypt.call(this,E,A,V.key,w);return I.mixIn(V),I},decrypt:function(E,A,H,w){w=this.cfg.extend(w),A=this._parse(A,w.format);var V=w.kdf.execute(H,E.keySize,E.ivSize,A.salt,w.hasher);w.iv=V.iv;var I=S.decrypt.call(this,E,A,V.key,w);return I}})}()})});var ms=U((qt,vs)=>{(function(t,e,r){typeof qt=="object"?vs.exports=qt=e(G(),se()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(qt,function(t){return t.mode.CFB=function(){var e=t.lib.BlockCipherMode.extend();e.Encryptor=e.extend({processBlock:function(n,a){var s=this._cipher,c=s.blockSize;r.call(this,n,a,c,s),this._prevBlock=n.slice(a,a+c)}}),e.Decryptor=e.extend({processBlock:function(n,a){var s=this._cipher,c=s.blockSize,i=n.slice(a,a+c);r.call(this,n,a,c,s),this._prevBlock=i}});function r(n,a,s,c){var i,u=this._iv;u?(i=u.slice(0),this._iv=void 0):i=this._prevBlock,c.encryptBlock(i,0);for(var d=0;d<s;d++)n[a+d]^=i[d]}return e}(),t.mode.CFB})});var Bs=U((Mt,gs)=>{(function(t,e,r){typeof Mt=="object"?gs.exports=Mt=e(G(),se()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(Mt,function(t){return t.mode.CTR=function(){var e=t.lib.BlockCipherMode.extend(),r=e.Encryptor=e.extend({processBlock:function(n,a){var s=this._cipher,c=s.blockSize,i=this._iv,u=this._counter;i&&(u=this._counter=i.slice(0),this._iv=void 0);var d=u.slice(0);s.encryptBlock(d,0),u[c-1]=u[c-1]+1|0;for(var o=0;o<c;o++)n[a+o]^=d[o]}});return e.Decryptor=r,e}(),t.mode.CTR})});var Cs=U((It,bs)=>{(function(t,e,r){typeof It=="object"?bs.exports=It=e(G(),se()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(It,function(t){return t.mode.CTRGladman=function(){var e=t.lib.BlockCipherMode.extend();function r(s){if((s>>24&255)===255){var c=s>>16&255,i=s>>8&255,u=s&255;c===255?(c=0,i===255?(i=0,u===255?u=0:++u):++i):++c,s=0,s+=c<<16,s+=i<<8,s+=u}else s+=1<<24;return s}function n(s){return(s[0]=r(s[0]))===0&&(s[1]=r(s[1])),s}var a=e.Encryptor=e.extend({processBlock:function(s,c){var i=this._cipher,u=i.blockSize,d=this._iv,o=this._counter;d&&(o=this._counter=d.slice(0),this._iv=void 0),n(o);var f=o.slice(0);i.encryptBlock(f,0);for(var x=0;x<u;x++)s[c+x]^=f[x]}});return e.Decryptor=a,e}(),t.mode.CTRGladman})});var Es=U((Ot,As)=>{(function(t,e,r){typeof Ot=="object"?As.exports=Ot=e(G(),se()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(Ot,function(t){return t.mode.OFB=function(){var e=t.lib.BlockCipherMode.extend(),r=e.Encryptor=e.extend({processBlock:function(n,a){var s=this._cipher,c=s.blockSize,i=this._iv,u=this._keystream;i&&(u=this._keystream=i.slice(0),this._iv=void 0),s.encryptBlock(u,0);for(var d=0;d<c;d++)n[a+d]^=u[d]}});return e.Decryptor=r,e}(),t.mode.OFB})});var Ds=U((Lt,_s)=>{(function(t,e,r){typeof Lt=="object"?_s.exports=Lt=e(G(),se()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(Lt,function(t){return t.mode.ECB=function(){var e=t.lib.BlockCipherMode.extend();return e.Encryptor=e.extend({processBlock:function(r,n){this._cipher.encryptBlock(r,n)}}),e.Decryptor=e.extend({processBlock:function(r,n){this._cipher.decryptBlock(r,n)}}),e}(),t.mode.ECB})});var ws=U((Nt,Fs)=>{(function(t,e,r){typeof Nt=="object"?Fs.exports=Nt=e(G(),se()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(Nt,function(t){return t.pad.AnsiX923={pad:function(e,r){var n=e.sigBytes,a=r*4,s=a-n%a,c=n+s-1;e.clamp(),e.words[c>>>2]|=s<<24-c%4*8,e.sigBytes+=s},unpad:function(e){var r=e.words[e.sigBytes-1>>>2]&255;e.sigBytes-=r}},t.pad.Ansix923})});var Ts=U((Ut,Ss)=>{(function(t,e,r){typeof Ut=="object"?Ss.exports=Ut=e(G(),se()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(Ut,function(t){return t.pad.Iso10126={pad:function(e,r){var n=r*4,a=n-e.sigBytes%n;e.concat(t.lib.WordArray.random(a-1)).concat(t.lib.WordArray.create([a<<24],1))},unpad:function(e){var r=e.words[e.sigBytes-1>>>2]&255;e.sigBytes-=r}},t.pad.Iso10126})});var Ps=U((Vt,ks)=>{(function(t,e,r){typeof Vt=="object"?ks.exports=Vt=e(G(),se()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(Vt,function(t){return t.pad.Iso97971={pad:function(e,r){e.concat(t.lib.WordArray.create([2147483648],1)),t.pad.ZeroPadding.pad(e,r)},unpad:function(e){t.pad.ZeroPadding.unpad(e),e.sigBytes--}},t.pad.Iso97971})});var Rs=U((zt,Hs)=>{(function(t,e,r){typeof zt=="object"?Hs.exports=zt=e(G(),se()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(zt,function(t){return t.pad.ZeroPadding={pad:function(e,r){var n=r*4;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){for(var r=e.words,n=e.sigBytes-1,n=e.sigBytes-1;n>=0;n--)if(r[n>>>2]>>>24-n%4*8&255){e.sigBytes=n+1;break}}},t.pad.ZeroPadding})});var Ms=U(($t,qs)=>{(function(t,e,r){typeof $t=="object"?qs.exports=$t=e(G(),se()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})($t,function(t){return t.pad.NoPadding={pad:function(){},unpad:function(){}},t.pad.NoPadding})});var Os=U((Kt,Is)=>{(function(t,e,r){typeof Kt=="object"?Is.exports=Kt=e(G(),se()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(Kt,function(t){return function(e){var r=t,n=r.lib,a=n.CipherParams,s=r.enc,c=s.Hex,i=r.format,u=i.Hex={stringify:function(d){return d.ciphertext.toString(c)},parse:function(d){var o=c.parse(d);return a.create({ciphertext:o})}}}(),t.format.Hex})});var Ns=U((Gt,Ls)=>{(function(t,e,r){typeof Gt=="object"?Ls.exports=Gt=e(G(),$e(),Ke(),qe(),se()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(t.CryptoJS)})(Gt,function(t){return function(){var e=t,r=e.lib,n=r.BlockCipher,a=e.algo,s=[],c=[],i=[],u=[],d=[],o=[],f=[],x=[],h=[],y=[];(function(){for(var l=[],p=0;p<256;p++)p<128?l[p]=p<<1:l[p]=p<<1^283;for(var b=0,B=0,p=0;p<256;p++){var C=B^B<<1^B<<2^B<<3^B<<4;C=C>>>8^C&255^99,s[b]=C,c[C]=b;var m=l[b],S=l[m],T=l[S],R=l[C]*257^C*16843008;i[b]=R<<24|R>>>8,u[b]=R<<16|R>>>16,d[b]=R<<8|R>>>24,o[b]=R;var R=T*16843009^S*65537^m*257^b*16843008;f[C]=R<<24|R>>>8,x[C]=R<<16|R>>>16,h[C]=R<<8|R>>>24,y[C]=R,b?(b=m^l[l[l[T^m]]],B^=l[l[B]]):b=B=1}})();var g=[0,1,2,4,8,16,32,64,128,27,54],v=a.AES=n.extend({_doReset:function(){var l;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var p=this._keyPriorReset=this._key,b=p.words,B=p.sigBytes/4,C=this._nRounds=B+6,m=(C+1)*4,S=this._keySchedule=[],T=0;T<m;T++)T<B?S[T]=b[T]:(l=S[T-1],T%B?B>6&&T%B==4&&(l=s[l>>>24]<<24|s[l>>>16&255]<<16|s[l>>>8&255]<<8|s[l&255]):(l=l<<8|l>>>24,l=s[l>>>24]<<24|s[l>>>16&255]<<16|s[l>>>8&255]<<8|s[l&255],l^=g[T/B|0]<<24),S[T]=S[T-B]^l);for(var R=this._invKeySchedule=[],q=0;q<m;q++){var T=m-q;if(q%4)var l=S[T];else var l=S[T-4];q<4||T<=4?R[q]=l:R[q]=f[s[l>>>24]]^x[s[l>>>16&255]]^h[s[l>>>8&255]]^y[s[l&255]]}}},encryptBlock:function(l,p){this._doCryptBlock(l,p,this._keySchedule,i,u,d,o,s)},decryptBlock:function(l,p){var b=l[p+1];l[p+1]=l[p+3],l[p+3]=b,this._doCryptBlock(l,p,this._invKeySchedule,f,x,h,y,c);var b=l[p+1];l[p+1]=l[p+3],l[p+3]=b},_doCryptBlock:function(l,p,b,B,C,m,S,T){for(var R=this._nRounds,q=l[p]^b[0],E=l[p+1]^b[1],A=l[p+2]^b[2],H=l[p+3]^b[3],w=4,V=1;V<R;V++){var I=B[q>>>24]^C[E>>>16&255]^m[A>>>8&255]^S[H&255]^b[w++],z=B[E>>>24]^C[A>>>16&255]^m[H>>>8&255]^S[q&255]^b[w++],$=B[A>>>24]^C[H>>>16&255]^m[q>>>8&255]^S[E&255]^b[w++],D=B[H>>>24]^C[q>>>16&255]^m[E>>>8&255]^S[A&255]^b[w++];q=I,E=z,A=$,H=D}var I=(T[q>>>24]<<24|T[E>>>16&255]<<16|T[A>>>8&255]<<8|T[H&255])^b[w++],z=(T[E>>>24]<<24|T[A>>>16&255]<<16|T[H>>>8&255]<<8|T[q&255])^b[w++],$=(T[A>>>24]<<24|T[H>>>16&255]<<16|T[q>>>8&255]<<8|T[E&255])^b[w++],D=(T[H>>>24]<<24|T[q>>>16&255]<<16|T[E>>>8&255]<<8|T[A&255])^b[w++];l[p]=I,l[p+1]=z,l[p+2]=$,l[p+3]=D},keySize:256/32});e.AES=n._createHelper(v)}(),t.AES})});var Vs=U((jt,Us)=>{(function(t,e,r){typeof jt=="object"?Us.exports=jt=e(G(),$e(),Ke(),qe(),se()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(t.CryptoJS)})(jt,function(t){return function(){var e=t,r=e.lib,n=r.WordArray,a=r.BlockCipher,s=e.algo,c=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],i=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],d=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],o=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],f=s.DES=a.extend({_doReset:function(){for(var g=this._key,v=g.words,l=[],p=0;p<56;p++){var b=c[p]-1;l[p]=v[b>>>5]>>>31-b%32&1}for(var B=this._subKeys=[],C=0;C<16;C++){for(var m=B[C]=[],S=u[C],p=0;p<24;p++)m[p/6|0]|=l[(i[p]-1+S)%28]<<31-p%6,m[4+(p/6|0)]|=l[28+(i[p+24]-1+S)%28]<<31-p%6;m[0]=m[0]<<1|m[0]>>>31;for(var p=1;p<7;p++)m[p]=m[p]>>>(p-1)*4+3;m[7]=m[7]<<5|m[7]>>>27}for(var T=this._invSubKeys=[],p=0;p<16;p++)T[p]=B[15-p]},encryptBlock:function(g,v){this._doCryptBlock(g,v,this._subKeys)},decryptBlock:function(g,v){this._doCryptBlock(g,v,this._invSubKeys)},_doCryptBlock:function(g,v,l){this._lBlock=g[v],this._rBlock=g[v+1],x.call(this,4,252645135),x.call(this,16,65535),h.call(this,2,858993459),h.call(this,8,16711935),x.call(this,1,1431655765);for(var p=0;p<16;p++){for(var b=l[p],B=this._lBlock,C=this._rBlock,m=0,S=0;S<8;S++)m|=d[S][((C^b[S])&o[S])>>>0];this._lBlock=C,this._rBlock=B^m}var T=this._lBlock;this._lBlock=this._rBlock,this._rBlock=T,x.call(this,1,1431655765),h.call(this,8,16711935),h.call(this,2,858993459),x.call(this,16,65535),x.call(this,4,252645135),g[v]=this._lBlock,g[v+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function x(g,v){var l=(this._lBlock>>>g^this._rBlock)&v;this._rBlock^=l,this._lBlock^=l<<g}function h(g,v){var l=(this._rBlock>>>g^this._lBlock)&v;this._lBlock^=l,this._rBlock^=l<<g}e.DES=a._createHelper(f);var y=s.TripleDES=a.extend({_doReset:function(){var g=this._key,v=g.words;if(v.length!==2&&v.length!==4&&v.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var l=v.slice(0,2),p=v.length<4?v.slice(0,2):v.slice(2,4),b=v.length<6?v.slice(0,2):v.slice(4,6);this._des1=f.createEncryptor(n.create(l)),this._des2=f.createEncryptor(n.create(p)),this._des3=f.createEncryptor(n.create(b))},encryptBlock:function(g,v){this._des1.encryptBlock(g,v),this._des2.decryptBlock(g,v),this._des3.encryptBlock(g,v)},decryptBlock:function(g,v){this._des3.decryptBlock(g,v),this._des2.encryptBlock(g,v),this._des1.decryptBlock(g,v)},keySize:192/32,ivSize:64/32,blockSize:64/32});e.TripleDES=a._createHelper(y)}(),t.TripleDES})});var $s=U((Wt,zs)=>{(function(t,e,r){typeof Wt=="object"?zs.exports=Wt=e(G(),$e(),Ke(),qe(),se()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(t.CryptoJS)})(Wt,function(t){return function(){var e=t,r=e.lib,n=r.StreamCipher,a=e.algo,s=a.RC4=n.extend({_doReset:function(){for(var u=this._key,d=u.words,o=u.sigBytes,f=this._S=[],x=0;x<256;x++)f[x]=x;for(var x=0,h=0;x<256;x++){var y=x%o,g=d[y>>>2]>>>24-y%4*8&255;h=(h+f[x]+g)%256;var v=f[x];f[x]=f[h],f[h]=v}this._i=this._j=0},_doProcessBlock:function(u,d){u[d]^=c.call(this)},keySize:256/32,ivSize:0});function c(){for(var u=this._S,d=this._i,o=this._j,f=0,x=0;x<4;x++){d=(d+1)%256,o=(o+u[d])%256;var h=u[d];u[d]=u[o],u[o]=h,f|=u[(u[d]+u[o])%256]<<24-x*8}return this._i=d,this._j=o,f}e.RC4=n._createHelper(s);var i=a.RC4Drop=s.extend({cfg:s.cfg.extend({drop:192}),_doReset:function(){s._doReset.call(this);for(var u=this.cfg.drop;u>0;u--)c.call(this)}});e.RC4Drop=n._createHelper(i)}(),t.RC4})});var Gs=U((Xt,Ks)=>{(function(t,e,r){typeof Xt=="object"?Ks.exports=Xt=e(G(),$e(),Ke(),qe(),se()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(t.CryptoJS)})(Xt,function(t){return function(){var e=t,r=e.lib,n=r.StreamCipher,a=e.algo,s=[],c=[],i=[],u=a.Rabbit=n.extend({_doReset:function(){for(var o=this._key.words,f=this.cfg.iv,x=0;x<4;x++)o[x]=(o[x]<<8|o[x]>>>24)&16711935|(o[x]<<24|o[x]>>>8)&4278255360;var h=this._X=[o[0],o[3]<<16|o[2]>>>16,o[1],o[0]<<16|o[3]>>>16,o[2],o[1]<<16|o[0]>>>16,o[3],o[2]<<16|o[1]>>>16],y=this._C=[o[2]<<16|o[2]>>>16,o[0]&4294901760|o[1]&65535,o[3]<<16|o[3]>>>16,o[1]&4294901760|o[2]&65535,o[0]<<16|o[0]>>>16,o[2]&4294901760|o[3]&65535,o[1]<<16|o[1]>>>16,o[3]&4294901760|o[0]&65535];this._b=0;for(var x=0;x<4;x++)d.call(this);for(var x=0;x<8;x++)y[x]^=h[x+4&7];if(f){var g=f.words,v=g[0],l=g[1],p=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,b=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360,B=p>>>16|b&4294901760,C=b<<16|p&65535;y[0]^=p,y[1]^=B,y[2]^=b,y[3]^=C,y[4]^=p,y[5]^=B,y[6]^=b,y[7]^=C;for(var x=0;x<4;x++)d.call(this)}},_doProcessBlock:function(o,f){var x=this._X;d.call(this),s[0]=x[0]^x[5]>>>16^x[3]<<16,s[1]=x[2]^x[7]>>>16^x[5]<<16,s[2]=x[4]^x[1]>>>16^x[7]<<16,s[3]=x[6]^x[3]>>>16^x[1]<<16;for(var h=0;h<4;h++)s[h]=(s[h]<<8|s[h]>>>24)&16711935|(s[h]<<24|s[h]>>>8)&4278255360,o[f+h]^=s[h]},blockSize:128/32,ivSize:64/32});function d(){for(var o=this._X,f=this._C,x=0;x<8;x++)c[x]=f[x];f[0]=f[0]+1295307597+this._b|0,f[1]=f[1]+3545052371+(f[0]>>>0<c[0]>>>0?1:0)|0,f[2]=f[2]+886263092+(f[1]>>>0<c[1]>>>0?1:0)|0,f[3]=f[3]+1295307597+(f[2]>>>0<c[2]>>>0?1:0)|0,f[4]=f[4]+3545052371+(f[3]>>>0<c[3]>>>0?1:0)|0,f[5]=f[5]+886263092+(f[4]>>>0<c[4]>>>0?1:0)|0,f[6]=f[6]+1295307597+(f[5]>>>0<c[5]>>>0?1:0)|0,f[7]=f[7]+3545052371+(f[6]>>>0<c[6]>>>0?1:0)|0,this._b=f[7]>>>0<c[7]>>>0?1:0;for(var x=0;x<8;x++){var h=o[x]+f[x],y=h&65535,g=h>>>16,v=((y*y>>>17)+y*g>>>15)+g*g,l=((h&4294901760)*h|0)+((h&65535)*h|0);i[x]=v^l}o[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,o[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,o[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,o[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,o[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,o[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,o[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,o[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}e.Rabbit=n._createHelper(u)}(),t.Rabbit})});var Ws=U((Zt,js)=>{(function(t,e,r){typeof Zt=="object"?js.exports=Zt=e(G(),$e(),Ke(),qe(),se()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(t.CryptoJS)})(Zt,function(t){return function(){var e=t,r=e.lib,n=r.StreamCipher,a=e.algo,s=[],c=[],i=[],u=a.RabbitLegacy=n.extend({_doReset:function(){var o=this._key.words,f=this.cfg.iv,x=this._X=[o[0],o[3]<<16|o[2]>>>16,o[1],o[0]<<16|o[3]>>>16,o[2],o[1]<<16|o[0]>>>16,o[3],o[2]<<16|o[1]>>>16],h=this._C=[o[2]<<16|o[2]>>>16,o[0]&4294901760|o[1]&65535,o[3]<<16|o[3]>>>16,o[1]&4294901760|o[2]&65535,o[0]<<16|o[0]>>>16,o[2]&4294901760|o[3]&65535,o[1]<<16|o[1]>>>16,o[3]&4294901760|o[0]&65535];this._b=0;for(var y=0;y<4;y++)d.call(this);for(var y=0;y<8;y++)h[y]^=x[y+4&7];if(f){var g=f.words,v=g[0],l=g[1],p=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,b=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360,B=p>>>16|b&4294901760,C=b<<16|p&65535;h[0]^=p,h[1]^=B,h[2]^=b,h[3]^=C,h[4]^=p,h[5]^=B,h[6]^=b,h[7]^=C;for(var y=0;y<4;y++)d.call(this)}},_doProcessBlock:function(o,f){var x=this._X;d.call(this),s[0]=x[0]^x[5]>>>16^x[3]<<16,s[1]=x[2]^x[7]>>>16^x[5]<<16,s[2]=x[4]^x[1]>>>16^x[7]<<16,s[3]=x[6]^x[3]>>>16^x[1]<<16;for(var h=0;h<4;h++)s[h]=(s[h]<<8|s[h]>>>24)&16711935|(s[h]<<24|s[h]>>>8)&4278255360,o[f+h]^=s[h]},blockSize:128/32,ivSize:64/32});function d(){for(var o=this._X,f=this._C,x=0;x<8;x++)c[x]=f[x];f[0]=f[0]+1295307597+this._b|0,f[1]=f[1]+3545052371+(f[0]>>>0<c[0]>>>0?1:0)|0,f[2]=f[2]+886263092+(f[1]>>>0<c[1]>>>0?1:0)|0,f[3]=f[3]+1295307597+(f[2]>>>0<c[2]>>>0?1:0)|0,f[4]=f[4]+3545052371+(f[3]>>>0<c[3]>>>0?1:0)|0,f[5]=f[5]+886263092+(f[4]>>>0<c[4]>>>0?1:0)|0,f[6]=f[6]+1295307597+(f[5]>>>0<c[5]>>>0?1:0)|0,f[7]=f[7]+3545052371+(f[6]>>>0<c[6]>>>0?1:0)|0,this._b=f[7]>>>0<c[7]>>>0?1:0;for(var x=0;x<8;x++){var h=o[x]+f[x],y=h&65535,g=h>>>16,v=((y*y>>>17)+y*g>>>15)+g*g,l=((h&4294901760)*h|0)+((h&65535)*h|0);i[x]=v^l}o[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,o[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,o[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,o[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,o[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,o[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,o[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,o[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}e.RabbitLegacy=n._createHelper(u)}(),t.RabbitLegacy})});var Zs=U((Yt,Xs)=>{(function(t,e,r){typeof Yt=="object"?Xs.exports=Yt=e(G(),$e(),Ke(),qe(),se()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(t.CryptoJS)})(Yt,function(t){return function(){var e=t,r=e.lib,n=r.BlockCipher,a=e.algo;let s=16,c=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],i=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var u={pbox:[],sbox:[]};function d(y,g){let v=g>>24&255,l=g>>16&255,p=g>>8&255,b=g&255,B=y.sbox[0][v]+y.sbox[1][l];return B=B^y.sbox[2][p],B=B+y.sbox[3][b],B}function o(y,g,v){let l=g,p=v,b;for(let B=0;B<s;++B)l=l^y.pbox[B],p=d(y,l)^p,b=l,l=p,p=b;return b=l,l=p,p=b,p=p^y.pbox[s],l=l^y.pbox[s+1],{left:l,right:p}}function f(y,g,v){let l=g,p=v,b;for(let B=s+1;B>1;--B)l=l^y.pbox[B],p=d(y,l)^p,b=l,l=p,p=b;return b=l,l=p,p=b,p=p^y.pbox[1],l=l^y.pbox[0],{left:l,right:p}}function x(y,g,v){for(let C=0;C<4;C++){y.sbox[C]=[];for(let m=0;m<256;m++)y.sbox[C][m]=i[C][m]}let l=0;for(let C=0;C<s+2;C++)y.pbox[C]=c[C]^g[l],l++,l>=v&&(l=0);let p=0,b=0,B=0;for(let C=0;C<s+2;C+=2)B=o(y,p,b),p=B.left,b=B.right,y.pbox[C]=p,y.pbox[C+1]=b;for(let C=0;C<4;C++)for(let m=0;m<256;m+=2)B=o(y,p,b),p=B.left,b=B.right,y.sbox[C][m]=p,y.sbox[C][m+1]=b;return!0}var h=a.Blowfish=n.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var y=this._keyPriorReset=this._key,g=y.words,v=y.sigBytes/4;x(u,g,v)}},encryptBlock:function(y,g){var v=o(u,y[g],y[g+1]);y[g]=v.left,y[g+1]=v.right},decryptBlock:function(y,g){var v=f(u,y[g],y[g+1]);y[g]=v.left,y[g+1]=v.right},blockSize:64/32,keySize:128/32,ivSize:64/32});e.Blowfish=n._createHelper(h)}(),t.Blowfish})});var Lr=U((Jt,Ys)=>{(function(t,e,r){typeof Jt=="object"?Ys.exports=Jt=e(G(),U0(),Wn(),Zn(),$e(),Qn(),Ke(),Ir(),y0(),ss(),Or(),os(),us(),fs(),V0(),hs(),qe(),se(),ms(),Bs(),Cs(),Es(),Ds(),ws(),Ts(),Ps(),Rs(),Ms(),Os(),Ns(),Vs(),$s(),Gs(),Ws(),Zs()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./lib-typedarrays","./enc-utf16","./enc-base64","./enc-base64url","./md5","./sha1","./sha256","./sha224","./sha512","./sha384","./sha3","./ripemd160","./hmac","./pbkdf2","./evpkdf","./cipher-core","./mode-cfb","./mode-ctr","./mode-ctr-gladman","./mode-ofb","./mode-ecb","./pad-ansix923","./pad-iso10126","./pad-iso97971","./pad-zeropadding","./pad-nopadding","./format-hex","./aes","./tripledes","./rc4","./rabbit","./rabbit-legacy","./blowfish"],e):t.CryptoJS=e(t.CryptoJS)})(Jt,function(t){return t})});var er=U(Qt=>{"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});Qt.ChannelCrypto=void 0;var he=Lr(),v0=ie(),Nr=class{static decryptGroupTextMessage(e,r,n){try{let a=(0,v0.hexToBytes)(n),s=(0,v0.hexToBytes)(r),c=new Uint8Array(32);c.set(a,0);let i=(0,he.HmacSHA256)(he.enc.Hex.parse(e),he.enc.Hex.parse((0,v0.bytesToHex)(c))),d=(0,v0.hexToBytes)(i.toString(he.enc.Hex)).slice(0,2);if(d[0]!==s[0]||d[1]!==s[1])return{success:!1,error:"MAC verification failed"};let o=he.enc.Hex.parse(n),f=he.enc.Hex.parse(e),x=he.AES.decrypt(he.lib.CipherParams.create({ciphertext:f}),o,{mode:he.mode.ECB,padding:he.pad.NoPadding}),h=(0,v0.hexToBytes)(x.toString(he.enc.Hex));if(!h||h.length<5)return{success:!1,error:"Decrypted content too short"};let y=h[0]|h[1]<<8|h[2]<<16|h[3]<<24,g=h[4],v=h.slice(5),p=new TextDecoder("utf-8").decode(v),b=p.indexOf("\0");b>=0&&(p=p.substring(0,b));let B=p.indexOf(": "),C,m;if(B>0&&B<50){let S=p.substring(0,B);/[:\[\]]/.test(S)?m=p:(C=S,m=p.substring(B+2))}else m=p;return{success:!0,data:{timestamp:y,flags:g,sender:C,message:m}}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Decryption failed"}}}static calculateChannelHash(e){let r=(0,he.SHA256)(he.enc.Hex.parse(e));return(0,v0.hexToBytes)(r.toString(he.enc.Hex))[0].toString(16).padStart(2,"0")}};Qt.ChannelCrypto=Nr});var Vr=U(tr=>{"use strict";Object.defineProperty(tr,"__esModule",{value:!0});tr.MeshCoreKeyStore=void 0;var yi=er(),Ur=class{constructor(e){this.nodeKeys=new Map,this.channelHashToKeys=new Map,e?.channelSecrets&&this.addChannelSecrets(e.channelSecrets),e?.nodeKeys&&Object.entries(e.nodeKeys).forEach(([r,n])=>{this.addNodeKey(r,n)})}addNodeKey(e,r){let n=e.toUpperCase();this.nodeKeys.set(n,r)}hasChannelKey(e){let r=e.toLowerCase();return this.channelHashToKeys.has(r)}hasNodeKey(e){let r=e.toUpperCase();return this.nodeKeys.has(r)}getChannelKeys(e){let r=e.toLowerCase();return this.channelHashToKeys.get(r)||[]}getNodeKey(e){let r=e.toUpperCase();return this.nodeKeys.get(r)}addChannelSecrets(e){for(let r of e){let n=yi.ChannelCrypto.calculateChannelHash(r).toLowerCase();this.channelHashToKeys.has(n)||this.channelHashToKeys.set(n,[]),this.channelHashToKeys.get(n).push(r)}}};tr.MeshCoreKeyStore=Ur});var ga={};ai(ga,{CURVE:()=>aa,ExtendedPoint:()=>we,Point:()=>we,etc:()=>rn,getPublicKey:()=>_i,getPublicKeyAsync:()=>Ei,sign:()=>Fi,signAsync:()=>Di,utils:()=>Ti,verify:()=>Si,verifyAsync:()=>wi});var aa,ue,rr,Js,Qs,zr,$r,vi,Fe,z0,ve,mi,ia,gi,i0,ir,jr,oa,Wr,Me,ea,Xr,Ge,ca,Bi,$0,ua,nr,a0,O,xa,fa,bi,ta,Kr,De,we,Ie,m0,da,Zr,_e,Ci,ra,Ai,sr,Yr,Jr,la,Qr,en,Ei,_i,ha,pa,ya,Di,Fi,tn,va,wi,Si,rn,Ti,ar,ki,ma,Gr,Pi,na,sa,Hi,Ba=si(()=>{aa={p:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffedn,n:0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3edn,h:8n,a:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffecn,d:0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3n,Gx:0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,Gy:0x6666666666666666666666666666666666666666666666666666666666666658n},{p:ue,n:rr,Gx:Js,Gy:Qs,a:zr,d:$r}=aa,vi=8n,Fe=32,z0=64,ve=(t="")=>{throw new Error(t)},mi=t=>typeof t=="bigint",ia=t=>typeof t=="string",gi=t=>t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array",i0=(t,e)=>!gi(t)||typeof e=="number"&&e>0&&t.length!==e?ve("Uint8Array expected"):t,ir=t=>new Uint8Array(t),jr=t=>Uint8Array.from(t),oa=(t,e)=>t.toString(16).padStart(e,"0"),Wr=t=>Array.from(i0(t)).map(e=>oa(e,2)).join(""),Me={_0:48,_9:57,A:65,F:70,a:97,f:102},ea=t=>{if(t>=Me._0&&t<=Me._9)return t-Me._0;if(t>=Me.A&&t<=Me.F)return t-(Me.A-10);if(t>=Me.a&&t<=Me.f)return t-(Me.a-10)},Xr=t=>{let e="hex invalid";if(!ia(t))return ve(e);let r=t.length,n=r/2;if(r%2)return ve(e);let a=ir(n);for(let s=0,c=0;s<n;s++,c+=2){let i=ea(t.charCodeAt(c)),u=ea(t.charCodeAt(c+1));if(i===void 0||u===void 0)return ve(e);a[s]=i*16+u}return a},Ge=(t,e)=>i0(ia(t)?Xr(t):jr(i0(t)),e),ca=()=>globalThis?.crypto,Bi=()=>ca()?.subtle??ve("crypto.subtle must be defined"),$0=(...t)=>{let e=ir(t.reduce((n,a)=>n+i0(a).length,0)),r=0;return t.forEach(n=>{e.set(n,r),r+=n.length}),e},ua=(t=Fe)=>ca().getRandomValues(ir(t)),nr=BigInt,a0=(t,e,r,n="bad number: out of range")=>mi(t)&&e<=t&&t<r?t:ve(n),O=(t,e=ue)=>{let r=t%e;return r>=0n?r:e+r},xa=t=>O(t,rr),fa=(t,e)=>{(t===0n||e<=0n)&&ve("no inverse n="+t+" mod="+e);let r=O(t,e),n=e,a=0n,s=1n,c=1n,i=0n;for(;r!==0n;){let u=n/r,d=n%r,o=a-c*u,f=s-i*u;n=r,r=d,a=c,s=i,c=o,i=f}return n===1n?O(a,e):ve("no inverse")},bi=t=>{let e=rn[t];return typeof e!="function"&&ve("hashes."+t+" not set"),e},ta=t=>t instanceof we?t:ve("Point expected"),Kr=2n**256n,De=class De{constructor(e,r,n,a){Re(this,"ex");Re(this,"ey");Re(this,"ez");Re(this,"et");let s=Kr;this.ex=a0(e,0n,s),this.ey=a0(r,0n,s),this.ez=a0(n,1n,s),this.et=a0(a,0n,s),Object.freeze(this)}static fromAffine(e){return new De(e.x,e.y,1n,O(e.x*e.y))}static fromBytes(e,r=!1){let n=$r,a=jr(i0(e,Fe)),s=e[31];a[31]=s&-129;let c=Zr(a);a0(c,0n,r?Kr:ue);let u=O(c*c),d=O(u-1n),o=O(n*u+1n),{isValid:f,value:x}=Ai(d,o);f||ve("bad point: y not sqrt");let h=(x&1n)===1n,y=(s&128)!==0;return!r&&x===0n&&y&&ve("bad point: x==0, isLastByteOdd"),y!==h&&(x=O(-x)),new De(x,c,1n,O(x*c))}assertValidity(){let e=zr,r=$r,n=this;if(n.is0())throw new Error("bad point: ZERO");let{ex:a,ey:s,ez:c,et:i}=n,u=O(a*a),d=O(s*s),o=O(c*c),f=O(o*o),x=O(u*e),h=O(o*O(x+d)),y=O(f+O(r*O(u*d)));if(h!==y)throw new Error("bad point: equation left != right (1)");let g=O(a*s),v=O(c*i);if(g!==v)throw new Error("bad point: equation left != right (2)");return this}equals(e){let{ex:r,ey:n,ez:a}=this,{ex:s,ey:c,ez:i}=ta(e),u=O(r*i),d=O(s*a),o=O(n*i),f=O(c*a);return u===d&&o===f}is0(){return this.equals(m0)}negate(){return new De(O(-this.ex),this.ey,this.ez,O(-this.et))}double(){let{ex:e,ey:r,ez:n}=this,a=zr,s=O(e*e),c=O(r*r),i=O(2n*O(n*n)),u=O(a*s),d=e+r,o=O(O(d*d)-s-c),f=u+c,x=f-i,h=u-c,y=O(o*x),g=O(f*h),v=O(o*h),l=O(x*f);return new De(y,g,l,v)}add(e){let{ex:r,ey:n,ez:a,et:s}=this,{ex:c,ey:i,ez:u,et:d}=ta(e),o=zr,f=$r,x=O(r*c),h=O(n*i),y=O(s*f*d),g=O(a*u),v=O((r+n)*(c+i)-x-h),l=O(g-y),p=O(g+y),b=O(h-o*x),B=O(v*l),C=O(p*b),m=O(v*b),S=O(l*p);return new De(B,C,S,m)}multiply(e,r=!0){if(!r&&(e===0n||this.is0()))return m0;if(a0(e,1n,rr),e===1n)return this;if(this.equals(Ie))return Hi(e).p;let n=m0,a=Ie;for(let s=this;e>0n;s=s.double(),e>>=1n)e&1n?n=n.add(s):r&&(a=a.add(s));return n}toAffine(){let{ex:e,ey:r,ez:n}=this;if(this.equals(m0))return{x:0n,y:1n};let a=fa(n,ue);return O(n*a)!==1n&&ve("invalid inverse"),{x:O(e*a),y:O(r*a)}}toBytes(){let{x:e,y:r}=this.assertValidity().toAffine(),n=da(r);return n[31]|=e&1n?128:0,n}toHex(){return Wr(this.toBytes())}clearCofactor(){return this.multiply(nr(vi),!1)}isSmallOrder(){return this.clearCofactor().is0()}isTorsionFree(){let e=this.multiply(rr/2n,!1).double();return rr%2n&&(e=e.add(this)),e.is0()}static fromHex(e,r){return De.fromBytes(Ge(e),r)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}toRawBytes(){return this.toBytes()}};Re(De,"BASE"),Re(De,"ZERO");we=De,Ie=new we(Js,Qs,1n,O(Js*Qs)),m0=new we(0n,1n,1n,0n);we.BASE=Ie;we.ZERO=m0;da=t=>Xr(oa(a0(t,0n,Kr),z0)).reverse(),Zr=t=>nr("0x"+Wr(jr(i0(t)).reverse())),_e=(t,e)=>{let r=t;for(;e-- >0n;)r*=r,r%=ue;return r},Ci=t=>{let r=t*t%ue*t%ue,n=_e(r,2n)*r%ue,a=_e(n,1n)*t%ue,s=_e(a,5n)*a%ue,c=_e(s,10n)*s%ue,i=_e(c,20n)*c%ue,u=_e(i,40n)*i%ue,d=_e(u,80n)*u%ue,o=_e(d,80n)*u%ue,f=_e(o,10n)*s%ue;return{pow_p_5_8:_e(f,2n)*t%ue,b2:r}},ra=0x2b8324804fc1df0b2b4d00993dfbd7a72f431806ad2fe478c4ee1b274a0ea0b0n,Ai=(t,e)=>{let r=O(e*e*e),n=O(r*r*e),a=Ci(t*n).pow_p_5_8,s=O(t*r*a),c=O(e*s*s),i=s,u=O(s*ra),d=c===t,o=c===O(-t),f=c===O(-t*ra);return d&&(s=i),(o||f)&&(s=u),(O(s)&1n)===1n&&(s=O(-s)),{isValid:d||o,value:s}},sr=t=>xa(Zr(t)),Yr=(...t)=>rn.sha512Async(...t),Jr=(...t)=>bi("sha512Sync")(...t),la=t=>{let e=t.slice(0,Fe);e[0]&=248,e[31]&=127,e[31]|=64;let r=t.slice(Fe,z0),n=sr(e),a=Ie.multiply(n),s=a.toBytes();return{head:e,prefix:r,scalar:n,point:a,pointBytes:s}},Qr=t=>Yr(Ge(t,Fe)).then(la),en=t=>la(Jr(Ge(t,Fe))),Ei=t=>Qr(t).then(e=>e.pointBytes),_i=t=>en(t).pointBytes,ha=t=>Yr(t.hashable).then(t.finish),pa=t=>t.finish(Jr(t.hashable)),ya=(t,e,r)=>{let{pointBytes:n,scalar:a}=t,s=sr(e),c=Ie.multiply(s).toBytes();return{hashable:$0(c,n,r),finish:d=>{let o=xa(s+sr(d)*a);return i0($0(c,da(o)),z0)}}},Di=async(t,e)=>{let r=Ge(t),n=await Qr(e),a=await Yr(n.prefix,r);return ha(ya(n,a,r))},Fi=(t,e)=>{let r=Ge(t),n=en(e),a=Jr(n.prefix,r);return pa(ya(n,a,r))},tn={zip215:!0},va=(t,e,r,n=tn)=>{t=Ge(t,z0),e=Ge(e),r=Ge(r,Fe);let{zip215:a}=n,s,c,i,u,d=Uint8Array.of();try{s=we.fromHex(r,a),c=we.fromHex(t.slice(0,Fe),a),i=Zr(t.slice(Fe,z0)),u=Ie.multiply(i,!1),d=$0(c.toBytes(),s.toBytes(),e)}catch{}return{hashable:d,finish:f=>{if(u==null||!a&&s.isSmallOrder())return!1;let x=sr(f);return c.add(s.multiply(x,!1)).add(u.negate()).clearCofactor().is0()}}},wi=async(t,e,r,n=tn)=>ha(va(t,e,r,n)),Si=(t,e,r,n=tn)=>pa(va(t,e,r,n)),rn={sha512Async:async(...t)=>{let e=Bi(),r=$0(...t);return ir(await e.digest("SHA-512",r.buffer))},sha512Sync:void 0,bytesToHex:Wr,hexToBytes:Xr,concatBytes:$0,mod:O,invert:fa,randomBytes:ua},Ti={getExtendedPublicKeyAsync:Qr,getExtendedPublicKey:en,randomPrivateKey:()=>ua(Fe),precompute:(t=8,e=Ie)=>(e.multiply(3n),e)},ar=8,ki=256,ma=Math.ceil(ki/ar)+1,Gr=2**(ar-1),Pi=()=>{let t=[],e=Ie,r=e;for(let n=0;n<ma;n++){r=e,t.push(r);for(let a=1;a<Gr;a++)r=r.add(e),t.push(r);e=r.double()}return t},sa=(t,e)=>{let r=e.negate();return t?r:e},Hi=t=>{let e=na||(na=Pi()),r=m0,n=Ie,a=2**ar,s=a,c=nr(a-1),i=nr(ar);for(let u=0;u<ma;u++){let d=Number(t&c);t>>=i,d>Gr&&(d-=s,t+=1n);let o=u*Gr,f=o,x=o+Math.abs(d)-1,h=u%2!==0,y=d<0;d===0?n=n.add(sa(h,e[f])):r=r.add(sa(y,e[x]))}return{p:r,f:n}}});var ba=U(()=>{});var Aa=U((Ca,or)=>{var nn=(()=>{var t=typeof document<"u"?document.currentScript?.src:void 0;return async function(e={}){var r,n=e,a=typeof window=="object",s=typeof WorkerGlobalScope<"u",c=typeof process=="object"&&process.versions?.node&&process.type!="renderer",i=[],u="./this.program",d=(_,M)=>{throw M};typeof __filename<"u"?t=__filename:s&&(t=self.location.href);var o="";function f(_){return n.locateFile?n.locateFile(_,o):o+_}var x,h;if(c){var y=ba();o=__dirname+"/",h=_=>{_=b(_)?new URL(_):_;var M=y.readFileSync(_);return M},x=async(_,M=!0)=>{_=b(_)?new URL(_):_;var L=y.readFileSync(_,M?void 0:"utf8");return L},process.argv.length>1&&(u=process.argv[1].replace(/\\/g,"/")),i=process.argv.slice(2),d=(_,M)=>{throw process.exitCode=_,M}}else if(a||s){try{o=new URL(".",t).href}catch{}s&&(h=_=>{var M=new XMLHttpRequest;return M.open("GET",_,!1),M.responseType="arraybuffer",M.send(null),new Uint8Array(M.response)}),x=async _=>{if(b(_))return new Promise((L,j)=>{var Y=new XMLHttpRequest;Y.open("GET",_,!0),Y.responseType="arraybuffer",Y.onload=()=>{if(Y.status==200||Y.status==0&&Y.response){L(Y.response);return}j(Y.status)},Y.onerror=j,Y.send(null)});var M=await fetch(_,{credentials:"same-origin"});if(M.ok)return M.arrayBuffer();throw new Error(M.status+" : "+M.url)}}var g=console.log.bind(console),v=console.error.bind(console),l,p=!1,b=_=>_.startsWith("file://"),B,C,m,S,T,R,q,E,A,H,w,V,I,z=!1;function $(){var _=m.buffer;n.HEAP8=S=new Int8Array(_),R=new Int16Array(_),n.HEAPU8=T=new Uint8Array(_),q=new Uint16Array(_),n.HEAP32=E=new Int32Array(_),n.HEAPU32=A=new Uint32Array(_),H=new Float32Array(_),w=new Float64Array(_),V=new BigInt64Array(_),I=new BigUint64Array(_)}function D(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)de(n.preRun.shift());Ue(fe)}function k(){z=!0,r0.b()}function P(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)Qe(n.postRun.shift());Ue(d0)}var F=0,X=null;function J(_){F++,n.monitorRunDependencies?.(F)}function oe(_){if(F--,n.monitorRunDependencies?.(F),F==0&&X){var M=X;X=null,M()}}function K(_){n.onAbort?.(_),_="Aborted("+_+")",v(_),p=!0,_+=". Build with -sASSERTIONS for more info.";var M=new WebAssembly.RuntimeError(_);throw C?.(M),M}var ke;function Ne(){return f("orlp-ed25519.wasm")}function H0(_){if(_==ke&&l)return new Uint8Array(l);if(h)return h(_);throw"both async and sync fetching of the wasm failed"}async function Ye(_){if(!l)try{var M=await x(_);return new Uint8Array(M)}catch{}return H0(_)}async function pe(_,M){try{var L=await Ye(_),j=await WebAssembly.instantiate(L,M);return j}catch(Y){v(`failed to asynchronously prepare wasm: ${Y}`),K(Y)}}async function xe(_,M,L){if(!_&&typeof WebAssembly.instantiateStreaming=="function"&&!b(M)&&!c)try{var j=fetch(M,{credentials:"same-origin"}),Y=await WebAssembly.instantiateStreaming(j,L);return Y}catch(ee){v(`wasm streaming compile failed: ${ee}`),v("falling back to ArrayBuffer instantiation")}return pe(M,L)}function f0(){return{a:ht}}async function Je(){function _(ee,Q){return r0=ee.exports,m=r0.a,$(),qr(r0),oe("wasm-instantiate"),r0}J("wasm-instantiate");function M(ee){return _(ee.instance)}var L=f0();if(n.instantiateWasm)return new Promise((ee,Q)=>{n.instantiateWasm(L,(re,Ve)=>{ee(_(re,Ve))})});ke??(ke=Ne());var j=await xe(l,ke,L),Y=M(j);return Y}class R0{constructor(M){Re(this,"name","ExitStatus");this.message=`Program terminated with exit(${M})`,this.status=M}}var Ue=_=>{for(;_.length>0;)_.shift()(n)},d0=[],Qe=_=>d0.push(_),fe=[],de=_=>fe.push(_),Ee=!0,l0=_=>q0(_),nt=()=>lt(),Pe=_=>{var M=n["_"+_];return M},e0=(_,M)=>{S.set(_,M)},kr=_=>{for(var M=0,L=0;L<_.length;++L){var j=_.charCodeAt(L);j<=127?M++:j<=2047?M+=2:j>=55296&&j<=57343?(M+=4,++L):M+=3}return M},st=(_,M,L,j)=>{if(!(j>0))return 0;for(var Y=L,ee=L+j-1,Q=0;Q<_.length;++Q){var re=_.codePointAt(Q);if(re<=127){if(L>=ee)break;M[L++]=re}else if(re<=2047){if(L+1>=ee)break;M[L++]=192|re>>6,M[L++]=128|re&63}else if(re<=65535){if(L+2>=ee)break;M[L++]=224|re>>12,M[L++]=128|re>>6&63,M[L++]=128|re&63}else{if(L+3>=ee)break;M[L++]=240|re>>18,M[L++]=128|re>>12&63,M[L++]=128|re>>6&63,M[L++]=128|re&63,Q++}}return M[L]=0,L-Y},at=(_,M,L)=>st(_,T,M,L),He=_=>dt(_),t0=_=>{var M=kr(_)+1,L=He(M);return at(_,L,M),L},it=typeof TextDecoder<"u"?new TextDecoder:void 0,ot=(_,M=0,L=NaN)=>{for(var j=M+L,Y=M;_[Y]&&!(Y>=j);)++Y;if(Y-M>16&&_.buffer&&it)return it.decode(_.subarray(M,Y));for(var ee="";M<Y;){var Q=_[M++];if(!(Q&128)){ee+=String.fromCharCode(Q);continue}var re=_[M++]&63;if((Q&224)==192){ee+=String.fromCharCode((Q&31)<<6|re);continue}var Ve=_[M++]&63;if((Q&240)==224?Q=(Q&15)<<12|re<<6|Ve:Q=(Q&7)<<18|re<<12|Ve<<6|_[M++]&63,Q<65536)ee+=String.fromCharCode(Q);else{var n0=Q-65536;ee+=String.fromCharCode(55296|n0>>10,56320|n0&1023)}}return ee},ct=(_,M)=>_?ot(T,_,M):"",ut=(_,M,L,j,Y)=>{var ee={string:ye=>{var I0=0;return ye!=null&&ye!==0&&(I0=t0(ye)),I0},array:ye=>{var I0=He(ye.length);return e0(ye,I0),I0}};function Q(ye){return M==="string"?ct(ye):M==="boolean"?!!ye:ye}var re=Pe(_),Ve=[],n0=0;if(j)for(var s0=0;s0<j.length;s0++){var qn=ee[L[s0]];qn?(n0===0&&(n0=nt()),Ve[s0]=qn(j[s0])):Ve[s0]=j[s0]}var Mr=re(...Ve);function Ya(ye){return n0!==0&&l0(n0),Q(ye)}return Mr=Ya(Mr),Mr},Pr=(_,M,L,j)=>{var Y=!L||L.every(Q=>Q==="number"||Q==="boolean"),ee=M!=="string";return ee&&Y&&!j?Pe(_):(...Q)=>ut(_,M,L,Q,j)};n.noExitRuntime&&(Ee=n.noExitRuntime),n.print&&(g=n.print),n.printErr&&(v=n.printErr),n.wasmBinary&&(l=n.wasmBinary),n.arguments&&(i=n.arguments),n.thisProgram&&(u=n.thisProgram),n.ccall=ut,n.cwrap=Pr;var xt,Hr,ft,Rr,q0,dt,lt;function qr(_){n._orlp_derive_public_key=xt=_.c,n._orlp_validate_keypair=Hr=_.d,n._orlp_sign=ft=_.e,n._orlp_verify=Rr=_.f,q0=_.g,dt=_.h,lt=_.i}var ht={},r0=await Je();function M0(){if(F>0){X=M0;return}if(D(),F>0){X=M0;return}function _(){n.calledRun=!0,!p&&(k(),B?.(n),n.onRuntimeInitialized?.(),P())}n.setStatus?(n.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>n.setStatus(""),1),_()},1)):_()}function pt(){if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.shift()()}return pt(),M0(),z?r=n:r=new Promise((_,M)=>{B=_,C=M}),r}})();typeof Ca=="object"&&typeof or=="object"?(or.exports=nn,or.exports.default=nn):typeof define=="function"&&define.amd&&define([],()=>nn)});var ur=U(g0=>{"use strict";Object.defineProperty(g0,"__esModule",{value:!0});g0.derivePublicKey=qi;g0.validateKeyPair=Mi;g0.sign=Ii;g0.verify=Oi;var Be=ie(),Ri=Aa();async function cr(){return await Ri()}async function qi(t){let e=await cr(),r=(0,Be.hexToBytes)(t);if(r.length!==64)throw new Error(`Invalid private key length: expected 64 bytes, got ${r.length}`);let n=1024,a=1088;if(e.HEAPU8.set(r,n),e.ccall("orlp_derive_public_key","number",["number","number"],[a,n])!==0)throw new Error("orlp key derivation failed: invalid private key");let c=new Uint8Array(32);return c.set(e.HEAPU8.subarray(a,a+32)),(0,Be.bytesToHex)(c)}async function Mi(t,e){try{let r=await cr(),n=(0,Be.hexToBytes)(t),a=(0,Be.hexToBytes)(e);if(n.length!==64||a.length!==32)return!1;let s=2048,c=2112;return r.HEAPU8.set(n,s),r.HEAPU8.set(a,c),r.ccall("orlp_validate_keypair","number",["number","number"],[c,s])===1}catch{return!1}}async function Ii(t,e,r){let n=await cr(),a=(0,Be.hexToBytes)(t),s=(0,Be.hexToBytes)(e),c=(0,Be.hexToBytes)(r);if(s.length!==64)throw new Error(`Invalid private key length: expected 64 bytes, got ${s.length}`);if(c.length!==32)throw new Error(`Invalid public key length: expected 32 bytes, got ${c.length}`);let i=1e5,u=2e5,d=3e5,o=4e5;n.HEAPU8.set(a,i),n.HEAPU8.set(s,u),n.HEAPU8.set(c,d),n.ccall("orlp_sign","void",["number","number","number","number","number"],[o,i,a.length,d,u]);let f=new Uint8Array(64);return f.set(n.HEAPU8.subarray(o,o+64)),(0,Be.bytesToHex)(f)}async function Oi(t,e,r){try{let n=await cr(),a=(0,Be.hexToBytes)(t),s=(0,Be.hexToBytes)(e),c=(0,Be.hexToBytes)(r);if(a.length!==64||c.length!==32)return!1;let i=5e5,u=6e5,d=7e5;return n.HEAPU8.set(a,u),n.HEAPU8.set(s,i),n.HEAPU8.set(c,d),n.ccall("orlp_verify","number",["number","number","number","number"],[u,i,s.length,d])===1}catch{return!1}}});var on=U(Se=>{"use strict";var Li=Se&&Se.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var a=Object.getOwnPropertyDescriptor(e,r);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,a)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ni=Se&&Se.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ui=Se&&Se.__importStar||function(){var t=function(e){return t=Object.getOwnPropertyNames||function(r){var n=[];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[n.length]=a);return n},t(e)};return function(e){if(e&&e.__esModule)return e;var r={};if(e!=null)for(var n=t(e),a=0;a<n.length;a++)n[a]!=="default"&&Li(r,e,n[a]);return Ni(r,e),r}}();Object.defineProperty(Se,"__esModule",{value:!0});Se.Ed25519SignatureVerifier=void 0;var an=Ui((Ba(),ii(ga))),je=ie(),Ea=ur();async function Vi(t){if(typeof globalThis<"u"&&globalThis.crypto&&globalThis.crypto.subtle){let e=await globalThis.crypto.subtle.digest("SHA-512",t);return new Uint8Array(e)}if(typeof L0<"u")try{let{createHash:e}=yt();return e("sha512").update(t).digest()}catch{}throw new Error("No SHA-512 implementation available")}function zi(t){if(typeof L0<"u")try{let{createHash:e}=yt();return e("sha512").update(t).digest()}catch{}try{let e=Lr(),r=e.lib.WordArray.create(t),n=e.SHA512(r),a=new Uint8Array(64);for(let s=0;s<16;s++){let c=n.words[s]||0;a[s*4]=c>>>24&255,a[s*4+1]=c>>>16&255,a[s*4+2]=c>>>8&255,a[s*4+3]=c&255}return a}catch{throw new Error("No SHA-512 implementation available for synchronous operation")}}an.etc.sha512Async=Vi;try{an.etc.sha512Sync=zi}catch(t){console.debug("Could not set up synchronous SHA-512:",t)}var sn=class{static async verifyAdvertisementSignature(e,r,n,a){try{let s=(0,je.hexToBytes)(e),c=(0,je.hexToBytes)(r),i=(0,je.hexToBytes)(a),u=this.constructAdvertSignedMessage(e,n,i);return await an.verify(c,u,s)}catch(s){return console.error("Ed25519 signature verification failed:",s),!1}}static constructAdvertSignedMessage(e,r,n){let a=(0,je.hexToBytes)(e),s=new Uint8Array(4);s[0]=r&255,s[1]=r>>8&255,s[2]=r>>16&255,s[3]=r>>24&255;let c=new Uint8Array(36+n.length);return c.set(a,0),c.set(s,32),c.set(n,36),c}static getSignedMessageDescription(e,r,n){return`Public Key: ${e} + Timestamp: ${r} (${new Date(r*1e3).toISOString()}) + App Data: ${n}`}static getSignedMessageHex(e,r,n){let a=(0,je.hexToBytes)(n),s=this.constructAdvertSignedMessage(e,r,a);return(0,je.bytesToHex)(s)}static async derivePublicKey(e){try{let r=(0,je.hexToBytes)(e);if(r.length!==64)throw new Error(`Invalid private key length: expected 64 bytes, got ${r.length}`);return await(0,Ea.derivePublicKey)(e)}catch(r){throw new Error(`Failed to derive public key: ${r instanceof Error?r.message:"Unknown error"}`)}}static derivePublicKeySync(e){try{let r=(0,je.hexToBytes)(e);throw r.length!==64?new Error(`Invalid private key length: expected 64 bytes, got ${r.length}`):new Error("Synchronous key derivation not supported with WASM. Use derivePublicKey() instead.")}catch(r){throw new Error(`Failed to derive public key: ${r instanceof Error?r.message:"Unknown error"}`)}}static async validateKeyPair(e,r){try{return await(0,Ea.validateKeyPair)(e,r)}catch{return!1}}};Se.Ed25519SignatureVerifier=sn});var _a=U(xr=>{"use strict";Object.defineProperty(xr,"__esModule",{value:!0});xr.AdvertPayloadDecoder=void 0;var ne=le(),We=ie(),$i=p0(),Ki=on(),cn=class{static decode(e,r){try{if(e.length<101){let x={type:ne.PayloadType.Advert,version:ne.PayloadVersion.Version1,isValid:!1,errors:["Advertisement payload too short"],publicKey:"",timestamp:0,signature:"",appData:{flags:0,deviceRole:ne.DeviceRole.ChatNode,hasLocation:!1,hasName:!1}};return r?.includeSegments&&(x.segments=[{name:"Invalid Advert Data",description:"Advert payload too short (minimum 101 bytes required)",startByte:r.segmentOffset||0,endByte:(r.segmentOffset||0)+e.length-1,value:(0,We.bytesToHex)(e)}]),x}let n=[],a=r?.segmentOffset||0,s=0,c=(0,We.bytesToHex)(e.subarray(s,s+32));r?.includeSegments&&n.push({name:"Public Key",description:"Ed25519 public key",startByte:a+s,endByte:a+s+31,value:c}),s+=32;let i=this.readUint32LE(e,s);if(r?.includeSegments){let x=new Date(i*1e3);n.push({name:"Timestamp",description:`${i} (${x.toISOString().slice(0,19)}Z)`,startByte:a+s,endByte:a+s+3,value:(0,We.bytesToHex)(e.subarray(s,s+4))})}s+=4;let u=(0,We.bytesToHex)(e.subarray(s,s+64));r?.includeSegments&&n.push({name:"Signature",description:"Ed25519 signature",startByte:a+s,endByte:a+s+63,value:u}),s+=64;let d=e[s];if(r?.includeSegments){let x=d.toString(2).padStart(8,"0"),h=this.parseDeviceRole(d),g=` | Bits 0-3 (Role): ${(0,$i.getDeviceRoleName)(h)} | Bit 4 (Location): ${d&ne.AdvertFlags.HasLocation?"Yes":"No"} | Bit 7 (Name): ${d&ne.AdvertFlags.HasName?"Yes":"No"}`;n.push({name:"App Flags",description:`Binary: ${x}${g}`,startByte:a+s,endByte:a+s,value:d.toString(16).padStart(2,"0").toUpperCase()})}s+=1;let o={type:ne.PayloadType.Advert,version:ne.PayloadVersion.Version1,isValid:!0,publicKey:c,timestamp:i,signature:u,appData:{flags:d,deviceRole:this.parseDeviceRole(d),hasLocation:!!(d&ne.AdvertFlags.HasLocation),hasName:!!(d&ne.AdvertFlags.HasName)}},f=s;if(d&ne.AdvertFlags.HasLocation&&e.length>=f+8){let x=this.readInt32LE(e,f)/1e6,h=this.readInt32LE(e,f+4)/1e6;o.appData.location={latitude:Math.round(x*1e6)/1e6,longitude:Math.round(h*1e6)/1e6},r?.includeSegments&&(n.push({name:"Latitude",description:`${x}\xB0 (${x})`,startByte:a+f,endByte:a+f+3,value:(0,We.bytesToHex)(e.subarray(f,f+4))}),n.push({name:"Longitude",description:`${h}\xB0 (${h})`,startByte:a+f+4,endByte:a+f+7,value:(0,We.bytesToHex)(e.subarray(f+4,f+8))})),f+=8}if(d&ne.AdvertFlags.HasFeature1&&(f+=2),d&ne.AdvertFlags.HasFeature2&&(f+=2),d&ne.AdvertFlags.HasName&&e.length>f){let x=e.subarray(f),h=new TextDecoder("utf-8").decode(x).replace(/\0.*$/,"");o.appData.name=this.sanitizeControlCharacters(h)||h,r?.includeSegments&&n.push({name:"Node Name",description:`Node name: "${o.appData.name}"`,startByte:a+f,endByte:a+e.length-1,value:(0,We.bytesToHex)(x)})}return r?.includeSegments&&(o.segments=n),o}catch(n){return{type:ne.PayloadType.Advert,version:ne.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode advertisement payload"],publicKey:"",timestamp:0,signature:"",appData:{flags:0,deviceRole:ne.DeviceRole.ChatNode,hasLocation:!1,hasName:!1}}}}static async decodeWithVerification(e,r){let n=this.decode(e,r);if(!n||!n.isValid)return n;try{let s=e.subarray(100),c=(0,We.bytesToHex)(s),i=await Ki.Ed25519SignatureVerifier.verifyAdvertisementSignature(n.publicKey,n.signature,n.timestamp,c);n.signatureValid=i,i||(n.signatureError="Ed25519 signature verification failed",n.isValid=!1,n.errors||(n.errors=[]),n.errors.push("Invalid Ed25519 signature"))}catch(a){n.signatureValid=!1,n.signatureError=a instanceof Error?a.message:"Signature verification error",n.isValid=!1,n.errors||(n.errors=[]),n.errors.push("Signature verification failed: "+(a instanceof Error?a.message:"Unknown error"))}return n}static parseDeviceRole(e){switch(e&15){case 1:return ne.DeviceRole.ChatNode;case 2:return ne.DeviceRole.Repeater;case 3:return ne.DeviceRole.RoomServer;case 4:return ne.DeviceRole.Sensor;default:return ne.DeviceRole.ChatNode}}static readUint32LE(e,r){return e[r]|e[r+1]<<8|e[r+2]<<16|e[r+3]<<24}static readInt32LE(e,r){let n=this.readUint32LE(e,r);return n>2147483647?n-4294967296:n}static sanitizeControlCharacters(e){return e&&e.trim().replace(/[\x00-\x1F\x7F]/g,"")||null}};xr.AdvertPayloadDecoder=cn});var Da=U(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});fr.TracePayloadDecoder=void 0;var B0=le(),b0=ie(),un=class{static decode(e,r,n){try{if(e.length<9){let g={type:B0.PayloadType.Trace,version:B0.PayloadVersion.Version1,isValid:!1,errors:["Trace payload too short (need at least tag(4) + auth(4) + flags(1))"],traceTag:"00000000",authCode:0,flags:0,pathHashes:[]};return n?.includeSegments&&(g.segments=[{name:"Invalid Trace Data",description:"Trace payload too short (minimum 9 bytes required)",startByte:n.segmentOffset||0,endByte:(n.segmentOffset||0)+e.length-1,value:(0,b0.bytesToHex)(e)}]),g}let a=0,s=[],c=n?.segmentOffset||0,i=this.readUint32LE(e,a),u=(0,b0.numberToHex)(i,8);n?.includeSegments&&s.push({name:"Trace Tag",description:`Unique identifier for this trace: 0x${i.toString(16).padStart(8,"0")}`,startByte:c+a,endByte:c+a+3,value:(0,b0.bytesToHex)(e.slice(a,a+4))}),a+=4;let d=this.readUint32LE(e,a);n?.includeSegments&&s.push({name:"Auth Code",description:`Authentication/verification code: ${d}`,startByte:c+a,endByte:c+a+3,value:(0,b0.bytesToHex)(e.slice(a,a+4))}),a+=4;let o=e[a];n?.includeSegments&&s.push({name:"Flags",description:`Application-defined control flags: 0x${o.toString(16).padStart(2,"0")} (${o.toString(2).padStart(8,"0")}b)`,startByte:c+a,endByte:c+a,value:o.toString(16).padStart(2,"0").toUpperCase()}),a+=1;let f=[],x=a;for(;a<e.length;)f.push((0,b0.byteToHex)(e[a])),a++;if(n?.includeSegments&&f.length>0){let g=f.join(" ");s.push({name:"Path Hashes",description:`Node hashes in trace path: ${g}`,startByte:c+x,endByte:c+e.length-1,value:(0,b0.bytesToHex)(e.slice(x))})}let h;r&&r.length>0&&(h=r.map(g=>{let v=parseInt(g,16);return(v>127?v-256:v)/4}));let y={type:B0.PayloadType.Trace,version:B0.PayloadVersion.Version1,isValid:!0,traceTag:u,authCode:d,flags:o,pathHashes:f,snrValues:h};return n?.includeSegments&&(y.segments=s),y}catch(a){return{type:B0.PayloadType.Trace,version:B0.PayloadVersion.Version1,isValid:!1,errors:[a instanceof Error?a.message:"Failed to decode trace payload"],traceTag:"00000000",authCode:0,flags:0,pathHashes:[]}}}static readUint32LE(e,r){return e[r]|e[r+1]<<8|e[r+2]<<16|e[r+3]<<24}};fr.TracePayloadDecoder=un});var Fa=U(lr=>{"use strict";Object.defineProperty(lr,"__esModule",{value:!0});lr.GroupTextPayloadDecoder=void 0;var C0=le(),Gi=er(),dr=ie(),xn=class{static decode(e,r){try{if(e.length<3){let o={type:C0.PayloadType.GroupText,version:C0.PayloadVersion.Version1,isValid:!1,errors:["GroupText payload too short (need at least channel_hash(1) + MAC(2))"],channelHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0};return r?.includeSegments&&(o.segments=[{name:"Invalid GroupText Data",description:"GroupText payload too short (minimum 3 bytes required)",startByte:r.segmentOffset||0,endByte:(r.segmentOffset||0)+e.length-1,value:(0,dr.bytesToHex)(e)}]),o}let n=[],a=r?.segmentOffset||0,s=0,c=(0,dr.byteToHex)(e[s]);r?.includeSegments&&n.push({name:"Channel Hash",description:"First byte of SHA256 of channel's shared key",startByte:a+s,endByte:a+s,value:c}),s+=1;let i=(0,dr.bytesToHex)(e.subarray(s,s+2));r?.includeSegments&&n.push({name:"Cipher MAC",description:"MAC for encrypted data",startByte:a+s,endByte:a+s+1,value:i}),s+=2;let u=(0,dr.bytesToHex)(e.subarray(s));r?.includeSegments&&e.length>s&&n.push({name:"Ciphertext",description:"Encrypted message content (timestamp + flags + message)",startByte:a+s,endByte:a+e.length-1,value:u});let d={type:C0.PayloadType.GroupText,version:C0.PayloadVersion.Version1,isValid:!0,channelHash:c,cipherMac:i,ciphertext:u,ciphertextLength:e.length-3};if(r?.keyStore&&r.keyStore.hasChannelKey(c)){let o=r.keyStore.getChannelKeys(c);for(let f of o){let x=Gi.ChannelCrypto.decryptGroupTextMessage(u,i,f);if(x.success&&x.data){d.decrypted={timestamp:x.data.timestamp,flags:x.data.flags,sender:x.data.sender,message:x.data.message};break}}}return r?.includeSegments&&(d.segments=n),d}catch(n){return{type:C0.PayloadType.GroupText,version:C0.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode GroupText payload"],channelHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0}}}};lr.GroupTextPayloadDecoder=xn});var wa=U(hr=>{"use strict";Object.defineProperty(hr,"__esModule",{value:!0});hr.RequestPayloadDecoder=void 0;var Oe=le(),K0=ie(),fn=class{static decode(e,r){try{if(e.length<4){let f={type:Oe.PayloadType.Request,version:Oe.PayloadVersion.Version1,isValid:!1,errors:["Request payload too short (minimum 4 bytes: dest hash + source hash + MAC)"],timestamp:0,requestType:Oe.RequestType.GetStats,requestData:"",destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:""};return r?.includeSegments&&(f.segments=[{name:"Invalid Request Data",description:"Request payload too short (minimum 4 bytes required: 1 for dest hash + 1 for source hash + 2 for MAC)",startByte:r.segmentOffset||0,endByte:(r.segmentOffset||0)+e.length-1,value:(0,K0.bytesToHex)(e)}]),f}let n=[],a=r?.segmentOffset||0,s=0,c=(0,K0.bytesToHex)(e.subarray(s,s+1));r?.includeSegments&&n.push({name:"Destination Hash",description:`First byte of destination node public key: 0x${c}`,startByte:a+s,endByte:a+s,value:c}),s+=1;let i=(0,K0.bytesToHex)(e.subarray(s,s+1));r?.includeSegments&&n.push({name:"Source Hash",description:`First byte of source node public key: 0x${i}`,startByte:a+s,endByte:a+s,value:i}),s+=1;let u=(0,K0.bytesToHex)(e.subarray(s,s+2));r?.includeSegments&&n.push({name:"Cipher MAC",description:"MAC for encrypted data verification (2 bytes)",startByte:a+s,endByte:a+s+1,value:u}),s+=2;let d=(0,K0.bytesToHex)(e.subarray(s));r?.includeSegments&&e.length>s&&n.push({name:"Ciphertext",description:`Encrypted message data (${e.length-s} bytes). Contains encrypted plaintext with this structure:
\u2022 Timestamp (4 bytes) - send time as unix timestamp
\u2022 Request Type (1 byte) - type of request (GetStats, GetTelemetryData, etc.)
\u2022 Request Data (remaining bytes) - additional request-specific data`,startByte:a+s,endByte:a+e.length-1,value:d});let o={type:Oe.PayloadType.Request,version:Oe.PayloadVersion.Version1,isValid:!0,timestamp:0,requestType:Oe.RequestType.GetStats,requestData:"",destinationHash:c,sourceHash:i,cipherMac:u,ciphertext:d};return r?.includeSegments&&(o.segments=n),o}catch(n){return{type:Oe.PayloadType.Request,version:Oe.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode request payload"],timestamp:0,requestType:Oe.RequestType.GetStats,requestData:"",destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:""}}}};hr.RequestPayloadDecoder=fn});var Sa=U(pr=>{"use strict";Object.defineProperty(pr,"__esModule",{value:!0});pr.ResponsePayloadDecoder=void 0;var A0=le(),G0=ie(),dn=class{static decode(e,r){try{if(e.length<4){let f={type:A0.PayloadType.Response,version:A0.PayloadVersion.Version1,isValid:!1,errors:["Response payload too short (minimum 4 bytes: dest + source + MAC)"],destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0};return r?.includeSegments&&(f.segments=[{name:"Invalid Response Data",description:"Response payload too short (minimum 4 bytes required)",startByte:r.segmentOffset||0,endByte:(r.segmentOffset||0)+e.length-1,value:(0,G0.bytesToHex)(e)}]),f}let n=[],a=r?.segmentOffset||0,s=0,c=(0,G0.byteToHex)(e[s]);r?.includeSegments&&n.push({name:"Destination Hash",description:"First byte of destination node public key",startByte:a+s,endByte:a+s,value:c}),s+=1;let i=(0,G0.byteToHex)(e[s]);r?.includeSegments&&n.push({name:"Source Hash",description:"First byte of source node public key",startByte:a+s,endByte:a+s,value:i}),s+=1;let u=(0,G0.bytesToHex)(e.subarray(s,s+2));r?.includeSegments&&n.push({name:"Cipher MAC",description:"MAC for encrypted data in next field",startByte:a+s,endByte:a+s+1,value:u}),s+=2;let d=(0,G0.bytesToHex)(e.subarray(s));r?.includeSegments&&e.length>s&&n.push({name:"Ciphertext",description:"Encrypted response data (tag + content)",startByte:a+s,endByte:a+e.length-1,value:d});let o={type:A0.PayloadType.Response,version:A0.PayloadVersion.Version1,isValid:!0,destinationHash:c,sourceHash:i,cipherMac:u,ciphertext:d,ciphertextLength:e.length-4};return r?.includeSegments&&(o.segments=n),o}catch(n){return{type:A0.PayloadType.Response,version:A0.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode response payload"],destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0}}}};pr.ResponsePayloadDecoder=dn});var Ta=U(yr=>{"use strict";Object.defineProperty(yr,"__esModule",{value:!0});yr.AnonRequestPayloadDecoder=void 0;var E0=le(),j0=ie(),ln=class{static decode(e,r){try{if(e.length<35){let f={type:E0.PayloadType.AnonRequest,version:E0.PayloadVersion.Version1,isValid:!1,errors:["AnonRequest payload too short (minimum 35 bytes: dest + public key + MAC)"],destinationHash:"",senderPublicKey:"",cipherMac:"",ciphertext:"",ciphertextLength:0};return r?.includeSegments&&(f.segments=[{name:"Invalid AnonRequest Data",description:"AnonRequest payload too short (minimum 35 bytes required: 1 for dest hash + 32 for public key + 2 for MAC)",startByte:r.segmentOffset||0,endByte:(r.segmentOffset||0)+e.length-1,value:(0,j0.bytesToHex)(e)}]),f}let n=[],a=r?.segmentOffset||0,s=0,c=(0,j0.byteToHex)(e[0]);r?.includeSegments&&n.push({name:"Destination Hash",description:`First byte of destination node public key: 0x${c}`,startByte:a+s,endByte:a+s,value:c}),s+=1;let i=(0,j0.bytesToHex)(e.subarray(1,33));r?.includeSegments&&n.push({name:"Sender Public Key",description:"Ed25519 public key of the sender (32 bytes)",startByte:a+s,endByte:a+s+31,value:i}),s+=32;let u=(0,j0.bytesToHex)(e.subarray(33,35));r?.includeSegments&&n.push({name:"Cipher MAC",description:"MAC for encrypted data verification (2 bytes)",startByte:a+s,endByte:a+s+1,value:u}),s+=2;let d=(0,j0.bytesToHex)(e.subarray(35));r?.includeSegments&&e.length>35&&n.push({name:"Ciphertext",description:`Encrypted message data (${e.length-35} bytes). Contains encrypted plaintext with this structure:
\u2022 Timestamp (4 bytes) - send time as unix timestamp
\u2022 Sync Timestamp (4 bytes) - room server only, sender's "sync messages SINCE x" timestamp  
\u2022 Password (remaining bytes) - password for repeater/room`,startByte:a+s,endByte:a+e.length-1,value:d});let o={type:E0.PayloadType.AnonRequest,version:E0.PayloadVersion.Version1,isValid:!0,destinationHash:c,senderPublicKey:i,cipherMac:u,ciphertext:d,ciphertextLength:e.length-35};return r?.includeSegments&&(o.segments=n),o}catch(n){return{type:E0.PayloadType.AnonRequest,version:E0.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode AnonRequest payload"],destinationHash:"",senderPublicKey:"",cipherMac:"",ciphertext:"",ciphertextLength:0}}}};yr.AnonRequestPayloadDecoder=ln});var ka=U(vr=>{"use strict";Object.defineProperty(vr,"__esModule",{value:!0});vr.AckPayloadDecoder=void 0;var _0=le(),hn=ie(),pn=class{static decode(e,r){try{if(e.length<4){let i={type:_0.PayloadType.Ack,version:_0.PayloadVersion.Version1,isValid:!1,errors:["Ack payload too short (minimum 4 bytes for checksum)"],checksum:""};return r?.includeSegments&&(i.segments=[{name:"Invalid Ack Data",description:"Ack payload too short (minimum 4 bytes required for checksum)",startByte:r.segmentOffset||0,endByte:(r.segmentOffset||0)+e.length-1,value:(0,hn.bytesToHex)(e)}]),i}let n=[],a=r?.segmentOffset||0,s=(0,hn.bytesToHex)(e.subarray(0,4));r?.includeSegments&&n.push({name:"Checksum",description:`CRC checksum of message timestamp, text, and sender pubkey: 0x${s}`,startByte:a,endByte:a+3,value:s}),r?.includeSegments&&e.length>4&&n.push({name:"Additional Data",description:"Extra data in Ack payload",startByte:a+4,endByte:a+e.length-1,value:(0,hn.bytesToHex)(e.subarray(4))});let c={type:_0.PayloadType.Ack,version:_0.PayloadVersion.Version1,isValid:!0,checksum:s};return r?.includeSegments&&(c.segments=n),c}catch(n){return{type:_0.PayloadType.Ack,version:_0.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode Ack payload"],checksum:""}}}};vr.AckPayloadDecoder=pn});var Ha=U(mr=>{"use strict";Object.defineProperty(mr,"__esModule",{value:!0});mr.PathPayloadDecoder=void 0;var Xe=le(),Pa=ie(),yn=class{static decode(e){try{if(e.length<2)return{type:Xe.PayloadType.Path,version:Xe.PayloadVersion.Version1,isValid:!1,errors:["Path payload too short (minimum 2 bytes: path length + extra type)"],pathLength:0,pathHashes:[],extraType:0,extraData:""};let r=e[0];if(e.length<1+r+1)return{type:Xe.PayloadType.Path,version:Xe.PayloadVersion.Version1,isValid:!1,errors:[`Path payload too short (need ${1+r+1} bytes for path length + path + extra type)`],pathLength:r,pathHashes:[],extraType:0,extraData:""};let n=[];for(let c=0;c<r;c++)n.push((0,Pa.byteToHex)(e[1+c]));let a=e[1+r],s="";return e.length>1+r+1&&(s=(0,Pa.bytesToHex)(e.subarray(1+r+1))),{type:Xe.PayloadType.Path,version:Xe.PayloadVersion.Version1,isValid:!0,pathLength:r,pathHashes:n,extraType:a,extraData:s}}catch(r){return{type:Xe.PayloadType.Path,version:Xe.PayloadVersion.Version1,isValid:!1,errors:[r instanceof Error?r.message:"Failed to decode Path payload"],pathLength:0,pathHashes:[],extraType:0,extraData:""}}}};mr.PathPayloadDecoder=yn});var Ra=U(gr=>{"use strict";Object.defineProperty(gr,"__esModule",{value:!0});gr.TextMessagePayloadDecoder=void 0;var D0=le(),W0=ie(),vn=class{static decode(e,r){try{if(e.length<4){let f={type:D0.PayloadType.TextMessage,version:D0.PayloadVersion.Version1,isValid:!1,errors:["TextMessage payload too short (minimum 4 bytes: dest + source + MAC)"],destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0};return r?.includeSegments&&(f.segments=[{name:"Invalid TextMessage Data",description:"TextMessage payload too short (minimum 4 bytes required)",startByte:r.segmentOffset||0,endByte:(r.segmentOffset||0)+e.length-1,value:(0,W0.bytesToHex)(e)}]),f}let n=[],a=r?.segmentOffset||0,s=0,c=(0,W0.byteToHex)(e[s]);r?.includeSegments&&n.push({name:"Destination Hash",description:"First byte of destination node public key",startByte:a+s,endByte:a+s,value:c}),s+=1;let i=(0,W0.byteToHex)(e[s]);r?.includeSegments&&n.push({name:"Source Hash",description:"First byte of source node public key",startByte:a+s,endByte:a+s,value:i}),s+=1;let u=(0,W0.bytesToHex)(e.subarray(s,s+2));r?.includeSegments&&n.push({name:"Cipher MAC",description:"MAC for encrypted data in next field",startByte:a+s,endByte:a+s+1,value:u}),s+=2;let d=(0,W0.bytesToHex)(e.subarray(s));r?.includeSegments&&e.length>s&&n.push({name:"Ciphertext",description:"Encrypted message data (timestamp + message text)",startByte:a+s,endByte:a+e.length-1,value:d});let o={type:D0.PayloadType.TextMessage,version:D0.PayloadVersion.Version1,isValid:!0,destinationHash:c,sourceHash:i,cipherMac:u,ciphertext:d,ciphertextLength:e.length-4};return r?.includeSegments&&(o.segments=n),o}catch(n){return{type:D0.PayloadType.TextMessage,version:D0.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode TextMessage payload"],destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0}}}};gr.TextMessagePayloadDecoder=vn});var qa=U(Br=>{"use strict";Object.defineProperty(Br,"__esModule",{value:!0});Br.ControlPayloadDecoder=void 0;var te=le(),o0=ie(),ji=p0(),mn=class{static decode(e,r){try{if(e.length<1)return this.createErrorPayload("Control payload too short (minimum 1 byte required)",e,r);let a=e[0]&240;switch(a){case te.ControlSubType.NodeDiscoverReq:return this.decodeDiscoverReq(e,r);case te.ControlSubType.NodeDiscoverResp:return this.decodeDiscoverResp(e,r);default:return this.createErrorPayload(`Unknown control sub-type: 0x${a.toString(16).padStart(2,"0")}`,e,r)}}catch(n){return this.createErrorPayload(n instanceof Error?n.message:"Failed to decode control payload",e,r)}}static decodeDiscoverReq(e,r){let n=[],a=r?.segmentOffset??0;if(e.length<6){let h={type:te.PayloadType.Control,version:te.PayloadVersion.Version1,isValid:!1,errors:["DISCOVER_REQ payload too short (minimum 6 bytes required)"],subType:te.ControlSubType.NodeDiscoverReq,rawFlags:e[0],prefixOnly:!1,typeFilter:0,typeFilterNames:[],tag:0,since:0};return r?.includeSegments&&(h.segments=[{name:"Invalid DISCOVER_REQ Data",description:"DISCOVER_REQ payload too short (minimum 6 bytes required)",startByte:a,endByte:a+e.length-1,value:(0,o0.bytesToHex)(e)}]),h}let s=0,c=e[s],i=(c&1)!==0;r?.includeSegments&&n.push({name:"Flags",description:`Sub-type: DISCOVER_REQ (0x8) | Prefix Only: ${i}`,startByte:a+s,endByte:a+s,value:c.toString(16).padStart(2,"0").toUpperCase()}),s+=1;let u=e[s],d=this.parseTypeFilter(u);r?.includeSegments&&n.push({name:"Type Filter",description:`Filter mask: 0b${u.toString(2).padStart(8,"0")} | Types: ${d.length>0?d.join(", "):"None"}`,startByte:a+s,endByte:a+s,value:u.toString(16).padStart(2,"0").toUpperCase()}),s+=1;let o=this.readUint32LE(e,s);r?.includeSegments&&n.push({name:"Tag",description:`Random tag for response matching: 0x${o.toString(16).padStart(8,"0")}`,startByte:a+s,endByte:a+s+3,value:(0,o0.bytesToHex)(e.slice(s,s+4))}),s+=4;let f=0;if(e.length>=s+4&&(f=this.readUint32LE(e,s),r?.includeSegments)){let h=f>0?new Date(f*1e3).toISOString().slice(0,19)+"Z":"N/A";n.push({name:"Since",description:`Filter timestamp: ${f} (${h})`,startByte:a+s,endByte:a+s+3,value:(0,o0.bytesToHex)(e.slice(s,s+4))})}let x={type:te.PayloadType.Control,version:te.PayloadVersion.Version1,isValid:!0,subType:te.ControlSubType.NodeDiscoverReq,rawFlags:c,prefixOnly:i,typeFilter:u,typeFilterNames:d,tag:o,since:f};return r?.includeSegments&&(x.segments=n),x}static decodeDiscoverResp(e,r){let n=[],a=r?.segmentOffset??0;if(e.length<14){let p={type:te.PayloadType.Control,version:te.PayloadVersion.Version1,isValid:!1,errors:["DISCOVER_RESP payload too short (minimum 14 bytes required)"],subType:te.ControlSubType.NodeDiscoverResp,rawFlags:e.length>0?e[0]:0,nodeType:te.DeviceRole.Unknown,nodeTypeName:"Unknown",snr:0,tag:0,publicKey:"",publicKeyLength:0};return r?.includeSegments&&(p.segments=[{name:"Invalid DISCOVER_RESP Data",description:"DISCOVER_RESP payload too short (minimum 14 bytes required)",startByte:a,endByte:a+e.length-1,value:(0,o0.bytesToHex)(e)}]),p}let s=0,c=e[s],i=c&15,u=(0,ji.getDeviceRoleName)(i);r?.includeSegments&&n.push({name:"Flags",description:`Sub-type: DISCOVER_RESP (0x9) | Node Type: ${u}`,startByte:a+s,endByte:a+s,value:c.toString(16).padStart(2,"0").toUpperCase()}),s+=1;let d=e[s],o=d>127?d-256:d,f=o/4;r?.includeSegments&&n.push({name:"SNR",description:`Inbound SNR: ${f.toFixed(2)} dB (raw: ${d}, signed: ${o})`,startByte:a+s,endByte:a+s,value:d.toString(16).padStart(2,"0").toUpperCase()}),s+=1;let x=this.readUint32LE(e,s);r?.includeSegments&&n.push({name:"Tag",description:`Reflected tag from request: 0x${x.toString(16).padStart(8,"0")}`,startByte:a+s,endByte:a+s+3,value:(0,o0.bytesToHex)(e.slice(s,s+4))}),s+=4;let y=e.length-s,g=e.slice(s,s+y),v=(0,o0.bytesToHex)(g);if(r?.includeSegments){let p=y===32?"Full Public Key":"Public Key Prefix";n.push({name:p,description:`${p} (${y} bytes)`,startByte:a+s,endByte:a+s+y-1,value:v})}let l={type:te.PayloadType.Control,version:te.PayloadVersion.Version1,isValid:!0,subType:te.ControlSubType.NodeDiscoverResp,rawFlags:c,nodeType:i,nodeTypeName:u,snr:f,tag:x,publicKey:v,publicKeyLength:y};return r?.includeSegments&&(l.segments=n),l}static parseTypeFilter(e){let r=[];return e&1<<te.DeviceRole.ChatNode&&r.push("Chat"),e&1<<te.DeviceRole.Repeater&&r.push("Repeater"),e&1<<te.DeviceRole.RoomServer&&r.push("Room"),e&1<<te.DeviceRole.Sensor&&r.push("Sensor"),r}static createErrorPayload(e,r,n){let a={type:te.PayloadType.Control,version:te.PayloadVersion.Version1,isValid:!1,errors:[e],subType:te.ControlSubType.NodeDiscoverReq,rawFlags:r.length>0?r[0]:0,prefixOnly:!1,typeFilter:0,typeFilterNames:[],tag:0,since:0};return n?.includeSegments&&(a.segments=[{name:"Invalid Control Data",description:e,startByte:n.segmentOffset??0,endByte:(n.segmentOffset??0)+r.length-1,value:(0,o0.bytesToHex)(r)}]),a}static readUint32LE(e,r){return(e[r]|e[r+1]<<8|e[r+2]<<16|e[r+3]<<24)>>>0}};Br.ControlPayloadDecoder=mn});var Bn=U(br=>{"use strict";Object.defineProperty(br,"__esModule",{value:!0});br.MeshCorePacketDecoder=void 0;var W=le(),be=ie(),F0=p0(),Wi=Vr(),Ma=_a(),Xi=Da(),Zi=Fa(),Yi=wa(),Ji=Sa(),Qi=Ta(),eo=ka(),to=Ha(),ro=Ra(),no=qa(),gn=class{static decode(e,r){return this.parseInternal(e,!1,r).packet}static async decodeWithVerification(e,r){return(await this.parseInternalAsync(e,!1,r)).packet}static analyzeStructure(e,r){return this.parseInternal(e,!0,r).structure}static async analyzeStructureWithVerification(e,r){return(await this.parseInternalAsync(e,!0,r)).structure}static parseInternal(e,r,n){let a=(0,be.hexToBytes)(e),s=[];if(a.length<2){let c={messageHash:"",routeType:W.RouteType.Flood,payloadType:W.PayloadType.RawCustom,payloadVersion:W.PayloadVersion.Version1,pathLength:0,path:null,payload:{raw:"",decoded:null},totalBytes:a.length,isValid:!1,errors:["Packet too short (minimum 2 bytes required)"]},i={segments:[],totalBytes:a.length,rawHex:e.toUpperCase(),messageHash:"",payload:{segments:[],hex:"",startByte:0,type:"Unknown"}};return{packet:c,structure:i}}try{let c=0,i=a[0],u=i&3,d=i>>2&15,o=i>>6&3;r&&s.push({name:"Header",description:"Header byte breakdown",startByte:0,endByte:0,value:`0x${i.toString(16).padStart(2,"0")}`,headerBreakdown:{fullBinary:i.toString(2).padStart(8,"0"),fields:[{bits:"0-1",field:"Route Type",value:(0,F0.getRouteTypeName)(u),binary:(i&3).toString(2).padStart(2,"0")},{bits:"2-5",field:"Payload Type",value:(0,F0.getPayloadTypeName)(d),binary:(i>>2&15).toString(2).padStart(4,"0")},{bits:"6-7",field:"Version",value:o.toString(),binary:(i>>6&3).toString(2).padStart(2,"0")}]}}),c=1;let f;if(u===W.RouteType.TransportFlood||u===W.RouteType.TransportDirect){if(a.length<c+4)throw new Error("Packet too short for transport codes");let m=a[c]|a[c+1]<<8,S=a[c+2]|a[c+3]<<8;if(f=[m,S],r){let T=a[c]|a[c+1]<<8|a[c+2]<<16|a[c+3]<<24;s.push({name:"Transport Code",description:"Used for Direct/Response routing",startByte:c,endByte:c+3,value:`0x${T.toString(16).padStart(8,"0")}`})}c+=4}if(a.length<c+1)throw new Error("Packet too short for path length");let x=a[c];if(r){let m=`Path contains ${x} bytes`;u===W.RouteType.Direct||u===W.RouteType.TransportDirect?m=`For "Direct" packets, this contains routing instructions. ${x} bytes of routing instructions (decreases as packet travels)`:(u===W.RouteType.Flood||u===W.RouteType.TransportFlood)&&(m=`${x} bytes showing route taken (increases as packet floods)`),s.push({name:"Path Length",description:m,startByte:c,endByte:c,value:`0x${x.toString(16).padStart(2,"0")}`})}if(c+=1,a.length<c+x)throw new Error("Packet too short for path data");let h=a.subarray(c,c+x),y=x>0?Array.from(h).map(be.byteToHex):null;if(r&&x>0)if(d===W.PayloadType.Trace){let m=[];for(let S=0;S<x;S++){let T=a[c+S],q=(T>127?T-256:T)/4;m.push(`${q.toFixed(2)}dB (0x${T.toString(16).padStart(2,"0")})`)}s.push({name:"Path SNR Data",description:`SNR values collected during trace: ${m.join(", ")}`,startByte:c,endByte:c+x-1,value:(0,be.bytesToHex)(a.slice(c,c+x))})}else{let m="Routing path information";u===W.RouteType.Direct||u===W.RouteType.TransportDirect?m="Routing instructions (bytes are stripped at each hop as packet travels to destination)":(u===W.RouteType.Flood||u===W.RouteType.TransportFlood)&&(m="Historical route taken (bytes are added as packet floods through network)"),s.push({name:"Path Data",description:m,startByte:c,endByte:c+x-1,value:(0,be.bytesToHex)(a.slice(c,c+x))})}c+=x;let g=a.subarray(c),v=(0,be.bytesToHex)(g);r&&a.length>c&&s.push({name:"Payload",description:`${(0,F0.getPayloadTypeName)(d)} payload data`,startByte:c,endByte:a.length-1,value:(0,be.bytesToHex)(a.slice(c))});let l=null,p=[];if(d===W.PayloadType.Advert){let m=Ma.AdvertPayloadDecoder.decode(g,{includeSegments:r,segmentOffset:0});l=m,m?.segments&&(p.push(...m.segments),delete m.segments)}else if(d===W.PayloadType.Trace){let m=Xi.TracePayloadDecoder.decode(g,y,{includeSegments:r,segmentOffset:0});l=m,m?.segments&&(p.push(...m.segments),delete m.segments)}else if(d===W.PayloadType.GroupText){let m=Zi.GroupTextPayloadDecoder.decode(g,{...n,includeSegments:r,segmentOffset:0});l=m,m?.segments&&(p.push(...m.segments),delete m.segments)}else if(d===W.PayloadType.Request){let m=Yi.RequestPayloadDecoder.decode(g,{includeSegments:r,segmentOffset:0});l=m,m?.segments&&(p.push(...m.segments),delete m.segments)}else if(d===W.PayloadType.Response){let m=Ji.ResponsePayloadDecoder.decode(g,{includeSegments:r,segmentOffset:0});l=m,m?.segments&&(p.push(...m.segments),delete m.segments)}else if(d===W.PayloadType.AnonRequest){let m=Qi.AnonRequestPayloadDecoder.decode(g,{includeSegments:r,segmentOffset:0});l=m,m?.segments&&(p.push(...m.segments),delete m.segments)}else if(d===W.PayloadType.Ack){let m=eo.AckPayloadDecoder.decode(g,{includeSegments:r,segmentOffset:0});l=m,m?.segments&&(p.push(...m.segments),delete m.segments)}else if(d===W.PayloadType.Path)l=to.PathPayloadDecoder.decode(g);else if(d===W.PayloadType.TextMessage){let m=ro.TextMessagePayloadDecoder.decode(g,{includeSegments:r,segmentOffset:0});l=m,m?.segments&&(p.push(...m.segments),delete m.segments)}else if(d===W.PayloadType.Control){let m=no.ControlPayloadDecoder.decode(g,{includeSegments:r,segmentOffset:0});l=m,m?.segments&&(p.push(...m.segments),delete m.segments)}r&&p.length===0&&a.length>c&&p.push({name:`${(0,F0.getPayloadTypeName)(d)} Payload`,description:`Raw ${(0,F0.getPayloadTypeName)(d)} payload data (${g.length} bytes)`,startByte:0,endByte:g.length-1,value:(0,be.bytesToHex)(g)});let b=this.calculateMessageHash(a,u,d,o),B={messageHash:b,routeType:u,payloadType:d,payloadVersion:o,transportCodes:f,pathLength:x,path:y,payload:{raw:v,decoded:l},totalBytes:a.length,isValid:!0},C={segments:s,totalBytes:a.length,rawHex:e.toUpperCase(),messageHash:b,payload:{segments:p,hex:v,startByte:c,type:(0,F0.getPayloadTypeName)(d)}};return{packet:B,structure:C}}catch(c){let i={messageHash:"",routeType:W.RouteType.Flood,payloadType:W.PayloadType.RawCustom,payloadVersion:W.PayloadVersion.Version1,pathLength:0,path:null,payload:{raw:"",decoded:null},totalBytes:a.length,isValid:!1,errors:[c instanceof Error?c.message:"Unknown decoding error"]},u={segments:[],totalBytes:a.length,rawHex:e.toUpperCase(),messageHash:"",payload:{segments:[],hex:"",startByte:0,type:"Unknown"}};return{packet:i,structure:u}}}static async parseInternalAsync(e,r,n){let a=this.parseInternal(e,r,n);if(a.packet.payloadType===W.PayloadType.Advert&&a.packet.payload.decoded)try{let s=a.packet.payload.decoded,c=await Ma.AdvertPayloadDecoder.decodeWithVerification((0,be.hexToBytes)(a.packet.payload.raw),{includeSegments:r,segmentOffset:0});c&&(a.packet.payload.decoded=c,c.isValid||(a.packet.isValid=!1,a.packet.errors=c.errors||["Invalid advertisement signature"]),r&&c.segments&&(a.structure.payload.segments=c.segments,delete c.segments))}catch(s){console.error("Signature verification failed:",s)}return a}static validate(e){let r=(0,be.hexToBytes)(e),n=[];if(r.length<2)return n.push("Packet too short (minimum 2 bytes required)"),{isValid:!1,errors:n};try{let a=1,c=r[0]&3;if((c===W.RouteType.TransportFlood||c===W.RouteType.TransportDirect)&&(r.length<a+4&&n.push("Packet too short for transport codes"),a+=4),r.length<a+1)n.push("Packet too short for path length");else{let i=r[a];a+=1,r.length<a+i&&n.push("Packet too short for path data"),a+=i}a>=r.length&&n.push("No payload data found")}catch(a){n.push(a instanceof Error?a.message:"Validation error")}return{isValid:n.length===0,errors:n.length>0?n:void 0}}static calculateMessageHash(e,r,n,a){if(n===W.PayloadType.Trace&&e.length>=13){let o=1;if((r===W.RouteType.TransportFlood||r===W.RouteType.TransportDirect)&&(o+=4),e.length>o){let f=e[o];o+=1+f}if(e.length>=o+4){let f=e[o]|e[o+1]<<8|e[o+2]<<16|e[o+3]<<24;return(0,be.numberToHex)(f,8)}}let s=n<<2|a<<6,c=1;if((r===W.RouteType.TransportFlood||r===W.RouteType.TransportDirect)&&(c+=4),e.length>c){let o=e[c];c+=1+o}let i=e.slice(c),u=[s,...Array.from(i)],d=0;for(let o=0;o<u.length;o++)d=(d<<5)-d+u[o]&4294967295;return(0,be.numberToHex)(d,8)}static createKeyStore(e){return new Wi.MeshCoreKeyStore(e)}};br.MeshCorePacketDecoder=gn});var Cn=U(w0=>{"use strict";Object.defineProperty(w0,"__esModule",{value:!0});w0.createAuthToken=so;w0.verifyAuthToken=ao;w0.parseAuthToken=io;w0.decodeAuthTokenPayload=oo;var Oa=ur(),La=ie();function Ia(t){let e="";if(typeof Buffer<"u")e=Buffer.from(t).toString("base64");else{let r=String.fromCharCode(...Array.from(t));e=btoa(r)}return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function bn(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");for(;e.length%4;)e+="=";if(typeof Buffer<"u")return new Uint8Array(Buffer.from(e,"base64"));{let r=atob(e),n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n}}async function so(t,e,r){let n={alg:"Ed25519",typ:"JWT"};t.publicKey?t.publicKey=t.publicKey.toUpperCase():t.publicKey=r.toUpperCase(),t.iat||(t.iat=Math.floor(Date.now()/1e3));let a=JSON.stringify(n),s=JSON.stringify(t),c=new TextEncoder().encode(a),i=new TextEncoder().encode(s),u=Ia(c),d=Ia(i),o=`${u}.${d}`,f=new TextEncoder().encode(o),x=(0,La.bytesToHex)(f),h=await(0,Oa.sign)(x,e,t.publicKey);return`${u}.${d}.${h}`}async function ao(t,e){try{let r=t.split(".");if(r.length!==3)return null;let[n,a,s]=r,c=bn(n),i=bn(a),u=new TextDecoder().decode(c),d=new TextDecoder().decode(i),o=JSON.parse(u),f=JSON.parse(d);if(o.alg!=="Ed25519"||o.typ!=="JWT"||!f.publicKey||!f.iat||e&&f.publicKey.toUpperCase()!==e.toUpperCase()||f.exp&&Math.floor(Date.now()/1e3)>f.exp)return null;let x=`${n}.${a}`,h=new TextEncoder().encode(x),y=(0,La.bytesToHex)(h);return await(0,Oa.verify)(s,y,f.publicKey)?f:null}catch{return null}}function io(t){try{let e=t.split(".");return e.length!==3?null:{header:e[0],payload:e[1],signature:e[2]}}catch{return null}}function oo(t){try{let e=t.split(".");if(e.length!==3)return null;let r=bn(e[1]),n=new TextDecoder().decode(r);return JSON.parse(n)}catch{return null}}});var En=U(N=>{"use strict";var co=N&&N.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var a=Object.getOwnPropertyDescriptor(e,r);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,a)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),uo=N&&N.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),An=N&&N.__importStar||function(){var t=function(e){return t=Object.getOwnPropertyNames||function(r){var n=[];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[n.length]=a);return n},t(e)};return function(e){if(e&&e.__esModule)return e;var r={};if(e!=null)for(var n=t(e),a=0;a<n.length;a++)n[a]!=="default"&&co(r,e,n[a]);return uo(r,e),r}}();Object.defineProperty(N,"__esModule",{value:!0});N.Utils=N.decodeAuthTokenPayload=N.parseAuthToken=N.verifyAuthToken=N.createAuthToken=N.getControlSubTypeName=N.getRequestTypeName=N.getDeviceRoleName=N.getPayloadVersionName=N.getPayloadTypeName=N.getRouteTypeName=N.numberToHex=N.byteToHex=N.bytesToHex=N.hexToBytes=N.Ed25519SignatureVerifier=N.ChannelCrypto=N.MeshCoreKeyStore=N.ControlSubType=N.RequestType=N.AdvertFlags=N.DeviceRole=N.PayloadVersion=N.PayloadType=N.RouteType=N.MeshCoreDecoder=N.MeshCorePacketDecoder=void 0;var xo=Bn();Object.defineProperty(N,"MeshCorePacketDecoder",{enumerable:!0,get:function(){return xo.MeshCorePacketDecoder}});var fo=Bn();Object.defineProperty(N,"MeshCoreDecoder",{enumerable:!0,get:function(){return fo.MeshCorePacketDecoder}});var c0=le();Object.defineProperty(N,"RouteType",{enumerable:!0,get:function(){return c0.RouteType}});Object.defineProperty(N,"PayloadType",{enumerable:!0,get:function(){return c0.PayloadType}});Object.defineProperty(N,"PayloadVersion",{enumerable:!0,get:function(){return c0.PayloadVersion}});Object.defineProperty(N,"DeviceRole",{enumerable:!0,get:function(){return c0.DeviceRole}});Object.defineProperty(N,"AdvertFlags",{enumerable:!0,get:function(){return c0.AdvertFlags}});Object.defineProperty(N,"RequestType",{enumerable:!0,get:function(){return c0.RequestType}});Object.defineProperty(N,"ControlSubType",{enumerable:!0,get:function(){return c0.ControlSubType}});var lo=Vr();Object.defineProperty(N,"MeshCoreKeyStore",{enumerable:!0,get:function(){return lo.MeshCoreKeyStore}});var ho=er();Object.defineProperty(N,"ChannelCrypto",{enumerable:!0,get:function(){return ho.ChannelCrypto}});var po=on();Object.defineProperty(N,"Ed25519SignatureVerifier",{enumerable:!0,get:function(){return po.Ed25519SignatureVerifier}});var Ar=ie();Object.defineProperty(N,"hexToBytes",{enumerable:!0,get:function(){return Ar.hexToBytes}});Object.defineProperty(N,"bytesToHex",{enumerable:!0,get:function(){return Ar.bytesToHex}});Object.defineProperty(N,"byteToHex",{enumerable:!0,get:function(){return Ar.byteToHex}});Object.defineProperty(N,"numberToHex",{enumerable:!0,get:function(){return Ar.numberToHex}});var S0=p0();Object.defineProperty(N,"getRouteTypeName",{enumerable:!0,get:function(){return S0.getRouteTypeName}});Object.defineProperty(N,"getPayloadTypeName",{enumerable:!0,get:function(){return S0.getPayloadTypeName}});Object.defineProperty(N,"getPayloadVersionName",{enumerable:!0,get:function(){return S0.getPayloadVersionName}});Object.defineProperty(N,"getDeviceRoleName",{enumerable:!0,get:function(){return S0.getDeviceRoleName}});Object.defineProperty(N,"getRequestTypeName",{enumerable:!0,get:function(){return S0.getRequestTypeName}});Object.defineProperty(N,"getControlSubTypeName",{enumerable:!0,get:function(){return S0.getControlSubTypeName}});var Er=Cn();Object.defineProperty(N,"createAuthToken",{enumerable:!0,get:function(){return Er.createAuthToken}});Object.defineProperty(N,"verifyAuthToken",{enumerable:!0,get:function(){return Er.verifyAuthToken}});Object.defineProperty(N,"parseAuthToken",{enumerable:!0,get:function(){return Er.parseAuthToken}});Object.defineProperty(N,"decodeAuthTokenPayload",{enumerable:!0,get:function(){return Er.decodeAuthTokenPayload}});var yo=An(p0()),vo=An(ie()),mo=An(Cn()),Cr=ur();N.Utils={...yo,...vo,...mo,derivePublicKey:Cr.derivePublicKey,validateKeyPair:Cr.validateKeyPair,sign:Cr.sign,verify:Cr.verify}});var Ua=U((_r,Na)=>{(function(t,e,r){typeof _r=="object"?Na.exports=_r=e(G(),y0(),V0()):typeof define=="function"&&define.amd?define(["./core","./sha256","./hmac"],e):e(t.CryptoJS)})(_r,function(t){return t.HmacSHA256})});var za=U((Dr,Va)=>{(function(t,e){typeof Dr=="object"?Va.exports=Dr=e(G()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(Dr,function(t){return t.enc.Hex})});var Ae=N0(En(),1);var Fr=N0(En(),1);var _n=N0(y0(),1),$a=N0(Ua(),1),x0=N0(za(),1),Ka="abcdefghijklmnopqrstuvwxyz0123456789",u0=Ka.length,Ga=Ka+"-",me="[[public room]]",ge="8b3387e9c5cdea6ac9e5edbaa115cd72",X0=30*24*60*60;function Dn(t){if(!t||t.length===0)return null;let e=t.length,r=0,n=1;for(let a=0;a<e;a++){let s=t[a],c=Ga.indexOf(s);if(c===-1)return null;let i=a===0,u=a===e-1,d=i||u?36:37;if((i||u)&&c===36)return null;r+=c*n,n*=d}return{length:e,index:r}}function Ce(t,e){if(t<=0)return null;let r="",n=e,a=!1;for(let s=0;s<t;s++){let c=s===0,i=s===t-1,u=c||i?36:37,d=n%u;n=Math.floor(n/u);let o=d===36;if(o&&a)return null;a=o,r+=Ga[d]}return r}function Le(t){return t===me?ge:(0,_n.default)(t).toString(x0.default).substring(0,32)}function T0(t){return(0,_n.default)(x0.default.parse(t)).toString(x0.default).substring(0,2)}function Z0(t,e,r){let n=r.padEnd(64,"0");return(0,$a.default)(x0.default.parse(t),x0.default.parse(n)).toString(x0.default).substring(0,4).toLowerCase()===e.toLowerCase()}function Ze(t){if(t===1)return u0;if(t===2)return u0*u0;let e=u0,r=1;for(let a=2;a<=t-2;a++){let s=(e+r)*u0,c=e;e=s,r=c}let n=t>2?e+r:1;return u0*n*u0}function Fn(t,e=X0,r){let n=r??Math.floor(Date.now()/1e3);return t<=n&&t>=n-e}function wn(t){return!t.includes("\uFFFD")}var Y0=class t{constructor(){this.device=null,this.pipeline=null,this.bindGroupLayout=null,this.paramsBuffer=null,this.matchCountBuffer=null,this.matchIndicesBuffer=null,this.ciphertextBuffer=null,this.ciphertextBufferSize=0,this.matchCountReadBuffers=[null,null],this.matchIndicesReadBuffers=[null,null],this.currentReadBufferIndex=0,this.bindGroup=null,this.bindGroupDirty=!0,this.shaderCode=`
// SHA256 round constants
const K: array<u32, 64> = array<u32, 64>(
  0x428a2f98u, 0x71374491u, 0xb5c0fbcfu, 0xe9b5dba5u, 0x3956c25bu, 0x59f111f1u, 0x923f82a4u, 0xab1c5ed5u,
  0xd807aa98u, 0x12835b01u, 0x243185beu, 0x550c7dc3u, 0x72be5d74u, 0x80deb1feu, 0x9bdc06a7u, 0xc19bf174u,
  0xe49b69c1u, 0xefbe4786u, 0x0fc19dc6u, 0x240ca1ccu, 0x2de92c6fu, 0x4a7484aau, 0x5cb0a9dcu, 0x76f988dau,
  0x983e5152u, 0xa831c66du, 0xb00327c8u, 0xbf597fc7u, 0xc6e00bf3u, 0xd5a79147u, 0x06ca6351u, 0x14292967u,
  0x27b70a85u, 0x2e1b2138u, 0x4d2c6dfcu, 0x53380d13u, 0x650a7354u, 0x766a0abbu, 0x81c2c92eu, 0x92722c85u,
  0xa2bfe8a1u, 0xa81a664bu, 0xc24b8b70u, 0xc76c51a3u, 0xd192e819u, 0xd6990624u, 0xf40e3585u, 0x106aa070u,
  0x19a4c116u, 0x1e376c08u, 0x2748774cu, 0x34b0bcb5u, 0x391c0cb3u, 0x4ed8aa4au, 0x5b9cca4fu, 0x682e6ff3u,
  0x748f82eeu, 0x78a5636fu, 0x84c87814u, 0x8cc70208u, 0x90befffau, 0xa4506cebu, 0xbef9a3f7u, 0xc67178f2u
);

// Character lookup table (a-z = 0-25, 0-9 = 26-35, dash = 36)
const CHARS: array<u32, 37> = array<u32, 37>(
  0x61u, 0x62u, 0x63u, 0x64u, 0x65u, 0x66u, 0x67u, 0x68u, 0x69u, 0x6au, // a-j
  0x6bu, 0x6cu, 0x6du, 0x6eu, 0x6fu, 0x70u, 0x71u, 0x72u, 0x73u, 0x74u, // k-t
  0x75u, 0x76u, 0x77u, 0x78u, 0x79u, 0x7au,                             // u-z
  0x30u, 0x31u, 0x32u, 0x33u, 0x34u, 0x35u, 0x36u, 0x37u, 0x38u, 0x39u, // 0-9
  0x2du                                                                  // dash
);

struct Params {
  target_channel_hash: u32,
  batch_offset: u32,
  name_length: u32,
  batch_size: u32,
  target_mac: u32,           // First 2 bytes of target MAC (in high 16 bits)
  ciphertext_words: u32,     // Number of 32-bit words in ciphertext
  ciphertext_len_bits: u32,  // Length of ciphertext in bits
  verify_mac: u32,           // 1 to verify MAC, 0 to skip
}

@group(0) @binding(0) var<uniform> params: Params;
@group(0) @binding(1) var<storage, read_write> match_count: atomic<u32>;
@group(0) @binding(2) var<storage, read_write> match_indices: array<u32>;
@group(0) @binding(3) var<storage, read> ciphertext: array<u32>; // Ciphertext data

fn rotr(x: u32, n: u32) -> u32 {
  return (x >> n) | (x << (32u - n));
}

fn ch(x: u32, y: u32, z: u32) -> u32 {
  return (x & y) ^ (~x & z);
}

fn maj(x: u32, y: u32, z: u32) -> u32 {
  return (x & y) ^ (x & z) ^ (y & z);
}

fn sigma0(x: u32) -> u32 {
  return rotr(x, 2u) ^ rotr(x, 13u) ^ rotr(x, 22u);
}

fn sigma1(x: u32) -> u32 {
  return rotr(x, 6u) ^ rotr(x, 11u) ^ rotr(x, 25u);
}

fn gamma0(x: u32) -> u32 {
  return rotr(x, 7u) ^ rotr(x, 18u) ^ (x >> 3u);
}

fn gamma1(x: u32) -> u32 {
  return rotr(x, 17u) ^ rotr(x, 19u) ^ (x >> 10u);
}

// Convert index to room name bytes, returns the hash as a u32 for the first byte check
fn index_to_room_name(idx: u32, length: u32, msg: ptr<function, array<u32, 16>>) -> bool {
  // Message starts with '#' (0x23)
  var byte_pos = 0u;
  var word_idx = 0u;
  var current_word = 0x23000000u; // '#' in big-endian position 0
  byte_pos = 1u;

  var remaining = idx;
  var prev_was_dash = false;

  // Generate room name from index
  for (var i = 0u; i < length; i++) {
    let char_count = select(37u, 36u, i == 0u || i == length - 1u); // no dash at start/end
    var char_idx = remaining % char_count;
    remaining = remaining / char_count;

    // Check for consecutive dashes (invalid)
    let is_dash = char_idx == 36u && i > 0u && i < length - 1u;
    if (is_dash && prev_was_dash) {
      return false; // Invalid: consecutive dashes
    }
    prev_was_dash = is_dash;

    // Map char index to actual character
    let c = CHARS[char_idx];

    // Pack byte into current word (big-endian)
    let shift = (3u - byte_pos % 4u) * 8u;
    if (byte_pos % 4u == 0u && byte_pos > 0u) {
      (*msg)[word_idx] = current_word;
      word_idx = word_idx + 1u;
      current_word = 0u;
    }
    current_word = current_word | (c << shift);
    byte_pos = byte_pos + 1u;
  }

  // Add padding: 0x80 followed by zeros, then length in bits
  let msg_len_bits = (length + 1u) * 8u; // +1 for '#'

  // Add 0x80 padding byte
  let shift = (3u - byte_pos % 4u) * 8u;
  if (byte_pos % 4u == 0u) {
    (*msg)[word_idx] = current_word;
    word_idx = word_idx + 1u;
    current_word = 0x80000000u;
  } else {
    current_word = current_word | (0x80u << shift);
  }
  byte_pos = byte_pos + 1u;

  // Store current word
  if (byte_pos % 4u == 0u || word_idx < 14u) {
    (*msg)[word_idx] = current_word;
    word_idx = word_idx + 1u;
  }

  // Zero-fill until word 14
  for (var i = word_idx; i < 14u; i++) {
    (*msg)[i] = 0u;
  }

  // Length in bits (64-bit, but we only use lower 32 bits for short messages)
  (*msg)[14u] = 0u;
  (*msg)[15u] = msg_len_bits;

  return true;
}

fn sha256_block(msg: ptr<function, array<u32, 16>>) -> array<u32, 8> {
  // Initialize hash values
  var h: array<u32, 8> = array<u32, 8>(
    0x6a09e667u, 0xbb67ae85u, 0x3c6ef372u, 0xa54ff53au,
    0x510e527fu, 0x9b05688cu, 0x1f83d9abu, 0x5be0cd19u
  );

  // Message schedule
  var w: array<u32, 64>;
  for (var i = 0u; i < 16u; i++) {
    w[i] = (*msg)[i];
  }
  for (var i = 16u; i < 64u; i++) {
    w[i] = gamma1(w[i-2u]) + w[i-7u] + gamma0(w[i-15u]) + w[i-16u];
  }

  // Compression
  var a = h[0]; var b = h[1]; var c = h[2]; var d = h[3];
  var e = h[4]; var f = h[5]; var g = h[6]; var hh = h[7];

  for (var i = 0u; i < 64u; i++) {
    let t1 = hh + sigma1(e) + ch(e, f, g) + K[i] + w[i];
    let t2 = sigma0(a) + maj(a, b, c);
    hh = g; g = f; f = e; e = d + t1;
    d = c; c = b; b = a; a = t1 + t2;
  }

  h[0] = h[0] + a; h[1] = h[1] + b; h[2] = h[2] + c; h[3] = h[3] + d;
  h[4] = h[4] + e; h[5] = h[5] + f; h[6] = h[6] + g; h[7] = h[7] + hh;

  return h;
}

// Compute SHA256 of the key (16 bytes) to get channel hash
fn sha256_key(key: array<u32, 4>) -> u32 {
  var msg: array<u32, 16>;

  // Key bytes (16 bytes = 4 words)
  msg[0] = key[0];
  msg[1] = key[1];
  msg[2] = key[2];
  msg[3] = key[3];

  // Padding: 0x80 followed by zeros
  msg[4] = 0x80000000u;
  for (var i = 5u; i < 14u; i++) {
    msg[i] = 0u;
  }

  // Length: 128 bits
  msg[14] = 0u;
  msg[15] = 128u;

  let hash = sha256_block(&msg);

  // Return first byte of hash (big-endian)
  return hash[0] >> 24u;
}

// HMAC-SHA256 for MAC verification
// Key is 16 bytes (4 words), padded to 32 bytes with zeros for MeshCore
// Returns first 2 bytes of HMAC (as u32 in high 16 bits)
fn hmac_sha256_mac(key: array<u32, 4>, ciphertext_len: u32) -> u32 {
  // HMAC: H((K' ^ opad) || H((K' ^ ipad) || message))
  // K' is 64 bytes (32 bytes key + 32 bytes zero padding for MeshCore, then padded to 64)
  // ipad = 0x36 repeated, opad = 0x5c repeated

  // Build padded key (64 bytes = 16 words)
  // MeshCore uses 32-byte secret: 16-byte key + 16 zero bytes
  var k_pad: array<u32, 16>;
  k_pad[0] = key[0];
  k_pad[1] = key[1];
  k_pad[2] = key[2];
  k_pad[3] = key[3];
  for (var i = 4u; i < 16u; i++) {
    k_pad[i] = 0u;
  }

  // Inner hash: SHA256((K' ^ ipad) || message)
  // First block: K' ^ ipad (64 bytes)
  var inner_block: array<u32, 16>;
  for (var i = 0u; i < 16u; i++) {
    inner_block[i] = k_pad[i] ^ 0x36363636u;
  }

  // Initialize hash state with first block
  var h: array<u32, 8> = sha256_block(&inner_block);

  // Process ciphertext blocks (continuing from h state)
  let ciphertext_words = params.ciphertext_words;
  var word_idx = 0u;

  // Process full 64-byte blocks of ciphertext
  while (word_idx + 16u <= ciphertext_words) {
    var block: array<u32, 16>;
    for (var i = 0u; i < 16u; i++) {
      block[i] = ciphertext[word_idx + i];
    }
    h = sha256_block_continue(&block, h);
    word_idx = word_idx + 16u;
  }

  // Final block with remaining ciphertext + padding
  var final_block: array<u32, 16>;
  var remaining = ciphertext_words - word_idx;
  for (var i = 0u; i < 16u; i++) {
    if (i < remaining) {
      final_block[i] = ciphertext[word_idx + i];
    } else if (i == remaining) {
      // Add 0x80 padding
      final_block[i] = 0x80000000u;
    } else {
      final_block[i] = 0u;
    }
  }

  // Add length (64 bytes of ipad + ciphertext length)
  let total_bits = 512u + params.ciphertext_len_bits;
  if (remaining < 14u) {
    final_block[14] = 0u;
    final_block[15] = total_bits;
    h = sha256_block_continue(&final_block, h);
  } else {
    // Need extra block for length
    h = sha256_block_continue(&final_block, h);
    var len_block: array<u32, 16>;
    for (var i = 0u; i < 14u; i++) {
      len_block[i] = 0u;
    }
    len_block[14] = 0u;
    len_block[15] = total_bits;
    h = sha256_block_continue(&len_block, h);
  }

  let inner_hash = h;

  // Outer hash: SHA256((K' ^ opad) || inner_hash)
  var outer_block: array<u32, 16>;
  for (var i = 0u; i < 16u; i++) {
    outer_block[i] = k_pad[i] ^ 0x5c5c5c5cu;
  }
  h = sha256_block(&outer_block);

  // Second block: inner_hash (32 bytes) + padding
  var hash_block: array<u32, 16>;
  for (var i = 0u; i < 8u; i++) {
    hash_block[i] = inner_hash[i];
  }
  hash_block[8] = 0x80000000u;
  for (var i = 9u; i < 14u; i++) {
    hash_block[i] = 0u;
  }
  hash_block[14] = 0u;
  hash_block[15] = 512u + 256u; // 64 bytes opad + 32 bytes inner hash

  h = sha256_block_continue(&hash_block, h);

  // Return first 2 bytes (high 16 bits of first word)
  return h[0] & 0xFFFF0000u;
}

// SHA256 block computation continuing from existing state
fn sha256_block_continue(msg: ptr<function, array<u32, 16>>, h_in: array<u32, 8>) -> array<u32, 8> {
  var h = h_in;

  // Message schedule
  var w: array<u32, 64>;
  for (var i = 0u; i < 16u; i++) {
    w[i] = (*msg)[i];
  }
  for (var i = 16u; i < 64u; i++) {
    w[i] = gamma1(w[i-2u]) + w[i-7u] + gamma0(w[i-15u]) + w[i-16u];
  }

  // Compression
  var a = h[0]; var b = h[1]; var c = h[2]; var d = h[3];
  var e = h[4]; var f = h[5]; var g = h[6]; var hh = h[7];

  for (var i = 0u; i < 64u; i++) {
    let t1 = hh + sigma1(e) + ch(e, f, g) + K[i] + w[i];
    let t2 = sigma0(a) + maj(a, b, c);
    hh = g; g = f; f = e; e = d + t1;
    d = c; c = b; b = a; a = t1 + t2;
  }

  h[0] = h[0] + a; h[1] = h[1] + b; h[2] = h[2] + c; h[3] = h[3] + d;
  h[4] = h[4] + e; h[5] = h[5] + f; h[6] = h[6] + g; h[7] = h[7] + hh;

  return h;
}

// Process a single candidate and record match if found
fn process_candidate(name_idx: u32) {
  // Generate message for this room name
  var msg: array<u32, 16>;
  let valid = index_to_room_name(name_idx, params.name_length, &msg);

  if (!valid) {
    return;
  }

  // Compute SHA256("#roomname") - this gives us the key
  let key_hash = sha256_block(&msg);

  // Take first 16 bytes (4 words) as the key
  var key: array<u32, 4>;
  key[0] = key_hash[0];
  key[1] = key_hash[1];
  key[2] = key_hash[2];
  key[3] = key_hash[3];

  // Compute SHA256(key) to get channel hash
  let channel_hash = sha256_key(key);

  // Check if channel hash matches target
  if (channel_hash != params.target_channel_hash) {
    return;
  }

  // Channel hash matches - verify MAC if enabled
  if (params.verify_mac == 1u) {
    let computed_mac = hmac_sha256_mac(key, params.ciphertext_len_bits);
    if (computed_mac != params.target_mac) {
      return;
    }
  }

  // Found a match - record the index
  let match_idx = atomicAdd(&match_count, 1u);
  if (match_idx < 1024u) { // Limit stored matches
    match_indices[match_idx] = name_idx;
  }
}

// Each thread processes 16 candidates to amortize thread overhead
const CANDIDATES_PER_THREAD: u32 = 16u;

@compute @workgroup_size(256)
fn main(@builtin(global_invocation_id) global_id: vec3<u32>) {
  let base_idx = global_id.x * CANDIDATES_PER_THREAD;

  for (var i = 0u; i < CANDIDATES_PER_THREAD; i++) {
    let idx = base_idx + i;
    if (idx >= params.batch_size) {
      return;
    }
    let name_idx = params.batch_offset + idx;
    process_candidate(name_idx);
  }
}
`}async init(){if(!navigator.gpu)return console.warn("WebGPU not supported"),!1;try{let e=await navigator.gpu.requestAdapter();if(!e)return console.warn("No GPU adapter found"),!1;this.device=await e.requestDevice(),this.bindGroupLayout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}},{binding:2,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}},{binding:3,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}}]}),this.paramsBuffer=this.device.createBuffer({size:32,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.matchCountBuffer=this.device.createBuffer({size:4,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST}),this.matchIndicesBuffer=this.device.createBuffer({size:1024*4,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC});for(let a=0;a<2;a++)this.matchCountReadBuffers[a]=this.device.createBuffer({size:4,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.matchIndicesReadBuffers[a]=this.device.createBuffer({size:1024*4,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST});let r=this.device.createShaderModule({code:this.shaderCode}),n=this.device.createPipelineLayout({bindGroupLayouts:[this.bindGroupLayout]});return this.pipeline=this.device.createComputePipeline({layout:n,compute:{module:r,entryPoint:"main"}}),!0}catch(e){return console.error("WebGPU initialization failed:",e),!1}}isAvailable(){return this.device!==null&&this.pipeline!==null}indexToRoomName(e,r){return Ce(r,e)}countNamesForLength(e){return Ze(e)}async runBatch(e,r,n,a,s,c){if(!this.device||!this.pipeline||!this.bindGroupLayout||!this.paramsBuffer||!this.matchCountBuffer||!this.matchIndicesBuffer||!this.matchCountReadBuffers[0]||!this.matchCountReadBuffers[1]||!this.matchIndicesReadBuffers[0]||!this.matchIndicesReadBuffers[1])throw new Error("GPU not initialized");let i=this.currentReadBufferIndex;this.currentReadBufferIndex=1-this.currentReadBufferIndex;let u=this.matchCountReadBuffers[i],d=this.matchIndicesReadBuffers[i],o=s&&c?1:0,f,x=0,h=0;if(o){let C=new Uint8Array(s.length/2);for(let q=0;q<C.length;q++)C[q]=parseInt(s.substr(q*2,2),16);x=C.length*8;let m=Math.ceil(C.length/4)*4,S=new Uint8Array(m);S.set(C),f=new Uint32Array(m/4);for(let q=0;q<f.length;q++)f[q]=S[q*4]<<24|S[q*4+1]<<16|S[q*4+2]<<8|S[q*4+3];let T=parseInt(c.substr(0,2),16),R=parseInt(c.substr(2,2),16);h=T<<24|R<<16}else f=new Uint32Array([0]);let y=Math.max(f.length*4,4);(!this.ciphertextBuffer||this.ciphertextBufferSize<y)&&(this.ciphertextBuffer&&this.ciphertextBuffer.destroy(),this.ciphertextBuffer=this.device.createBuffer({size:y,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),this.ciphertextBufferSize=y,this.bindGroupDirty=!0);let g=new Uint32Array([e,n,r,a,h,f.length,x,o]);this.device.queue.writeBuffer(this.paramsBuffer,0,g),this.device.queue.writeBuffer(this.ciphertextBuffer,0,f),this.device.queue.writeBuffer(this.matchCountBuffer,0,t.ZERO_DATA),(this.bindGroupDirty||!this.bindGroup)&&(this.bindGroup=this.device.createBindGroup({layout:this.bindGroupLayout,entries:[{binding:0,resource:{buffer:this.paramsBuffer}},{binding:1,resource:{buffer:this.matchCountBuffer}},{binding:2,resource:{buffer:this.matchIndicesBuffer}},{binding:3,resource:{buffer:this.ciphertextBuffer}}]}),this.bindGroupDirty=!1);let v=this.device.createCommandEncoder(),l=v.beginComputePass();l.setPipeline(this.pipeline),l.setBindGroup(0,this.bindGroup),l.dispatchWorkgroups(Math.ceil(a/(256*16))),l.end(),v.copyBufferToBuffer(this.matchCountBuffer,0,u,0,4),v.copyBufferToBuffer(this.matchIndicesBuffer,0,d,0,1024*4),this.device.queue.submit([v.finish()]),await u.mapAsync(GPUMapMode.READ);let b=new Uint32Array(u.getMappedRange())[0];u.unmap();let B=[];if(b>0){await d.mapAsync(GPUMapMode.READ);let C=new Uint32Array(d.getMappedRange());for(let m=0;m<Math.min(b,1024);m++)B.push(C[m]);d.unmap()}return B}destroy(){this.paramsBuffer?.destroy(),this.matchCountBuffer?.destroy(),this.matchIndicesBuffer?.destroy(),this.ciphertextBuffer?.destroy(),this.matchCountReadBuffers[0]?.destroy(),this.matchCountReadBuffers[1]?.destroy(),this.matchIndicesReadBuffers[0]?.destroy(),this.matchIndicesReadBuffers[1]?.destroy(),this.paramsBuffer=null,this.matchCountBuffer=null,this.matchIndicesBuffer=null,this.ciphertextBuffer=null,this.ciphertextBufferSize=0,this.matchCountReadBuffers=[null,null],this.matchIndicesReadBuffers=[null,null],this.currentReadBufferIndex=0,this.bindGroup=null,this.bindGroupDirty=!0,this.device&&(this.device.destroy(),this.device=null),this.pipeline=null,this.bindGroupLayout=null}};Y0.ZERO_DATA=new Uint32Array([0]);function Sn(){return typeof navigator<"u"&&"gpu"in navigator}var J0=class{runBatch(e,r,n,a,s,c){let i=[],u=e.toString(16).padStart(2,"0"),d=!!(s&&c);for(let o=0;o<a;o++){let f=n+o,x=Ce(r,f);if(!x)continue;let h=Le("#"+x);T0(h)===u&&(d&&!Z0(s,c,h)||i.push(f))}return i}destroy(){}};var go=/^[a-z0-9-]+$/,Bo=/^[a-z0-9].*[a-z0-9]$|^[a-z0-9]$/,bo=/--/;function ja(t){return!(!t||t.length===0||!go.test(t)||t.length>1&&!Bo.test(t)||bo.test(t))}var Q0=class{constructor(){this.gpuInstance=null,this.cpuInstance=null,this.wordlist=[],this.abortFlag=!1,this.useTimestampFilter=!0,this.useUtf8Filter=!0,this.validSeconds=X0,this.useCpu=!1}async loadWordlist(e){let r=await fetch(e);if(!r.ok)throw new Error(`Failed to load wordlist: ${r.status} ${r.statusText}`);let a=(await r.text()).split(`
`).map(s=>s.trim().toLowerCase()).filter(s=>s.length>0);this.wordlist=a.filter(ja)}setWordlist(e){this.wordlist=e.map(r=>r.trim().toLowerCase()).filter(ja)}abort(){this.abortFlag=!0}isGpuAvailable(){return Sn()}async decodePacket(e){let r=e.trim().replace(/\s+/g,"").replace(/^0x/i,"");if(!r||!/^[0-9a-fA-F]+$/.test(r))return null;try{let a=(await Fr.MeshCorePacketDecoder.decodeWithVerification(r,{})).payload?.decoded;return!a?.channelHash||!a?.ciphertext||!a?.cipherMac?null:{channelHash:a.channelHash,ciphertext:a.ciphertext,cipherMac:a.cipherMac,isGroupText:!0}}catch{return null}}async crack(e,r,n){this.abortFlag=!1,this.useTimestampFilter=r?.useTimestampFilter??!0,this.useUtf8Filter=r?.useUtf8Filter??!0,this.validSeconds=r?.validSeconds??X0,this.useCpu=r?.forceCpu??!1;let a=r?.maxLength??8,s=r?.startingLength??1,c=r?.useDictionary??!0,i=r?.startFromType??"bruteforce",u=await this.decodePacket(e);if(!u)return{found:!1,error:"Invalid packet or not a GroupText packet"};let{channelHash:d,ciphertext:o,cipherMac:f}=u,x=parseInt(d,16);this.useCpu?this.cpuInstance||(this.cpuInstance=new J0):this.gpuInstance||(this.gpuInstance=new Y0,await this.gpuInstance.init()||(this.useCpu=!0,this.cpuInstance=new J0));let h=performance.now(),y=0,g=performance.now(),v=s,l=0,p=0,b=!1;if(r?.startFrom){let A=r.startFrom.toLowerCase();if(i==="dictionary"){let H=this.wordlist.indexOf(A);H>=0&&(p=H+1)}else{b=!0;let H=Dn(A);H&&(v=Math.max(s,H.length),l=H.index+1,l>=Ze(v)&&(v++,l=0))}}let B=0;c&&!b&&this.wordlist.length>0&&(B+=this.wordlist.length-p);for(let A=v;A<=a;A++)B+=Ze(A);B-=l;let C=(A,H,w)=>{if(!n)return;let I=(performance.now()-h)/1e3,z=I>0?Math.round(y/I):0,$=B-y,D=z>0?$/z:0;n({checked:y,total:B,percent:B>0?Math.min(100,y/B*100):0,rateKeysPerSec:z,etaSeconds:D,elapsedSeconds:I,currentLength:H,currentPosition:w,phase:A})},m=A=>{if(!Z0(o,f,A))return{valid:!1};let H=Fr.ChannelCrypto.decryptGroupTextMessage(o,f,A);return!H.success||!H.data?{valid:!1}:this.useTimestampFilter&&!Fn(H.data.timestamp,this.validSeconds)?{valid:!1}:this.useUtf8Filter&&!wn(H.data.message)?{valid:!1}:{valid:!0,message:H.data.message}};if(!b&&p===0&&v===s&&l===0){C("public-key",0,me);let A=T0(ge);if(d===A){let H=m(ge);if(H.valid)return{found:!0,roomName:me,key:ge,decryptedMessage:H.message}}}if(c&&!b&&this.wordlist.length>0)for(let A=p;A<this.wordlist.length;A++){if(this.abortFlag)return{found:!1,aborted:!0,resumeFrom:this.wordlist[A],resumeType:"dictionary"};let H=this.wordlist[A],w=Le("#"+H),V=T0(w);if(parseInt(V,16)===x){let z=m(w);if(z.valid)return{found:!0,roomName:H,key:w,decryptedMessage:z.message,resumeFrom:H,resumeType:"dictionary"}}y++;let I=performance.now();I-g>=200&&(C("wordlist",H.length,H),g=I,await new Promise(z=>setTimeout(z,0)))}let S=this.useCpu?1024:32768,T=1e3,R=S,q=!1;for(let A=v;A<=a;A++){if(this.abortFlag)return{found:!1,aborted:!0,resumeFrom:Ce(A,0)||void 0,resumeType:"bruteforce"};let H=Ze(A),w=A===v?l:0;for(;w<H;){if(this.abortFlag)return{found:!1,aborted:!0,resumeFrom:Ce(A,w)||void 0,resumeType:"bruteforce"};let V=Math.min(R,H-w),I=performance.now(),z;this.useCpu?z=this.cpuInstance.runBatch(x,A,w,V,o,f):z=await this.gpuInstance.runBatch(x,A,w,V,o,f);let $=performance.now()-I;if(y+=V,!this.useCpu&&!q&&V>=S&&$>0){let k=T/$,P=Math.round(V*k),F=Math.pow(2,Math.round(Math.log2(Math.max(S,P))));R=Math.max(S,F),q=!0}for(let k of z){let P=Ce(A,k);if(!P)continue;let F=Le("#"+P),X=m(F);if(X.valid)return{found:!0,roomName:P,key:F,decryptedMessage:X.message,resumeFrom:P,resumeType:"bruteforce"}}w+=V;let D=performance.now();if(D-g>=200){let k=Ce(A,Math.min(w,H-1))||"";C("bruteforce",A,k),g=D,await new Promise(P=>setTimeout(P,0))}}}return{found:!1,resumeFrom:Ce(a,Ze(a)-1)||void 0,resumeType:"bruteforce"}}destroy(){this.gpuInstance&&(this.gpuInstance.destroy(),this.gpuInstance=null),this.cpuInstance&&(this.cpuInstance.destroy(),this.cpuInstance=null)}};function ae(t){return String(t).replace(/[&<>"']/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[e]||e)}var et=null,P0=!1,Tn="",Hn,rt="",kn=!0,Pn=!0;function Wa(t){if(t<60)return`${Math.round(t)}s`;if(t<3600){let n=Math.floor(t/60),a=Math.round(t%60);return`${n}:${a.toString().padStart(2,"0")}`}let e=Math.floor(t/3600),r=Math.floor(t%3600/60);return`${e}:${r.toString().padStart(2,"0")}:${Math.round(t%60).toString().padStart(2,"0")}`}function Co(t){return t>=1e9?`${(t/1e9).toFixed(2)} Gkeys/s`:t>=1e6?`${(t/1e6).toFixed(2)} Mkeys/s`:t>=1e3?`${(t/1e3).toFixed(1)} kkeys/s`:`${t} keys/s`}function Rn(){return{statusEl:document.getElementById("brute-status"),bruteBtn:document.getElementById("brute-btn"),skipBtn:document.getElementById("brute-skip-btn")}}function Ao(){let{bruteBtn:t,skipBtn:e}=Rn();P0=!0,t.disabled=!1,t.textContent="Stop",t.classList.add("running"),e.style.display="none"}function wr(t){let{bruteBtn:e,skipBtn:r}=Rn();P0=!1,e.textContent="Start",e.classList.remove("running"),r.style.display=t?"inline-block":"none"}function Eo(){return document.getElementById("resume-from")}function Xa(t){let e=Eo();e&&(e.value=t)}async function Za(t,e,r){if(!et)return{found:!1};let{statusEl:n}=Rn();Tn=t,Ao();try{let a=await et.crack(t,{maxLength:20,useTimestampFilter:kn,useUtf8Filter:Pn,startFrom:e,startFromType:r},s=>{let c=s.phase==="wordlist"?`dict: ${ae(s.currentPosition)}`:`GPU length ${s.currentLength}`,i=365*24*60*60,d=s.etaSeconds<i&&s.percent>0?`<div class="stat">${s.percent.toFixed(1)}% complete, ~${Wa(s.etaSeconds)} remaining</div>`:`<div class="stat">Searching length ${s.currentLength}...</div>`;n.innerHTML=`<div class="stat">Mode: ${c}</div><div class="stat">Elapsed: ${Wa(s.elapsedSeconds)} | Checked: ${s.checked.toLocaleString()} keys (${Co(s.rateKeysPerSec)})</div>`+d});return a.found&&a.roomName&&a.key?(n.innerHTML=`<div class="stat found">Found: #${ae(a.roomName)}</div><div class="stat">Key: ${a.key}</div>`,Hn=a.resumeType,rt=a.resumeFrom||a.roomName,Xa(rt),wr(!0),{found:!0,roomName:a.roomName,key:a.key}):a.aborted?(Xa(a.resumeFrom||""),wr(!!a.resumeFrom),{found:!1}):(wr(!1),n.innerHTML='<div class="stat warning">Room name not found within search limits</div>',{found:!1})}catch(a){return wr(!1),n.innerHTML=`<div class="stat error">Error: ${ae(a.message)}</div>`,{found:!1}}}function _o(t,e,r){if(t.decrypted){let s=e?` with key ${e.substring(0,8)}...`:"",c=new Date(t.decrypted.timestamp*1e3).toISOString(),i=t.decrypted.sender?`<div class="field"><span class="field-name">Sender:</span> ${ae(t.decrypted.sender)}</div>`:"";return`<div class="field success">Decrypted successfully${s}</div><div class="field"><span class="field-name">Timestamp:</span> ${c}</div>`+i+`<div class="field"><span class="field-name">Message:</span> ${ae(t.decrypted.message)}</div>`}let n="";e&&r&&(n+='<div class="field warning">Decryption failed - key may be incorrect or channel hash mismatch</div>');let a=["ciphertext","payload","rawPayload"];for(let[s,c]of Object.entries(t)){if(s==="segments")continue;let i;typeof c=="object"&&c!==null?i=JSON.stringify(c,null,2):s==="timestamp"&&typeof c=="number"&&c>1e9?i=`${new Date(c*1e3).toISOString()} (${c})`:i=String(c),a.includes(s)?n+=`<div class="field field-block"><span class="field-name">${ae(s)}:</span><span class="field-value">${ae(i)}</span></div>`:n+=`<div class="field"><span class="field-name">${ae(s)}:</span> ${ae(i)}</div>`}return n}function Do(t,e,r){let n=Ae.Utils.getPayloadTypeName(t.payloadType)==="GroupText",a=t.path?.length?`<div class="field"><span class="field-name">Path:</span> ${t.path.join(" ")}</div>`:"",s=!!t.payload?.decoded?.decrypted,c=t.payload?.decoded?`<div class="section${s?" decrypted":""}"><div class="section-title">Decoded Payload</div>`+_o(t.payload.decoded,r,n)+"</div>":"",i=!t.isValid&&t.errors?'<div class="section"><div class="section-title error">Validation Errors</div>'+t.errors.map(h=>`<div class="field error">${ae(h)}</div>`).join("")+"</div>":"",u=`<div class="section"><div class="section-title">Packet Header</div><div class="field"><span class="field-name">Route Type:</span> ${Ae.Utils.getRouteTypeName(t.routeType)}</div><div class="field"><span class="field-name">Payload Type:</span> ${Ae.Utils.getPayloadTypeName(t.payloadType)}</div><div class="field"><span class="field-name">Version:</span> ${t.payloadVersion}</div><div class="field"><span class="field-name">Message Hash:</span> ${t.messageHash}</div><div class="field"><span class="field-name">Total Bytes:</span> ${t.totalBytes}</div>`+a+"</div>"+c+i,d=h=>/payload|ciphertext/i.test(h)&&!/type|version|hash/i.test(h),o=e.segments?.length?'<div class="section"><div class="section-title">Structure Breakdown</div>'+e.segments.map(h=>{let y=h.description?` title="${ae(h.description)}"`:"",g=h.headerBreakdown?.fields.map(v=>`<div class="field" style="margin-left: 20px;"><span class="muted">bits ${v.bits}:</span> ${v.field} = ${ae(v.value)}</div>`).join("")||"";return d(h.name)?`<div class="field field-block"><span class="field-name"${y}>[${h.startByte}-${h.endByte}] ${h.name}:</span><span class="field-value">${ae(h.value)}</span></div>`+g:`<div class="field"><span class="field-name"${y}>[${h.startByte}-${h.endByte}] ${h.name}:</span> ${ae(h.value)}</div>`+g}).join("")+"</div>":"",f=e.payload?.segments?.length?`<div class="section"><div class="section-title">Payload Breakdown (${e.payload.type})</div>`+e.payload.segments.map(h=>{let y=h.description?` title="${ae(h.description)}"`:"";return d(h.name)?`<div class="field field-block"><span class="field-name"${y}>[${h.startByte}-${h.endByte}] ${h.name}:</span><span class="field-value">${ae(String(h.value))}</span></div>`:`<div class="field"><span class="field-name"${y}>[${h.startByte}-${h.endByte}] ${h.name}:</span> ${ae(String(h.value))}</div>`}).join("")+"</div>":"",x=o+f;return`<div class="columns"><div class="column">${u}</div><div class="column">${x}</div></div>`}var tt=null,Tr="",Sr=!1;function k0(){let t=document.getElementById("room"),e=document.querySelector(".room-prefix");if(t&&e){let r=t.value.trim()===me;e.style.display=r?"none":""}}async function Te(){let t=document.getElementById("packet"),e=document.getElementById("key"),r=document.getElementById("room"),n=document.getElementById("output"),a=document.getElementById("brute-btn"),s=t.value.trim().replace(/\s+/g,"").replace(/^0x/i,"");if(!s){n.style.display="none",a.disabled=!0,a.textContent="Start",tt=null,Tr="",Sr=!1,Hn=void 0,rt="";return}Tr=s,n.style.display="block";try{let c=e.value.trim().replace(/^0x/i,"")||null;if(!c&&!Sr){let o=Ae.MeshCorePacketDecoder.createKeyStore({channelSecrets:[ge]});(await Ae.MeshCorePacketDecoder.decodeWithVerification(s,{keyStore:o})).payload?.decoded?.decrypted&&(c=ge,e.value=ge,r.value=me,Sr=!0,k0())}let i=c?Ae.MeshCorePacketDecoder.createKeyStore({channelSecrets:[c]}):null,u=await Ae.MeshCorePacketDecoder.analyzeStructureWithVerification(s,{keyStore:i}),d=await Ae.MeshCorePacketDecoder.decodeWithVerification(s,{keyStore:i});if(tt=d,!P0){let o=Ae.Utils.getPayloadTypeName(d.payloadType)==="GroupText",f=d.payload?.decoded?.decrypted;a.disabled=!o||!!f,a.textContent=f?"Key already known!":"Start"}n.innerHTML=Do(d,u,c)}catch(c){n.innerHTML=`<span class="error">Error: ${ae(c.message)}</span>`,P0||(a.disabled=!0,a.textContent="Start"),tt=null}}document.addEventListener("DOMContentLoaded",async()=>{let t=document.getElementById("room"),e=document.getElementById("key"),r=document.getElementById("packet"),n=document.getElementById("brute-btn"),a=document.getElementById("brute-status"),s=document.getElementById("cracker-status");et=new Q0;try{await et.loadWordlist("./words_alpha.txt"),s&&(s.textContent="Cracker: Ready",s.classList.add("success"))}catch{s&&(s.textContent="Cracker: Ready (no wordlist)",s.classList.add("warning"))}let c=document.getElementById("timestamp-filter");c&&(c.checked=kn,c.addEventListener("change",()=>{kn=c.checked}));let i=document.getElementById("unicode-filter");i&&(i.checked=Pn,i.addEventListener("change",()=>{Pn=i.checked}));let u=!1;t.addEventListener("input",()=>{let v=t.value.trim();u=!0,v===me?e.value=ge:v?e.value=Le("#"+v):e.value="",u=!1,k0(),Te()}),document.getElementById("public-btn").addEventListener("click",()=>{t.value=me,e.value=ge,k0(),Te()}),document.getElementById("demo-btn-1").addEventListener("click",()=>{r.value="150013CA60BF7C841CA46BFC7A23021C814FD3AA8DEC007457CD7A6733F2D1B8E99FCC1AFDEBC21B2D8A451342F8CE1370818E6308",t.value="aa",e.value=Le("#aa"),k0(),Te()}),document.getElementById("demo-btn-2").addEventListener("click",()=>{r.value="1500E69C7A89DD0AF6A2D69F5823B88F9720731E4B887C56932BF889255D8D926D99195927144323A42DD8A158F878B518B8304DF55E80501C7D02A9FFD578D3518283156BBA257BF8413E80A237393B2E4149BBBC864371140A9BBC4E23EB9BF203EF0D029214B3E3AAC3C0295690ACDB89A28619E7E5F22C83E16073AD679D25FA904D07E5ACF1DB5A7C77D7E1719FB9AE5BF55541EE0D7F59ED890E12CF0FEED6700818",t.value="",e.value="",k0(),Te()}),e.addEventListener("input",()=>{u||(t.value="",k0()),Te()}),r.addEventListener("input",()=>{a.innerHTML="",Sr=!1,Te()});let x=document.getElementById("resume-from");n.addEventListener("click",async()=>{if(P0){et?.abort();return}if(!tt?.payload?.decoded||!Tr)return;let v=tt.payload.decoded;if(!v.channelHash||!v.ciphertext||!v.cipherMac)return;let l=x.value.trim()||void 0,p=await Za(Tr,l);p.found&&p.roomName&&p.key&&(t.value=p.roomName===me?me:p.roomName,e.value=p.key,Te())}),document.getElementById("brute-skip-btn").addEventListener("click",async()=>{if(P0||!rt||!Tn)return;t.value="",e.value="",Te();let v=await Za(Tn,rt,Hn);v.found&&v.roomName&&v.key&&(t.value=v.roomName,e.value=v.key,Te())});let g=new URLSearchParams(window.location.search).get("packet");if(g&&/^[0-9a-fA-F]+$/.test(g)){r.value=g;let v=document.getElementById("brute-section");v&&(v.open=!0),await Te(),setTimeout(()=>{n.disabled||n.click()},100)}});})();
/*! Bundled license information:

crypto-js/ripemd160.js:
  (** @preserve
  	(c) 2012 by Cdric Mesnil. All rights reserved.
  
  	Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
  
  	    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
  	    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
  
  	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  	*)

crypto-js/mode-ctr-gladman.js:
  (** @preserve
   * Counter block mode compatible with  Dr Brian Gladman fileenc.c
   * derived from CryptoJS.mode.CTR
   * Jan Hruby jhruby.web@gmail.com
   *)

@noble/ed25519/index.js:
  (*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=bundle.js.map
