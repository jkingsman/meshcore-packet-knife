{
  "version": 3,
  "sources": ["../node_modules/@noble/hashes/src/crypto.ts", "../node_modules/@noble/hashes/src/utils.ts", "../node_modules/@noble/hashes/src/_md.ts", "../node_modules/@noble/hashes/src/_u64.ts", "../node_modules/@noble/hashes/src/sha2.ts", "../node_modules/@noble/curves/src/utils.ts", "../node_modules/@noble/curves/src/abstract/modular.ts", "../node_modules/@noble/curves/src/abstract/curve.ts", "../node_modules/@noble/curves/src/abstract/edwards.ts", "../node_modules/@noble/curves/src/abstract/hash-to-curve.ts", "../node_modules/@noble/curves/src/abstract/montgomery.ts", "../node_modules/@noble/curves/src/ed25519.ts", "../node_modules/@liamcottle/meshcore.js/src/buffer_writer.js", "../node_modules/@liamcottle/meshcore.js/src/buffer_reader.js", "../node_modules/@liamcottle/meshcore.js/src/constants.js", "../node_modules/@liamcottle/meshcore.js/src/events.js", "../node_modules/@liamcottle/meshcore.js/src/buffer_utils.js", "../node_modules/@liamcottle/meshcore.js/src/advert.js", "../node_modules/@liamcottle/meshcore.js/src/packet.js", "../node_modules/@liamcottle/meshcore.js/src/random_utils.js", "../node_modules/@liamcottle/meshcore.js/src/connection/connection.js", "../node_modules/@liamcottle/meshcore.js/src/connection/serial_connection.js", "../node_modules/@liamcottle/meshcore.js/src/connection/web_serial_connection.js", "../src/radio-config.ts"],
  "sourcesContent": ["/**\n * Internal webcrypto alias.\n * We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n * See utils.ts for details.\n * @module\n */\ndeclare const globalThis: Record<string, any> | undefined;\nexport const crypto: any =\n  typeof globalThis === 'object' && 'crypto' in globalThis ? globalThis.crypto : undefined;\n", "/**\n * Utilities for hex, bytes, CSPRNG.\n * @module\n */\n/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated (2025-04-30), we can just drop the import.\nimport { crypto } from '@noble/hashes/crypto';\n\n/** Checks if something is Uint8Array. Be careful: nodejs Buffer will return true. */\nexport function isBytes(a: unknown): a is Uint8Array {\n  return a instanceof Uint8Array || (ArrayBuffer.isView(a) && a.constructor.name === 'Uint8Array');\n}\n\n/** Asserts something is positive integer. */\nexport function anumber(n: number): void {\n  if (!Number.isSafeInteger(n) || n < 0) throw new Error('positive integer expected, got ' + n);\n}\n\n/** Asserts something is Uint8Array. */\nexport function abytes(b: Uint8Array | undefined, ...lengths: number[]): void {\n  if (!isBytes(b)) throw new Error('Uint8Array expected');\n  if (lengths.length > 0 && !lengths.includes(b.length))\n    throw new Error('Uint8Array expected of length ' + lengths + ', got length=' + b.length);\n}\n\n/** Asserts something is hash */\nexport function ahash(h: IHash): void {\n  if (typeof h !== 'function' || typeof h.create !== 'function')\n    throw new Error('Hash should be wrapped by utils.createHasher');\n  anumber(h.outputLen);\n  anumber(h.blockLen);\n}\n\n/** Asserts a hash instance has not been destroyed / finished */\nexport function aexists(instance: any, checkFinished = true): void {\n  if (instance.destroyed) throw new Error('Hash instance has been destroyed');\n  if (checkFinished && instance.finished) throw new Error('Hash#digest() has already been called');\n}\n\n/** Asserts output is properly-sized byte array */\nexport function aoutput(out: any, instance: any): void {\n  abytes(out);\n  const min = instance.outputLen;\n  if (out.length < min) {\n    throw new Error('digestInto() expects output buffer of length at least ' + min);\n  }\n}\n\n/** Generic type encompassing 8/16/32-byte arrays - but not 64-byte. */\n// prettier-ignore\nexport type TypedArray = Int8Array | Uint8ClampedArray | Uint8Array |\n  Uint16Array | Int16Array | Uint32Array | Int32Array;\n\n/** Cast u8 / u16 / u32 to u8. */\nexport function u8(arr: TypedArray): Uint8Array {\n  return new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\n}\n\n/** Cast u8 / u16 / u32 to u32. */\nexport function u32(arr: TypedArray): Uint32Array {\n  return new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n}\n\n/** Zeroize a byte array. Warning: JS provides no guarantees. */\nexport function clean(...arrays: TypedArray[]): void {\n  for (let i = 0; i < arrays.length; i++) {\n    arrays[i].fill(0);\n  }\n}\n\n/** Create DataView of an array for easy byte-level manipulation. */\nexport function createView(arr: TypedArray): DataView {\n  return new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n}\n\n/** The rotate right (circular right shift) operation for uint32 */\nexport function rotr(word: number, shift: number): number {\n  return (word << (32 - shift)) | (word >>> shift);\n}\n\n/** The rotate left (circular left shift) operation for uint32 */\nexport function rotl(word: number, shift: number): number {\n  return (word << shift) | ((word >>> (32 - shift)) >>> 0);\n}\n\n/** Is current platform little-endian? Most are. Big-Endian platform: IBM */\nexport const isLE: boolean = /* @__PURE__ */ (() =>\n  new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44)();\n\n/** The byte swap operation for uint32 */\nexport function byteSwap(word: number): number {\n  return (\n    ((word << 24) & 0xff000000) |\n    ((word << 8) & 0xff0000) |\n    ((word >>> 8) & 0xff00) |\n    ((word >>> 24) & 0xff)\n  );\n}\n/** Conditionally byte swap if on a big-endian platform */\nexport const swap8IfBE: (n: number) => number = isLE\n  ? (n: number) => n\n  : (n: number) => byteSwap(n);\n\n/** @deprecated */\nexport const byteSwapIfBE: typeof swap8IfBE = swap8IfBE;\n/** In place byte swap for Uint32Array */\nexport function byteSwap32(arr: Uint32Array): Uint32Array {\n  for (let i = 0; i < arr.length; i++) {\n    arr[i] = byteSwap(arr[i]);\n  }\n  return arr;\n}\n\nexport const swap32IfBE: (u: Uint32Array) => Uint32Array = isLE\n  ? (u: Uint32Array) => u\n  : byteSwap32;\n\n// Built-in hex conversion https://caniuse.com/mdn-javascript_builtins_uint8array_fromhex\nconst hasHexBuiltin: boolean = /* @__PURE__ */ (() =>\n  // @ts-ignore\n  typeof Uint8Array.from([]).toHex === 'function' && typeof Uint8Array.fromHex === 'function')();\n\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) =>\n  i.toString(16).padStart(2, '0')\n);\n\n/**\n * Convert byte array to hex string. Uses built-in function, when available.\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes: Uint8Array): string {\n  abytes(bytes);\n  // @ts-ignore\n  if (hasHexBuiltin) return bytes.toHex();\n  // pre-caching improves the speed 6x\n  let hex = '';\n  for (let i = 0; i < bytes.length; i++) {\n    hex += hexes[bytes[i]];\n  }\n  return hex;\n}\n\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, A: 65, F: 70, a: 97, f: 102 } as const;\nfunction asciiToBase16(ch: number): number | undefined {\n  if (ch >= asciis._0 && ch <= asciis._9) return ch - asciis._0; // '2' => 50-48\n  if (ch >= asciis.A && ch <= asciis.F) return ch - (asciis.A - 10); // 'B' => 66-(65-10)\n  if (ch >= asciis.a && ch <= asciis.f) return ch - (asciis.a - 10); // 'b' => 98-(97-10)\n  return;\n}\n\n/**\n * Convert hex string to byte array. Uses built-in function, when available.\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex: string): Uint8Array {\n  if (typeof hex !== 'string') throw new Error('hex string expected, got ' + typeof hex);\n  // @ts-ignore\n  if (hasHexBuiltin) return Uint8Array.fromHex(hex);\n  const hl = hex.length;\n  const al = hl / 2;\n  if (hl % 2) throw new Error('hex string expected, got unpadded hex of length ' + hl);\n  const array = new Uint8Array(al);\n  for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n    const n1 = asciiToBase16(hex.charCodeAt(hi));\n    const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n    if (n1 === undefined || n2 === undefined) {\n      const char = hex[hi] + hex[hi + 1];\n      throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n    }\n    array[ai] = n1 * 16 + n2; // multiply first octet, e.g. 'a3' => 10*16+3 => 160 + 3 => 163\n  }\n  return array;\n}\n\n/**\n * There is no setImmediate in browser and setTimeout is slow.\n * Call of async fn will return Promise, which will be fullfiled only on\n * next scheduler queue processing step and this is exactly what we need.\n */\nexport const nextTick = async (): Promise<void> => {};\n\n/** Returns control to thread each 'tick' ms to avoid blocking. */\nexport async function asyncLoop(\n  iters: number,\n  tick: number,\n  cb: (i: number) => void\n): Promise<void> {\n  let ts = Date.now();\n  for (let i = 0; i < iters; i++) {\n    cb(i);\n    // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n    const diff = Date.now() - ts;\n    if (diff >= 0 && diff < tick) continue;\n    await nextTick();\n    ts += diff;\n  }\n}\n\n// Global symbols, but ts doesn't see them: https://github.com/microsoft/TypeScript/issues/31535\ndeclare const TextEncoder: any;\ndeclare const TextDecoder: any;\n\n/**\n * Converts string to bytes using UTF8 encoding.\n * @example utf8ToBytes('abc') // Uint8Array.from([97, 98, 99])\n */\nexport function utf8ToBytes(str: string): Uint8Array {\n  if (typeof str !== 'string') throw new Error('string expected');\n  return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n\n/**\n * Converts bytes to string using UTF8 encoding.\n * @example bytesToUtf8(Uint8Array.from([97, 98, 99])) // 'abc'\n */\nexport function bytesToUtf8(bytes: Uint8Array): string {\n  return new TextDecoder().decode(bytes);\n}\n\n/** Accepted input of hash functions. Strings are converted to byte arrays. */\nexport type Input = string | Uint8Array;\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data: Input): Uint8Array {\n  if (typeof data === 'string') data = utf8ToBytes(data);\n  abytes(data);\n  return data;\n}\n\n/** KDFs can accept string or Uint8Array for user convenience. */\nexport type KDFInput = string | Uint8Array;\n/**\n * Helper for KDFs: consumes uint8array or string.\n * When string is passed, does utf8 decoding, using TextDecoder.\n */\nexport function kdfInputToBytes(data: KDFInput): Uint8Array {\n  if (typeof data === 'string') data = utf8ToBytes(data);\n  abytes(data);\n  return data;\n}\n\n/** Copies several Uint8Arrays into one. */\nexport function concatBytes(...arrays: Uint8Array[]): Uint8Array {\n  let sum = 0;\n  for (let i = 0; i < arrays.length; i++) {\n    const a = arrays[i];\n    abytes(a);\n    sum += a.length;\n  }\n  const res = new Uint8Array(sum);\n  for (let i = 0, pad = 0; i < arrays.length; i++) {\n    const a = arrays[i];\n    res.set(a, pad);\n    pad += a.length;\n  }\n  return res;\n}\n\ntype EmptyObj = {};\nexport function checkOpts<T1 extends EmptyObj, T2 extends EmptyObj>(\n  defaults: T1,\n  opts?: T2\n): T1 & T2 {\n  if (opts !== undefined && {}.toString.call(opts) !== '[object Object]')\n    throw new Error('options should be object or undefined');\n  const merged = Object.assign(defaults, opts);\n  return merged as T1 & T2;\n}\n\n/** Hash interface. */\nexport type IHash = {\n  (data: Uint8Array): Uint8Array;\n  blockLen: number;\n  outputLen: number;\n  create: any;\n};\n\n/** For runtime check if class implements interface */\nexport abstract class Hash<T extends Hash<T>> {\n  abstract blockLen: number; // Bytes per block\n  abstract outputLen: number; // Bytes in output\n  abstract update(buf: Input): this;\n  // Writes digest into buf\n  abstract digestInto(buf: Uint8Array): void;\n  abstract digest(): Uint8Array;\n  /**\n   * Resets internal state. Makes Hash instance unusable.\n   * Reset is impossible for keyed hashes if key is consumed into state. If digest is not consumed\n   * by user, they will need to manually call `destroy()` when zeroing is necessary.\n   */\n  abstract destroy(): void;\n  /**\n   * Clones hash instance. Unsafe: doesn't check whether `to` is valid. Can be used as `clone()`\n   * when no options are passed.\n   * Reasons to use `_cloneInto` instead of clone: 1) performance 2) reuse instance => all internal\n   * buffers are overwritten => causes buffer overwrite which is used for digest in some cases.\n   * There are no guarantees for clean-up because it's impossible in JS.\n   */\n  abstract _cloneInto(to?: T): T;\n  // Safe version that clones internal state\n  abstract clone(): T;\n}\n\n/**\n * XOF: streaming API to read digest in chunks.\n * Same as 'squeeze' in keccak/k12 and 'seek' in blake3, but more generic name.\n * When hash used in XOF mode it is up to user to call '.destroy' afterwards, since we cannot\n * destroy state, next call can require more bytes.\n */\nexport type HashXOF<T extends Hash<T>> = Hash<T> & {\n  xof(bytes: number): Uint8Array; // Read 'bytes' bytes from digest stream\n  xofInto(buf: Uint8Array): Uint8Array; // read buf.length bytes from digest stream into buf\n};\n\n/** Hash function */\nexport type CHash = ReturnType<typeof createHasher>;\n/** Hash function with output */\nexport type CHashO = ReturnType<typeof createOptHasher>;\n/** XOF with output */\nexport type CHashXO = ReturnType<typeof createXOFer>;\n\n/** Wraps hash function, creating an interface on top of it */\nexport function createHasher<T extends Hash<T>>(\n  hashCons: () => Hash<T>\n): {\n  (msg: Input): Uint8Array;\n  outputLen: number;\n  blockLen: number;\n  create(): Hash<T>;\n} {\n  const hashC = (msg: Input): Uint8Array => hashCons().update(toBytes(msg)).digest();\n  const tmp = hashCons();\n  hashC.outputLen = tmp.outputLen;\n  hashC.blockLen = tmp.blockLen;\n  hashC.create = () => hashCons();\n  return hashC;\n}\n\nexport function createOptHasher<H extends Hash<H>, T extends Object>(\n  hashCons: (opts?: T) => Hash<H>\n): {\n  (msg: Input, opts?: T): Uint8Array;\n  outputLen: number;\n  blockLen: number;\n  create(opts?: T): Hash<H>;\n} {\n  const hashC = (msg: Input, opts?: T): Uint8Array => hashCons(opts).update(toBytes(msg)).digest();\n  const tmp = hashCons({} as T);\n  hashC.outputLen = tmp.outputLen;\n  hashC.blockLen = tmp.blockLen;\n  hashC.create = (opts?: T) => hashCons(opts);\n  return hashC;\n}\n\nexport function createXOFer<H extends HashXOF<H>, T extends Object>(\n  hashCons: (opts?: T) => HashXOF<H>\n): {\n  (msg: Input, opts?: T): Uint8Array;\n  outputLen: number;\n  blockLen: number;\n  create(opts?: T): HashXOF<H>;\n} {\n  const hashC = (msg: Input, opts?: T): Uint8Array => hashCons(opts).update(toBytes(msg)).digest();\n  const tmp = hashCons({} as T);\n  hashC.outputLen = tmp.outputLen;\n  hashC.blockLen = tmp.blockLen;\n  hashC.create = (opts?: T) => hashCons(opts);\n  return hashC;\n}\nexport const wrapConstructor: typeof createHasher = createHasher;\nexport const wrapConstructorWithOpts: typeof createOptHasher = createOptHasher;\nexport const wrapXOFConstructorWithOpts: typeof createXOFer = createXOFer;\n\n/** Cryptographically secure PRNG. Uses internal OS-level `crypto.getRandomValues`. */\nexport function randomBytes(bytesLength = 32): Uint8Array {\n  if (crypto && typeof crypto.getRandomValues === 'function') {\n    return crypto.getRandomValues(new Uint8Array(bytesLength));\n  }\n  // Legacy Node.js compatibility\n  if (crypto && typeof crypto.randomBytes === 'function') {\n    return Uint8Array.from(crypto.randomBytes(bytesLength));\n  }\n  throw new Error('crypto.getRandomValues must be defined');\n}\n", "/**\n * Internal Merkle-Damgard hash utils.\n * @module\n */\nimport { type Input, Hash, abytes, aexists, aoutput, clean, createView, toBytes } from './utils.ts';\n\n/** Polyfill for Safari 14. https://caniuse.com/mdn-javascript_builtins_dataview_setbiguint64 */\nexport function setBigUint64(\n  view: DataView,\n  byteOffset: number,\n  value: bigint,\n  isLE: boolean\n): void {\n  if (typeof view.setBigUint64 === 'function') return view.setBigUint64(byteOffset, value, isLE);\n  const _32n = BigInt(32);\n  const _u32_max = BigInt(0xffffffff);\n  const wh = Number((value >> _32n) & _u32_max);\n  const wl = Number(value & _u32_max);\n  const h = isLE ? 4 : 0;\n  const l = isLE ? 0 : 4;\n  view.setUint32(byteOffset + h, wh, isLE);\n  view.setUint32(byteOffset + l, wl, isLE);\n}\n\n/** Choice: a ? b : c */\nexport function Chi(a: number, b: number, c: number): number {\n  return (a & b) ^ (~a & c);\n}\n\n/** Majority function, true if any two inputs is true. */\nexport function Maj(a: number, b: number, c: number): number {\n  return (a & b) ^ (a & c) ^ (b & c);\n}\n\n/**\n * Merkle-Damgard hash construction base class.\n * Could be used to create MD5, RIPEMD, SHA1, SHA2.\n */\nexport abstract class HashMD<T extends HashMD<T>> extends Hash<T> {\n  protected abstract process(buf: DataView, offset: number): void;\n  protected abstract get(): number[];\n  protected abstract set(...args: number[]): void;\n  abstract destroy(): void;\n  protected abstract roundClean(): void;\n\n  readonly blockLen: number;\n  readonly outputLen: number;\n  readonly padOffset: number;\n  readonly isLE: boolean;\n\n  // For partial updates less than block size\n  protected buffer: Uint8Array;\n  protected view: DataView;\n  protected finished = false;\n  protected length = 0;\n  protected pos = 0;\n  protected destroyed = false;\n\n  constructor(blockLen: number, outputLen: number, padOffset: number, isLE: boolean) {\n    super();\n    this.blockLen = blockLen;\n    this.outputLen = outputLen;\n    this.padOffset = padOffset;\n    this.isLE = isLE;\n    this.buffer = new Uint8Array(blockLen);\n    this.view = createView(this.buffer);\n  }\n  update(data: Input): this {\n    aexists(this);\n    data = toBytes(data);\n    abytes(data);\n    const { view, buffer, blockLen } = this;\n    const len = data.length;\n    for (let pos = 0; pos < len; ) {\n      const take = Math.min(blockLen - this.pos, len - pos);\n      // Fast path: we have at least one block in input, cast it to view and process\n      if (take === blockLen) {\n        const dataView = createView(data);\n        for (; blockLen <= len - pos; pos += blockLen) this.process(dataView, pos);\n        continue;\n      }\n      buffer.set(data.subarray(pos, pos + take), this.pos);\n      this.pos += take;\n      pos += take;\n      if (this.pos === blockLen) {\n        this.process(view, 0);\n        this.pos = 0;\n      }\n    }\n    this.length += data.length;\n    this.roundClean();\n    return this;\n  }\n  digestInto(out: Uint8Array): void {\n    aexists(this);\n    aoutput(out, this);\n    this.finished = true;\n    // Padding\n    // We can avoid allocation of buffer for padding completely if it\n    // was previously not allocated here. But it won't change performance.\n    const { buffer, view, blockLen, isLE } = this;\n    let { pos } = this;\n    // append the bit '1' to the message\n    buffer[pos++] = 0b10000000;\n    clean(this.buffer.subarray(pos));\n    // we have less than padOffset left in buffer, so we cannot put length in\n    // current block, need process it and pad again\n    if (this.padOffset > blockLen - pos) {\n      this.process(view, 0);\n      pos = 0;\n    }\n    // Pad until full block byte with zeros\n    for (let i = pos; i < blockLen; i++) buffer[i] = 0;\n    // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n    // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n    // So we just write lowest 64 bits of that value.\n    setBigUint64(view, blockLen - 8, BigInt(this.length * 8), isLE);\n    this.process(view, 0);\n    const oview = createView(out);\n    const len = this.outputLen;\n    // NOTE: we do division by 4 later, which should be fused in single op with modulo by JIT\n    if (len % 4) throw new Error('_sha2: outputLen should be aligned to 32bit');\n    const outLen = len / 4;\n    const state = this.get();\n    if (outLen > state.length) throw new Error('_sha2: outputLen bigger than state');\n    for (let i = 0; i < outLen; i++) oview.setUint32(4 * i, state[i], isLE);\n  }\n  digest(): Uint8Array {\n    const { buffer, outputLen } = this;\n    this.digestInto(buffer);\n    const res = buffer.slice(0, outputLen);\n    this.destroy();\n    return res;\n  }\n  _cloneInto(to?: T): T {\n    to ||= new (this.constructor as any)() as T;\n    to.set(...this.get());\n    const { blockLen, buffer, length, finished, destroyed, pos } = this;\n    to.destroyed = destroyed;\n    to.finished = finished;\n    to.length = length;\n    to.pos = pos;\n    if (length % blockLen) to.buffer.set(buffer);\n    return to;\n  }\n  clone(): T {\n    return this._cloneInto();\n  }\n}\n\n/**\n * Initial SHA-2 state: fractional parts of square roots of first 16 primes 2..53.\n * Check out `test/misc/sha2-gen-iv.js` for recomputation guide.\n */\n\n/** Initial SHA256 state. Bits 0..32 of frac part of sqrt of primes 2..19 */\nexport const SHA256_IV: Uint32Array = /* @__PURE__ */ Uint32Array.from([\n  0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19,\n]);\n\n/** Initial SHA224 state. Bits 32..64 of frac part of sqrt of primes 23..53 */\nexport const SHA224_IV: Uint32Array = /* @__PURE__ */ Uint32Array.from([\n  0xc1059ed8, 0x367cd507, 0x3070dd17, 0xf70e5939, 0xffc00b31, 0x68581511, 0x64f98fa7, 0xbefa4fa4,\n]);\n\n/** Initial SHA384 state. Bits 0..64 of frac part of sqrt of primes 23..53 */\nexport const SHA384_IV: Uint32Array = /* @__PURE__ */ Uint32Array.from([\n  0xcbbb9d5d, 0xc1059ed8, 0x629a292a, 0x367cd507, 0x9159015a, 0x3070dd17, 0x152fecd8, 0xf70e5939,\n  0x67332667, 0xffc00b31, 0x8eb44a87, 0x68581511, 0xdb0c2e0d, 0x64f98fa7, 0x47b5481d, 0xbefa4fa4,\n]);\n\n/** Initial SHA512 state. Bits 0..64 of frac part of sqrt of primes 2..19 */\nexport const SHA512_IV: Uint32Array = /* @__PURE__ */ Uint32Array.from([\n  0x6a09e667, 0xf3bcc908, 0xbb67ae85, 0x84caa73b, 0x3c6ef372, 0xfe94f82b, 0xa54ff53a, 0x5f1d36f1,\n  0x510e527f, 0xade682d1, 0x9b05688c, 0x2b3e6c1f, 0x1f83d9ab, 0xfb41bd6b, 0x5be0cd19, 0x137e2179,\n]);\n", "/**\n * Internal helpers for u64. BigUint64Array is too slow as per 2025, so we implement it using Uint32Array.\n * @todo re-check https://issues.chromium.org/issues/42212588\n * @module\n */\nconst U32_MASK64 = /* @__PURE__ */ BigInt(2 ** 32 - 1);\nconst _32n = /* @__PURE__ */ BigInt(32);\n\nfunction fromBig(\n  n: bigint,\n  le = false\n): {\n  h: number;\n  l: number;\n} {\n  if (le) return { h: Number(n & U32_MASK64), l: Number((n >> _32n) & U32_MASK64) };\n  return { h: Number((n >> _32n) & U32_MASK64) | 0, l: Number(n & U32_MASK64) | 0 };\n}\n\nfunction split(lst: bigint[], le = false): Uint32Array[] {\n  const len = lst.length;\n  let Ah = new Uint32Array(len);\n  let Al = new Uint32Array(len);\n  for (let i = 0; i < len; i++) {\n    const { h, l } = fromBig(lst[i], le);\n    [Ah[i], Al[i]] = [h, l];\n  }\n  return [Ah, Al];\n}\n\nconst toBig = (h: number, l: number): bigint => (BigInt(h >>> 0) << _32n) | BigInt(l >>> 0);\n// for Shift in [0, 32)\nconst shrSH = (h: number, _l: number, s: number): number => h >>> s;\nconst shrSL = (h: number, l: number, s: number): number => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in [1, 32)\nconst rotrSH = (h: number, l: number, s: number): number => (h >>> s) | (l << (32 - s));\nconst rotrSL = (h: number, l: number, s: number): number => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotrBH = (h: number, l: number, s: number): number => (h << (64 - s)) | (l >>> (s - 32));\nconst rotrBL = (h: number, l: number, s: number): number => (h >>> (s - 32)) | (l << (64 - s));\n// Right rotate for shift===32 (just swaps l&h)\nconst rotr32H = (_h: number, l: number): number => l;\nconst rotr32L = (h: number, _l: number): number => h;\n// Left rotate for Shift in [1, 32)\nconst rotlSH = (h: number, l: number, s: number): number => (h << s) | (l >>> (32 - s));\nconst rotlSL = (h: number, l: number, s: number): number => (l << s) | (h >>> (32 - s));\n// Left rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotlBH = (h: number, l: number, s: number): number => (l << (s - 32)) | (h >>> (64 - s));\nconst rotlBL = (h: number, l: number, s: number): number => (h << (s - 32)) | (l >>> (64 - s));\n\n// JS uses 32-bit signed integers for bitwise operations which means we cannot\n// simple take carry out of low bit sum by shift, we need to use division.\nfunction add(\n  Ah: number,\n  Al: number,\n  Bh: number,\n  Bl: number\n): {\n  h: number;\n  l: number;\n} {\n  const l = (Al >>> 0) + (Bl >>> 0);\n  return { h: (Ah + Bh + ((l / 2 ** 32) | 0)) | 0, l: l | 0 };\n}\n// Addition with more than 2 elements\nconst add3L = (Al: number, Bl: number, Cl: number): number => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0);\nconst add3H = (low: number, Ah: number, Bh: number, Ch: number): number =>\n  (Ah + Bh + Ch + ((low / 2 ** 32) | 0)) | 0;\nconst add4L = (Al: number, Bl: number, Cl: number, Dl: number): number =>\n  (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0);\nconst add4H = (low: number, Ah: number, Bh: number, Ch: number, Dh: number): number =>\n  (Ah + Bh + Ch + Dh + ((low / 2 ** 32) | 0)) | 0;\nconst add5L = (Al: number, Bl: number, Cl: number, Dl: number, El: number): number =>\n  (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0) + (El >>> 0);\nconst add5H = (low: number, Ah: number, Bh: number, Ch: number, Dh: number, Eh: number): number =>\n  (Ah + Bh + Ch + Dh + Eh + ((low / 2 ** 32) | 0)) | 0;\n\n// prettier-ignore\nexport {\n  add, add3H, add3L, add4H, add4L, add5H, add5L, fromBig, rotlBH, rotlBL, rotlSH, rotlSL, rotr32H, rotr32L, rotrBH, rotrBL, rotrSH, rotrSL, shrSH, shrSL, split, toBig\n};\n// prettier-ignore\nconst u64: { fromBig: typeof fromBig; split: typeof split; toBig: (h: number, l: number) => bigint; shrSH: (h: number, _l: number, s: number) => number; shrSL: (h: number, l: number, s: number) => number; rotrSH: (h: number, l: number, s: number) => number; rotrSL: (h: number, l: number, s: number) => number; rotrBH: (h: number, l: number, s: number) => number; rotrBL: (h: number, l: number, s: number) => number; rotr32H: (_h: number, l: number) => number; rotr32L: (h: number, _l: number) => number; rotlSH: (h: number, l: number, s: number) => number; rotlSL: (h: number, l: number, s: number) => number; rotlBH: (h: number, l: number, s: number) => number; rotlBL: (h: number, l: number, s: number) => number; add: typeof add; add3L: (Al: number, Bl: number, Cl: number) => number; add3H: (low: number, Ah: number, Bh: number, Ch: number) => number; add4L: (Al: number, Bl: number, Cl: number, Dl: number) => number; add4H: (low: number, Ah: number, Bh: number, Ch: number, Dh: number) => number; add5H: (low: number, Ah: number, Bh: number, Ch: number, Dh: number, Eh: number) => number; add5L: (Al: number, Bl: number, Cl: number, Dl: number, El: number) => number; } = {\n  fromBig, split, toBig,\n  shrSH, shrSL,\n  rotrSH, rotrSL, rotrBH, rotrBL,\n  rotr32H, rotr32L,\n  rotlSH, rotlSL, rotlBH, rotlBL,\n  add, add3L, add3H, add4L, add4H, add5H, add5L,\n};\nexport default u64;\n", "/**\n * SHA2 hash function. A.k.a. sha256, sha384, sha512, sha512_224, sha512_256.\n * SHA256 is the fastest hash implementable in JS, even faster than Blake3.\n * Check out [RFC 4634](https://datatracker.ietf.org/doc/html/rfc4634) and\n * [FIPS 180-4](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf).\n * @module\n */\nimport { Chi, HashMD, Maj, SHA224_IV, SHA256_IV, SHA384_IV, SHA512_IV } from './_md.ts';\nimport * as u64 from './_u64.ts';\nimport { type CHash, clean, createHasher, rotr } from './utils.ts';\n\n/**\n * Round constants:\n * First 32 bits of fractional parts of the cube roots of the first 64 primes 2..311)\n */\n// prettier-ignore\nconst SHA256_K = /* @__PURE__ */ Uint32Array.from([\n  0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n  0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n  0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n  0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n  0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n  0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n  0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n  0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n\n/** Reusable temporary buffer. \"W\" comes straight from spec. */\nconst SHA256_W = /* @__PURE__ */ new Uint32Array(64);\nexport class SHA256 extends HashMD<SHA256> {\n  // We cannot use array here since array allows indexing by variable\n  // which means optimizer/compiler cannot use registers.\n  protected A: number = SHA256_IV[0] | 0;\n  protected B: number = SHA256_IV[1] | 0;\n  protected C: number = SHA256_IV[2] | 0;\n  protected D: number = SHA256_IV[3] | 0;\n  protected E: number = SHA256_IV[4] | 0;\n  protected F: number = SHA256_IV[5] | 0;\n  protected G: number = SHA256_IV[6] | 0;\n  protected H: number = SHA256_IV[7] | 0;\n\n  constructor(outputLen: number = 32) {\n    super(64, outputLen, 8, false);\n  }\n  protected get(): [number, number, number, number, number, number, number, number] {\n    const { A, B, C, D, E, F, G, H } = this;\n    return [A, B, C, D, E, F, G, H];\n  }\n  // prettier-ignore\n  protected set(\n    A: number, B: number, C: number, D: number, E: number, F: number, G: number, H: number\n  ): void {\n    this.A = A | 0;\n    this.B = B | 0;\n    this.C = C | 0;\n    this.D = D | 0;\n    this.E = E | 0;\n    this.F = F | 0;\n    this.G = G | 0;\n    this.H = H | 0;\n  }\n  protected process(view: DataView, offset: number): void {\n    // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n    for (let i = 0; i < 16; i++, offset += 4) SHA256_W[i] = view.getUint32(offset, false);\n    for (let i = 16; i < 64; i++) {\n      const W15 = SHA256_W[i - 15];\n      const W2 = SHA256_W[i - 2];\n      const s0 = rotr(W15, 7) ^ rotr(W15, 18) ^ (W15 >>> 3);\n      const s1 = rotr(W2, 17) ^ rotr(W2, 19) ^ (W2 >>> 10);\n      SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n    }\n    // Compression function main loop, 64 rounds\n    let { A, B, C, D, E, F, G, H } = this;\n    for (let i = 0; i < 64; i++) {\n      const sigma1 = rotr(E, 6) ^ rotr(E, 11) ^ rotr(E, 25);\n      const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n      const sigma0 = rotr(A, 2) ^ rotr(A, 13) ^ rotr(A, 22);\n      const T2 = (sigma0 + Maj(A, B, C)) | 0;\n      H = G;\n      G = F;\n      F = E;\n      E = (D + T1) | 0;\n      D = C;\n      C = B;\n      B = A;\n      A = (T1 + T2) | 0;\n    }\n    // Add the compressed chunk to the current hash value\n    A = (A + this.A) | 0;\n    B = (B + this.B) | 0;\n    C = (C + this.C) | 0;\n    D = (D + this.D) | 0;\n    E = (E + this.E) | 0;\n    F = (F + this.F) | 0;\n    G = (G + this.G) | 0;\n    H = (H + this.H) | 0;\n    this.set(A, B, C, D, E, F, G, H);\n  }\n  protected roundClean(): void {\n    clean(SHA256_W);\n  }\n  destroy(): void {\n    this.set(0, 0, 0, 0, 0, 0, 0, 0);\n    clean(this.buffer);\n  }\n}\n\nexport class SHA224 extends SHA256 {\n  protected A: number = SHA224_IV[0] | 0;\n  protected B: number = SHA224_IV[1] | 0;\n  protected C: number = SHA224_IV[2] | 0;\n  protected D: number = SHA224_IV[3] | 0;\n  protected E: number = SHA224_IV[4] | 0;\n  protected F: number = SHA224_IV[5] | 0;\n  protected G: number = SHA224_IV[6] | 0;\n  protected H: number = SHA224_IV[7] | 0;\n  constructor() {\n    super(28);\n  }\n}\n\n// SHA2-512 is slower than sha256 in js because u64 operations are slow.\n\n// Round contants\n// First 32 bits of the fractional parts of the cube roots of the first 80 primes 2..409\n// prettier-ignore\nconst K512 = /* @__PURE__ */ (() => u64.split([\n  '0x428a2f98d728ae22', '0x7137449123ef65cd', '0xb5c0fbcfec4d3b2f', '0xe9b5dba58189dbbc',\n  '0x3956c25bf348b538', '0x59f111f1b605d019', '0x923f82a4af194f9b', '0xab1c5ed5da6d8118',\n  '0xd807aa98a3030242', '0x12835b0145706fbe', '0x243185be4ee4b28c', '0x550c7dc3d5ffb4e2',\n  '0x72be5d74f27b896f', '0x80deb1fe3b1696b1', '0x9bdc06a725c71235', '0xc19bf174cf692694',\n  '0xe49b69c19ef14ad2', '0xefbe4786384f25e3', '0x0fc19dc68b8cd5b5', '0x240ca1cc77ac9c65',\n  '0x2de92c6f592b0275', '0x4a7484aa6ea6e483', '0x5cb0a9dcbd41fbd4', '0x76f988da831153b5',\n  '0x983e5152ee66dfab', '0xa831c66d2db43210', '0xb00327c898fb213f', '0xbf597fc7beef0ee4',\n  '0xc6e00bf33da88fc2', '0xd5a79147930aa725', '0x06ca6351e003826f', '0x142929670a0e6e70',\n  '0x27b70a8546d22ffc', '0x2e1b21385c26c926', '0x4d2c6dfc5ac42aed', '0x53380d139d95b3df',\n  '0x650a73548baf63de', '0x766a0abb3c77b2a8', '0x81c2c92e47edaee6', '0x92722c851482353b',\n  '0xa2bfe8a14cf10364', '0xa81a664bbc423001', '0xc24b8b70d0f89791', '0xc76c51a30654be30',\n  '0xd192e819d6ef5218', '0xd69906245565a910', '0xf40e35855771202a', '0x106aa07032bbd1b8',\n  '0x19a4c116b8d2d0c8', '0x1e376c085141ab53', '0x2748774cdf8eeb99', '0x34b0bcb5e19b48a8',\n  '0x391c0cb3c5c95a63', '0x4ed8aa4ae3418acb', '0x5b9cca4f7763e373', '0x682e6ff3d6b2b8a3',\n  '0x748f82ee5defb2fc', '0x78a5636f43172f60', '0x84c87814a1f0ab72', '0x8cc702081a6439ec',\n  '0x90befffa23631e28', '0xa4506cebde82bde9', '0xbef9a3f7b2c67915', '0xc67178f2e372532b',\n  '0xca273eceea26619c', '0xd186b8c721c0c207', '0xeada7dd6cde0eb1e', '0xf57d4f7fee6ed178',\n  '0x06f067aa72176fba', '0x0a637dc5a2c898a6', '0x113f9804bef90dae', '0x1b710b35131c471b',\n  '0x28db77f523047d84', '0x32caab7b40c72493', '0x3c9ebe0a15c9bebc', '0x431d67c49c100d4c',\n  '0x4cc5d4becb3e42b6', '0x597f299cfc657e2a', '0x5fcb6fab3ad6faec', '0x6c44198c4a475817'\n].map(n => BigInt(n))))();\nconst SHA512_Kh = /* @__PURE__ */ (() => K512[0])();\nconst SHA512_Kl = /* @__PURE__ */ (() => K512[1])();\n\n// Reusable temporary buffers\nconst SHA512_W_H = /* @__PURE__ */ new Uint32Array(80);\nconst SHA512_W_L = /* @__PURE__ */ new Uint32Array(80);\n\nexport class SHA512 extends HashMD<SHA512> {\n  // We cannot use array here since array allows indexing by variable\n  // which means optimizer/compiler cannot use registers.\n  // h -- high 32 bits, l -- low 32 bits\n  protected Ah: number = SHA512_IV[0] | 0;\n  protected Al: number = SHA512_IV[1] | 0;\n  protected Bh: number = SHA512_IV[2] | 0;\n  protected Bl: number = SHA512_IV[3] | 0;\n  protected Ch: number = SHA512_IV[4] | 0;\n  protected Cl: number = SHA512_IV[5] | 0;\n  protected Dh: number = SHA512_IV[6] | 0;\n  protected Dl: number = SHA512_IV[7] | 0;\n  protected Eh: number = SHA512_IV[8] | 0;\n  protected El: number = SHA512_IV[9] | 0;\n  protected Fh: number = SHA512_IV[10] | 0;\n  protected Fl: number = SHA512_IV[11] | 0;\n  protected Gh: number = SHA512_IV[12] | 0;\n  protected Gl: number = SHA512_IV[13] | 0;\n  protected Hh: number = SHA512_IV[14] | 0;\n  protected Hl: number = SHA512_IV[15] | 0;\n\n  constructor(outputLen: number = 64) {\n    super(128, outputLen, 16, false);\n  }\n  // prettier-ignore\n  protected get(): [\n    number, number, number, number, number, number, number, number,\n    number, number, number, number, number, number, number, number\n  ] {\n    const { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;\n    return [Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl];\n  }\n  // prettier-ignore\n  protected set(\n    Ah: number, Al: number, Bh: number, Bl: number, Ch: number, Cl: number, Dh: number, Dl: number,\n    Eh: number, El: number, Fh: number, Fl: number, Gh: number, Gl: number, Hh: number, Hl: number\n  ): void {\n    this.Ah = Ah | 0;\n    this.Al = Al | 0;\n    this.Bh = Bh | 0;\n    this.Bl = Bl | 0;\n    this.Ch = Ch | 0;\n    this.Cl = Cl | 0;\n    this.Dh = Dh | 0;\n    this.Dl = Dl | 0;\n    this.Eh = Eh | 0;\n    this.El = El | 0;\n    this.Fh = Fh | 0;\n    this.Fl = Fl | 0;\n    this.Gh = Gh | 0;\n    this.Gl = Gl | 0;\n    this.Hh = Hh | 0;\n    this.Hl = Hl | 0;\n  }\n  protected process(view: DataView, offset: number): void {\n    // Extend the first 16 words into the remaining 64 words w[16..79] of the message schedule array\n    for (let i = 0; i < 16; i++, offset += 4) {\n      SHA512_W_H[i] = view.getUint32(offset);\n      SHA512_W_L[i] = view.getUint32((offset += 4));\n    }\n    for (let i = 16; i < 80; i++) {\n      // s0 := (w[i-15] rightrotate 1) xor (w[i-15] rightrotate 8) xor (w[i-15] rightshift 7)\n      const W15h = SHA512_W_H[i - 15] | 0;\n      const W15l = SHA512_W_L[i - 15] | 0;\n      const s0h = u64.rotrSH(W15h, W15l, 1) ^ u64.rotrSH(W15h, W15l, 8) ^ u64.shrSH(W15h, W15l, 7);\n      const s0l = u64.rotrSL(W15h, W15l, 1) ^ u64.rotrSL(W15h, W15l, 8) ^ u64.shrSL(W15h, W15l, 7);\n      // s1 := (w[i-2] rightrotate 19) xor (w[i-2] rightrotate 61) xor (w[i-2] rightshift 6)\n      const W2h = SHA512_W_H[i - 2] | 0;\n      const W2l = SHA512_W_L[i - 2] | 0;\n      const s1h = u64.rotrSH(W2h, W2l, 19) ^ u64.rotrBH(W2h, W2l, 61) ^ u64.shrSH(W2h, W2l, 6);\n      const s1l = u64.rotrSL(W2h, W2l, 19) ^ u64.rotrBL(W2h, W2l, 61) ^ u64.shrSL(W2h, W2l, 6);\n      // SHA256_W[i] = s0 + s1 + SHA256_W[i - 7] + SHA256_W[i - 16];\n      const SUMl = u64.add4L(s0l, s1l, SHA512_W_L[i - 7], SHA512_W_L[i - 16]);\n      const SUMh = u64.add4H(SUMl, s0h, s1h, SHA512_W_H[i - 7], SHA512_W_H[i - 16]);\n      SHA512_W_H[i] = SUMh | 0;\n      SHA512_W_L[i] = SUMl | 0;\n    }\n    let { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;\n    // Compression function main loop, 80 rounds\n    for (let i = 0; i < 80; i++) {\n      // S1 := (e rightrotate 14) xor (e rightrotate 18) xor (e rightrotate 41)\n      const sigma1h = u64.rotrSH(Eh, El, 14) ^ u64.rotrSH(Eh, El, 18) ^ u64.rotrBH(Eh, El, 41);\n      const sigma1l = u64.rotrSL(Eh, El, 14) ^ u64.rotrSL(Eh, El, 18) ^ u64.rotrBL(Eh, El, 41);\n      //const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n      const CHIh = (Eh & Fh) ^ (~Eh & Gh);\n      const CHIl = (El & Fl) ^ (~El & Gl);\n      // T1 = H + sigma1 + Chi(E, F, G) + SHA512_K[i] + SHA512_W[i]\n      // prettier-ignore\n      const T1ll = u64.add5L(Hl, sigma1l, CHIl, SHA512_Kl[i], SHA512_W_L[i]);\n      const T1h = u64.add5H(T1ll, Hh, sigma1h, CHIh, SHA512_Kh[i], SHA512_W_H[i]);\n      const T1l = T1ll | 0;\n      // S0 := (a rightrotate 28) xor (a rightrotate 34) xor (a rightrotate 39)\n      const sigma0h = u64.rotrSH(Ah, Al, 28) ^ u64.rotrBH(Ah, Al, 34) ^ u64.rotrBH(Ah, Al, 39);\n      const sigma0l = u64.rotrSL(Ah, Al, 28) ^ u64.rotrBL(Ah, Al, 34) ^ u64.rotrBL(Ah, Al, 39);\n      const MAJh = (Ah & Bh) ^ (Ah & Ch) ^ (Bh & Ch);\n      const MAJl = (Al & Bl) ^ (Al & Cl) ^ (Bl & Cl);\n      Hh = Gh | 0;\n      Hl = Gl | 0;\n      Gh = Fh | 0;\n      Gl = Fl | 0;\n      Fh = Eh | 0;\n      Fl = El | 0;\n      ({ h: Eh, l: El } = u64.add(Dh | 0, Dl | 0, T1h | 0, T1l | 0));\n      Dh = Ch | 0;\n      Dl = Cl | 0;\n      Ch = Bh | 0;\n      Cl = Bl | 0;\n      Bh = Ah | 0;\n      Bl = Al | 0;\n      const All = u64.add3L(T1l, sigma0l, MAJl);\n      Ah = u64.add3H(All, T1h, sigma0h, MAJh);\n      Al = All | 0;\n    }\n    // Add the compressed chunk to the current hash value\n    ({ h: Ah, l: Al } = u64.add(this.Ah | 0, this.Al | 0, Ah | 0, Al | 0));\n    ({ h: Bh, l: Bl } = u64.add(this.Bh | 0, this.Bl | 0, Bh | 0, Bl | 0));\n    ({ h: Ch, l: Cl } = u64.add(this.Ch | 0, this.Cl | 0, Ch | 0, Cl | 0));\n    ({ h: Dh, l: Dl } = u64.add(this.Dh | 0, this.Dl | 0, Dh | 0, Dl | 0));\n    ({ h: Eh, l: El } = u64.add(this.Eh | 0, this.El | 0, Eh | 0, El | 0));\n    ({ h: Fh, l: Fl } = u64.add(this.Fh | 0, this.Fl | 0, Fh | 0, Fl | 0));\n    ({ h: Gh, l: Gl } = u64.add(this.Gh | 0, this.Gl | 0, Gh | 0, Gl | 0));\n    ({ h: Hh, l: Hl } = u64.add(this.Hh | 0, this.Hl | 0, Hh | 0, Hl | 0));\n    this.set(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl);\n  }\n  protected roundClean(): void {\n    clean(SHA512_W_H, SHA512_W_L);\n  }\n  destroy(): void {\n    clean(this.buffer);\n    this.set(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);\n  }\n}\n\nexport class SHA384 extends SHA512 {\n  protected Ah: number = SHA384_IV[0] | 0;\n  protected Al: number = SHA384_IV[1] | 0;\n  protected Bh: number = SHA384_IV[2] | 0;\n  protected Bl: number = SHA384_IV[3] | 0;\n  protected Ch: number = SHA384_IV[4] | 0;\n  protected Cl: number = SHA384_IV[5] | 0;\n  protected Dh: number = SHA384_IV[6] | 0;\n  protected Dl: number = SHA384_IV[7] | 0;\n  protected Eh: number = SHA384_IV[8] | 0;\n  protected El: number = SHA384_IV[9] | 0;\n  protected Fh: number = SHA384_IV[10] | 0;\n  protected Fl: number = SHA384_IV[11] | 0;\n  protected Gh: number = SHA384_IV[12] | 0;\n  protected Gl: number = SHA384_IV[13] | 0;\n  protected Hh: number = SHA384_IV[14] | 0;\n  protected Hl: number = SHA384_IV[15] | 0;\n\n  constructor() {\n    super(48);\n  }\n}\n\n/**\n * Truncated SHA512/256 and SHA512/224.\n * SHA512_IV is XORed with 0xa5a5a5a5a5a5a5a5, then used as \"intermediary\" IV of SHA512/t.\n * Then t hashes string to produce result IV.\n * See `test/misc/sha2-gen-iv.js`.\n */\n\n/** SHA512/224 IV */\nconst T224_IV = /* @__PURE__ */ Uint32Array.from([\n  0x8c3d37c8, 0x19544da2, 0x73e19966, 0x89dcd4d6, 0x1dfab7ae, 0x32ff9c82, 0x679dd514, 0x582f9fcf,\n  0x0f6d2b69, 0x7bd44da8, 0x77e36f73, 0x04c48942, 0x3f9d85a8, 0x6a1d36c8, 0x1112e6ad, 0x91d692a1,\n]);\n\n/** SHA512/256 IV */\nconst T256_IV = /* @__PURE__ */ Uint32Array.from([\n  0x22312194, 0xfc2bf72c, 0x9f555fa3, 0xc84c64c2, 0x2393b86b, 0x6f53b151, 0x96387719, 0x5940eabd,\n  0x96283ee2, 0xa88effe3, 0xbe5e1e25, 0x53863992, 0x2b0199fc, 0x2c85b8aa, 0x0eb72ddc, 0x81c52ca2,\n]);\n\nexport class SHA512_224 extends SHA512 {\n  protected Ah: number = T224_IV[0] | 0;\n  protected Al: number = T224_IV[1] | 0;\n  protected Bh: number = T224_IV[2] | 0;\n  protected Bl: number = T224_IV[3] | 0;\n  protected Ch: number = T224_IV[4] | 0;\n  protected Cl: number = T224_IV[5] | 0;\n  protected Dh: number = T224_IV[6] | 0;\n  protected Dl: number = T224_IV[7] | 0;\n  protected Eh: number = T224_IV[8] | 0;\n  protected El: number = T224_IV[9] | 0;\n  protected Fh: number = T224_IV[10] | 0;\n  protected Fl: number = T224_IV[11] | 0;\n  protected Gh: number = T224_IV[12] | 0;\n  protected Gl: number = T224_IV[13] | 0;\n  protected Hh: number = T224_IV[14] | 0;\n  protected Hl: number = T224_IV[15] | 0;\n\n  constructor() {\n    super(28);\n  }\n}\n\nexport class SHA512_256 extends SHA512 {\n  protected Ah: number = T256_IV[0] | 0;\n  protected Al: number = T256_IV[1] | 0;\n  protected Bh: number = T256_IV[2] | 0;\n  protected Bl: number = T256_IV[3] | 0;\n  protected Ch: number = T256_IV[4] | 0;\n  protected Cl: number = T256_IV[5] | 0;\n  protected Dh: number = T256_IV[6] | 0;\n  protected Dl: number = T256_IV[7] | 0;\n  protected Eh: number = T256_IV[8] | 0;\n  protected El: number = T256_IV[9] | 0;\n  protected Fh: number = T256_IV[10] | 0;\n  protected Fl: number = T256_IV[11] | 0;\n  protected Gh: number = T256_IV[12] | 0;\n  protected Gl: number = T256_IV[13] | 0;\n  protected Hh: number = T256_IV[14] | 0;\n  protected Hl: number = T256_IV[15] | 0;\n\n  constructor() {\n    super(32);\n  }\n}\n\n/**\n * SHA2-256 hash function from RFC 4634.\n *\n * It is the fastest JS hash, even faster than Blake3.\n * To break sha256 using birthday attack, attackers need to try 2^128 hashes.\n * BTC network is doing 2^70 hashes/sec (2^95 hashes/year) as per 2025.\n */\nexport const sha256: CHash = /* @__PURE__ */ createHasher(() => new SHA256());\n/** SHA2-224 hash function from RFC 4634 */\nexport const sha224: CHash = /* @__PURE__ */ createHasher(() => new SHA224());\n\n/** SHA2-512 hash function from RFC 4634. */\nexport const sha512: CHash = /* @__PURE__ */ createHasher(() => new SHA512());\n/** SHA2-384 hash function from RFC 4634. */\nexport const sha384: CHash = /* @__PURE__ */ createHasher(() => new SHA384());\n\n/**\n * SHA2-512/256 \"truncated\" hash function, with improved resistance to length extension attacks.\n * See the paper on [truncated SHA512](https://eprint.iacr.org/2010/548.pdf).\n */\nexport const sha512_256: CHash = /* @__PURE__ */ createHasher(() => new SHA512_256());\n/**\n * SHA2-512/224 \"truncated\" hash function, with improved resistance to length extension attacks.\n * See the paper on [truncated SHA512](https://eprint.iacr.org/2010/548.pdf).\n */\nexport const sha512_224: CHash = /* @__PURE__ */ createHasher(() => new SHA512_224());\n", "/**\n * Hex, bytes and number utilities.\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport {\n  abytes as abytes_,\n  bytesToHex as bytesToHex_,\n  concatBytes as concatBytes_,\n  hexToBytes as hexToBytes_,\n  isBytes as isBytes_,\n} from '@noble/hashes/utils.js';\nexport {\n  abytes,\n  anumber,\n  bytesToHex,\n  bytesToUtf8,\n  concatBytes,\n  hexToBytes,\n  isBytes,\n  randomBytes,\n  utf8ToBytes,\n} from '@noble/hashes/utils.js';\nconst _0n = /* @__PURE__ */ BigInt(0);\nconst _1n = /* @__PURE__ */ BigInt(1);\nexport type Hex = Uint8Array | string; // hex strings are accepted for simplicity\nexport type PrivKey = Hex | bigint; // bigints are accepted to ease learning curve\nexport type CHash = {\n  (message: Uint8Array | string): Uint8Array;\n  blockLen: number;\n  outputLen: number;\n  create(opts?: { dkLen?: number }): any; // For shake\n};\nexport type FHash = (message: Uint8Array | string) => Uint8Array;\n\nexport function abool(title: string, value: boolean): void {\n  if (typeof value !== 'boolean') throw new Error(title + ' boolean expected, got ' + value);\n}\n\n// tmp name until v2\nexport function _abool2(value: boolean, title: string = ''): boolean {\n  if (typeof value !== 'boolean') {\n    const prefix = title && `\"${title}\"`;\n    throw new Error(prefix + 'expected boolean, got type=' + typeof value);\n  }\n  return value;\n}\n\n// tmp name until v2\n/** Asserts something is Uint8Array. */\nexport function _abytes2(value: Uint8Array, length?: number, title: string = ''): Uint8Array {\n  const bytes = isBytes_(value);\n  const len = value?.length;\n  const needsLen = length !== undefined;\n  if (!bytes || (needsLen && len !== length)) {\n    const prefix = title && `\"${title}\" `;\n    const ofLen = needsLen ? ` of length ${length}` : '';\n    const got = bytes ? `length=${len}` : `type=${typeof value}`;\n    throw new Error(prefix + 'expected Uint8Array' + ofLen + ', got ' + got);\n  }\n  return value;\n}\n\n// Used in weierstrass, der\nexport function numberToHexUnpadded(num: number | bigint): string {\n  const hex = num.toString(16);\n  return hex.length & 1 ? '0' + hex : hex;\n}\n\nexport function hexToNumber(hex: string): bigint {\n  if (typeof hex !== 'string') throw new Error('hex string expected, got ' + typeof hex);\n  return hex === '' ? _0n : BigInt('0x' + hex); // Big Endian\n}\n\n// BE: Big Endian, LE: Little Endian\nexport function bytesToNumberBE(bytes: Uint8Array): bigint {\n  return hexToNumber(bytesToHex_(bytes));\n}\nexport function bytesToNumberLE(bytes: Uint8Array): bigint {\n  abytes_(bytes);\n  return hexToNumber(bytesToHex_(Uint8Array.from(bytes).reverse()));\n}\n\nexport function numberToBytesBE(n: number | bigint, len: number): Uint8Array {\n  return hexToBytes_(n.toString(16).padStart(len * 2, '0'));\n}\nexport function numberToBytesLE(n: number | bigint, len: number): Uint8Array {\n  return numberToBytesBE(n, len).reverse();\n}\n// Unpadded, rarely used\nexport function numberToVarBytesBE(n: number | bigint): Uint8Array {\n  return hexToBytes_(numberToHexUnpadded(n));\n}\n\n/**\n * Takes hex string or Uint8Array, converts to Uint8Array.\n * Validates output length.\n * Will throw error for other types.\n * @param title descriptive title for an error e.g. 'secret key'\n * @param hex hex string or Uint8Array\n * @param expectedLength optional, will compare to result array's length\n * @returns\n */\nexport function ensureBytes(title: string, hex: Hex, expectedLength?: number): Uint8Array {\n  let res: Uint8Array;\n  if (typeof hex === 'string') {\n    try {\n      res = hexToBytes_(hex);\n    } catch (e) {\n      throw new Error(title + ' must be hex string or Uint8Array, cause: ' + e);\n    }\n  } else if (isBytes_(hex)) {\n    // Uint8Array.from() instead of hash.slice() because node.js Buffer\n    // is instance of Uint8Array, and its slice() creates **mutable** copy\n    res = Uint8Array.from(hex);\n  } else {\n    throw new Error(title + ' must be hex string or Uint8Array');\n  }\n  const len = res.length;\n  if (typeof expectedLength === 'number' && len !== expectedLength)\n    throw new Error(title + ' of length ' + expectedLength + ' expected, got ' + len);\n  return res;\n}\n\n// Compares 2 u8a-s in kinda constant time\nexport function equalBytes(a: Uint8Array, b: Uint8Array): boolean {\n  if (a.length !== b.length) return false;\n  let diff = 0;\n  for (let i = 0; i < a.length; i++) diff |= a[i] ^ b[i];\n  return diff === 0;\n}\n/**\n * Copies Uint8Array. We can't use u8a.slice(), because u8a can be Buffer,\n * and Buffer#slice creates mutable copy. Never use Buffers!\n */\nexport function copyBytes(bytes: Uint8Array): Uint8Array {\n  return Uint8Array.from(bytes);\n}\n\n/**\n * Decodes 7-bit ASCII string to Uint8Array, throws on non-ascii symbols\n * Should be safe to use for things expected to be ASCII.\n * Returns exact same result as utf8ToBytes for ASCII or throws.\n */\nexport function asciiToBytes(ascii: string): Uint8Array {\n  return Uint8Array.from(ascii, (c, i) => {\n    const charCode = c.charCodeAt(0);\n    if (c.length !== 1 || charCode > 127) {\n      throw new Error(\n        `string contains non-ASCII character \"${ascii[i]}\" with code ${charCode} at position ${i}`\n      );\n    }\n    return charCode;\n  });\n}\n\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\n// export const utf8ToBytes: typeof utf8ToBytes_ = utf8ToBytes_;\n/**\n * Converts bytes to string using UTF8 encoding.\n * @example bytesToUtf8(Uint8Array.from([97, 98, 99])) // 'abc'\n */\n// export const bytesToUtf8: typeof bytesToUtf8_ = bytesToUtf8_;\n\n// Is positive bigint\nconst isPosBig = (n: bigint) => typeof n === 'bigint' && _0n <= n;\n\nexport function inRange(n: bigint, min: bigint, max: bigint): boolean {\n  return isPosBig(n) && isPosBig(min) && isPosBig(max) && min <= n && n < max;\n}\n\n/**\n * Asserts min <= n < max. NOTE: It's < max and not <= max.\n * @example\n * aInRange('x', x, 1n, 256n); // would assume x is in (1n..255n)\n */\nexport function aInRange(title: string, n: bigint, min: bigint, max: bigint): void {\n  // Why min <= n < max and not a (min < n < max) OR b (min <= n <= max)?\n  // consider P=256n, min=0n, max=P\n  // - a for min=0 would require -1:          `inRange('x', x, -1n, P)`\n  // - b would commonly require subtraction:  `inRange('x', x, 0n, P - 1n)`\n  // - our way is the cleanest:               `inRange('x', x, 0n, P)\n  if (!inRange(n, min, max))\n    throw new Error('expected valid ' + title + ': ' + min + ' <= n < ' + max + ', got ' + n);\n}\n\n// Bit operations\n\n/**\n * Calculates amount of bits in a bigint.\n * Same as `n.toString(2).length`\n * TODO: merge with nLength in modular\n */\nexport function bitLen(n: bigint): number {\n  let len;\n  for (len = 0; n > _0n; n >>= _1n, len += 1);\n  return len;\n}\n\n/**\n * Gets single bit at position.\n * NOTE: first bit position is 0 (same as arrays)\n * Same as `!!+Array.from(n.toString(2)).reverse()[pos]`\n */\nexport function bitGet(n: bigint, pos: number): bigint {\n  return (n >> BigInt(pos)) & _1n;\n}\n\n/**\n * Sets single bit at position.\n */\nexport function bitSet(n: bigint, pos: number, value: boolean): bigint {\n  return n | ((value ? _1n : _0n) << BigInt(pos));\n}\n\n/**\n * Calculate mask for N bits. Not using ** operator with bigints because of old engines.\n * Same as BigInt(`0b${Array(i).fill('1').join('')}`)\n */\nexport const bitMask = (n: number): bigint => (_1n << BigInt(n)) - _1n;\n\n// DRBG\n\ntype Pred<T> = (v: Uint8Array) => T | undefined;\n/**\n * Minimal HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n * @returns function that will call DRBG until 2nd arg returns something meaningful\n * @example\n *   const drbg = createHmacDRBG<Key>(32, 32, hmac);\n *   drbg(seed, bytesToKey); // bytesToKey must return Key or undefined\n */\nexport function createHmacDrbg<T>(\n  hashLen: number,\n  qByteLen: number,\n  hmacFn: (key: Uint8Array, ...messages: Uint8Array[]) => Uint8Array\n): (seed: Uint8Array, predicate: Pred<T>) => T {\n  if (typeof hashLen !== 'number' || hashLen < 2) throw new Error('hashLen must be a number');\n  if (typeof qByteLen !== 'number' || qByteLen < 2) throw new Error('qByteLen must be a number');\n  if (typeof hmacFn !== 'function') throw new Error('hmacFn must be a function');\n  // Step B, Step C: set hashLen to 8*ceil(hlen/8)\n  const u8n = (len: number) => new Uint8Array(len); // creates Uint8Array\n  const u8of = (byte: number) => Uint8Array.of(byte); // another shortcut\n  let v = u8n(hashLen); // Minimal non-full-spec HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n  let k = u8n(hashLen); // Steps B and C of RFC6979 3.2: set hashLen, in our case always same\n  let i = 0; // Iterations counter, will throw when over 1000\n  const reset = () => {\n    v.fill(1);\n    k.fill(0);\n    i = 0;\n  };\n  const h = (...b: Uint8Array[]) => hmacFn(k, v, ...b); // hmac(k)(v, ...values)\n  const reseed = (seed = u8n(0)) => {\n    // HMAC-DRBG reseed() function. Steps D-G\n    k = h(u8of(0x00), seed); // k = hmac(k || v || 0x00 || seed)\n    v = h(); // v = hmac(k || v)\n    if (seed.length === 0) return;\n    k = h(u8of(0x01), seed); // k = hmac(k || v || 0x01 || seed)\n    v = h(); // v = hmac(k || v)\n  };\n  const gen = () => {\n    // HMAC-DRBG generate() function\n    if (i++ >= 1000) throw new Error('drbg: tried 1000 values');\n    let len = 0;\n    const out: Uint8Array[] = [];\n    while (len < qByteLen) {\n      v = h();\n      const sl = v.slice();\n      out.push(sl);\n      len += v.length;\n    }\n    return concatBytes_(...out);\n  };\n  const genUntil = (seed: Uint8Array, pred: Pred<T>): T => {\n    reset();\n    reseed(seed); // Steps D-G\n    let res: T | undefined = undefined; // Step H: grind until k is in [1..n-1]\n    while (!(res = pred(gen()))) reseed();\n    reset();\n    return res;\n  };\n  return genUntil;\n}\n\n// Validating curves and fields\n\nconst validatorFns = {\n  bigint: (val: any): boolean => typeof val === 'bigint',\n  function: (val: any): boolean => typeof val === 'function',\n  boolean: (val: any): boolean => typeof val === 'boolean',\n  string: (val: any): boolean => typeof val === 'string',\n  stringOrUint8Array: (val: any): boolean => typeof val === 'string' || isBytes_(val),\n  isSafeInteger: (val: any): boolean => Number.isSafeInteger(val),\n  array: (val: any): boolean => Array.isArray(val),\n  field: (val: any, object: any): any => (object as any).Fp.isValid(val),\n  hash: (val: any): boolean => typeof val === 'function' && Number.isSafeInteger(val.outputLen),\n} as const;\ntype Validator = keyof typeof validatorFns;\ntype ValMap<T extends Record<string, any>> = { [K in keyof T]?: Validator };\n// type Record<K extends string | number | symbol, T> = { [P in K]: T; }\n\nexport function validateObject<T extends Record<string, any>>(\n  object: T,\n  validators: ValMap<T>,\n  optValidators: ValMap<T> = {}\n): T {\n  const checkField = (fieldName: keyof T, type: Validator, isOptional: boolean) => {\n    const checkVal = validatorFns[type];\n    if (typeof checkVal !== 'function') throw new Error('invalid validator function');\n\n    const val = object[fieldName as keyof typeof object];\n    if (isOptional && val === undefined) return;\n    if (!checkVal(val, object)) {\n      throw new Error(\n        'param ' + String(fieldName) + ' is invalid. Expected ' + type + ', got ' + val\n      );\n    }\n  };\n  for (const [fieldName, type] of Object.entries(validators)) checkField(fieldName, type!, false);\n  for (const [fieldName, type] of Object.entries(optValidators)) checkField(fieldName, type!, true);\n  return object;\n}\n// validate type tests\n// const o: { a: number; b: number; c: number } = { a: 1, b: 5, c: 6 };\n// const z0 = validateObject(o, { a: 'isSafeInteger' }, { c: 'bigint' }); // Ok!\n// // Should fail type-check\n// const z1 = validateObject(o, { a: 'tmp' }, { c: 'zz' });\n// const z2 = validateObject(o, { a: 'isSafeInteger' }, { c: 'zz' });\n// const z3 = validateObject(o, { test: 'boolean', z: 'bug' });\n// const z4 = validateObject(o, { a: 'boolean', z: 'bug' });\n\nexport function isHash(val: CHash): boolean {\n  return typeof val === 'function' && Number.isSafeInteger(val.outputLen);\n}\nexport function _validateObject(\n  object: Record<string, any>,\n  fields: Record<string, string>,\n  optFields: Record<string, string> = {}\n): void {\n  if (!object || typeof object !== 'object') throw new Error('expected valid options object');\n  type Item = keyof typeof object;\n  function checkField(fieldName: Item, expectedType: string, isOpt: boolean) {\n    const val = object[fieldName];\n    if (isOpt && val === undefined) return;\n    const current = typeof val;\n    if (current !== expectedType || val === null)\n      throw new Error(`param \"${fieldName}\" is invalid: expected ${expectedType}, got ${current}`);\n  }\n  Object.entries(fields).forEach(([k, v]) => checkField(k, v, false));\n  Object.entries(optFields).forEach(([k, v]) => checkField(k, v, true));\n}\n\n/**\n * throws not implemented error\n */\nexport const notImplemented = (): never => {\n  throw new Error('not implemented');\n};\n\n/**\n * Memoizes (caches) computation result.\n * Uses WeakMap: the value is going auto-cleaned by GC after last reference is removed.\n */\nexport function memoized<T extends object, R, O extends any[]>(\n  fn: (arg: T, ...args: O) => R\n): (arg: T, ...args: O) => R {\n  const map = new WeakMap<T, R>();\n  return (arg: T, ...args: O): R => {\n    const val = map.get(arg);\n    if (val !== undefined) return val;\n    const computed = fn(arg, ...args);\n    map.set(arg, computed);\n    return computed;\n  };\n}\n", "/**\n * Utils for modular division and fields.\n * Field over 11 is a finite (Galois) field is integer number operations `mod 11`.\n * There is no division: it is replaced by modular multiplicative inverse.\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport {\n  _validateObject,\n  anumber,\n  bitMask,\n  bytesToNumberBE,\n  bytesToNumberLE,\n  ensureBytes,\n  numberToBytesBE,\n  numberToBytesLE,\n} from '../utils.ts';\n\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = /* @__PURE__ */ BigInt(2), _3n = /* @__PURE__ */ BigInt(3);\n// prettier-ignore\nconst _4n = /* @__PURE__ */ BigInt(4), _5n = /* @__PURE__ */ BigInt(5), _7n = /* @__PURE__ */ BigInt(7);\n// prettier-ignore\nconst _8n = /* @__PURE__ */ BigInt(8), _9n = /* @__PURE__ */ BigInt(9), _16n = /* @__PURE__ */ BigInt(16);\n\n// Calculates a modulo b\nexport function mod(a: bigint, b: bigint): bigint {\n  const result = a % b;\n  return result >= _0n ? result : b + result;\n}\n/**\n * Efficiently raise num to power and do modular division.\n * Unsafe in some contexts: uses ladder, so can expose bigint bits.\n * @example\n * pow(2n, 6n, 11n) // 64n % 11n == 9n\n */\nexport function pow(num: bigint, power: bigint, modulo: bigint): bigint {\n  return FpPow(Field(modulo), num, power);\n}\n\n/** Does `x^(2^power)` mod p. `pow2(30, 4)` == `30^(2^4)` */\nexport function pow2(x: bigint, power: bigint, modulo: bigint): bigint {\n  let res = x;\n  while (power-- > _0n) {\n    res *= res;\n    res %= modulo;\n  }\n  return res;\n}\n\n/**\n * Inverses number over modulo.\n * Implemented using [Euclidean GCD](https://brilliant.org/wiki/extended-euclidean-algorithm/).\n */\nexport function invert(number: bigint, modulo: bigint): bigint {\n  if (number === _0n) throw new Error('invert: expected non-zero number');\n  if (modulo <= _0n) throw new Error('invert: expected positive modulus, got ' + modulo);\n  // Fermat's little theorem \"CT-like\" version inv(n) = n^(m-2) mod m is 30x slower.\n  let a = mod(number, modulo);\n  let b = modulo;\n  // prettier-ignore\n  let x = _0n, y = _1n, u = _1n, v = _0n;\n  while (a !== _0n) {\n    // JIT applies optimization if those two lines follow each other\n    const q = b / a;\n    const r = b % a;\n    const m = x - u * q;\n    const n = y - v * q;\n    // prettier-ignore\n    b = a, a = r, x = u, y = v, u = m, v = n;\n  }\n  const gcd = b;\n  if (gcd !== _1n) throw new Error('invert: does not exist');\n  return mod(x, modulo);\n}\n\nfunction assertIsSquare<T>(Fp: IField<T>, root: T, n: T): void {\n  if (!Fp.eql(Fp.sqr(root), n)) throw new Error('Cannot find square root');\n}\n\n// Not all roots are possible! Example which will throw:\n// const NUM =\n// n = 72057594037927816n;\n// Fp = Field(BigInt('0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab'));\nfunction sqrt3mod4<T>(Fp: IField<T>, n: T) {\n  const p1div4 = (Fp.ORDER + _1n) / _4n;\n  const root = Fp.pow(n, p1div4);\n  assertIsSquare(Fp, root, n);\n  return root;\n}\n\nfunction sqrt5mod8<T>(Fp: IField<T>, n: T) {\n  const p5div8 = (Fp.ORDER - _5n) / _8n;\n  const n2 = Fp.mul(n, _2n);\n  const v = Fp.pow(n2, p5div8);\n  const nv = Fp.mul(n, v);\n  const i = Fp.mul(Fp.mul(nv, _2n), v);\n  const root = Fp.mul(nv, Fp.sub(i, Fp.ONE));\n  assertIsSquare(Fp, root, n);\n  return root;\n}\n\n// Based on RFC9380, Kong algorithm\n// prettier-ignore\nfunction sqrt9mod16(P: bigint): <T>(Fp: IField<T>, n: T) => T {\n  const Fp_ = Field(P);\n  const tn = tonelliShanks(P);\n  const c1 = tn(Fp_, Fp_.neg(Fp_.ONE));//  1. c1 = sqrt(-1) in F, i.e., (c1^2) == -1 in F\n  const c2 = tn(Fp_, c1);              //  2. c2 = sqrt(c1) in F, i.e., (c2^2) == c1 in F\n  const c3 = tn(Fp_, Fp_.neg(c1));     //  3. c3 = sqrt(-c1) in F, i.e., (c3^2) == -c1 in F\n  const c4 = (P + _7n) / _16n;         //  4. c4 = (q + 7) / 16        # Integer arithmetic\n  return <T>(Fp: IField<T>, n: T) => {\n    let tv1 = Fp.pow(n, c4);           //  1. tv1 = x^c4\n    let tv2 = Fp.mul(tv1, c1);         //  2. tv2 = c1 * tv1\n    const tv3 = Fp.mul(tv1, c2);       //  3. tv3 = c2 * tv1\n    const tv4 = Fp.mul(tv1, c3);       //  4. tv4 = c3 * tv1\n    const e1 = Fp.eql(Fp.sqr(tv2), n); //  5.  e1 = (tv2^2) == x\n    const e2 = Fp.eql(Fp.sqr(tv3), n); //  6.  e2 = (tv3^2) == x\n    tv1 = Fp.cmov(tv1, tv2, e1);       //  7. tv1 = CMOV(tv1, tv2, e1)  # Select tv2 if (tv2^2) == x\n    tv2 = Fp.cmov(tv4, tv3, e2);       //  8. tv2 = CMOV(tv4, tv3, e2)  # Select tv3 if (tv3^2) == x\n    const e3 = Fp.eql(Fp.sqr(tv2), n); //  9.  e3 = (tv2^2) == x\n    const root = Fp.cmov(tv1, tv2, e3);// 10.  z = CMOV(tv1, tv2, e3)   # Select sqrt from tv1 & tv2\n    assertIsSquare(Fp, root, n);\n    return root;\n  };\n}\n\n/**\n * Tonelli-Shanks square root search algorithm.\n * 1. https://eprint.iacr.org/2012/685.pdf (page 12)\n * 2. Square Roots from 1; 24, 51, 10 to Dan Shanks\n * @param P field order\n * @returns function that takes field Fp (created from P) and number n\n */\nexport function tonelliShanks(P: bigint): <T>(Fp: IField<T>, n: T) => T {\n  // Initialization (precomputation).\n  // Caching initialization could boost perf by 7%.\n  if (P < _3n) throw new Error('sqrt is not defined for small field');\n  // Factor P - 1 = Q * 2^S, where Q is odd\n  let Q = P - _1n;\n  let S = 0;\n  while (Q % _2n === _0n) {\n    Q /= _2n;\n    S++;\n  }\n\n  // Find the first quadratic non-residue Z >= 2\n  let Z = _2n;\n  const _Fp = Field(P);\n  while (FpLegendre(_Fp, Z) === 1) {\n    // Basic primality test for P. After x iterations, chance of\n    // not finding quadratic non-residue is 2^x, so 2^1000.\n    if (Z++ > 1000) throw new Error('Cannot find square root: probably non-prime P');\n  }\n  // Fast-path; usually done before Z, but we do \"primality test\".\n  if (S === 1) return sqrt3mod4;\n\n  // Slow-path\n  // TODO: test on Fp2 and others\n  let cc = _Fp.pow(Z, Q); // c = z^Q\n  const Q1div2 = (Q + _1n) / _2n;\n  return function tonelliSlow<T>(Fp: IField<T>, n: T): T {\n    if (Fp.is0(n)) return n;\n    // Check if n is a quadratic residue using Legendre symbol\n    if (FpLegendre(Fp, n) !== 1) throw new Error('Cannot find square root');\n\n    // Initialize variables for the main loop\n    let M = S;\n    let c = Fp.mul(Fp.ONE, cc); // c = z^Q, move cc from field _Fp into field Fp\n    let t = Fp.pow(n, Q); // t = n^Q, first guess at the fudge factor\n    let R = Fp.pow(n, Q1div2); // R = n^((Q+1)/2), first guess at the square root\n\n    // Main loop\n    // while t != 1\n    while (!Fp.eql(t, Fp.ONE)) {\n      if (Fp.is0(t)) return Fp.ZERO; // if t=0 return R=0\n      let i = 1;\n\n      // Find the smallest i >= 1 such that t^(2^i) \u2261 1 (mod P)\n      let t_tmp = Fp.sqr(t); // t^(2^1)\n      while (!Fp.eql(t_tmp, Fp.ONE)) {\n        i++;\n        t_tmp = Fp.sqr(t_tmp); // t^(2^2)...\n        if (i === M) throw new Error('Cannot find square root');\n      }\n\n      // Calculate the exponent for b: 2^(M - i - 1)\n      const exponent = _1n << BigInt(M - i - 1); // bigint is important\n      const b = Fp.pow(c, exponent); // b = 2^(M - i - 1)\n\n      // Update variables\n      M = i;\n      c = Fp.sqr(b); // c = b^2\n      t = Fp.mul(t, c); // t = (t * b^2)\n      R = Fp.mul(R, b); // R = R*b\n    }\n    return R;\n  };\n}\n\n/**\n * Square root for a finite field. Will try optimized versions first:\n *\n * 1. P \u2261 3 (mod 4)\n * 2. P \u2261 5 (mod 8)\n * 3. P \u2261 9 (mod 16)\n * 4. Tonelli-Shanks algorithm\n *\n * Different algorithms can give different roots, it is up to user to decide which one they want.\n * For example there is FpSqrtOdd/FpSqrtEven to choice root based on oddness (used for hash-to-curve).\n */\nexport function FpSqrt(P: bigint): <T>(Fp: IField<T>, n: T) => T {\n  // P \u2261 3 (mod 4) => \u221An = n^((P+1)/4)\n  if (P % _4n === _3n) return sqrt3mod4;\n  // P \u2261 5 (mod 8) => Atkin algorithm, page 10 of https://eprint.iacr.org/2012/685.pdf\n  if (P % _8n === _5n) return sqrt5mod8;\n  // P \u2261 9 (mod 16) => Kong algorithm, page 11 of https://eprint.iacr.org/2012/685.pdf (algorithm 4)\n  if (P % _16n === _9n) return sqrt9mod16(P);\n  // Tonelli-Shanks algorithm\n  return tonelliShanks(P);\n}\n\n// Little-endian check for first LE bit (last BE bit);\nexport const isNegativeLE = (num: bigint, modulo: bigint): boolean =>\n  (mod(num, modulo) & _1n) === _1n;\n\n/** Field is not always over prime: for example, Fp2 has ORDER(q)=p^m. */\nexport interface IField<T> {\n  ORDER: bigint;\n  isLE: boolean;\n  BYTES: number;\n  BITS: number;\n  MASK: bigint;\n  ZERO: T;\n  ONE: T;\n  // 1-arg\n  create: (num: T) => T;\n  isValid: (num: T) => boolean;\n  is0: (num: T) => boolean;\n  isValidNot0: (num: T) => boolean;\n  neg(num: T): T;\n  inv(num: T): T;\n  sqrt(num: T): T;\n  sqr(num: T): T;\n  // 2-args\n  eql(lhs: T, rhs: T): boolean;\n  add(lhs: T, rhs: T): T;\n  sub(lhs: T, rhs: T): T;\n  mul(lhs: T, rhs: T | bigint): T;\n  pow(lhs: T, power: bigint): T;\n  div(lhs: T, rhs: T | bigint): T;\n  // N for NonNormalized (for now)\n  addN(lhs: T, rhs: T): T;\n  subN(lhs: T, rhs: T): T;\n  mulN(lhs: T, rhs: T | bigint): T;\n  sqrN(num: T): T;\n\n  // Optional\n  // Should be same as sgn0 function in\n  // [RFC9380](https://www.rfc-editor.org/rfc/rfc9380#section-4.1).\n  // NOTE: sgn0 is 'negative in LE', which is same as odd. And negative in LE is kinda strange definition anyway.\n  isOdd?(num: T): boolean; // Odd instead of even since we have it for Fp2\n  allowedLengths?: number[];\n  // legendre?(num: T): T;\n  invertBatch: (lst: T[]) => T[];\n  toBytes(num: T): Uint8Array;\n  fromBytes(bytes: Uint8Array, skipValidation?: boolean): T;\n  // If c is False, CMOV returns a, otherwise it returns b.\n  cmov(a: T, b: T, c: boolean): T;\n}\n// prettier-ignore\nconst FIELD_FIELDS = [\n  'create', 'isValid', 'is0', 'neg', 'inv', 'sqrt', 'sqr',\n  'eql', 'add', 'sub', 'mul', 'pow', 'div',\n  'addN', 'subN', 'mulN', 'sqrN'\n] as const;\nexport function validateField<T>(field: IField<T>): IField<T> {\n  const initial = {\n    ORDER: 'bigint',\n    MASK: 'bigint',\n    BYTES: 'number',\n    BITS: 'number',\n  } as Record<string, string>;\n  const opts = FIELD_FIELDS.reduce((map, val: string) => {\n    map[val] = 'function';\n    return map;\n  }, initial);\n  _validateObject(field, opts);\n  // const max = 16384;\n  // if (field.BYTES < 1 || field.BYTES > max) throw new Error('invalid field');\n  // if (field.BITS < 1 || field.BITS > 8 * max) throw new Error('invalid field');\n  return field;\n}\n\n// Generic field functions\n\n/**\n * Same as `pow` but for Fp: non-constant-time.\n * Unsafe in some contexts: uses ladder, so can expose bigint bits.\n */\nexport function FpPow<T>(Fp: IField<T>, num: T, power: bigint): T {\n  if (power < _0n) throw new Error('invalid exponent, negatives unsupported');\n  if (power === _0n) return Fp.ONE;\n  if (power === _1n) return num;\n  let p = Fp.ONE;\n  let d = num;\n  while (power > _0n) {\n    if (power & _1n) p = Fp.mul(p, d);\n    d = Fp.sqr(d);\n    power >>= _1n;\n  }\n  return p;\n}\n\n/**\n * Efficiently invert an array of Field elements.\n * Exception-free. Will return `undefined` for 0 elements.\n * @param passZero map 0 to 0 (instead of undefined)\n */\nexport function FpInvertBatch<T>(Fp: IField<T>, nums: T[], passZero = false): T[] {\n  const inverted = new Array(nums.length).fill(passZero ? Fp.ZERO : undefined);\n  // Walk from first to last, multiply them by each other MOD p\n  const multipliedAcc = nums.reduce((acc, num, i) => {\n    if (Fp.is0(num)) return acc;\n    inverted[i] = acc;\n    return Fp.mul(acc, num);\n  }, Fp.ONE);\n  // Invert last element\n  const invertedAcc = Fp.inv(multipliedAcc);\n  // Walk from last to first, multiply them by inverted each other MOD p\n  nums.reduceRight((acc, num, i) => {\n    if (Fp.is0(num)) return acc;\n    inverted[i] = Fp.mul(acc, inverted[i]);\n    return Fp.mul(acc, num);\n  }, invertedAcc);\n  return inverted;\n}\n\n// TODO: remove\nexport function FpDiv<T>(Fp: IField<T>, lhs: T, rhs: T | bigint): T {\n  return Fp.mul(lhs, typeof rhs === 'bigint' ? invert(rhs, Fp.ORDER) : Fp.inv(rhs));\n}\n\n/**\n * Legendre symbol.\n * Legendre constant is used to calculate Legendre symbol (a | p)\n * which denotes the value of a^((p-1)/2) (mod p).\n *\n * * (a | p) \u2261 1    if a is a square (mod p), quadratic residue\n * * (a | p) \u2261 -1   if a is not a square (mod p), quadratic non residue\n * * (a | p) \u2261 0    if a \u2261 0 (mod p)\n */\nexport function FpLegendre<T>(Fp: IField<T>, n: T): -1 | 0 | 1 {\n  // We can use 3rd argument as optional cache of this value\n  // but seems unneeded for now. The operation is very fast.\n  const p1mod2 = (Fp.ORDER - _1n) / _2n;\n  const powered = Fp.pow(n, p1mod2);\n  const yes = Fp.eql(powered, Fp.ONE);\n  const zero = Fp.eql(powered, Fp.ZERO);\n  const no = Fp.eql(powered, Fp.neg(Fp.ONE));\n  if (!yes && !zero && !no) throw new Error('invalid Legendre symbol result');\n  return yes ? 1 : zero ? 0 : -1;\n}\n\n// This function returns True whenever the value x is a square in the field F.\nexport function FpIsSquare<T>(Fp: IField<T>, n: T): boolean {\n  const l = FpLegendre(Fp, n);\n  return l === 1;\n}\n\nexport type NLength = { nByteLength: number; nBitLength: number };\n// CURVE.n lengths\nexport function nLength(n: bigint, nBitLength?: number): NLength {\n  // Bit size, byte size of CURVE.n\n  if (nBitLength !== undefined) anumber(nBitLength);\n  const _nBitLength = nBitLength !== undefined ? nBitLength : n.toString(2).length;\n  const nByteLength = Math.ceil(_nBitLength / 8);\n  return { nBitLength: _nBitLength, nByteLength };\n}\n\ntype FpField = IField<bigint> & Required<Pick<IField<bigint>, 'isOdd'>>;\ntype SqrtFn = (n: bigint) => bigint;\ntype FieldOpts = Partial<{\n  sqrt: SqrtFn;\n  isLE: boolean;\n  BITS: number;\n  modFromBytes: boolean; // bls12-381 requires mod(n) instead of rejecting keys >= n\n  allowedLengths?: readonly number[]; // for P521 (adds padding for smaller sizes)\n}>;\n/**\n * Creates a finite field. Major performance optimizations:\n * * 1. Denormalized operations like mulN instead of mul.\n * * 2. Identical object shape: never add or remove keys.\n * * 3. `Object.freeze`.\n * Fragile: always run a benchmark on a change.\n * Security note: operations don't check 'isValid' for all elements for performance reasons,\n * it is caller responsibility to check this.\n * This is low-level code, please make sure you know what you're doing.\n *\n * Note about field properties:\n * * CHARACTERISTIC p = prime number, number of elements in main subgroup.\n * * ORDER q = similar to cofactor in curves, may be composite `q = p^m`.\n *\n * @param ORDER field order, probably prime, or could be composite\n * @param bitLen how many bits the field consumes\n * @param isLE (default: false) if encoding / decoding should be in little-endian\n * @param redef optional faster redefinitions of sqrt and other methods\n */\nexport function Field(\n  ORDER: bigint,\n  bitLenOrOpts?: number | FieldOpts, // TODO: use opts only in v2?\n  isLE = false,\n  opts: { sqrt?: SqrtFn } = {}\n): Readonly<FpField> {\n  if (ORDER <= _0n) throw new Error('invalid field: expected ORDER > 0, got ' + ORDER);\n  let _nbitLength: number | undefined = undefined;\n  let _sqrt: SqrtFn | undefined = undefined;\n  let modFromBytes: boolean = false;\n  let allowedLengths: undefined | readonly number[] = undefined;\n  if (typeof bitLenOrOpts === 'object' && bitLenOrOpts != null) {\n    if (opts.sqrt || isLE) throw new Error('cannot specify opts in two arguments');\n    const _opts = bitLenOrOpts;\n    if (_opts.BITS) _nbitLength = _opts.BITS;\n    if (_opts.sqrt) _sqrt = _opts.sqrt;\n    if (typeof _opts.isLE === 'boolean') isLE = _opts.isLE;\n    if (typeof _opts.modFromBytes === 'boolean') modFromBytes = _opts.modFromBytes;\n    allowedLengths = _opts.allowedLengths;\n  } else {\n    if (typeof bitLenOrOpts === 'number') _nbitLength = bitLenOrOpts;\n    if (opts.sqrt) _sqrt = opts.sqrt;\n  }\n  const { nBitLength: BITS, nByteLength: BYTES } = nLength(ORDER, _nbitLength);\n  if (BYTES > 2048) throw new Error('invalid field: expected ORDER of <= 2048 bytes');\n  let sqrtP: ReturnType<typeof FpSqrt>; // cached sqrtP\n  const f: Readonly<FpField> = Object.freeze({\n    ORDER,\n    isLE,\n    BITS,\n    BYTES,\n    MASK: bitMask(BITS),\n    ZERO: _0n,\n    ONE: _1n,\n    allowedLengths: allowedLengths,\n    create: (num) => mod(num, ORDER),\n    isValid: (num) => {\n      if (typeof num !== 'bigint')\n        throw new Error('invalid field element: expected bigint, got ' + typeof num);\n      return _0n <= num && num < ORDER; // 0 is valid element, but it's not invertible\n    },\n    is0: (num) => num === _0n,\n    // is valid and invertible\n    isValidNot0: (num: bigint) => !f.is0(num) && f.isValid(num),\n    isOdd: (num) => (num & _1n) === _1n,\n    neg: (num) => mod(-num, ORDER),\n    eql: (lhs, rhs) => lhs === rhs,\n\n    sqr: (num) => mod(num * num, ORDER),\n    add: (lhs, rhs) => mod(lhs + rhs, ORDER),\n    sub: (lhs, rhs) => mod(lhs - rhs, ORDER),\n    mul: (lhs, rhs) => mod(lhs * rhs, ORDER),\n    pow: (num, power) => FpPow(f, num, power),\n    div: (lhs, rhs) => mod(lhs * invert(rhs, ORDER), ORDER),\n\n    // Same as above, but doesn't normalize\n    sqrN: (num) => num * num,\n    addN: (lhs, rhs) => lhs + rhs,\n    subN: (lhs, rhs) => lhs - rhs,\n    mulN: (lhs, rhs) => lhs * rhs,\n\n    inv: (num) => invert(num, ORDER),\n    sqrt:\n      _sqrt ||\n      ((n) => {\n        if (!sqrtP) sqrtP = FpSqrt(ORDER);\n        return sqrtP(f, n);\n      }),\n    toBytes: (num) => (isLE ? numberToBytesLE(num, BYTES) : numberToBytesBE(num, BYTES)),\n    fromBytes: (bytes, skipValidation = true) => {\n      if (allowedLengths) {\n        if (!allowedLengths.includes(bytes.length) || bytes.length > BYTES) {\n          throw new Error(\n            'Field.fromBytes: expected ' + allowedLengths + ' bytes, got ' + bytes.length\n          );\n        }\n        const padded = new Uint8Array(BYTES);\n        // isLE add 0 to right, !isLE to the left.\n        padded.set(bytes, isLE ? 0 : padded.length - bytes.length);\n        bytes = padded;\n      }\n      if (bytes.length !== BYTES)\n        throw new Error('Field.fromBytes: expected ' + BYTES + ' bytes, got ' + bytes.length);\n      let scalar = isLE ? bytesToNumberLE(bytes) : bytesToNumberBE(bytes);\n      if (modFromBytes) scalar = mod(scalar, ORDER);\n      if (!skipValidation)\n        if (!f.isValid(scalar)) throw new Error('invalid field element: outside of range 0..ORDER');\n      // NOTE: we don't validate scalar here, please use isValid. This done such way because some\n      // protocol may allow non-reduced scalar that reduced later or changed some other way.\n      return scalar;\n    },\n    // TODO: we don't need it here, move out to separate fn\n    invertBatch: (lst) => FpInvertBatch(f, lst),\n    // We can't move this out because Fp6, Fp12 implement it\n    // and it's unclear what to return in there.\n    cmov: (a, b, c) => (c ? b : a),\n  } as FpField);\n  return Object.freeze(f);\n}\n\n// Generic random scalar, we can do same for other fields if via Fp2.mul(Fp2.ONE, Fp2.random)?\n// This allows unsafe methods like ignore bias or zero. These unsafe, but often used in different protocols (if deterministic RNG).\n// which mean we cannot force this via opts.\n// Not sure what to do with randomBytes, we can accept it inside opts if wanted.\n// Probably need to export getMinHashLength somewhere?\n// random(bytes?: Uint8Array, unsafeAllowZero = false, unsafeAllowBias = false) {\n//   const LEN = !unsafeAllowBias ? getMinHashLength(ORDER) : BYTES;\n//   if (bytes === undefined) bytes = randomBytes(LEN); // _opts.randomBytes?\n//   const num = isLE ? bytesToNumberLE(bytes) : bytesToNumberBE(bytes);\n//   // `mod(x, 11)` can sometimes produce 0. `mod(x, 10) + 1` is the same, but no 0\n//   const reduced = unsafeAllowZero ? mod(num, ORDER) : mod(num, ORDER - _1n) + _1n;\n//   return reduced;\n// },\n\nexport function FpSqrtOdd<T>(Fp: IField<T>, elm: T): T {\n  if (!Fp.isOdd) throw new Error(\"Field doesn't have isOdd\");\n  const root = Fp.sqrt(elm);\n  return Fp.isOdd(root) ? root : Fp.neg(root);\n}\n\nexport function FpSqrtEven<T>(Fp: IField<T>, elm: T): T {\n  if (!Fp.isOdd) throw new Error(\"Field doesn't have isOdd\");\n  const root = Fp.sqrt(elm);\n  return Fp.isOdd(root) ? Fp.neg(root) : root;\n}\n\n/**\n * \"Constant-time\" private key generation utility.\n * Same as mapKeyToField, but accepts less bytes (40 instead of 48 for 32-byte field).\n * Which makes it slightly more biased, less secure.\n * @deprecated use `mapKeyToField` instead\n */\nexport function hashToPrivateScalar(\n  hash: string | Uint8Array,\n  groupOrder: bigint,\n  isLE = false\n): bigint {\n  hash = ensureBytes('privateHash', hash);\n  const hashLen = hash.length;\n  const minLen = nLength(groupOrder).nByteLength + 8;\n  if (minLen < 24 || hashLen < minLen || hashLen > 1024)\n    throw new Error(\n      'hashToPrivateScalar: expected ' + minLen + '-1024 bytes of input, got ' + hashLen\n    );\n  const num = isLE ? bytesToNumberLE(hash) : bytesToNumberBE(hash);\n  return mod(num, groupOrder - _1n) + _1n;\n}\n\n/**\n * Returns total number of bytes consumed by the field element.\n * For example, 32 bytes for usual 256-bit weierstrass curve.\n * @param fieldOrder number of field elements, usually CURVE.n\n * @returns byte length of field\n */\nexport function getFieldBytesLength(fieldOrder: bigint): number {\n  if (typeof fieldOrder !== 'bigint') throw new Error('field order must be bigint');\n  const bitLength = fieldOrder.toString(2).length;\n  return Math.ceil(bitLength / 8);\n}\n\n/**\n * Returns minimal amount of bytes that can be safely reduced\n * by field order.\n * Should be 2^-128 for 128-bit curve such as P256.\n * @param fieldOrder number of field elements, usually CURVE.n\n * @returns byte length of target hash\n */\nexport function getMinHashLength(fieldOrder: bigint): number {\n  const length = getFieldBytesLength(fieldOrder);\n  return length + Math.ceil(length / 2);\n}\n\n/**\n * \"Constant-time\" private key generation utility.\n * Can take (n + n/2) or more bytes of uniform input e.g. from CSPRNG or KDF\n * and convert them into private scalar, with the modulo bias being negligible.\n * Needs at least 48 bytes of input for 32-byte private key.\n * https://research.kudelskisecurity.com/2020/07/28/the-definitive-guide-to-modulo-bias-and-how-to-avoid-it/\n * FIPS 186-5, A.2 https://csrc.nist.gov/publications/detail/fips/186/5/final\n * RFC 9380, https://www.rfc-editor.org/rfc/rfc9380#section-5\n * @param hash hash output from SHA3 or a similar function\n * @param groupOrder size of subgroup - (e.g. secp256k1.CURVE.n)\n * @param isLE interpret hash bytes as LE num\n * @returns valid private scalar\n */\nexport function mapHashToField(key: Uint8Array, fieldOrder: bigint, isLE = false): Uint8Array {\n  const len = key.length;\n  const fieldLen = getFieldBytesLength(fieldOrder);\n  const minLen = getMinHashLength(fieldOrder);\n  // No small numbers: need to understand bias story. No huge numbers: easier to detect JS timings.\n  if (len < 16 || len < minLen || len > 1024)\n    throw new Error('expected ' + minLen + '-1024 bytes of input, got ' + len);\n  const num = isLE ? bytesToNumberLE(key) : bytesToNumberBE(key);\n  // `mod(x, 11)` can sometimes produce 0. `mod(x, 10) + 1` is the same, but no 0\n  const reduced = mod(num, fieldOrder - _1n) + _1n;\n  return isLE ? numberToBytesLE(reduced, fieldLen) : numberToBytesBE(reduced, fieldLen);\n}\n", "/**\n * Methods for elliptic curve multiplication by scalars.\n * Contains wNAF, pippenger.\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { bitLen, bitMask, validateObject } from '../utils.ts';\nimport { Field, FpInvertBatch, nLength, validateField, type IField } from './modular.ts';\n\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\n\nexport type AffinePoint<T> = {\n  x: T;\n  y: T;\n} & { Z?: never };\n\n// This was initialy do this way to re-use montgomery ladder in field (add->mul,double->sqr), but\n// that didn't happen and there is probably not much reason to have separate Group like this?\nexport interface Group<T extends Group<T>> {\n  double(): T;\n  negate(): T;\n  add(other: T): T;\n  subtract(other: T): T;\n  equals(other: T): boolean;\n  multiply(scalar: bigint): T;\n  toAffine?(invertedZ?: any): AffinePoint<any>;\n}\n\n// We can't \"abstract out\" coordinates (X, Y, Z; and T in Edwards): argument names of constructor\n// are not accessible. See Typescript gh-56093, gh-41594.\n//\n// We have to use recursive types, so it will return actual point, not constained `CurvePoint`.\n// If, at any point, P is `any`, it will erase all types and replace it\n// with `any`, because of recursion, `any implements CurvePoint`,\n// but we lose all constrains on methods.\n\n/** Base interface for all elliptic curve Points. */\nexport interface CurvePoint<F, P extends CurvePoint<F, P>> extends Group<P> {\n  /** Affine x coordinate. Different from projective / extended X coordinate. */\n  x: F;\n  /** Affine y coordinate. Different from projective / extended Y coordinate. */\n  y: F;\n  Z?: F;\n  double(): P;\n  negate(): P;\n  add(other: P): P;\n  subtract(other: P): P;\n  equals(other: P): boolean;\n  multiply(scalar: bigint): P;\n  assertValidity(): void;\n  clearCofactor(): P;\n  is0(): boolean;\n  isTorsionFree(): boolean;\n  isSmallOrder(): boolean;\n  multiplyUnsafe(scalar: bigint): P;\n  /**\n   * Massively speeds up `p.multiply(n)` by using precompute tables (caching). See {@link wNAF}.\n   * @param isLazy calculate cache now. Default (true) ensures it's deferred to first `multiply()`\n   */\n  precompute(windowSize?: number, isLazy?: boolean): P;\n  /** Converts point to 2D xy affine coordinates */\n  toAffine(invertedZ?: F): AffinePoint<F>;\n  toBytes(): Uint8Array;\n  toHex(): string;\n}\n\n/** Base interface for all elliptic curve Point constructors. */\nexport interface CurvePointCons<P extends CurvePoint<any, P>> {\n  [Symbol.hasInstance]: (item: unknown) => boolean;\n  BASE: P;\n  ZERO: P;\n  /** Field for basic curve math */\n  Fp: IField<P_F<P>>;\n  /** Scalar field, for scalars in multiply and others */\n  Fn: IField<bigint>;\n  /** Creates point from x, y. Does NOT validate if the point is valid. Use `.assertValidity()`. */\n  fromAffine(p: AffinePoint<P_F<P>>): P;\n  fromBytes(bytes: Uint8Array): P;\n  fromHex(hex: Uint8Array | string): P;\n}\n\n// Type inference helpers: PC - PointConstructor, P - Point, Fp - Field element\n// Short names, because we use them a lot in result types:\n// * we can't do 'P = GetCurvePoint<PC>': this is default value and doesn't constrain anything\n// * we can't do 'type X = GetCurvePoint<PC>': it won't be accesible for arguments/return types\n// * `CurvePointCons<P extends CurvePoint<any, P>>` constraints from interface definition\n//   won't propagate, if `PC extends CurvePointCons<any>`: the P would be 'any', which is incorrect\n// * PC could be super specific with super specific P, which implements CurvePoint<any, P>.\n//   this means we need to do stuff like\n//   `function test<P extends CurvePoint<any, P>, PC extends CurvePointCons<P>>(`\n//   if we want type safety around P, otherwise PC_P<PC> will be any\n\n/** Returns Fp type from Point (P_F<P> == P.F) */\nexport type P_F<P extends CurvePoint<any, P>> = P extends CurvePoint<infer F, P> ? F : never;\n/** Returns Fp type from PointCons (PC_F<PC> == PC.P.F) */\nexport type PC_F<PC extends CurvePointCons<CurvePoint<any, any>>> = PC['Fp']['ZERO'];\n/** Returns Point type from PointCons (PC_P<PC> == PC.P) */\nexport type PC_P<PC extends CurvePointCons<CurvePoint<any, any>>> = PC['ZERO'];\n\n// Ugly hack to get proper type inference, because in typescript fails to infer resursively.\n// The hack allows to do up to 10 chained operations without applying type erasure.\n//\n// Types which won't work:\n// * `CurvePointCons<CurvePoint<any, any>>`, will return `any` after 1 operation\n// * `CurvePointCons<any>: WeierstrassPointCons<bigint> extends CurvePointCons<any> = false`\n// * `P extends CurvePoint, PC extends CurvePointCons<P>`\n//     * It can't infer P from PC alone\n//     * Too many relations between F, P & PC\n//     * It will infer P/F if `arg: CurvePointCons<F, P>`, but will fail if PC is generic\n//     * It will work correctly if there is an additional argument of type P\n//     * But generally, we don't want to parametrize `CurvePointCons` over `F`: it will complicate\n//       types, making them un-inferable\n// prettier-ignore\nexport type PC_ANY = CurvePointCons<\n  CurvePoint<any,\n  CurvePoint<any,\n  CurvePoint<any,\n  CurvePoint<any,\n  CurvePoint<any,\n  CurvePoint<any,\n  CurvePoint<any,\n  CurvePoint<any,\n  CurvePoint<any,\n  CurvePoint<any, any>\n  >>>>>>>>>\n>;\n\nexport interface CurveLengths {\n  secretKey?: number;\n  publicKey?: number;\n  publicKeyUncompressed?: number;\n  publicKeyHasPrefix?: boolean;\n  signature?: number;\n  seed?: number;\n}\nexport type GroupConstructor<T> = {\n  BASE: T;\n  ZERO: T;\n};\n/** @deprecated */\nexport type ExtendedGroupConstructor<T> = GroupConstructor<T> & {\n  Fp: IField<any>;\n  Fn: IField<bigint>;\n  fromAffine(ap: AffinePoint<any>): T;\n};\nexport type Mapper<T> = (i: T[]) => T[];\n\nexport function negateCt<T extends { negate: () => T }>(condition: boolean, item: T): T {\n  const neg = item.negate();\n  return condition ? neg : item;\n}\n\n/**\n * Takes a bunch of Projective Points but executes only one\n * inversion on all of them. Inversion is very slow operation,\n * so this improves performance massively.\n * Optimization: converts a list of projective points to a list of identical points with Z=1.\n */\nexport function normalizeZ<P extends CurvePoint<any, P>, PC extends CurvePointCons<P>>(\n  c: PC,\n  points: P[]\n): P[] {\n  const invertedZs = FpInvertBatch(\n    c.Fp,\n    points.map((p) => p.Z!)\n  );\n  return points.map((p, i) => c.fromAffine(p.toAffine(invertedZs[i])));\n}\n\nfunction validateW(W: number, bits: number) {\n  if (!Number.isSafeInteger(W) || W <= 0 || W > bits)\n    throw new Error('invalid window size, expected [1..' + bits + '], got W=' + W);\n}\n\n/** Internal wNAF opts for specific W and scalarBits */\nexport type WOpts = {\n  windows: number;\n  windowSize: number;\n  mask: bigint;\n  maxNumber: number;\n  shiftBy: bigint;\n};\n\nfunction calcWOpts(W: number, scalarBits: number): WOpts {\n  validateW(W, scalarBits);\n  const windows = Math.ceil(scalarBits / W) + 1; // W=8 33. Not 32, because we skip zero\n  const windowSize = 2 ** (W - 1); // W=8 128. Not 256, because we skip zero\n  const maxNumber = 2 ** W; // W=8 256\n  const mask = bitMask(W); // W=8 255 == mask 0b11111111\n  const shiftBy = BigInt(W); // W=8 8\n  return { windows, windowSize, mask, maxNumber, shiftBy };\n}\n\nfunction calcOffsets(n: bigint, window: number, wOpts: WOpts) {\n  const { windowSize, mask, maxNumber, shiftBy } = wOpts;\n  let wbits = Number(n & mask); // extract W bits.\n  let nextN = n >> shiftBy; // shift number by W bits.\n\n  // What actually happens here:\n  // const highestBit = Number(mask ^ (mask >> 1n));\n  // let wbits2 = wbits - 1; // skip zero\n  // if (wbits2 & highestBit) { wbits2 ^= Number(mask); // (~);\n\n  // split if bits > max: +224 => 256-32\n  if (wbits > windowSize) {\n    // we skip zero, which means instead of `>= size-1`, we do `> size`\n    wbits -= maxNumber; // -32, can be maxNumber - wbits, but then we need to set isNeg here.\n    nextN += _1n; // +256 (carry)\n  }\n  const offsetStart = window * windowSize;\n  const offset = offsetStart + Math.abs(wbits) - 1; // -1 because we skip zero\n  const isZero = wbits === 0; // is current window slice a 0?\n  const isNeg = wbits < 0; // is current window slice negative?\n  const isNegF = window % 2 !== 0; // fake random statement for noise\n  const offsetF = offsetStart; // fake offset for noise\n  return { nextN, offset, isZero, isNeg, isNegF, offsetF };\n}\n\nfunction validateMSMPoints(points: any[], c: any) {\n  if (!Array.isArray(points)) throw new Error('array expected');\n  points.forEach((p, i) => {\n    if (!(p instanceof c)) throw new Error('invalid point at index ' + i);\n  });\n}\nfunction validateMSMScalars(scalars: any[], field: any) {\n  if (!Array.isArray(scalars)) throw new Error('array of scalars expected');\n  scalars.forEach((s, i) => {\n    if (!field.isValid(s)) throw new Error('invalid scalar at index ' + i);\n  });\n}\n\n// Since points in different groups cannot be equal (different object constructor),\n// we can have single place to store precomputes.\n// Allows to make points frozen / immutable.\nconst pointPrecomputes = new WeakMap<any, any[]>();\nconst pointWindowSizes = new WeakMap<any, number>();\n\nfunction getW(P: any): number {\n  // To disable precomputes:\n  // return 1;\n  return pointWindowSizes.get(P) || 1;\n}\n\nfunction assert0(n: bigint): void {\n  if (n !== _0n) throw new Error('invalid wNAF');\n}\n\n/**\n * Elliptic curve multiplication of Point by scalar. Fragile.\n * Table generation takes **30MB of ram and 10ms on high-end CPU**,\n * but may take much longer on slow devices. Actual generation will happen on\n * first call of `multiply()`. By default, `BASE` point is precomputed.\n *\n * Scalars should always be less than curve order: this should be checked inside of a curve itself.\n * Creates precomputation tables for fast multiplication:\n * - private scalar is split by fixed size windows of W bits\n * - every window point is collected from window's table & added to accumulator\n * - since windows are different, same point inside tables won't be accessed more than once per calc\n * - each multiplication is 'Math.ceil(CURVE_ORDER / \uD835\uDC4A) + 1' point additions (fixed for any scalar)\n * - +1 window is neccessary for wNAF\n * - wNAF reduces table size: 2x less memory + 2x faster generation, but 10% slower multiplication\n *\n * @todo Research returning 2d JS array of windows, instead of a single window.\n * This would allow windows to be in different memory locations\n */\nexport class wNAF<PC extends PC_ANY> {\n  private readonly BASE: PC_P<PC>;\n  private readonly ZERO: PC_P<PC>;\n  private readonly Fn: PC['Fn'];\n  readonly bits: number;\n\n  // Parametrized with a given Point class (not individual point)\n  constructor(Point: PC, bits: number) {\n    this.BASE = Point.BASE;\n    this.ZERO = Point.ZERO;\n    this.Fn = Point.Fn;\n    this.bits = bits;\n  }\n\n  // non-const time multiplication ladder\n  _unsafeLadder(elm: PC_P<PC>, n: bigint, p: PC_P<PC> = this.ZERO): PC_P<PC> {\n    let d: PC_P<PC> = elm;\n    while (n > _0n) {\n      if (n & _1n) p = p.add(d);\n      d = d.double();\n      n >>= _1n;\n    }\n    return p;\n  }\n\n  /**\n   * Creates a wNAF precomputation window. Used for caching.\n   * Default window size is set by `utils.precompute()` and is equal to 8.\n   * Number of precomputed points depends on the curve size:\n   * 2^(\uD835\uDC4A\u22121) * (Math.ceil(\uD835\uDC5B / \uD835\uDC4A) + 1), where:\n   * - \uD835\uDC4A is the window size\n   * - \uD835\uDC5B is the bitlength of the curve order.\n   * For a 256-bit curve and window size 8, the number of precomputed points is 128 * 33 = 4224.\n   * @param point Point instance\n   * @param W window size\n   * @returns precomputed point tables flattened to a single array\n   */\n  private precomputeWindow(point: PC_P<PC>, W: number): PC_P<PC>[] {\n    const { windows, windowSize } = calcWOpts(W, this.bits);\n    const points: PC_P<PC>[] = [];\n    let p: PC_P<PC> = point;\n    let base = p;\n    for (let window = 0; window < windows; window++) {\n      base = p;\n      points.push(base);\n      // i=1, bc we skip 0\n      for (let i = 1; i < windowSize; i++) {\n        base = base.add(p);\n        points.push(base);\n      }\n      p = base.double();\n    }\n    return points;\n  }\n\n  /**\n   * Implements ec multiplication using precomputed tables and w-ary non-adjacent form.\n   * More compact implementation:\n   * https://github.com/paulmillr/noble-secp256k1/blob/47cb1669b6e506ad66b35fe7d76132ae97465da2/index.ts#L502-L541\n   * @returns real and fake (for const-time) points\n   */\n  private wNAF(W: number, precomputes: PC_P<PC>[], n: bigint): { p: PC_P<PC>; f: PC_P<PC> } {\n    // Scalar should be smaller than field order\n    if (!this.Fn.isValid(n)) throw new Error('invalid scalar');\n    // Accumulators\n    let p = this.ZERO;\n    let f = this.BASE;\n    // This code was first written with assumption that 'f' and 'p' will never be infinity point:\n    // since each addition is multiplied by 2 ** W, it cannot cancel each other. However,\n    // there is negate now: it is possible that negated element from low value\n    // would be the same as high element, which will create carry into next window.\n    // It's not obvious how this can fail, but still worth investigating later.\n    const wo = calcWOpts(W, this.bits);\n    for (let window = 0; window < wo.windows; window++) {\n      // (n === _0n) is handled and not early-exited. isEven and offsetF are used for noise\n      const { nextN, offset, isZero, isNeg, isNegF, offsetF } = calcOffsets(n, window, wo);\n      n = nextN;\n      if (isZero) {\n        // bits are 0: add garbage to fake point\n        // Important part for const-time getPublicKey: add random \"noise\" point to f.\n        f = f.add(negateCt(isNegF, precomputes[offsetF]));\n      } else {\n        // bits are 1: add to result point\n        p = p.add(negateCt(isNeg, precomputes[offset]));\n      }\n    }\n    assert0(n);\n    // Return both real and fake points: JIT won't eliminate f.\n    // At this point there is a way to F be infinity-point even if p is not,\n    // which makes it less const-time: around 1 bigint multiply.\n    return { p, f };\n  }\n\n  /**\n   * Implements ec unsafe (non const-time) multiplication using precomputed tables and w-ary non-adjacent form.\n   * @param acc accumulator point to add result of multiplication\n   * @returns point\n   */\n  private wNAFUnsafe(\n    W: number,\n    precomputes: PC_P<PC>[],\n    n: bigint,\n    acc: PC_P<PC> = this.ZERO\n  ): PC_P<PC> {\n    const wo = calcWOpts(W, this.bits);\n    for (let window = 0; window < wo.windows; window++) {\n      if (n === _0n) break; // Early-exit, skip 0 value\n      const { nextN, offset, isZero, isNeg } = calcOffsets(n, window, wo);\n      n = nextN;\n      if (isZero) {\n        // Window bits are 0: skip processing.\n        // Move to next window.\n        continue;\n      } else {\n        const item = precomputes[offset];\n        acc = acc.add(isNeg ? item.negate() : item); // Re-using acc allows to save adds in MSM\n      }\n    }\n    assert0(n);\n    return acc;\n  }\n\n  private getPrecomputes(W: number, point: PC_P<PC>, transform?: Mapper<PC_P<PC>>): PC_P<PC>[] {\n    // Calculate precomputes on a first run, reuse them after\n    let comp = pointPrecomputes.get(point);\n    if (!comp) {\n      comp = this.precomputeWindow(point, W) as PC_P<PC>[];\n      if (W !== 1) {\n        // Doing transform outside of if brings 15% perf hit\n        if (typeof transform === 'function') comp = transform(comp);\n        pointPrecomputes.set(point, comp);\n      }\n    }\n    return comp;\n  }\n\n  cached(\n    point: PC_P<PC>,\n    scalar: bigint,\n    transform?: Mapper<PC_P<PC>>\n  ): { p: PC_P<PC>; f: PC_P<PC> } {\n    const W = getW(point);\n    return this.wNAF(W, this.getPrecomputes(W, point, transform), scalar);\n  }\n\n  unsafe(point: PC_P<PC>, scalar: bigint, transform?: Mapper<PC_P<PC>>, prev?: PC_P<PC>): PC_P<PC> {\n    const W = getW(point);\n    if (W === 1) return this._unsafeLadder(point, scalar, prev); // For W=1 ladder is ~x2 faster\n    return this.wNAFUnsafe(W, this.getPrecomputes(W, point, transform), scalar, prev);\n  }\n\n  // We calculate precomputes for elliptic curve point multiplication\n  // using windowed method. This specifies window size and\n  // stores precomputed values. Usually only base point would be precomputed.\n  createCache(P: PC_P<PC>, W: number): void {\n    validateW(W, this.bits);\n    pointWindowSizes.set(P, W);\n    pointPrecomputes.delete(P);\n  }\n\n  hasCache(elm: PC_P<PC>): boolean {\n    return getW(elm) !== 1;\n  }\n}\n\n/**\n * Endomorphism-specific multiplication for Koblitz curves.\n * Cost: 128 dbl, 0-256 adds.\n */\nexport function mulEndoUnsafe<P extends CurvePoint<any, P>, PC extends CurvePointCons<P>>(\n  Point: PC,\n  point: P,\n  k1: bigint,\n  k2: bigint\n): { p1: P; p2: P } {\n  let acc = point;\n  let p1 = Point.ZERO;\n  let p2 = Point.ZERO;\n  while (k1 > _0n || k2 > _0n) {\n    if (k1 & _1n) p1 = p1.add(acc);\n    if (k2 & _1n) p2 = p2.add(acc);\n    acc = acc.double();\n    k1 >>= _1n;\n    k2 >>= _1n;\n  }\n  return { p1, p2 };\n}\n\n/**\n * Pippenger algorithm for multi-scalar multiplication (MSM, Pa + Qb + Rc + ...).\n * 30x faster vs naive addition on L=4096, 10x faster than precomputes.\n * For N=254bit, L=1, it does: 1024 ADD + 254 DBL. For L=5: 1536 ADD + 254 DBL.\n * Algorithmically constant-time (for same L), even when 1 point + scalar, or when scalar = 0.\n * @param c Curve Point constructor\n * @param fieldN field over CURVE.N - important that it's not over CURVE.P\n * @param points array of L curve points\n * @param scalars array of L scalars (aka secret keys / bigints)\n */\nexport function pippenger<P extends CurvePoint<any, P>, PC extends CurvePointCons<P>>(\n  c: PC,\n  fieldN: IField<bigint>,\n  points: P[],\n  scalars: bigint[]\n): P {\n  // If we split scalars by some window (let's say 8 bits), every chunk will only\n  // take 256 buckets even if there are 4096 scalars, also re-uses double.\n  // TODO:\n  // - https://eprint.iacr.org/2024/750.pdf\n  // - https://tches.iacr.org/index.php/TCHES/article/view/10287\n  // 0 is accepted in scalars\n  validateMSMPoints(points, c);\n  validateMSMScalars(scalars, fieldN);\n  const plength = points.length;\n  const slength = scalars.length;\n  if (plength !== slength) throw new Error('arrays of points and scalars must have equal length');\n  // if (plength === 0) throw new Error('array must be of length >= 2');\n  const zero = c.ZERO;\n  const wbits = bitLen(BigInt(plength));\n  let windowSize = 1; // bits\n  if (wbits > 12) windowSize = wbits - 3;\n  else if (wbits > 4) windowSize = wbits - 2;\n  else if (wbits > 0) windowSize = 2;\n  const MASK = bitMask(windowSize);\n  const buckets = new Array(Number(MASK) + 1).fill(zero); // +1 for zero array\n  const lastBits = Math.floor((fieldN.BITS - 1) / windowSize) * windowSize;\n  let sum = zero;\n  for (let i = lastBits; i >= 0; i -= windowSize) {\n    buckets.fill(zero);\n    for (let j = 0; j < slength; j++) {\n      const scalar = scalars[j];\n      const wbits = Number((scalar >> BigInt(i)) & MASK);\n      buckets[wbits] = buckets[wbits].add(points[j]);\n    }\n    let resI = zero; // not using this will do small speed-up, but will lose ct\n    // Skip first bucket, because it is zero\n    for (let j = buckets.length - 1, sumI = zero; j > 0; j--) {\n      sumI = sumI.add(buckets[j]);\n      resI = resI.add(sumI);\n    }\n    sum = sum.add(resI);\n    if (i !== 0) for (let j = 0; j < windowSize; j++) sum = sum.double();\n  }\n  return sum as P;\n}\n/**\n * Precomputed multi-scalar multiplication (MSM, Pa + Qb + Rc + ...).\n * @param c Curve Point constructor\n * @param fieldN field over CURVE.N - important that it's not over CURVE.P\n * @param points array of L curve points\n * @returns function which multiplies points with scaars\n */\nexport function precomputeMSMUnsafe<P extends CurvePoint<any, P>, PC extends CurvePointCons<P>>(\n  c: PC,\n  fieldN: IField<bigint>,\n  points: P[],\n  windowSize: number\n): (scalars: bigint[]) => P {\n  /**\n   * Performance Analysis of Window-based Precomputation\n   *\n   * Base Case (256-bit scalar, 8-bit window):\n   * - Standard precomputation requires:\n   *   - 31 additions per scalar \u00D7 256 scalars = 7,936 ops\n   *   - Plus 255 summary additions = 8,191 total ops\n   *   Note: Summary additions can be optimized via accumulator\n   *\n   * Chunked Precomputation Analysis:\n   * - Using 32 chunks requires:\n   *   - 255 additions per chunk\n   *   - 256 doublings\n   *   - Total: (255 \u00D7 32) + 256 = 8,416 ops\n   *\n   * Memory Usage Comparison:\n   * Window Size | Standard Points | Chunked Points\n   * ------------|-----------------|---------------\n   *     4-bit   |     520         |      15\n   *     8-bit   |    4,224        |     255\n   *    10-bit   |   13,824        |   1,023\n   *    16-bit   |  557,056        |  65,535\n   *\n   * Key Advantages:\n   * 1. Enables larger window sizes due to reduced memory overhead\n   * 2. More efficient for smaller scalar counts:\n   *    - 16 chunks: (16 \u00D7 255) + 256 = 4,336 ops\n   *    - ~2x faster than standard 8,191 ops\n   *\n   * Limitations:\n   * - Not suitable for plain precomputes (requires 256 constant doublings)\n   * - Performance degrades with larger scalar counts:\n   *   - Optimal for ~256 scalars\n   *   - Less efficient for 4096+ scalars (Pippenger preferred)\n   */\n  validateW(windowSize, fieldN.BITS);\n  validateMSMPoints(points, c);\n  const zero = c.ZERO;\n  const tableSize = 2 ** windowSize - 1; // table size (without zero)\n  const chunks = Math.ceil(fieldN.BITS / windowSize); // chunks of item\n  const MASK = bitMask(windowSize);\n  const tables = points.map((p: P) => {\n    const res = [];\n    for (let i = 0, acc = p; i < tableSize; i++) {\n      res.push(acc);\n      acc = acc.add(p);\n    }\n    return res;\n  });\n  return (scalars: bigint[]): P => {\n    validateMSMScalars(scalars, fieldN);\n    if (scalars.length > points.length)\n      throw new Error('array of scalars must be smaller than array of points');\n    let res = zero;\n    for (let i = 0; i < chunks; i++) {\n      // No need to double if accumulator is still zero.\n      if (res !== zero) for (let j = 0; j < windowSize; j++) res = res.double();\n      const shiftBy = BigInt(chunks * windowSize - (i + 1) * windowSize);\n      for (let j = 0; j < scalars.length; j++) {\n        const n = scalars[j];\n        const curr = Number((n >> shiftBy) & MASK);\n        if (!curr) continue; // skip zero scalars chunks\n        res = res.add(tables[j][curr - 1]);\n      }\n    }\n    return res;\n  };\n}\n\n// TODO: remove\n/**\n * Generic BasicCurve interface: works even for polynomial fields (BLS): P, n, h would be ok.\n * Though generator can be different (Fp2 / Fp6 for BLS).\n */\nexport type BasicCurve<T> = {\n  Fp: IField<T>; // Field over which we'll do calculations (Fp)\n  n: bigint; // Curve order, total count of valid points in the field\n  nBitLength?: number; // bit length of curve order\n  nByteLength?: number; // byte length of curve order\n  h: bigint; // cofactor. we can assign default=1, but users will just ignore it w/o validation\n  hEff?: bigint; // Number to multiply to clear cofactor\n  Gx: T; // base point X coordinate\n  Gy: T; // base point Y coordinate\n  allowInfinityPoint?: boolean; // bls12-381 requires it. ZERO point is valid, but invalid pubkey\n};\n\n// TODO: remove\n/** @deprecated */\nexport function validateBasic<FP, T>(\n  curve: BasicCurve<FP> & T\n): Readonly<\n  {\n    readonly nBitLength: number;\n    readonly nByteLength: number;\n  } & BasicCurve<FP> &\n    T & {\n      p: bigint;\n    }\n> {\n  validateField(curve.Fp);\n  validateObject(\n    curve,\n    {\n      n: 'bigint',\n      h: 'bigint',\n      Gx: 'field',\n      Gy: 'field',\n    },\n    {\n      nBitLength: 'isSafeInteger',\n      nByteLength: 'isSafeInteger',\n    }\n  );\n  // Set defaults\n  return Object.freeze({\n    ...nLength(curve.n, curve.nBitLength),\n    ...curve,\n    ...{ p: curve.Fp.ORDER },\n  } as const);\n}\n\nexport type ValidCurveParams<T> = {\n  p: bigint;\n  n: bigint;\n  h: bigint;\n  a: T;\n  b?: T;\n  d?: T;\n  Gx: T;\n  Gy: T;\n};\n\nfunction createField<T>(order: bigint, field?: IField<T>, isLE?: boolean): IField<T> {\n  if (field) {\n    if (field.ORDER !== order) throw new Error('Field.ORDER must match order: Fp == p, Fn == n');\n    validateField(field);\n    return field;\n  } else {\n    return Field(order, { isLE }) as unknown as IField<T>;\n  }\n}\nexport type FpFn<T> = { Fp: IField<T>; Fn: IField<bigint> };\n\n/** Validates CURVE opts and creates fields */\nexport function _createCurveFields<T>(\n  type: 'weierstrass' | 'edwards',\n  CURVE: ValidCurveParams<T>,\n  curveOpts: Partial<FpFn<T>> = {},\n  FpFnLE?: boolean\n): FpFn<T> & { CURVE: ValidCurveParams<T> } {\n  if (FpFnLE === undefined) FpFnLE = type === 'edwards';\n  if (!CURVE || typeof CURVE !== 'object') throw new Error(`expected valid ${type} CURVE object`);\n  for (const p of ['p', 'n', 'h'] as const) {\n    const val = CURVE[p];\n    if (!(typeof val === 'bigint' && val > _0n))\n      throw new Error(`CURVE.${p} must be positive bigint`);\n  }\n  const Fp = createField(CURVE.p, curveOpts.Fp, FpFnLE);\n  const Fn = createField(CURVE.n, curveOpts.Fn, FpFnLE);\n  const _b: 'b' | 'd' = type === 'weierstrass' ? 'b' : 'd';\n  const params = ['Gx', 'Gy', 'a', _b] as const;\n  for (const p of params) {\n    // @ts-ignore\n    if (!Fp.isValid(CURVE[p]))\n      throw new Error(`CURVE.${p} must be valid field element of CURVE.Fp`);\n  }\n  CURVE = Object.freeze(Object.assign({}, CURVE));\n  return { CURVE, Fp, Fn };\n}\n", "/**\n * Twisted Edwards curve. The formula is: ax\u00B2 + y\u00B2 = 1 + dx\u00B2y\u00B2.\n * For design rationale of types / exports, see weierstrass module documentation.\n * Untwisted Edwards curves exist, but they aren't used in real-world protocols.\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport {\n  _validateObject,\n  _abool2 as abool,\n  _abytes2 as abytes,\n  aInRange,\n  bytesToHex,\n  bytesToNumberLE,\n  concatBytes,\n  copyBytes,\n  ensureBytes,\n  isBytes,\n  memoized,\n  notImplemented,\n  randomBytes as randomBytesWeb,\n  type FHash,\n  type Hex,\n} from '../utils.ts';\nimport {\n  _createCurveFields,\n  normalizeZ,\n  pippenger,\n  wNAF,\n  type AffinePoint,\n  type BasicCurve,\n  type CurveLengths,\n  type CurvePoint,\n  type CurvePointCons,\n} from './curve.ts';\nimport { Field, type IField, type NLength } from './modular.ts';\n\n// Be friendly to bad ECMAScript parsers by not using bigint literals\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _8n = BigInt(8);\n\nexport type UVRatio = (u: bigint, v: bigint) => { isValid: boolean; value: bigint };\n\n/** Instance of Extended Point with coordinates in X, Y, Z, T. */\nexport interface EdwardsPoint extends CurvePoint<bigint, EdwardsPoint> {\n  /** extended X coordinate. Different from affine x. */\n  readonly X: bigint;\n  /** extended Y coordinate. Different from affine y. */\n  readonly Y: bigint;\n  /** extended Z coordinate */\n  readonly Z: bigint;\n  /** extended T coordinate */\n  readonly T: bigint;\n\n  /** @deprecated use `toBytes` */\n  toRawBytes(): Uint8Array;\n  /** @deprecated use `p.precompute(windowSize)` */\n  _setWindowSize(windowSize: number): void;\n  /** @deprecated use .X */\n  readonly ex: bigint;\n  /** @deprecated use .Y */\n  readonly ey: bigint;\n  /** @deprecated use .Z */\n  readonly ez: bigint;\n  /** @deprecated use .T */\n  readonly et: bigint;\n}\n/** Static methods of Extended Point with coordinates in X, Y, Z, T. */\nexport interface EdwardsPointCons extends CurvePointCons<EdwardsPoint> {\n  new (X: bigint, Y: bigint, Z: bigint, T: bigint): EdwardsPoint;\n  CURVE(): EdwardsOpts;\n  fromBytes(bytes: Uint8Array, zip215?: boolean): EdwardsPoint;\n  fromHex(hex: Hex, zip215?: boolean): EdwardsPoint;\n  /** @deprecated use `import { pippenger } from '@noble/curves/abstract/curve.js';` */\n  msm(points: EdwardsPoint[], scalars: bigint[]): EdwardsPoint;\n}\n/** @deprecated use EdwardsPoint */\nexport type ExtPointType = EdwardsPoint;\n/** @deprecated use EdwardsPointCons */\nexport type ExtPointConstructor = EdwardsPointCons;\n\n/**\n * Twisted Edwards curve options.\n *\n * * a: formula param\n * * d: formula param\n * * p: prime characteristic (order) of finite field, in which arithmetics is done\n * * n: order of prime subgroup a.k.a total amount of valid curve points\n * * h: cofactor. h*n is group order; n is subgroup order\n * * Gx: x coordinate of generator point a.k.a. base point\n * * Gy: y coordinate of generator point\n */\nexport type EdwardsOpts = Readonly<{\n  p: bigint;\n  n: bigint;\n  h: bigint;\n  a: bigint;\n  d: bigint;\n  Gx: bigint;\n  Gy: bigint;\n}>;\n\n/**\n * Extra curve options for Twisted Edwards.\n *\n * * Fp: redefined Field over curve.p\n * * Fn: redefined Field over curve.n\n * * uvRatio: helper function for decompression, calculating \u221A(u/v)\n */\nexport type EdwardsExtraOpts = Partial<{\n  Fp: IField<bigint>;\n  Fn: IField<bigint>;\n  FpFnLE: boolean;\n  uvRatio: (u: bigint, v: bigint) => { isValid: boolean; value: bigint };\n}>;\n\n/**\n * EdDSA (Edwards Digital Signature algorithm) options.\n *\n * * hash: hash function used to hash secret keys and messages\n * * adjustScalarBytes: clears bits to get valid field element\n * * domain: Used for hashing\n * * mapToCurve: for hash-to-curve standard\n * * prehash: RFC 8032 pre-hashing of messages to sign() / verify()\n * * randomBytes: function generating random bytes, used for randomSecretKey\n */\nexport type EdDSAOpts = Partial<{\n  adjustScalarBytes: (bytes: Uint8Array) => Uint8Array;\n  domain: (data: Uint8Array, ctx: Uint8Array, phflag: boolean) => Uint8Array;\n  mapToCurve: (scalar: bigint[]) => AffinePoint<bigint>;\n  prehash: FHash;\n  randomBytes: (bytesLength?: number) => Uint8Array;\n}>;\n\n/**\n * EdDSA (Edwards Digital Signature algorithm) interface.\n *\n * Allows to create and verify signatures, create public and secret keys.\n */\nexport interface EdDSA {\n  keygen: (seed?: Uint8Array) => { secretKey: Uint8Array; publicKey: Uint8Array };\n  getPublicKey: (secretKey: Hex) => Uint8Array;\n  sign: (message: Hex, secretKey: Hex, options?: { context?: Hex }) => Uint8Array;\n  verify: (\n    sig: Hex,\n    message: Hex,\n    publicKey: Hex,\n    options?: { context?: Hex; zip215: boolean }\n  ) => boolean;\n  Point: EdwardsPointCons;\n  utils: {\n    randomSecretKey: (seed?: Uint8Array) => Uint8Array;\n    isValidSecretKey: (secretKey: Uint8Array) => boolean;\n    isValidPublicKey: (publicKey: Uint8Array, zip215?: boolean) => boolean;\n\n    /**\n     * Converts ed public key to x public key.\n     *\n     * There is NO `fromMontgomery`:\n     * - There are 2 valid ed25519 points for every x25519, with flipped coordinate\n     * - Sometimes there are 0 valid ed25519 points, because x25519 *additionally*\n     *   accepts inputs on the quadratic twist, which can't be moved to ed25519\n     *\n     * @example\n     * ```js\n     * const someonesPub = ed25519.getPublicKey(ed25519.utils.randomSecretKey());\n     * const aPriv = x25519.utils.randomSecretKey();\n     * x25519.getSharedSecret(aPriv, ed25519.utils.toMontgomery(someonesPub))\n     * ```\n     */\n    toMontgomery: (publicKey: Uint8Array) => Uint8Array;\n    /**\n     * Converts ed secret key to x secret key.\n     * @example\n     * ```js\n     * const someonesPub = x25519.getPublicKey(x25519.utils.randomSecretKey());\n     * const aPriv = ed25519.utils.randomSecretKey();\n     * x25519.getSharedSecret(ed25519.utils.toMontgomerySecret(aPriv), someonesPub)\n     * ```\n     */\n    toMontgomerySecret: (privateKey: Uint8Array) => Uint8Array;\n    getExtendedPublicKey: (key: Hex) => {\n      head: Uint8Array;\n      prefix: Uint8Array;\n      scalar: bigint;\n      point: EdwardsPoint;\n      pointBytes: Uint8Array;\n    };\n\n    /** @deprecated use `randomSecretKey` */\n    randomPrivateKey: (seed?: Uint8Array) => Uint8Array;\n    /** @deprecated use `point.precompute()` */\n    precompute: (windowSize?: number, point?: EdwardsPoint) => EdwardsPoint;\n  };\n  lengths: CurveLengths;\n}\n\nfunction isEdValidXY(Fp: IField<bigint>, CURVE: EdwardsOpts, x: bigint, y: bigint): boolean {\n  const x2 = Fp.sqr(x);\n  const y2 = Fp.sqr(y);\n  const left = Fp.add(Fp.mul(CURVE.a, x2), y2);\n  const right = Fp.add(Fp.ONE, Fp.mul(CURVE.d, Fp.mul(x2, y2)));\n  return Fp.eql(left, right);\n}\n\nexport function edwards(params: EdwardsOpts, extraOpts: EdwardsExtraOpts = {}): EdwardsPointCons {\n  const validated = _createCurveFields('edwards', params, extraOpts, extraOpts.FpFnLE);\n  const { Fp, Fn } = validated;\n  let CURVE = validated.CURVE as EdwardsOpts;\n  const { h: cofactor } = CURVE;\n  _validateObject(extraOpts, {}, { uvRatio: 'function' });\n\n  // Important:\n  // There are some places where Fp.BYTES is used instead of nByteLength.\n  // So far, everything has been tested with curves of Fp.BYTES == nByteLength.\n  // TODO: test and find curves which behave otherwise.\n  const MASK = _2n << (BigInt(Fn.BYTES * 8) - _1n);\n  const modP = (n: bigint) => Fp.create(n); // Function overrides\n\n  // sqrt(u/v)\n  const uvRatio =\n    extraOpts.uvRatio ||\n    ((u: bigint, v: bigint) => {\n      try {\n        return { isValid: true, value: Fp.sqrt(Fp.div(u, v)) };\n      } catch (e) {\n        return { isValid: false, value: _0n };\n      }\n    });\n\n  // Validate whether the passed curve params are valid.\n  // equation ax\u00B2 + y\u00B2 = 1 + dx\u00B2y\u00B2 should work for generator point.\n  if (!isEdValidXY(Fp, CURVE, CURVE.Gx, CURVE.Gy))\n    throw new Error('bad curve params: generator point');\n\n  /**\n   * Asserts coordinate is valid: 0 <= n < MASK.\n   * Coordinates >= Fp.ORDER are allowed for zip215.\n   */\n  function acoord(title: string, n: bigint, banZero = false) {\n    const min = banZero ? _1n : _0n;\n    aInRange('coordinate ' + title, n, min, MASK);\n    return n;\n  }\n\n  function aextpoint(other: unknown) {\n    if (!(other instanceof Point)) throw new Error('ExtendedPoint expected');\n  }\n  // Converts Extended point to default (x, y) coordinates.\n  // Can accept precomputed Z^-1 - for example, from invertBatch.\n  const toAffineMemo = memoized((p: Point, iz?: bigint): AffinePoint<bigint> => {\n    const { X, Y, Z } = p;\n    const is0 = p.is0();\n    if (iz == null) iz = is0 ? _8n : (Fp.inv(Z) as bigint); // 8 was chosen arbitrarily\n    const x = modP(X * iz);\n    const y = modP(Y * iz);\n    const zz = Fp.mul(Z, iz);\n    if (is0) return { x: _0n, y: _1n };\n    if (zz !== _1n) throw new Error('invZ was invalid');\n    return { x, y };\n  });\n  const assertValidMemo = memoized((p: Point) => {\n    const { a, d } = CURVE;\n    if (p.is0()) throw new Error('bad point: ZERO'); // TODO: optimize, with vars below?\n    // Equation in affine coordinates: ax\u00B2 + y\u00B2 = 1 + dx\u00B2y\u00B2\n    // Equation in projective coordinates (X/Z, Y/Z, Z):  (aX\u00B2 + Y\u00B2)Z\u00B2 = Z\u2074 + dX\u00B2Y\u00B2\n    const { X, Y, Z, T } = p;\n    const X2 = modP(X * X); // X\u00B2\n    const Y2 = modP(Y * Y); // Y\u00B2\n    const Z2 = modP(Z * Z); // Z\u00B2\n    const Z4 = modP(Z2 * Z2); // Z\u2074\n    const aX2 = modP(X2 * a); // aX\u00B2\n    const left = modP(Z2 * modP(aX2 + Y2)); // (aX\u00B2 + Y\u00B2)Z\u00B2\n    const right = modP(Z4 + modP(d * modP(X2 * Y2))); // Z\u2074 + dX\u00B2Y\u00B2\n    if (left !== right) throw new Error('bad point: equation left != right (1)');\n    // In Extended coordinates we also have T, which is x*y=T/Z: check X*Y == Z*T\n    const XY = modP(X * Y);\n    const ZT = modP(Z * T);\n    if (XY !== ZT) throw new Error('bad point: equation left != right (2)');\n    return true;\n  });\n\n  // Extended Point works in extended coordinates: (X, Y, Z, T) \u220B (x=X/Z, y=Y/Z, T=xy).\n  // https://en.wikipedia.org/wiki/Twisted_Edwards_curve#Extended_coordinates\n  class Point implements EdwardsPoint {\n    // base / generator point\n    static readonly BASE = new Point(CURVE.Gx, CURVE.Gy, _1n, modP(CURVE.Gx * CURVE.Gy));\n    // zero / infinity / identity point\n    static readonly ZERO = new Point(_0n, _1n, _1n, _0n); // 0, 1, 1, 0\n    // math field\n    static readonly Fp = Fp;\n    // scalar field\n    static readonly Fn = Fn;\n\n    readonly X: bigint;\n    readonly Y: bigint;\n    readonly Z: bigint;\n    readonly T: bigint;\n\n    constructor(X: bigint, Y: bigint, Z: bigint, T: bigint) {\n      this.X = acoord('x', X);\n      this.Y = acoord('y', Y);\n      this.Z = acoord('z', Z, true);\n      this.T = acoord('t', T);\n      Object.freeze(this);\n    }\n\n    static CURVE(): EdwardsOpts {\n      return CURVE;\n    }\n\n    static fromAffine(p: AffinePoint<bigint>): Point {\n      if (p instanceof Point) throw new Error('extended point not allowed');\n      const { x, y } = p || {};\n      acoord('x', x);\n      acoord('y', y);\n      return new Point(x, y, _1n, modP(x * y));\n    }\n\n    // Uses algo from RFC8032 5.1.3.\n    static fromBytes(bytes: Uint8Array, zip215 = false): Point {\n      const len = Fp.BYTES;\n      const { a, d } = CURVE;\n      bytes = copyBytes(abytes(bytes, len, 'point'));\n      abool(zip215, 'zip215');\n      const normed = copyBytes(bytes); // copy again, we'll manipulate it\n      const lastByte = bytes[len - 1]; // select last byte\n      normed[len - 1] = lastByte & ~0x80; // clear last bit\n      const y = bytesToNumberLE(normed);\n\n      // zip215=true is good for consensus-critical apps. =false follows RFC8032 / NIST186-5.\n      // RFC8032 prohibits >= p, but ZIP215 doesn't\n      // zip215=true:  0 <= y < MASK (2^256 for ed25519)\n      // zip215=false: 0 <= y < P (2^255-19 for ed25519)\n      const max = zip215 ? MASK : Fp.ORDER;\n      aInRange('point.y', y, _0n, max);\n\n      // Ed25519: x\u00B2 = (y\u00B2-1)/(dy\u00B2+1) mod p. Ed448: x\u00B2 = (y\u00B2-1)/(dy\u00B2-1) mod p. Generic case:\n      // ax\u00B2+y\u00B2=1+dx\u00B2y\u00B2 => y\u00B2-1=dx\u00B2y\u00B2-ax\u00B2 => y\u00B2-1=x\u00B2(dy\u00B2-a) => x\u00B2=(y\u00B2-1)/(dy\u00B2-a)\n      const y2 = modP(y * y); // denominator is always non-0 mod p.\n      const u = modP(y2 - _1n); // u = y\u00B2 - 1\n      const v = modP(d * y2 - a); // v = d y\u00B2 + 1.\n      let { isValid, value: x } = uvRatio(u, v); // \u221A(u/v)\n      if (!isValid) throw new Error('bad point: invalid y coordinate');\n      const isXOdd = (x & _1n) === _1n; // There are 2 square roots. Use x_0 bit to select proper\n      const isLastByteOdd = (lastByte & 0x80) !== 0; // x_0, last bit\n      if (!zip215 && x === _0n && isLastByteOdd)\n        // if x=0 and x_0 = 1, fail\n        throw new Error('bad point: x=0 and x_0=1');\n      if (isLastByteOdd !== isXOdd) x = modP(-x); // if x_0 != x mod 2, set x = p-x\n      return Point.fromAffine({ x, y });\n    }\n    static fromHex(bytes: Uint8Array, zip215 = false): Point {\n      return Point.fromBytes(ensureBytes('point', bytes), zip215);\n    }\n\n    get x(): bigint {\n      return this.toAffine().x;\n    }\n    get y(): bigint {\n      return this.toAffine().y;\n    }\n\n    precompute(windowSize: number = 8, isLazy = true) {\n      wnaf.createCache(this, windowSize);\n      if (!isLazy) this.multiply(_2n); // random number\n      return this;\n    }\n\n    // Useful in fromAffine() - not for fromBytes(), which always created valid points.\n    assertValidity(): void {\n      assertValidMemo(this);\n    }\n\n    // Compare one point to another.\n    equals(other: Point): boolean {\n      aextpoint(other);\n      const { X: X1, Y: Y1, Z: Z1 } = this;\n      const { X: X2, Y: Y2, Z: Z2 } = other;\n      const X1Z2 = modP(X1 * Z2);\n      const X2Z1 = modP(X2 * Z1);\n      const Y1Z2 = modP(Y1 * Z2);\n      const Y2Z1 = modP(Y2 * Z1);\n      return X1Z2 === X2Z1 && Y1Z2 === Y2Z1;\n    }\n\n    is0(): boolean {\n      return this.equals(Point.ZERO);\n    }\n\n    negate(): Point {\n      // Flips point sign to a negative one (-x, y in affine coords)\n      return new Point(modP(-this.X), this.Y, this.Z, modP(-this.T));\n    }\n\n    // Fast algo for doubling Extended Point.\n    // https://hyperelliptic.org/EFD/g1p/auto-twisted-extended.html#doubling-dbl-2008-hwcd\n    // Cost: 4M + 4S + 1*a + 6add + 1*2.\n    double(): Point {\n      const { a } = CURVE;\n      const { X: X1, Y: Y1, Z: Z1 } = this;\n      const A = modP(X1 * X1); // A = X12\n      const B = modP(Y1 * Y1); // B = Y12\n      const C = modP(_2n * modP(Z1 * Z1)); // C = 2*Z12\n      const D = modP(a * A); // D = a*A\n      const x1y1 = X1 + Y1;\n      const E = modP(modP(x1y1 * x1y1) - A - B); // E = (X1+Y1)2-A-B\n      const G = D + B; // G = D+B\n      const F = G - C; // F = G-C\n      const H = D - B; // H = D-B\n      const X3 = modP(E * F); // X3 = E*F\n      const Y3 = modP(G * H); // Y3 = G*H\n      const T3 = modP(E * H); // T3 = E*H\n      const Z3 = modP(F * G); // Z3 = F*G\n      return new Point(X3, Y3, Z3, T3);\n    }\n\n    // Fast algo for adding 2 Extended Points.\n    // https://hyperelliptic.org/EFD/g1p/auto-twisted-extended.html#addition-add-2008-hwcd\n    // Cost: 9M + 1*a + 1*d + 7add.\n    add(other: Point) {\n      aextpoint(other);\n      const { a, d } = CURVE;\n      const { X: X1, Y: Y1, Z: Z1, T: T1 } = this;\n      const { X: X2, Y: Y2, Z: Z2, T: T2 } = other;\n      const A = modP(X1 * X2); // A = X1*X2\n      const B = modP(Y1 * Y2); // B = Y1*Y2\n      const C = modP(T1 * d * T2); // C = T1*d*T2\n      const D = modP(Z1 * Z2); // D = Z1*Z2\n      const E = modP((X1 + Y1) * (X2 + Y2) - A - B); // E = (X1+Y1)*(X2+Y2)-A-B\n      const F = D - C; // F = D-C\n      const G = D + C; // G = D+C\n      const H = modP(B - a * A); // H = B-a*A\n      const X3 = modP(E * F); // X3 = E*F\n      const Y3 = modP(G * H); // Y3 = G*H\n      const T3 = modP(E * H); // T3 = E*H\n      const Z3 = modP(F * G); // Z3 = F*G\n      return new Point(X3, Y3, Z3, T3);\n    }\n\n    subtract(other: Point): Point {\n      return this.add(other.negate());\n    }\n\n    // Constant-time multiplication.\n    multiply(scalar: bigint): Point {\n      // 1 <= scalar < L\n      if (!Fn.isValidNot0(scalar)) throw new Error('invalid scalar: expected 1 <= sc < curve.n');\n      const { p, f } = wnaf.cached(this, scalar, (p) => normalizeZ(Point, p));\n      return normalizeZ(Point, [p, f])[0];\n    }\n\n    // Non-constant-time multiplication. Uses double-and-add algorithm.\n    // It's faster, but should only be used when you don't care about\n    // an exposed private key e.g. sig verification.\n    // Does NOT allow scalars higher than CURVE.n.\n    // Accepts optional accumulator to merge with multiply (important for sparse scalars)\n    multiplyUnsafe(scalar: bigint, acc = Point.ZERO): Point {\n      // 0 <= scalar < L\n      if (!Fn.isValid(scalar)) throw new Error('invalid scalar: expected 0 <= sc < curve.n');\n      if (scalar === _0n) return Point.ZERO;\n      if (this.is0() || scalar === _1n) return this;\n      return wnaf.unsafe(this, scalar, (p) => normalizeZ(Point, p), acc);\n    }\n\n    // Checks if point is of small order.\n    // If you add something to small order point, you will have \"dirty\"\n    // point with torsion component.\n    // Multiplies point by cofactor and checks if the result is 0.\n    isSmallOrder(): boolean {\n      return this.multiplyUnsafe(cofactor).is0();\n    }\n\n    // Multiplies point by curve order and checks if the result is 0.\n    // Returns `false` is the point is dirty.\n    isTorsionFree(): boolean {\n      return wnaf.unsafe(this, CURVE.n).is0();\n    }\n\n    // Converts Extended point to default (x, y) coordinates.\n    // Can accept precomputed Z^-1 - for example, from invertBatch.\n    toAffine(invertedZ?: bigint): AffinePoint<bigint> {\n      return toAffineMemo(this, invertedZ);\n    }\n\n    clearCofactor(): Point {\n      if (cofactor === _1n) return this;\n      return this.multiplyUnsafe(cofactor);\n    }\n\n    toBytes(): Uint8Array {\n      const { x, y } = this.toAffine();\n      // Fp.toBytes() allows non-canonical encoding of y (>= p).\n      const bytes = Fp.toBytes(y);\n      // Each y has 2 valid points: (x, y), (x,-y).\n      // When compressing, it's enough to store y and use the last byte to encode sign of x\n      bytes[bytes.length - 1] |= x & _1n ? 0x80 : 0;\n      return bytes;\n    }\n    toHex(): string {\n      return bytesToHex(this.toBytes());\n    }\n\n    toString() {\n      return `<Point ${this.is0() ? 'ZERO' : this.toHex()}>`;\n    }\n\n    // TODO: remove\n    get ex(): bigint {\n      return this.X;\n    }\n    get ey(): bigint {\n      return this.Y;\n    }\n    get ez(): bigint {\n      return this.Z;\n    }\n    get et(): bigint {\n      return this.T;\n    }\n    static normalizeZ(points: Point[]): Point[] {\n      return normalizeZ(Point, points);\n    }\n    static msm(points: Point[], scalars: bigint[]): Point {\n      return pippenger(Point, Fn, points, scalars);\n    }\n    _setWindowSize(windowSize: number) {\n      this.precompute(windowSize);\n    }\n    toRawBytes(): Uint8Array {\n      return this.toBytes();\n    }\n  }\n  const wnaf = new wNAF(Point, Fn.BITS);\n  Point.BASE.precompute(8); // Enable precomputes. Slows down first publicKey computation by 20ms.\n  return Point;\n}\n\n/**\n * Base class for prime-order points like Ristretto255 and Decaf448.\n * These points eliminate cofactor issues by representing equivalence classes\n * of Edwards curve points.\n */\nexport abstract class PrimeEdwardsPoint<T extends PrimeEdwardsPoint<T>>\n  implements CurvePoint<bigint, T>\n{\n  static BASE: PrimeEdwardsPoint<any>;\n  static ZERO: PrimeEdwardsPoint<any>;\n  static Fp: IField<bigint>;\n  static Fn: IField<bigint>;\n\n  protected readonly ep: EdwardsPoint;\n\n  constructor(ep: EdwardsPoint) {\n    this.ep = ep;\n  }\n\n  // Abstract methods that must be implemented by subclasses\n  abstract toBytes(): Uint8Array;\n  abstract equals(other: T): boolean;\n\n  // Static methods that must be implemented by subclasses\n  static fromBytes(_bytes: Uint8Array): any {\n    notImplemented();\n  }\n\n  static fromHex(_hex: Hex): any {\n    notImplemented();\n  }\n\n  get x(): bigint {\n    return this.toAffine().x;\n  }\n  get y(): bigint {\n    return this.toAffine().y;\n  }\n\n  // Common implementations\n  clearCofactor(): T {\n    // no-op for prime-order groups\n    return this as any;\n  }\n\n  assertValidity(): void {\n    this.ep.assertValidity();\n  }\n\n  toAffine(invertedZ?: bigint): AffinePoint<bigint> {\n    return this.ep.toAffine(invertedZ);\n  }\n\n  toHex(): string {\n    return bytesToHex(this.toBytes());\n  }\n\n  toString(): string {\n    return this.toHex();\n  }\n\n  isTorsionFree(): boolean {\n    return true;\n  }\n\n  isSmallOrder(): boolean {\n    return false;\n  }\n\n  add(other: T): T {\n    this.assertSame(other);\n    return this.init(this.ep.add(other.ep));\n  }\n\n  subtract(other: T): T {\n    this.assertSame(other);\n    return this.init(this.ep.subtract(other.ep));\n  }\n\n  multiply(scalar: bigint): T {\n    return this.init(this.ep.multiply(scalar));\n  }\n\n  multiplyUnsafe(scalar: bigint): T {\n    return this.init(this.ep.multiplyUnsafe(scalar));\n  }\n\n  double(): T {\n    return this.init(this.ep.double());\n  }\n\n  negate(): T {\n    return this.init(this.ep.negate());\n  }\n\n  precompute(windowSize?: number, isLazy?: boolean): T {\n    return this.init(this.ep.precompute(windowSize, isLazy));\n  }\n\n  // Helper methods\n  abstract is0(): boolean;\n  protected abstract assertSame(other: T): void;\n  protected abstract init(ep: EdwardsPoint): T;\n\n  /** @deprecated use `toBytes` */\n  toRawBytes(): Uint8Array {\n    return this.toBytes();\n  }\n}\n\n/**\n * Initializes EdDSA signatures over given Edwards curve.\n */\nexport function eddsa(Point: EdwardsPointCons, cHash: FHash, eddsaOpts: EdDSAOpts = {}): EdDSA {\n  if (typeof cHash !== 'function') throw new Error('\"hash\" function param is required');\n  _validateObject(\n    eddsaOpts,\n    {},\n    {\n      adjustScalarBytes: 'function',\n      randomBytes: 'function',\n      domain: 'function',\n      prehash: 'function',\n      mapToCurve: 'function',\n    }\n  );\n\n  const { prehash } = eddsaOpts;\n  const { BASE, Fp, Fn } = Point;\n\n  const randomBytes = eddsaOpts.randomBytes || randomBytesWeb;\n  const adjustScalarBytes = eddsaOpts.adjustScalarBytes || ((bytes: Uint8Array) => bytes);\n  const domain =\n    eddsaOpts.domain ||\n    ((data: Uint8Array, ctx: Uint8Array, phflag: boolean) => {\n      abool(phflag, 'phflag');\n      if (ctx.length || phflag) throw new Error('Contexts/pre-hash are not supported');\n      return data;\n    }); // NOOP\n\n  // Little-endian SHA512 with modulo n\n  function modN_LE(hash: Uint8Array): bigint {\n    return Fn.create(bytesToNumberLE(hash)); // Not Fn.fromBytes: it has length limit\n  }\n\n  // Get the hashed private scalar per RFC8032 5.1.5\n  function getPrivateScalar(key: Hex) {\n    const len = lengths.secretKey;\n    key = ensureBytes('private key', key, len);\n    // Hash private key with curve's hash function to produce uniformingly random input\n    // Check byte lengths: ensure(64, h(ensure(32, key)))\n    const hashed = ensureBytes('hashed private key', cHash(key), 2 * len);\n    const head = adjustScalarBytes(hashed.slice(0, len)); // clear first half bits, produce FE\n    const prefix = hashed.slice(len, 2 * len); // second half is called key prefix (5.1.6)\n    const scalar = modN_LE(head); // The actual private scalar\n    return { head, prefix, scalar };\n  }\n\n  /** Convenience method that creates public key from scalar. RFC8032 5.1.5 */\n  function getExtendedPublicKey(secretKey: Hex) {\n    const { head, prefix, scalar } = getPrivateScalar(secretKey);\n    const point = BASE.multiply(scalar); // Point on Edwards curve aka public key\n    const pointBytes = point.toBytes();\n    return { head, prefix, scalar, point, pointBytes };\n  }\n\n  /** Calculates EdDSA pub key. RFC8032 5.1.5. */\n  function getPublicKey(secretKey: Hex): Uint8Array {\n    return getExtendedPublicKey(secretKey).pointBytes;\n  }\n\n  // int('LE', SHA512(dom2(F, C) || msgs)) mod N\n  function hashDomainToScalar(context: Hex = Uint8Array.of(), ...msgs: Uint8Array[]) {\n    const msg = concatBytes(...msgs);\n    return modN_LE(cHash(domain(msg, ensureBytes('context', context), !!prehash)));\n  }\n\n  /** Signs message with privateKey. RFC8032 5.1.6 */\n  function sign(msg: Hex, secretKey: Hex, options: { context?: Hex } = {}): Uint8Array {\n    msg = ensureBytes('message', msg);\n    if (prehash) msg = prehash(msg); // for ed25519ph etc.\n    const { prefix, scalar, pointBytes } = getExtendedPublicKey(secretKey);\n    const r = hashDomainToScalar(options.context, prefix, msg); // r = dom2(F, C) || prefix || PH(M)\n    const R = BASE.multiply(r).toBytes(); // R = rG\n    const k = hashDomainToScalar(options.context, R, pointBytes, msg); // R || A || PH(M)\n    const s = Fn.create(r + k * scalar); // S = (r + k * s) mod L\n    if (!Fn.isValid(s)) throw new Error('sign failed: invalid s'); // 0 <= s < L\n    const rs = concatBytes(R, Fn.toBytes(s));\n    return abytes(rs, lengths.signature, 'result');\n  }\n\n  // verification rule is either zip215 or rfc8032 / nist186-5. Consult fromHex:\n  const verifyOpts: { context?: Hex; zip215?: boolean } = { zip215: true };\n\n  /**\n   * Verifies EdDSA signature against message and public key. RFC8032 5.1.7.\n   * An extended group equation is checked.\n   */\n  function verify(sig: Hex, msg: Hex, publicKey: Hex, options = verifyOpts): boolean {\n    const { context, zip215 } = options;\n    const len = lengths.signature;\n    sig = ensureBytes('signature', sig, len);\n    msg = ensureBytes('message', msg);\n    publicKey = ensureBytes('publicKey', publicKey, lengths.publicKey);\n    if (zip215 !== undefined) abool(zip215, 'zip215');\n    if (prehash) msg = prehash(msg); // for ed25519ph, etc\n\n    const mid = len / 2;\n    const r = sig.subarray(0, mid);\n    const s = bytesToNumberLE(sig.subarray(mid, len));\n    let A, R, SB;\n    try {\n      // zip215=true is good for consensus-critical apps. =false follows RFC8032 / NIST186-5.\n      // zip215=true:  0 <= y < MASK (2^256 for ed25519)\n      // zip215=false: 0 <= y < P (2^255-19 for ed25519)\n      A = Point.fromBytes(publicKey, zip215);\n      R = Point.fromBytes(r, zip215);\n      SB = BASE.multiplyUnsafe(s); // 0 <= s < l is done inside\n    } catch (error) {\n      return false;\n    }\n    if (!zip215 && A.isSmallOrder()) return false; // zip215 allows public keys of small order\n\n    const k = hashDomainToScalar(context, R.toBytes(), A.toBytes(), msg);\n    const RkA = R.add(A.multiplyUnsafe(k));\n    // Extended group equation\n    // [8][S]B = [8]R + [8][k]A'\n    return RkA.subtract(SB).clearCofactor().is0();\n  }\n\n  const _size = Fp.BYTES; // 32 for ed25519, 57 for ed448\n  const lengths = {\n    secretKey: _size,\n    publicKey: _size,\n    signature: 2 * _size,\n    seed: _size,\n  };\n  function randomSecretKey(seed = randomBytes(lengths.seed)): Uint8Array {\n    return abytes(seed, lengths.seed, 'seed');\n  }\n  function keygen(seed?: Uint8Array) {\n    const secretKey = utils.randomSecretKey(seed);\n    return { secretKey, publicKey: getPublicKey(secretKey) };\n  }\n  function isValidSecretKey(key: Uint8Array): boolean {\n    return isBytes(key) && key.length === Fn.BYTES;\n  }\n  function isValidPublicKey(key: Uint8Array, zip215?: boolean): boolean {\n    try {\n      return !!Point.fromBytes(key, zip215);\n    } catch (error) {\n      return false;\n    }\n  }\n\n  const utils = {\n    getExtendedPublicKey,\n    randomSecretKey,\n    isValidSecretKey,\n    isValidPublicKey,\n    /**\n     * Converts ed public key to x public key. Uses formula:\n     * - ed25519:\n     *   - `(u, v) = ((1+y)/(1-y), sqrt(-486664)*u/x)`\n     *   - `(x, y) = (sqrt(-486664)*u/v, (u-1)/(u+1))`\n     * - ed448:\n     *   - `(u, v) = ((y-1)/(y+1), sqrt(156324)*u/x)`\n     *   - `(x, y) = (sqrt(156324)*u/v, (1+u)/(1-u))`\n     */\n    toMontgomery(publicKey: Uint8Array): Uint8Array {\n      const { y } = Point.fromBytes(publicKey);\n      const size = lengths.publicKey;\n      const is25519 = size === 32;\n      if (!is25519 && size !== 57) throw new Error('only defined for 25519 and 448');\n      const u = is25519 ? Fp.div(_1n + y, _1n - y) : Fp.div(y - _1n, y + _1n);\n      return Fp.toBytes(u);\n    },\n\n    toMontgomerySecret(secretKey: Uint8Array): Uint8Array {\n      const size = lengths.secretKey;\n      abytes(secretKey, size);\n      const hashed = cHash(secretKey.subarray(0, size));\n      return adjustScalarBytes(hashed).subarray(0, size);\n    },\n\n    /** @deprecated */\n    randomPrivateKey: randomSecretKey,\n    /** @deprecated */\n    precompute(windowSize = 8, point: EdwardsPoint = Point.BASE): EdwardsPoint {\n      return point.precompute(windowSize, false);\n    },\n  };\n\n  return Object.freeze({\n    keygen,\n    getPublicKey,\n    sign,\n    verify,\n    utils,\n    Point,\n    lengths,\n  });\n}\n\n// TODO: remove everything below\nexport type CurveType = BasicCurve<bigint> & {\n  a: bigint; // curve param a\n  d: bigint; // curve param d\n  /** @deprecated the property will be removed in next release */\n  hash: FHash; // Hashing\n  randomBytes?: (bytesLength?: number) => Uint8Array; // CSPRNG\n  adjustScalarBytes?: (bytes: Uint8Array) => Uint8Array; // clears bits to get valid field elemtn\n  domain?: (data: Uint8Array, ctx: Uint8Array, phflag: boolean) => Uint8Array; // Used for hashing\n  uvRatio?: UVRatio; // Ratio \u221A(u/v)\n  prehash?: FHash; // RFC 8032 pre-hashing of messages to sign() / verify()\n  mapToCurve?: (scalar: bigint[]) => AffinePoint<bigint>; // for hash-to-curve standard\n};\nexport type CurveTypeWithLength = Readonly<CurveType & Partial<NLength>>;\nexport type CurveFn = {\n  /** @deprecated the property will be removed in next release */\n  CURVE: CurveType;\n  keygen: EdDSA['keygen'];\n  getPublicKey: EdDSA['getPublicKey'];\n  sign: EdDSA['sign'];\n  verify: EdDSA['verify'];\n  Point: EdwardsPointCons;\n  /** @deprecated use `Point` */\n  ExtendedPoint: EdwardsPointCons;\n  utils: EdDSA['utils'];\n  lengths: CurveLengths;\n};\nexport type EdComposed = {\n  CURVE: EdwardsOpts;\n  curveOpts: EdwardsExtraOpts;\n  hash: FHash;\n  eddsaOpts: EdDSAOpts;\n};\nfunction _eddsa_legacy_opts_to_new(c: CurveTypeWithLength): EdComposed {\n  const CURVE: EdwardsOpts = {\n    a: c.a,\n    d: c.d,\n    p: c.Fp.ORDER,\n    n: c.n,\n    h: c.h,\n    Gx: c.Gx,\n    Gy: c.Gy,\n  };\n  const Fp = c.Fp;\n  const Fn = Field(CURVE.n, c.nBitLength, true);\n  const curveOpts: EdwardsExtraOpts = { Fp, Fn, uvRatio: c.uvRatio };\n  const eddsaOpts: EdDSAOpts = {\n    randomBytes: c.randomBytes,\n    adjustScalarBytes: c.adjustScalarBytes,\n    domain: c.domain,\n    prehash: c.prehash,\n    mapToCurve: c.mapToCurve,\n  };\n  return { CURVE, curveOpts, hash: c.hash, eddsaOpts };\n}\nfunction _eddsa_new_output_to_legacy(c: CurveTypeWithLength, eddsa: EdDSA): CurveFn {\n  const Point = eddsa.Point;\n  const legacy = Object.assign({}, eddsa, {\n    ExtendedPoint: Point,\n    CURVE: c,\n    nBitLength: Point.Fn.BITS,\n    nByteLength: Point.Fn.BYTES,\n  });\n  return legacy;\n}\n// TODO: remove. Use eddsa\nexport function twistedEdwards(c: CurveTypeWithLength): CurveFn {\n  const { CURVE, curveOpts, hash, eddsaOpts } = _eddsa_legacy_opts_to_new(c);\n  const Point = edwards(CURVE, curveOpts);\n  const EDDSA = eddsa(Point, hash, eddsaOpts);\n  return _eddsa_new_output_to_legacy(c, EDDSA);\n}\n", "/**\n * hash-to-curve from RFC 9380.\n * Hashes arbitrary-length byte strings to a list of one or more elements of a finite field F.\n * https://www.rfc-editor.org/rfc/rfc9380\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport type { CHash } from '../utils.ts';\nimport {\n  _validateObject,\n  abytes,\n  bytesToNumberBE,\n  concatBytes,\n  isBytes,\n  isHash,\n  utf8ToBytes,\n} from '../utils.ts';\nimport type { AffinePoint, Group, GroupConstructor } from './curve.ts';\nimport { FpInvertBatch, mod, type IField } from './modular.ts';\n\nexport type UnicodeOrBytes = string | Uint8Array;\n\n/**\n * * `DST` is a domain separation tag, defined in section 2.2.5\n * * `p` characteristic of F, where F is a finite field of characteristic p and order q = p^m\n * * `m` is extension degree (1 for prime fields)\n * * `k` is the target security target in bits (e.g. 128), from section 5.1\n * * `expand` is `xmd` (SHA2, SHA3, BLAKE) or `xof` (SHAKE, BLAKE-XOF)\n * * `hash` conforming to `utils.CHash` interface, with `outputLen` / `blockLen` props\n */\nexport type H2COpts = {\n  DST: UnicodeOrBytes;\n  expand: 'xmd' | 'xof';\n  hash: CHash;\n  p: bigint;\n  m: number;\n  k: number;\n};\nexport type H2CHashOpts = {\n  expand: 'xmd' | 'xof';\n  hash: CHash;\n};\n// todo: remove\nexport type Opts = H2COpts;\n\n// Octet Stream to Integer. \"spec\" implementation of os2ip is 2.5x slower vs bytesToNumberBE.\nconst os2ip = bytesToNumberBE;\n\n// Integer to Octet Stream (numberToBytesBE)\nfunction i2osp(value: number, length: number): Uint8Array {\n  anum(value);\n  anum(length);\n  if (value < 0 || value >= 1 << (8 * length)) throw new Error('invalid I2OSP input: ' + value);\n  const res = Array.from({ length }).fill(0) as number[];\n  for (let i = length - 1; i >= 0; i--) {\n    res[i] = value & 0xff;\n    value >>>= 8;\n  }\n  return new Uint8Array(res);\n}\n\nfunction strxor(a: Uint8Array, b: Uint8Array): Uint8Array {\n  const arr = new Uint8Array(a.length);\n  for (let i = 0; i < a.length; i++) {\n    arr[i] = a[i] ^ b[i];\n  }\n  return arr;\n}\n\nfunction anum(item: unknown): void {\n  if (!Number.isSafeInteger(item)) throw new Error('number expected');\n}\n\nfunction normDST(DST: UnicodeOrBytes): Uint8Array {\n  if (!isBytes(DST) && typeof DST !== 'string') throw new Error('DST must be Uint8Array or string');\n  return typeof DST === 'string' ? utf8ToBytes(DST) : DST;\n}\n\n/**\n * Produces a uniformly random byte string using a cryptographic hash function H that outputs b bits.\n * [RFC 9380 5.3.1](https://www.rfc-editor.org/rfc/rfc9380#section-5.3.1).\n */\nexport function expand_message_xmd(\n  msg: Uint8Array,\n  DST: UnicodeOrBytes,\n  lenInBytes: number,\n  H: CHash\n): Uint8Array {\n  abytes(msg);\n  anum(lenInBytes);\n  DST = normDST(DST);\n  // https://www.rfc-editor.org/rfc/rfc9380#section-5.3.3\n  if (DST.length > 255) DST = H(concatBytes(utf8ToBytes('H2C-OVERSIZE-DST-'), DST));\n  const { outputLen: b_in_bytes, blockLen: r_in_bytes } = H;\n  const ell = Math.ceil(lenInBytes / b_in_bytes);\n  if (lenInBytes > 65535 || ell > 255) throw new Error('expand_message_xmd: invalid lenInBytes');\n  const DST_prime = concatBytes(DST, i2osp(DST.length, 1));\n  const Z_pad = i2osp(0, r_in_bytes);\n  const l_i_b_str = i2osp(lenInBytes, 2); // len_in_bytes_str\n  const b = new Array<Uint8Array>(ell);\n  const b_0 = H(concatBytes(Z_pad, msg, l_i_b_str, i2osp(0, 1), DST_prime));\n  b[0] = H(concatBytes(b_0, i2osp(1, 1), DST_prime));\n  for (let i = 1; i <= ell; i++) {\n    const args = [strxor(b_0, b[i - 1]), i2osp(i + 1, 1), DST_prime];\n    b[i] = H(concatBytes(...args));\n  }\n  const pseudo_random_bytes = concatBytes(...b);\n  return pseudo_random_bytes.slice(0, lenInBytes);\n}\n\n/**\n * Produces a uniformly random byte string using an extendable-output function (XOF) H.\n * 1. The collision resistance of H MUST be at least k bits.\n * 2. H MUST be an XOF that has been proved indifferentiable from\n *    a random oracle under a reasonable cryptographic assumption.\n * [RFC 9380 5.3.2](https://www.rfc-editor.org/rfc/rfc9380#section-5.3.2).\n */\nexport function expand_message_xof(\n  msg: Uint8Array,\n  DST: UnicodeOrBytes,\n  lenInBytes: number,\n  k: number,\n  H: CHash\n): Uint8Array {\n  abytes(msg);\n  anum(lenInBytes);\n  DST = normDST(DST);\n  // https://www.rfc-editor.org/rfc/rfc9380#section-5.3.3\n  // DST = H('H2C-OVERSIZE-DST-' || a_very_long_DST, Math.ceil((lenInBytes * k) / 8));\n  if (DST.length > 255) {\n    const dkLen = Math.ceil((2 * k) / 8);\n    DST = H.create({ dkLen }).update(utf8ToBytes('H2C-OVERSIZE-DST-')).update(DST).digest();\n  }\n  if (lenInBytes > 65535 || DST.length > 255)\n    throw new Error('expand_message_xof: invalid lenInBytes');\n  return (\n    H.create({ dkLen: lenInBytes })\n      .update(msg)\n      .update(i2osp(lenInBytes, 2))\n      // 2. DST_prime = DST || I2OSP(len(DST), 1)\n      .update(DST)\n      .update(i2osp(DST.length, 1))\n      .digest()\n  );\n}\n\n/**\n * Hashes arbitrary-length byte strings to a list of one or more elements of a finite field F.\n * [RFC 9380 5.2](https://www.rfc-editor.org/rfc/rfc9380#section-5.2).\n * @param msg a byte string containing the message to hash\n * @param count the number of elements of F to output\n * @param options `{DST: string, p: bigint, m: number, k: number, expand: 'xmd' | 'xof', hash: H}`, see above\n * @returns [u_0, ..., u_(count - 1)], a list of field elements.\n */\nexport function hash_to_field(msg: Uint8Array, count: number, options: H2COpts): bigint[][] {\n  _validateObject(options, {\n    p: 'bigint',\n    m: 'number',\n    k: 'number',\n    hash: 'function',\n  });\n  const { p, k, m, hash, expand, DST } = options;\n  if (!isHash(options.hash)) throw new Error('expected valid hash');\n  abytes(msg);\n  anum(count);\n  const log2p = p.toString(2).length;\n  const L = Math.ceil((log2p + k) / 8); // section 5.1 of ietf draft link above\n  const len_in_bytes = count * m * L;\n  let prb; // pseudo_random_bytes\n  if (expand === 'xmd') {\n    prb = expand_message_xmd(msg, DST, len_in_bytes, hash);\n  } else if (expand === 'xof') {\n    prb = expand_message_xof(msg, DST, len_in_bytes, k, hash);\n  } else if (expand === '_internal_pass') {\n    // for internal tests only\n    prb = msg;\n  } else {\n    throw new Error('expand must be \"xmd\" or \"xof\"');\n  }\n  const u = new Array(count);\n  for (let i = 0; i < count; i++) {\n    const e = new Array(m);\n    for (let j = 0; j < m; j++) {\n      const elm_offset = L * (j + i * m);\n      const tv = prb.subarray(elm_offset, elm_offset + L);\n      e[j] = mod(os2ip(tv), p);\n    }\n    u[i] = e;\n  }\n  return u;\n}\n\nexport type XY<T> = (x: T, y: T) => { x: T; y: T };\nexport type XYRatio<T> = [T[], T[], T[], T[]]; // xn/xd, yn/yd\nexport function isogenyMap<T, F extends IField<T>>(field: F, map: XYRatio<T>): XY<T> {\n  // Make same order as in spec\n  const coeff = map.map((i) => Array.from(i).reverse());\n  return (x: T, y: T) => {\n    const [xn, xd, yn, yd] = coeff.map((val) =>\n      val.reduce((acc, i) => field.add(field.mul(acc, x), i))\n    );\n    // 6.6.3\n    // Exceptional cases of iso_map are inputs that cause the denominator of\n    // either rational function to evaluate to zero; such cases MUST return\n    // the identity point on E.\n    const [xd_inv, yd_inv] = FpInvertBatch(field, [xd, yd], true);\n    x = field.mul(xn, xd_inv); // xNum / xDen\n    y = field.mul(y, field.mul(yn, yd_inv)); // y * (yNum / yDev)\n    return { x, y };\n  };\n}\n\n/** Point interface, which curves must implement to work correctly with the module. */\nexport interface H2CPoint<T> extends Group<H2CPoint<T>> {\n  add(rhs: H2CPoint<T>): H2CPoint<T>;\n  toAffine(iz?: bigint): AffinePoint<T>;\n  clearCofactor(): H2CPoint<T>;\n  assertValidity(): void;\n}\n\nexport interface H2CPointConstructor<T> extends GroupConstructor<H2CPoint<T>> {\n  fromAffine(ap: AffinePoint<T>): H2CPoint<T>;\n}\n\nexport type MapToCurve<T> = (scalar: bigint[]) => AffinePoint<T>;\n\n// Separated from initialization opts, so users won't accidentally change per-curve parameters\n// (changing DST is ok!)\nexport type htfBasicOpts = { DST: UnicodeOrBytes };\nexport type H2CMethod<T> = (msg: Uint8Array, options?: htfBasicOpts) => H2CPoint<T>;\n// TODO: remove\nexport type HTFMethod<T> = H2CMethod<T>;\nexport type MapMethod<T> = (scalars: bigint[]) => H2CPoint<T>;\nexport type H2CHasherBase<T> = {\n  hashToCurve: H2CMethod<T>;\n  hashToScalar: (msg: Uint8Array, options: htfBasicOpts) => bigint;\n};\n/**\n * RFC 9380 methods, with cofactor clearing. See https://www.rfc-editor.org/rfc/rfc9380#section-3.\n *\n * * hashToCurve: `map(hash(input))`, encodes RANDOM bytes to curve (WITH hashing)\n * * encodeToCurve: `map(hash(input))`, encodes NON-UNIFORM bytes to curve (WITH hashing)\n * * mapToCurve: `map(scalars)`, encodes NON-UNIFORM scalars to curve (NO hashing)\n */\nexport type H2CHasher<T> = H2CHasherBase<T> & {\n  encodeToCurve: H2CMethod<T>;\n  mapToCurve: MapMethod<T>;\n  defaults: H2COpts & { encodeDST?: UnicodeOrBytes };\n};\n// TODO: remove\nexport type Hasher<T> = H2CHasher<T>;\n\nexport const _DST_scalar: Uint8Array = utf8ToBytes('HashToScalar-');\n\n/** Creates hash-to-curve methods from EC Point and mapToCurve function. See {@link H2CHasher}. */\nexport function createHasher<T>(\n  Point: H2CPointConstructor<T>,\n  mapToCurve: MapToCurve<T>,\n  defaults: H2COpts & { encodeDST?: UnicodeOrBytes }\n): H2CHasher<T> {\n  if (typeof mapToCurve !== 'function') throw new Error('mapToCurve() must be defined');\n  function map(num: bigint[]) {\n    return Point.fromAffine(mapToCurve(num));\n  }\n  function clear(initial: H2CPoint<T>) {\n    const P = initial.clearCofactor();\n    if (P.equals(Point.ZERO)) return Point.ZERO; // zero will throw in assert\n    P.assertValidity();\n    return P;\n  }\n\n  return {\n    defaults,\n\n    hashToCurve(msg: Uint8Array, options?: htfBasicOpts): H2CPoint<T> {\n      const opts = Object.assign({}, defaults, options);\n      const u = hash_to_field(msg, 2, opts);\n      const u0 = map(u[0]);\n      const u1 = map(u[1]);\n      return clear(u0.add(u1));\n    },\n    encodeToCurve(msg: Uint8Array, options?: htfBasicOpts): H2CPoint<T> {\n      const optsDst = defaults.encodeDST ? { DST: defaults.encodeDST } : {};\n      const opts = Object.assign({}, defaults, optsDst, options);\n      const u = hash_to_field(msg, 1, opts);\n      const u0 = map(u[0]);\n      return clear(u0);\n    },\n    /** See {@link H2CHasher} */\n    mapToCurve(scalars: bigint[]): H2CPoint<T> {\n      if (!Array.isArray(scalars)) throw new Error('expected array of bigints');\n      for (const i of scalars)\n        if (typeof i !== 'bigint') throw new Error('expected array of bigints');\n      return clear(map(scalars));\n    },\n\n    // hash_to_scalar can produce 0: https://www.rfc-editor.org/errata/eid8393\n    // RFC 9380, draft-irtf-cfrg-bbs-signatures-08\n    hashToScalar(msg: Uint8Array, options?: htfBasicOpts): bigint {\n      // @ts-ignore\n      const N = Point.Fn.ORDER;\n      const opts = Object.assign({}, defaults, { p: N, m: 1, DST: _DST_scalar }, options);\n      return hash_to_field(msg, 1, opts)[0][0];\n    },\n  };\n}\n", "/**\n * Montgomery curve methods. It's not really whole montgomery curve,\n * just bunch of very specific methods for X25519 / X448 from\n * [RFC 7748](https://www.rfc-editor.org/rfc/rfc7748)\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport {\n  _validateObject,\n  abytes,\n  aInRange,\n  bytesToNumberLE,\n  ensureBytes,\n  numberToBytesLE,\n  randomBytes,\n} from '../utils.ts';\nimport type { CurveLengths } from './curve.ts';\nimport { mod } from './modular.ts';\n\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\ntype Hex = string | Uint8Array;\n\nexport type CurveType = {\n  P: bigint; // finite field prime\n  type: 'x25519' | 'x448';\n  adjustScalarBytes: (bytes: Uint8Array) => Uint8Array;\n  powPminus2: (x: bigint) => bigint;\n  randomBytes?: (bytesLength?: number) => Uint8Array;\n};\n\nexport type MontgomeryECDH = {\n  scalarMult: (scalar: Hex, u: Hex) => Uint8Array;\n  scalarMultBase: (scalar: Hex) => Uint8Array;\n  getSharedSecret: (secretKeyA: Hex, publicKeyB: Hex) => Uint8Array;\n  getPublicKey: (secretKey: Hex) => Uint8Array;\n  utils: {\n    randomSecretKey: () => Uint8Array;\n    /** @deprecated use `randomSecretKey` */\n    randomPrivateKey: () => Uint8Array;\n  };\n  GuBytes: Uint8Array;\n  lengths: CurveLengths;\n  keygen: (seed?: Uint8Array) => { secretKey: Uint8Array; publicKey: Uint8Array };\n};\nexport type CurveFn = MontgomeryECDH;\n\nfunction validateOpts(curve: CurveType) {\n  _validateObject(curve, {\n    adjustScalarBytes: 'function',\n    powPminus2: 'function',\n  });\n  return Object.freeze({ ...curve } as const);\n}\n\nexport function montgomery(curveDef: CurveType): MontgomeryECDH {\n  const CURVE = validateOpts(curveDef);\n  const { P, type, adjustScalarBytes, powPminus2, randomBytes: rand } = CURVE;\n  const is25519 = type === 'x25519';\n  if (!is25519 && type !== 'x448') throw new Error('invalid type');\n  const randomBytes_ = rand || randomBytes;\n\n  const montgomeryBits = is25519 ? 255 : 448;\n  const fieldLen = is25519 ? 32 : 56;\n  const Gu = is25519 ? BigInt(9) : BigInt(5);\n  // RFC 7748 #5:\n  // The constant a24 is (486662 - 2) / 4 = 121665 for curve25519/X25519 and\n  // (156326 - 2) / 4 = 39081 for curve448/X448\n  // const a = is25519 ? 156326n : 486662n;\n  const a24 = is25519 ? BigInt(121665) : BigInt(39081);\n  // RFC: x25519 \"the resulting integer is of the form 2^254 plus\n  // eight times a value between 0 and 2^251 - 1 (inclusive)\"\n  // x448: \"2^447 plus four times a value between 0 and 2^445 - 1 (inclusive)\"\n  const minScalar = is25519 ? _2n ** BigInt(254) : _2n ** BigInt(447);\n  const maxAdded = is25519\n    ? BigInt(8) * _2n ** BigInt(251) - _1n\n    : BigInt(4) * _2n ** BigInt(445) - _1n;\n  const maxScalar = minScalar + maxAdded + _1n; // (inclusive)\n  const modP = (n: bigint) => mod(n, P);\n  const GuBytes = encodeU(Gu);\n  function encodeU(u: bigint): Uint8Array {\n    return numberToBytesLE(modP(u), fieldLen);\n  }\n  function decodeU(u: Hex): bigint {\n    const _u = ensureBytes('u coordinate', u, fieldLen);\n    // RFC: When receiving such an array, implementations of X25519\n    // (but not X448) MUST mask the most significant bit in the final byte.\n    if (is25519) _u[31] &= 127; // 0b0111_1111\n    // RFC: Implementations MUST accept non-canonical values and process them as\n    // if they had been reduced modulo the field prime.  The non-canonical\n    // values are 2^255 - 19 through 2^255 - 1 for X25519 and 2^448 - 2^224\n    // - 1 through 2^448 - 1 for X448.\n    return modP(bytesToNumberLE(_u));\n  }\n  function decodeScalar(scalar: Hex): bigint {\n    return bytesToNumberLE(adjustScalarBytes(ensureBytes('scalar', scalar, fieldLen)));\n  }\n  function scalarMult(scalar: Hex, u: Hex): Uint8Array {\n    const pu = montgomeryLadder(decodeU(u), decodeScalar(scalar));\n    // Some public keys are useless, of low-order. Curve author doesn't think\n    // it needs to be validated, but we do it nonetheless.\n    // https://cr.yp.to/ecdh.html#validate\n    if (pu === _0n) throw new Error('invalid private or public key received');\n    return encodeU(pu);\n  }\n  // Computes public key from private. By doing scalar multiplication of base point.\n  function scalarMultBase(scalar: Hex): Uint8Array {\n    return scalarMult(scalar, GuBytes);\n  }\n\n  // cswap from RFC7748 \"example code\"\n  function cswap(swap: bigint, x_2: bigint, x_3: bigint): { x_2: bigint; x_3: bigint } {\n    // dummy = mask(swap) AND (x_2 XOR x_3)\n    // Where mask(swap) is the all-1 or all-0 word of the same length as x_2\n    // and x_3, computed, e.g., as mask(swap) = 0 - swap.\n    const dummy = modP(swap * (x_2 - x_3));\n    x_2 = modP(x_2 - dummy); // x_2 = x_2 XOR dummy\n    x_3 = modP(x_3 + dummy); // x_3 = x_3 XOR dummy\n    return { x_2, x_3 };\n  }\n\n  /**\n   * Montgomery x-only multiplication ladder.\n   * @param pointU u coordinate (x) on Montgomery Curve 25519\n   * @param scalar by which the point would be multiplied\n   * @returns new Point on Montgomery curve\n   */\n  function montgomeryLadder(u: bigint, scalar: bigint): bigint {\n    aInRange('u', u, _0n, P);\n    aInRange('scalar', scalar, minScalar, maxScalar);\n    const k = scalar;\n    const x_1 = u;\n    let x_2 = _1n;\n    let z_2 = _0n;\n    let x_3 = u;\n    let z_3 = _1n;\n    let swap = _0n;\n    for (let t = BigInt(montgomeryBits - 1); t >= _0n; t--) {\n      const k_t = (k >> t) & _1n;\n      swap ^= k_t;\n      ({ x_2, x_3 } = cswap(swap, x_2, x_3));\n      ({ x_2: z_2, x_3: z_3 } = cswap(swap, z_2, z_3));\n      swap = k_t;\n\n      const A = x_2 + z_2;\n      const AA = modP(A * A);\n      const B = x_2 - z_2;\n      const BB = modP(B * B);\n      const E = AA - BB;\n      const C = x_3 + z_3;\n      const D = x_3 - z_3;\n      const DA = modP(D * A);\n      const CB = modP(C * B);\n      const dacb = DA + CB;\n      const da_cb = DA - CB;\n      x_3 = modP(dacb * dacb);\n      z_3 = modP(x_1 * modP(da_cb * da_cb));\n      x_2 = modP(AA * BB);\n      z_2 = modP(E * (AA + modP(a24 * E)));\n    }\n    ({ x_2, x_3 } = cswap(swap, x_2, x_3));\n    ({ x_2: z_2, x_3: z_3 } = cswap(swap, z_2, z_3));\n    const z2 = powPminus2(z_2); // `Fp.pow(x, P - _2n)` is much slower equivalent\n    return modP(x_2 * z2); // Return x_2 * (z_2^(p - 2))\n  }\n  const lengths = {\n    secretKey: fieldLen,\n    publicKey: fieldLen,\n    seed: fieldLen,\n  };\n  const randomSecretKey = (seed = randomBytes_(fieldLen)) => {\n    abytes(seed, lengths.seed);\n    return seed;\n  };\n  function keygen(seed?: Uint8Array) {\n    const secretKey = randomSecretKey(seed);\n    return { secretKey, publicKey: scalarMultBase(secretKey) };\n  }\n  const utils = {\n    randomSecretKey,\n    randomPrivateKey: randomSecretKey,\n  };\n  return {\n    keygen,\n    getSharedSecret: (secretKey: Hex, publicKey: Hex) => scalarMult(secretKey, publicKey),\n    getPublicKey: (secretKey: Hex): Uint8Array => scalarMultBase(secretKey),\n    scalarMult,\n    scalarMultBase,\n    utils,\n    GuBytes: GuBytes.slice(),\n    lengths,\n  };\n}\n", "/**\n * ed25519 Twisted Edwards curve with following addons:\n * - X25519 ECDH\n * - Ristretto cofactor elimination\n * - Elligator hash-to-group / point indistinguishability\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { sha512 } from '@noble/hashes/sha2.js';\nimport { abytes, concatBytes, utf8ToBytes } from '@noble/hashes/utils.js';\nimport { pippenger, type AffinePoint } from './abstract/curve.ts';\nimport {\n  PrimeEdwardsPoint,\n  twistedEdwards,\n  type CurveFn,\n  type EdwardsOpts,\n  type EdwardsPoint,\n} from './abstract/edwards.ts';\nimport {\n  _DST_scalar,\n  createHasher,\n  expand_message_xmd,\n  type H2CHasher,\n  type H2CHasherBase,\n  type H2CMethod,\n  type htfBasicOpts,\n} from './abstract/hash-to-curve.ts';\nimport {\n  Field,\n  FpInvertBatch,\n  FpSqrtEven,\n  isNegativeLE,\n  mod,\n  pow2,\n  type IField,\n} from './abstract/modular.ts';\nimport { montgomery, type MontgomeryECDH as XCurveFn } from './abstract/montgomery.ts';\nimport { bytesToNumberLE, ensureBytes, equalBytes, type Hex } from './utils.ts';\n\n// prettier-ignore\nconst _0n = /* @__PURE__ */ BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _3n = BigInt(3);\n// prettier-ignore\nconst _5n = BigInt(5), _8n = BigInt(8);\n\n// P = 2n**255n-19n\nconst ed25519_CURVE_p = BigInt(\n  '0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed'\n);\n\n// N = 2n**252n + 27742317777372353535851937790883648493n\n// a = Fp.create(BigInt(-1))\n// d = -121665/121666 a.k.a. Fp.neg(121665 * Fp.inv(121666))\nconst ed25519_CURVE: EdwardsOpts = /* @__PURE__ */ (() => ({\n  p: ed25519_CURVE_p,\n  n: BigInt('0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed'),\n  h: _8n,\n  a: BigInt('0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec'),\n  d: BigInt('0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3'),\n  Gx: BigInt('0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a'),\n  Gy: BigInt('0x6666666666666666666666666666666666666666666666666666666666666658'),\n}))();\n\nfunction ed25519_pow_2_252_3(x: bigint) {\n  // prettier-ignore\n  const _10n = BigInt(10), _20n = BigInt(20), _40n = BigInt(40), _80n = BigInt(80);\n  const P = ed25519_CURVE_p;\n  const x2 = (x * x) % P;\n  const b2 = (x2 * x) % P; // x^3, 11\n  const b4 = (pow2(b2, _2n, P) * b2) % P; // x^15, 1111\n  const b5 = (pow2(b4, _1n, P) * x) % P; // x^31\n  const b10 = (pow2(b5, _5n, P) * b5) % P;\n  const b20 = (pow2(b10, _10n, P) * b10) % P;\n  const b40 = (pow2(b20, _20n, P) * b20) % P;\n  const b80 = (pow2(b40, _40n, P) * b40) % P;\n  const b160 = (pow2(b80, _80n, P) * b80) % P;\n  const b240 = (pow2(b160, _80n, P) * b80) % P;\n  const b250 = (pow2(b240, _10n, P) * b10) % P;\n  const pow_p_5_8 = (pow2(b250, _2n, P) * x) % P;\n  // ^ To pow to (p+3)/8, multiply it by x.\n  return { pow_p_5_8, b2 };\n}\n\nfunction adjustScalarBytes(bytes: Uint8Array): Uint8Array {\n  // Section 5: For X25519, in order to decode 32 random bytes as an integer scalar,\n  // set the three least significant bits of the first byte\n  bytes[0] &= 248; // 0b1111_1000\n  // and the most significant bit of the last to zero,\n  bytes[31] &= 127; // 0b0111_1111\n  // set the second most significant bit of the last byte to 1\n  bytes[31] |= 64; // 0b0100_0000\n  return bytes;\n}\n\n// \u221A(-1) aka \u221A(a) aka 2^((p-1)/4)\n// Fp.sqrt(Fp.neg(1))\nconst ED25519_SQRT_M1 = /* @__PURE__ */ BigInt(\n  '19681161376707505956807079304988542015446066515923890162744021073123829784752'\n);\n// sqrt(u/v)\nfunction uvRatio(u: bigint, v: bigint): { isValid: boolean; value: bigint } {\n  const P = ed25519_CURVE_p;\n  const v3 = mod(v * v * v, P); // v\u00B3\n  const v7 = mod(v3 * v3 * v, P); // v\u2077\n  // (p+3)/8 and (p-5)/8\n  const pow = ed25519_pow_2_252_3(u * v7).pow_p_5_8;\n  let x = mod(u * v3 * pow, P); // (uv\u00B3)(uv\u2077)^(p-5)/8\n  const vx2 = mod(v * x * x, P); // vx\u00B2\n  const root1 = x; // First root candidate\n  const root2 = mod(x * ED25519_SQRT_M1, P); // Second root candidate\n  const useRoot1 = vx2 === u; // If vx\u00B2 = u (mod p), x is a square root\n  const useRoot2 = vx2 === mod(-u, P); // If vx\u00B2 = -u, set x <-- x * 2^((p-1)/4)\n  const noRoot = vx2 === mod(-u * ED25519_SQRT_M1, P); // There is no valid root, vx\u00B2 = -u\u221A(-1)\n  if (useRoot1) x = root1;\n  if (useRoot2 || noRoot) x = root2; // We return root2 anyway, for const-time\n  if (isNegativeLE(x, P)) x = mod(-x, P);\n  return { isValid: useRoot1 || useRoot2, value: x };\n}\n\nconst Fp = /* @__PURE__ */ (() => Field(ed25519_CURVE.p, { isLE: true }))();\nconst Fn = /* @__PURE__ */ (() => Field(ed25519_CURVE.n, { isLE: true }))();\n\nconst ed25519Defaults = /* @__PURE__ */ (() => ({\n  ...ed25519_CURVE,\n  Fp,\n  hash: sha512,\n  adjustScalarBytes,\n  // dom2\n  // Ratio of u to v. Allows us to combine inversion and square root. Uses algo from RFC8032 5.1.3.\n  // Constant-time, u/\u221Av\n  uvRatio,\n}))();\n\n/**\n * ed25519 curve with EdDSA signatures.\n * @example\n * import { ed25519 } from '@noble/curves/ed25519';\n * const { secretKey, publicKey } = ed25519.keygen();\n * const msg = new TextEncoder().encode('hello');\n * const sig = ed25519.sign(msg, priv);\n * ed25519.verify(sig, msg, pub); // Default mode: follows ZIP215\n * ed25519.verify(sig, msg, pub, { zip215: false }); // RFC8032 / FIPS 186-5\n */\nexport const ed25519: CurveFn = /* @__PURE__ */ (() => twistedEdwards(ed25519Defaults))();\n\nfunction ed25519_domain(data: Uint8Array, ctx: Uint8Array, phflag: boolean) {\n  if (ctx.length > 255) throw new Error('Context is too big');\n  return concatBytes(\n    utf8ToBytes('SigEd25519 no Ed25519 collisions'),\n    new Uint8Array([phflag ? 1 : 0, ctx.length]),\n    ctx,\n    data\n  );\n}\n\n/** Context of ed25519. Uses context for domain separation. */\nexport const ed25519ctx: CurveFn = /* @__PURE__ */ (() =>\n  twistedEdwards({\n    ...ed25519Defaults,\n    domain: ed25519_domain,\n  }))();\n\n/** Prehashed version of ed25519. Accepts already-hashed messages in sign() and verify(). */\nexport const ed25519ph: CurveFn = /* @__PURE__ */ (() =>\n  twistedEdwards(\n    Object.assign({}, ed25519Defaults, {\n      domain: ed25519_domain,\n      prehash: sha512,\n    })\n  ))();\n\n/**\n * ECDH using curve25519 aka x25519.\n * @example\n * import { x25519 } from '@noble/curves/ed25519';\n * const priv = 'a546e36bf0527c9d3b16154b82465edd62144c0ac1fc5a18506a2244ba449ac4';\n * const pub = 'e6db6867583030db3594c1a424b15f7c726624ec26b3353b10a903a6d0ab1c4c';\n * x25519.getSharedSecret(priv, pub) === x25519.scalarMult(priv, pub); // aliases\n * x25519.getPublicKey(priv) === x25519.scalarMultBase(priv);\n * x25519.getPublicKey(x25519.utils.randomSecretKey());\n */\nexport const x25519: XCurveFn = /* @__PURE__ */ (() => {\n  const P = Fp.ORDER;\n  return montgomery({\n    P,\n    type: 'x25519',\n    powPminus2: (x: bigint): bigint => {\n      // x^(p-2) aka x^(2^255-21)\n      const { pow_p_5_8, b2 } = ed25519_pow_2_252_3(x);\n      return mod(pow2(pow_p_5_8, _3n, P) * b2, P);\n    },\n    adjustScalarBytes,\n  });\n})();\n\n// Hash To Curve Elligator2 Map (NOTE: different from ristretto255 elligator)\n// NOTE: very important part is usage of FpSqrtEven for ELL2_C1_EDWARDS, since\n// SageMath returns different root first and everything falls apart\nconst ELL2_C1 = /* @__PURE__ */ (() => (ed25519_CURVE_p + _3n) / _8n)(); // 1. c1 = (q + 3) / 8       # Integer arithmetic\nconst ELL2_C2 = /* @__PURE__ */ (() => Fp.pow(_2n, ELL2_C1))(); // 2. c2 = 2^c1\nconst ELL2_C3 = /* @__PURE__ */ (() => Fp.sqrt(Fp.neg(Fp.ONE)))(); // 3. c3 = sqrt(-1)\n\n// prettier-ignore\nfunction map_to_curve_elligator2_curve25519(u: bigint) {\n  const ELL2_C4 = (ed25519_CURVE_p - _5n) / _8n; // 4. c4 = (q - 5) / 8       # Integer arithmetic\n  const ELL2_J = BigInt(486662);\n\n  let tv1 = Fp.sqr(u);          //  1.  tv1 = u^2\n  tv1 = Fp.mul(tv1, _2n);       //  2.  tv1 = 2 * tv1\n  let xd = Fp.add(tv1, Fp.ONE); //  3.   xd = tv1 + 1         # Nonzero: -1 is square (mod p), tv1 is not\n  let x1n = Fp.neg(ELL2_J);     //  4.  x1n = -J              # x1 = x1n / xd = -J / (1 + 2 * u^2)\n  let tv2 = Fp.sqr(xd);         //  5.  tv2 = xd^2\n  let gxd = Fp.mul(tv2, xd);    //  6.  gxd = tv2 * xd        # gxd = xd^3\n  let gx1 = Fp.mul(tv1, ELL2_J);//  7.  gx1 = J * tv1         # x1n + J * xd\n  gx1 = Fp.mul(gx1, x1n);       //  8.  gx1 = gx1 * x1n       # x1n^2 + J * x1n * xd\n  gx1 = Fp.add(gx1, tv2);       //  9.  gx1 = gx1 + tv2       # x1n^2 + J * x1n * xd + xd^2\n  gx1 = Fp.mul(gx1, x1n);       //  10. gx1 = gx1 * x1n       # x1n^3 + J * x1n^2 * xd + x1n * xd^2\n  let tv3 = Fp.sqr(gxd);        //  11. tv3 = gxd^2\n  tv2 = Fp.sqr(tv3);            //  12. tv2 = tv3^2           # gxd^4\n  tv3 = Fp.mul(tv3, gxd);       //  13. tv3 = tv3 * gxd       # gxd^3\n  tv3 = Fp.mul(tv3, gx1);       //  14. tv3 = tv3 * gx1       # gx1 * gxd^3\n  tv2 = Fp.mul(tv2, tv3);       //  15. tv2 = tv2 * tv3       # gx1 * gxd^7\n  let y11 = Fp.pow(tv2, ELL2_C4); //  16. y11 = tv2^c4        # (gx1 * gxd^7)^((p - 5) / 8)\n  y11 = Fp.mul(y11, tv3);       //  17. y11 = y11 * tv3       # gx1*gxd^3*(gx1*gxd^7)^((p-5)/8)\n  let y12 = Fp.mul(y11, ELL2_C3); //  18. y12 = y11 * c3\n  tv2 = Fp.sqr(y11);            //  19. tv2 = y11^2\n  tv2 = Fp.mul(tv2, gxd);       //  20. tv2 = tv2 * gxd\n  let e1 = Fp.eql(tv2, gx1);    //  21.  e1 = tv2 == gx1\n  let y1 = Fp.cmov(y12, y11, e1); //  22.  y1 = CMOV(y12, y11, e1)  # If g(x1) is square, this is its sqrt\n  let x2n = Fp.mul(x1n, tv1);   //  23. x2n = x1n * tv1       # x2 = x2n / xd = 2 * u^2 * x1n / xd\n  let y21 = Fp.mul(y11, u);     //  24. y21 = y11 * u\n  y21 = Fp.mul(y21, ELL2_C2);   //  25. y21 = y21 * c2\n  let y22 = Fp.mul(y21, ELL2_C3); //  26. y22 = y21 * c3\n  let gx2 = Fp.mul(gx1, tv1);   //  27. gx2 = gx1 * tv1       # g(x2) = gx2 / gxd = 2 * u^2 * g(x1)\n  tv2 = Fp.sqr(y21);            //  28. tv2 = y21^2\n  tv2 = Fp.mul(tv2, gxd);       //  29. tv2 = tv2 * gxd\n  let e2 = Fp.eql(tv2, gx2);    //  30.  e2 = tv2 == gx2\n  let y2 = Fp.cmov(y22, y21, e2); //  31.  y2 = CMOV(y22, y21, e2)  # If g(x2) is square, this is its sqrt\n  tv2 = Fp.sqr(y1);             //  32. tv2 = y1^2\n  tv2 = Fp.mul(tv2, gxd);       //  33. tv2 = tv2 * gxd\n  let e3 = Fp.eql(tv2, gx1);    //  34.  e3 = tv2 == gx1\n  let xn = Fp.cmov(x2n, x1n, e3); //  35.  xn = CMOV(x2n, x1n, e3)  # If e3, x = x1, else x = x2\n  let y = Fp.cmov(y2, y1, e3);  //  36.   y = CMOV(y2, y1, e3)    # If e3, y = y1, else y = y2\n  let e4 = Fp.isOdd!(y);         //  37.  e4 = sgn0(y) == 1        # Fix sign of y\n  y = Fp.cmov(y, Fp.neg(y), e3 !== e4); //  38.   y = CMOV(y, -y, e3 XOR e4)\n  return { xMn: xn, xMd: xd, yMn: y, yMd: _1n }; //  39. return (xn, xd, y, 1)\n}\n\nconst ELL2_C1_EDWARDS = /* @__PURE__ */ (() => FpSqrtEven(Fp, Fp.neg(BigInt(486664))))(); // sgn0(c1) MUST equal 0\nfunction map_to_curve_elligator2_edwards25519(u: bigint) {\n  const { xMn, xMd, yMn, yMd } = map_to_curve_elligator2_curve25519(u); //  1.  (xMn, xMd, yMn, yMd) =\n  // map_to_curve_elligator2_curve25519(u)\n  let xn = Fp.mul(xMn, yMd); //  2.  xn = xMn * yMd\n  xn = Fp.mul(xn, ELL2_C1_EDWARDS); //  3.  xn = xn * c1\n  let xd = Fp.mul(xMd, yMn); //  4.  xd = xMd * yMn    # xn / xd = c1 * xM / yM\n  let yn = Fp.sub(xMn, xMd); //  5.  yn = xMn - xMd\n  let yd = Fp.add(xMn, xMd); //  6.  yd = xMn + xMd    # (n / d - 1) / (n / d + 1) = (n - d) / (n + d)\n  let tv1 = Fp.mul(xd, yd); //  7. tv1 = xd * yd\n  let e = Fp.eql(tv1, Fp.ZERO); //  8.   e = tv1 == 0\n  xn = Fp.cmov(xn, Fp.ZERO, e); //  9.  xn = CMOV(xn, 0, e)\n  xd = Fp.cmov(xd, Fp.ONE, e); //  10. xd = CMOV(xd, 1, e)\n  yn = Fp.cmov(yn, Fp.ONE, e); //  11. yn = CMOV(yn, 1, e)\n  yd = Fp.cmov(yd, Fp.ONE, e); //  12. yd = CMOV(yd, 1, e)\n  const [xd_inv, yd_inv] = FpInvertBatch(Fp, [xd, yd], true); // batch division\n  return { x: Fp.mul(xn, xd_inv), y: Fp.mul(yn, yd_inv) }; //  13. return (xn, xd, yn, yd)\n}\n\n/** Hashing to ed25519 points / field. RFC 9380 methods. */\nexport const ed25519_hasher: H2CHasher<bigint> = /* @__PURE__ */ (() =>\n  createHasher(\n    ed25519.Point,\n    (scalars: bigint[]) => map_to_curve_elligator2_edwards25519(scalars[0]),\n    {\n      DST: 'edwards25519_XMD:SHA-512_ELL2_RO_',\n      encodeDST: 'edwards25519_XMD:SHA-512_ELL2_NU_',\n      p: ed25519_CURVE_p,\n      m: 1,\n      k: 128,\n      expand: 'xmd',\n      hash: sha512,\n    }\n  ))();\n\n// \u221A(-1) aka \u221A(a) aka 2^((p-1)/4)\nconst SQRT_M1 = ED25519_SQRT_M1;\n// \u221A(ad - 1)\nconst SQRT_AD_MINUS_ONE = /* @__PURE__ */ BigInt(\n  '25063068953384623474111414158702152701244531502492656460079210482610430750235'\n);\n// 1 / \u221A(a-d)\nconst INVSQRT_A_MINUS_D = /* @__PURE__ */ BigInt(\n  '54469307008909316920995813868745141605393597292927456921205312896311721017578'\n);\n// 1-d\u00B2\nconst ONE_MINUS_D_SQ = /* @__PURE__ */ BigInt(\n  '1159843021668779879193775521855586647937357759715417654439879720876111806838'\n);\n// (d-1)\u00B2\nconst D_MINUS_ONE_SQ = /* @__PURE__ */ BigInt(\n  '40440834346308536858101042469323190826248399146238708352240133220865137265952'\n);\n// Calculates 1/\u221A(number)\nconst invertSqrt = (number: bigint) => uvRatio(_1n, number);\n\nconst MAX_255B = /* @__PURE__ */ BigInt(\n  '0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff'\n);\nconst bytes255ToNumberLE = (bytes: Uint8Array) =>\n  ed25519.Point.Fp.create(bytesToNumberLE(bytes) & MAX_255B);\n\ntype ExtendedPoint = EdwardsPoint;\n\n/**\n * Computes Elligator map for Ristretto255.\n * Described in [RFC9380](https://www.rfc-editor.org/rfc/rfc9380#appendix-B) and on\n * the [website](https://ristretto.group/formulas/elligator.html).\n */\nfunction calcElligatorRistrettoMap(r0: bigint): ExtendedPoint {\n  const { d } = ed25519_CURVE;\n  const P = ed25519_CURVE_p;\n  const mod = (n: bigint) => Fp.create(n);\n  const r = mod(SQRT_M1 * r0 * r0); // 1\n  const Ns = mod((r + _1n) * ONE_MINUS_D_SQ); // 2\n  let c = BigInt(-1); // 3\n  const D = mod((c - d * r) * mod(r + d)); // 4\n  let { isValid: Ns_D_is_sq, value: s } = uvRatio(Ns, D); // 5\n  let s_ = mod(s * r0); // 6\n  if (!isNegativeLE(s_, P)) s_ = mod(-s_);\n  if (!Ns_D_is_sq) s = s_; // 7\n  if (!Ns_D_is_sq) c = r; // 8\n  const Nt = mod(c * (r - _1n) * D_MINUS_ONE_SQ - D); // 9\n  const s2 = s * s;\n  const W0 = mod((s + s) * D); // 10\n  const W1 = mod(Nt * SQRT_AD_MINUS_ONE); // 11\n  const W2 = mod(_1n - s2); // 12\n  const W3 = mod(_1n + s2); // 13\n  return new ed25519.Point(mod(W0 * W3), mod(W2 * W1), mod(W1 * W3), mod(W0 * W2));\n}\n\nfunction ristretto255_map(bytes: Uint8Array): _RistrettoPoint {\n  abytes(bytes, 64);\n  const r1 = bytes255ToNumberLE(bytes.subarray(0, 32));\n  const R1 = calcElligatorRistrettoMap(r1);\n  const r2 = bytes255ToNumberLE(bytes.subarray(32, 64));\n  const R2 = calcElligatorRistrettoMap(r2);\n  return new _RistrettoPoint(R1.add(R2));\n}\n\n/**\n * Wrapper over Edwards Point for ristretto255.\n *\n * Each ed25519/ExtendedPoint has 8 different equivalent points. This can be\n * a source of bugs for protocols like ring signatures. Ristretto was created to solve this.\n * Ristretto point operates in X:Y:Z:T extended coordinates like ExtendedPoint,\n * but it should work in its own namespace: do not combine those two.\n * See [RFC9496](https://www.rfc-editor.org/rfc/rfc9496).\n */\nclass _RistrettoPoint extends PrimeEdwardsPoint<_RistrettoPoint> {\n  // Do NOT change syntax: the following gymnastics is done,\n  // because typescript strips comments, which makes bundlers disable tree-shaking.\n  // prettier-ignore\n  static BASE: _RistrettoPoint =\n    /* @__PURE__ */ (() => new _RistrettoPoint(ed25519.Point.BASE))();\n  // prettier-ignore\n  static ZERO: _RistrettoPoint =\n    /* @__PURE__ */ (() => new _RistrettoPoint(ed25519.Point.ZERO))();\n  // prettier-ignore\n  static Fp: IField<bigint> =\n    /* @__PURE__ */ (() => Fp)();\n  // prettier-ignore\n  static Fn: IField<bigint> =\n    /* @__PURE__ */ (() => Fn)();\n\n  constructor(ep: ExtendedPoint) {\n    super(ep);\n  }\n\n  static fromAffine(ap: AffinePoint<bigint>): _RistrettoPoint {\n    return new _RistrettoPoint(ed25519.Point.fromAffine(ap));\n  }\n\n  protected assertSame(other: _RistrettoPoint): void {\n    if (!(other instanceof _RistrettoPoint)) throw new Error('RistrettoPoint expected');\n  }\n\n  protected init(ep: EdwardsPoint): _RistrettoPoint {\n    return new _RistrettoPoint(ep);\n  }\n\n  /** @deprecated use `import { ristretto255_hasher } from '@noble/curves/ed25519.js';` */\n  static hashToCurve(hex: Hex): _RistrettoPoint {\n    return ristretto255_map(ensureBytes('ristrettoHash', hex, 64));\n  }\n\n  static fromBytes(bytes: Uint8Array): _RistrettoPoint {\n    abytes(bytes, 32);\n    const { a, d } = ed25519_CURVE;\n    const P = ed25519_CURVE_p;\n    const mod = (n: bigint) => Fp.create(n);\n    const s = bytes255ToNumberLE(bytes);\n    // 1. Check that s_bytes is the canonical encoding of a field element, or else abort.\n    // 3. Check that s is non-negative, or else abort\n    if (!equalBytes(Fp.toBytes(s), bytes) || isNegativeLE(s, P))\n      throw new Error('invalid ristretto255 encoding 1');\n    const s2 = mod(s * s);\n    const u1 = mod(_1n + a * s2); // 4 (a is -1)\n    const u2 = mod(_1n - a * s2); // 5\n    const u1_2 = mod(u1 * u1);\n    const u2_2 = mod(u2 * u2);\n    const v = mod(a * d * u1_2 - u2_2); // 6\n    const { isValid, value: I } = invertSqrt(mod(v * u2_2)); // 7\n    const Dx = mod(I * u2); // 8\n    const Dy = mod(I * Dx * v); // 9\n    let x = mod((s + s) * Dx); // 10\n    if (isNegativeLE(x, P)) x = mod(-x); // 10\n    const y = mod(u1 * Dy); // 11\n    const t = mod(x * y); // 12\n    if (!isValid || isNegativeLE(t, P) || y === _0n)\n      throw new Error('invalid ristretto255 encoding 2');\n    return new _RistrettoPoint(new ed25519.Point(x, y, _1n, t));\n  }\n\n  /**\n   * Converts ristretto-encoded string to ristretto point.\n   * Described in [RFC9496](https://www.rfc-editor.org/rfc/rfc9496#name-decode).\n   * @param hex Ristretto-encoded 32 bytes. Not every 32-byte string is valid ristretto encoding\n   */\n  static fromHex(hex: Hex): _RistrettoPoint {\n    return _RistrettoPoint.fromBytes(ensureBytes('ristrettoHex', hex, 32));\n  }\n\n  static msm(points: _RistrettoPoint[], scalars: bigint[]): _RistrettoPoint {\n    return pippenger(_RistrettoPoint, ed25519.Point.Fn, points, scalars);\n  }\n\n  /**\n   * Encodes ristretto point to Uint8Array.\n   * Described in [RFC9496](https://www.rfc-editor.org/rfc/rfc9496#name-encode).\n   */\n  toBytes(): Uint8Array {\n    let { X, Y, Z, T } = this.ep;\n    const P = ed25519_CURVE_p;\n    const mod = (n: bigint) => Fp.create(n);\n    const u1 = mod(mod(Z + Y) * mod(Z - Y)); // 1\n    const u2 = mod(X * Y); // 2\n    // Square root always exists\n    const u2sq = mod(u2 * u2);\n    const { value: invsqrt } = invertSqrt(mod(u1 * u2sq)); // 3\n    const D1 = mod(invsqrt * u1); // 4\n    const D2 = mod(invsqrt * u2); // 5\n    const zInv = mod(D1 * D2 * T); // 6\n    let D: bigint; // 7\n    if (isNegativeLE(T * zInv, P)) {\n      let _x = mod(Y * SQRT_M1);\n      let _y = mod(X * SQRT_M1);\n      X = _x;\n      Y = _y;\n      D = mod(D1 * INVSQRT_A_MINUS_D);\n    } else {\n      D = D2; // 8\n    }\n    if (isNegativeLE(X * zInv, P)) Y = mod(-Y); // 9\n    let s = mod((Z - Y) * D); // 10 (check footer's note, no sqrt(-a))\n    if (isNegativeLE(s, P)) s = mod(-s);\n    return Fp.toBytes(s); // 11\n  }\n\n  /**\n   * Compares two Ristretto points.\n   * Described in [RFC9496](https://www.rfc-editor.org/rfc/rfc9496#name-equals).\n   */\n  equals(other: _RistrettoPoint): boolean {\n    this.assertSame(other);\n    const { X: X1, Y: Y1 } = this.ep;\n    const { X: X2, Y: Y2 } = other.ep;\n    const mod = (n: bigint) => Fp.create(n);\n    // (x1 * y2 == y1 * x2) | (y1 * y2 == x1 * x2)\n    const one = mod(X1 * Y2) === mod(Y1 * X2);\n    const two = mod(Y1 * Y2) === mod(X1 * X2);\n    return one || two;\n  }\n\n  is0(): boolean {\n    return this.equals(_RistrettoPoint.ZERO);\n  }\n}\n\nexport const ristretto255: {\n  Point: typeof _RistrettoPoint;\n} = { Point: _RistrettoPoint };\n\n/** Hashing to ristretto255 points / field. RFC 9380 methods. */\nexport const ristretto255_hasher: H2CHasherBase<bigint> = {\n  hashToCurve(msg: Uint8Array, options?: htfBasicOpts): _RistrettoPoint {\n    const DST = options?.DST || 'ristretto255_XMD:SHA-512_R255MAP_RO_';\n    const xmd = expand_message_xmd(msg, DST, 64, sha512);\n    return ristretto255_map(xmd);\n  },\n  hashToScalar(msg: Uint8Array, options: htfBasicOpts = { DST: _DST_scalar }) {\n    const xmd = expand_message_xmd(msg, options.DST, 64, sha512);\n    return Fn.create(bytesToNumberLE(xmd));\n  },\n};\n\n// export const ristretto255_oprf: OPRF = createORPF({\n//   name: 'ristretto255-SHA512',\n//   Point: RistrettoPoint,\n//   hash: sha512,\n//   hashToGroup: ristretto255_hasher.hashToCurve,\n//   hashToScalar: ristretto255_hasher.hashToScalar,\n// });\n\n/**\n * Weird / bogus points, useful for debugging.\n * All 8 ed25519 points of 8-torsion subgroup can be generated from the point\n * T = `26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05`.\n * \u27E8T\u27E9 = { O, T, 2T, 3T, 4T, 5T, 6T, 7T }\n */\nexport const ED25519_TORSION_SUBGROUP: string[] = [\n  '0100000000000000000000000000000000000000000000000000000000000000',\n  'c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a',\n  '0000000000000000000000000000000000000000000000000000000000000080',\n  '26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05',\n  'ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f',\n  '26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85',\n  '0000000000000000000000000000000000000000000000000000000000000000',\n  'c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa',\n];\n\n/** @deprecated use `ed25519.utils.toMontgomery` */\nexport function edwardsToMontgomeryPub(edwardsPub: Hex): Uint8Array {\n  return ed25519.utils.toMontgomery(ensureBytes('pub', edwardsPub));\n}\n/** @deprecated use `ed25519.utils.toMontgomery` */\nexport const edwardsToMontgomery: typeof edwardsToMontgomeryPub = edwardsToMontgomeryPub;\n\n/** @deprecated use `ed25519.utils.toMontgomerySecret` */\nexport function edwardsToMontgomeryPriv(edwardsPriv: Uint8Array): Uint8Array {\n  return ed25519.utils.toMontgomerySecret(ensureBytes('pub', edwardsPriv));\n}\n\n/** @deprecated use `ristretto255.Point` */\nexport const RistrettoPoint: typeof _RistrettoPoint = _RistrettoPoint;\n/** @deprecated use `import { ed25519_hasher } from '@noble/curves/ed25519.js';` */\nexport const hashToCurve: H2CMethod<bigint> = /* @__PURE__ */ (() => ed25519_hasher.hashToCurve)();\n/** @deprecated use `import { ed25519_hasher } from '@noble/curves/ed25519.js';` */\nexport const encodeToCurve: H2CMethod<bigint> = /* @__PURE__ */ (() =>\n  ed25519_hasher.encodeToCurve)();\ntype RistHasher = (msg: Uint8Array, options: htfBasicOpts) => _RistrettoPoint;\n/** @deprecated use `import { ristretto255_hasher } from '@noble/curves/ed25519.js';` */\nexport const hashToRistretto255: RistHasher = /* @__PURE__ */ (() =>\n  ristretto255_hasher.hashToCurve as RistHasher)();\n/** @deprecated use `import { ristretto255_hasher } from '@noble/curves/ed25519.js';` */\nexport const hash_to_ristretto255: RistHasher = /* @__PURE__ */ (() =>\n  ristretto255_hasher.hashToCurve as RistHasher)();\n", "class BufferWriter {\n\n    constructor() {\n        this.buffer = [];\n    }\n\n    toBytes() {\n        return new Uint8Array(this.buffer);\n    }\n\n    writeBytes(bytes) {\n        this.buffer = [\n            ...this.buffer,\n            ...bytes,\n        ];\n    }\n\n    writeByte(byte) {\n        this.writeBytes([\n            byte,\n        ]);\n    }\n\n    writeUInt16LE(num) {\n        const bytes = new Uint8Array(2);\n        const view = new DataView(bytes.buffer);\n        view.setUint16(0, num, true);\n        this.writeBytes(bytes);\n    }\n\n    writeUInt32LE(num) {\n        const bytes = new Uint8Array(4);\n        const view = new DataView(bytes.buffer);\n        view.setUint32(0, num, true);\n        this.writeBytes(bytes);\n    }\n\n    writeInt32LE(num) {\n        const bytes = new Uint8Array(4);\n        const view = new DataView(bytes.buffer);\n        view.setInt32(0, num, true);\n        this.writeBytes(bytes);\n    }\n\n    writeString(string) {\n        this.writeBytes(new TextEncoder().encode(string));\n    }\n\n    writeCString(string, maxLength) {\n\n        // create buffer of max length\n        const bytes = new Uint8Array(new ArrayBuffer(maxLength));\n\n        // encode string to bytes\n        const encodedString = new TextEncoder().encode(string);\n\n        // copy in string until we hit the max length, or we run out of string bytes\n        for(var i = 0; i < maxLength && i < encodedString.length; i++){\n            bytes[i] = encodedString[i];\n        }\n\n        // ensure the last byte is always a null terminator\n        bytes[bytes.length - 1] = 0;\n\n        // write to buffer\n        this.writeBytes(bytes);\n\n    }\n\n}\n\nexport default BufferWriter;\n", "class BufferReader {\n\n    constructor(data) {\n        this.pointer = 0;\n        this.buffer = new Uint8Array(data);\n    }\n\n    getRemainingBytesCount() {\n        return this.buffer.length - this.pointer;\n    }\n\n    readByte() {\n        return this.readBytes(1)[0];\n    }\n\n    readBytes(count) {\n        const data = this.buffer.slice(this.pointer, this.pointer + count);\n        this.pointer += count;\n        return data;\n    }\n\n    readRemainingBytes() {\n        return this.readBytes(this.getRemainingBytesCount());\n    }\n\n    readString() {\n        return new TextDecoder().decode(this.readRemainingBytes());\n    }\n\n    readCString(maxLength) {\n        const value = [];\n        const bytes = this.readBytes(maxLength);\n        for(const byte of bytes){\n\n            // if we find a null terminator character, we have reached the end of the cstring\n            if(byte === 0){\n                return new TextDecoder().decode(new Uint8Array(value));\n            }\n\n            value.push(byte);\n\n        }\n    }\n\n    readInt8() {\n        const bytes = this.readBytes(1);\n        const view = new DataView(bytes.buffer);\n        return view.getInt8(0);\n    }\n\n    readUInt8() {\n        const bytes = this.readBytes(1);\n        const view = new DataView(bytes.buffer);\n        return view.getUint8(0);\n    }\n\n    readUInt16LE() {\n        const bytes = this.readBytes(2);\n        const view = new DataView(bytes.buffer);\n        return view.getUint16(0, true);\n    }\n\n    readUInt16BE() {\n        const bytes = this.readBytes(2);\n        const view = new DataView(bytes.buffer);\n        return view.getUint16(0, false);\n    }\n\n    readUInt32LE() {\n        const bytes = this.readBytes(4);\n        const view = new DataView(bytes.buffer);\n        return view.getUint32(0, true);\n    }\n\n    readUInt32BE() {\n        const bytes = this.readBytes(4);\n        const view = new DataView(bytes.buffer);\n        return view.getUint32(0, false);\n    }\n\n    readInt16LE() {\n        const bytes = this.readBytes(2);\n        const view = new DataView(bytes.buffer);\n        return view.getInt16(0, true);\n    }\n\n    readInt16BE() {\n        const bytes = this.readBytes(2);\n        const view = new DataView(bytes.buffer);\n        return view.getInt16(0, false);\n    }\n\n    readInt32LE() {\n        const bytes = this.readBytes(4);\n        const view = new DataView(bytes.buffer);\n        return view.getInt32(0, true);\n    }\n\n    readInt24BE() {\n\n        // read 24-bit (3 bytes) big endian integer\n        var value = (this.readByte() << 16) | (this.readByte() << 8) | this.readByte();\n\n        // convert 24-bit signed integer to 32-bit signed integer\n        // 0x800000 is the sign bit for a 24-bit value\n        // if it's set, value is negative in 24-bit two's complement\n        // so we subtract 0x1000000 (which is 2^24) to get the correct negative value as a Dart integer\n        if((value & 0x800000) !== 0){\n            value -= 0x1000000;\n        }\n\n        return value;\n\n    }\n\n}\n\nexport default BufferReader;\n", "class Constants {\n\n    static SupportedCompanionProtocolVersion = 1;\n\n    static SerialFrameTypes = {\n        Incoming: 0x3e, // \">\"\n        Outgoing: 0x3c, // \"<\"\n    }\n\n    static Ble = {\n        ServiceUuid: \"6E400001-B5A3-F393-E0A9-E50E24DCCA9E\",\n        CharacteristicUuidRx: \"6E400002-B5A3-F393-E0A9-E50E24DCCA9E\",\n        CharacteristicUuidTx: \"6E400003-B5A3-F393-E0A9-E50E24DCCA9E\",\n    }\n\n    static CommandCodes = {\n        AppStart: 1,\n        SendTxtMsg: 2,\n        SendChannelTxtMsg: 3,\n        GetContacts: 4,\n        GetDeviceTime: 5,\n        SetDeviceTime: 6,\n        SendSelfAdvert: 7,\n        SetAdvertName: 8,\n        AddUpdateContact: 9,\n        SyncNextMessage: 10,\n        SetRadioParams: 11,\n        SetTxPower: 12,\n        ResetPath: 13,\n        SetAdvertLatLon: 14,\n        RemoveContact: 15,\n        ShareContact: 16,\n        ExportContact: 17,\n        ImportContact: 18,\n        Reboot: 19,\n        GetBatteryVoltage: 20,\n        SetTuningParams: 21, // todo\n        DeviceQuery: 22,\n        ExportPrivateKey: 23,\n        ImportPrivateKey: 24,\n        SendRawData: 25,\n        SendLogin: 26, // todo\n        SendStatusReq: 27, // todo\n        GetChannel: 31,\n        SetChannel: 32,\n        SignStart: 33,\n        SignData: 34,\n        SignFinish: 35,\n        SendTracePath: 36,\n        // todo set device pin command\n        SetOtherParams: 38,\n        SendTelemetryReq: 39,\n\n        SendBinaryReq: 50,\n    }\n\n    static ResponseCodes = {\n        Ok: 0, // todo\n        Err: 1, // todo\n        ContactsStart: 2,\n        Contact: 3,\n        EndOfContacts: 4,\n        SelfInfo: 5,\n        Sent: 6,\n        ContactMsgRecv: 7,\n        ChannelMsgRecv: 8,\n        CurrTime: 9,\n        NoMoreMessages: 10,\n        ExportContact: 11,\n        BatteryVoltage: 12,\n        DeviceInfo: 13,\n        PrivateKey: 14,\n        Disabled: 15,\n        ChannelInfo: 18,\n        SignStart: 19,\n        Signature: 20,\n    }\n\n    static PushCodes = {\n        Advert: 0x80, // when companion is set to auto add contacts\n        PathUpdated: 0x81,\n        SendConfirmed: 0x82,\n        MsgWaiting: 0x83,\n        RawData: 0x84,\n        LoginSuccess: 0x85,\n        LoginFail: 0x86, // not usable yet\n        StatusResponse: 0x87,\n        LogRxData: 0x88,\n        TraceData: 0x89,\n        NewAdvert: 0x8A, // when companion is set to manually add contacts\n        TelemetryResponse: 0x8B,\n        BinaryResponse: 0x8C,\n    }\n\n    static ErrorCodes = {\n        UnsupportedCmd: 1,\n        NotFound: 2,\n        TableFull: 3,\n        BadState: 4,\n        FileIoError: 5,\n        IllegalArg: 6,\n    }\n\n    static AdvType = {\n        None: 0,\n        Chat: 1,\n        Repeater: 2,\n        Room: 3,\n    }\n\n    static SelfAdvertTypes = {\n        ZeroHop: 0,\n        Flood: 1,\n    }\n\n    static TxtTypes = {\n        Plain: 0,\n        CliData: 1,\n        SignedPlain: 2,\n    }\n\n    static BinaryRequestTypes = {\n        GetTelemetryData: 0x03, // #define REQ_TYPE_GET_TELEMETRY_DATA 0x03\n        GetAvgMinMax: 0x04, // #define REQ_TYPE_GET_AVG_MIN_MAX 0x04\n        GetAccessList: 0x05, // #define REQ_TYPE_GET_ACCESS_LIST 0x05\n        GetNeighbours: 0x06, // #define REQ_TYPE_GET_NEIGHBOURS 0x06\n    }\n\n}\n\nexport default Constants;\n", "class EventEmitter {\n\n    constructor() {\n        this.eventListenersMap = new Map();\n    }\n\n    on(event, callback) {\n\n        // create list of listeners for event if it doesn't exist\n        if(!this.eventListenersMap.has(event)){\n            this.eventListenersMap.set(event, []);\n        }\n\n        // add listener for event\n        this.eventListenersMap.get(event).push(callback);\n\n    }\n\n    off(event, callback) {\n\n        // remove callback from listeners for this event\n        if(this.eventListenersMap.has(event)){\n            const callbacks = this.eventListenersMap.get(event).filter(cb => cb !== callback);\n            this.eventListenersMap.set(event, callbacks);\n        }\n\n    }\n\n    once(event, callback) {\n\n        // internal callback to handle the event\n        const internalCallback = (...data) => {\n\n            // we received an event, so lets remove the event listener\n            this.off(event, internalCallback);\n\n            // fire the original callback provided by the user\n            setTimeout(() => callback(...data), 0);\n\n        };\n\n        // listen to this event\n        this.on(event, internalCallback);\n\n    }\n\n    emit(event, ...data) {\n\n        // invoke each listener for this event\n        if(this.eventListenersMap.has(event)){\n            for(const eventListener of this.eventListenersMap.get(event)){\n                setTimeout(() => eventListener(...data), 0);\n            }\n        }\n\n    }\n\n}\n\nexport default EventEmitter;\n", "class BufferUtils {\n\n    static bytesToHex(uint8Array) {\n        return Array.from(uint8Array).map(byte => {\n            return byte.toString(16).padStart(2, '0');\n        }).join('');\n    }\n\n    static hexToBytes(hex) {\n        return Uint8Array.from(hex.match(/.{1,2}/g).map((byte) => parseInt(byte, 16)));\n    }\n\n    static base64ToBytes(base64) {\n        return Uint8Array.from(atob(base64), (c) => {\n            return c.charCodeAt(0);\n        });\n    }\n\n    static areBuffersEqual(byteArray1, byteArray2) {\n\n        // ensure length is the same\n        if(byteArray1.length !== byteArray2.length){\n            return false;\n        }\n\n        // ensure each item is the same\n        for(let i = 0; i < byteArray1.length; i++){\n            if(byteArray1[i] !== byteArray2[i]){\n                return false;\n            }\n        }\n\n        // arrays are the same\n        return true;\n\n    }\n\n}\n\nexport default BufferUtils;\n", "import BufferReader from \"./buffer_reader.js\";\nimport BufferWriter from \"./buffer_writer.js\";\n\nclass Advert {\n\n    static ADV_TYPE_NONE = 0;\n    static ADV_TYPE_CHAT = 1;\n    static ADV_TYPE_REPEATER = 2;\n    static ADV_TYPE_ROOM = 3;\n\n    static ADV_LATLON_MASK = 0x10;\n    static ADV_BATTERY_MASK = 0x20;\n    static ADV_TEMPERATURE_MASK = 0x40;\n    static ADV_NAME_MASK = 0x80;\n\n    constructor(publicKey, timestamp, signature, appData) {\n        this.publicKey = publicKey;\n        this.timestamp = timestamp;\n        this.signature = signature;\n        this.appData = appData;\n        this.parsed = this.parseAppData();\n    }\n\n    static fromBytes(bytes) {\n\n        // read bytes\n        const bufferReader = new BufferReader(bytes);\n        const publicKey = bufferReader.readBytes(32);\n        const timestamp = bufferReader.readUInt32LE();\n        const signature = bufferReader.readBytes(64);\n        const appData = bufferReader.readRemainingBytes();\n\n        return new Advert(publicKey, timestamp, signature, appData);\n\n    }\n\n    getFlags() {\n        return this.appData[0];\n    }\n\n    getType() {\n        const flags = this.getFlags();\n        return flags & 0x0F;\n    }\n\n    getTypeString() {\n        const type = this.getType();\n        if(type === Advert.ADV_TYPE_NONE) return \"NONE\";\n        if(type === Advert.ADV_TYPE_CHAT) return \"CHAT\";\n        if(type === Advert.ADV_TYPE_REPEATER) return \"REPEATER\";\n        if(type === Advert.ADV_TYPE_ROOM) return \"ROOM\";\n        return null;\n    }\n\n    async isVerified() {\n\n        const { ed25519 } = await import(\"@noble/curves/ed25519\");\n\n        // build signed data\n        const bufferWriter = new BufferWriter();\n        bufferWriter.writeBytes(this.publicKey);\n        bufferWriter.writeUInt32LE(this.timestamp);\n        bufferWriter.writeBytes(this.appData);\n\n        // verify signature\n        return ed25519.verify(this.signature, bufferWriter.toBytes(), this.publicKey);\n\n    }\n\n    parseAppData() {\n\n        // read app data\n        const bufferReader = new BufferReader(this.appData);\n        const flags = bufferReader.readByte();\n\n        // parse lat lon\n        var lat = null;\n        var lon = null;\n        if(flags & Advert.ADV_LATLON_MASK){\n            lat = bufferReader.readInt32LE();\n            lon = bufferReader.readInt32LE();\n        }\n\n        // parse name (remainder of app data)\n        var name = null;\n        if(flags & Advert.ADV_NAME_MASK){\n            name = bufferReader.readString();\n        }\n\n        return {\n            type: this.getTypeString(),\n            lat: lat,\n            lon: lon,\n            name: name,\n        };\n\n    }\n\n}\n\nexport default Advert;\n", "import BufferReader from \"./buffer_reader.js\";\nimport Advert from \"./advert.js\";\n\nclass Packet {\n\n    // Packet::header values\n    static PH_ROUTE_MASK = 0x03;   // 2-bits\n    static PH_TYPE_SHIFT = 2;\n    static PH_TYPE_MASK = 0x0F;   // 4-bits\n    static PH_VER_SHIFT = 6;\n    static PH_VER_MASK = 0x03;   // 2-bits\n\n    static ROUTE_TYPE_RESERVED1 = 0x00;    // FUTURE\n    static ROUTE_TYPE_FLOOD = 0x01;    // flood mode, needs 'path' to be built up (max 64 bytes)\n    static ROUTE_TYPE_DIRECT = 0x02;    // direct route, 'path' is supplied\n    static ROUTE_TYPE_RESERVED2 = 0x03;    // FUTURE\n\n    static PAYLOAD_TYPE_REQ = 0x00;    // request (prefixed with dest/src hashes, MAC) (enc data: timestamp, blob)\n    static PAYLOAD_TYPE_RESPONSE = 0x01;    // response to REQ or ANON_REQ (prefixed with dest/src hashes, MAC) (enc data: timestamp, blob)\n    static PAYLOAD_TYPE_TXT_MSG = 0x02;    // a plain text message (prefixed with dest/src hashes, MAC) (enc data: timestamp, text)\n    static PAYLOAD_TYPE_ACK = 0x03;    // a simple ack\n    static PAYLOAD_TYPE_ADVERT = 0x04;    // a node advertising its Identity\n    static PAYLOAD_TYPE_GRP_TXT = 0x05;    // an (unverified) group text message (prefixed with channel hash, MAC) (enc data: timestamp, \"name: msg\")\n    static PAYLOAD_TYPE_GRP_DATA = 0x06;    // an (unverified) group datagram (prefixed with channel hash, MAC) (enc data: timestamp, blob)\n    static PAYLOAD_TYPE_ANON_REQ = 0x07;    // generic request (prefixed with dest_hash, ephemeral pub_key, MAC) (enc data: ...)\n    static PAYLOAD_TYPE_PATH = 0x08;    // returned path (prefixed with dest/src hashes, MAC) (enc data: path, extra)\n    static PAYLOAD_TYPE_TRACE = 0x09;    // trace a path, collecting SNR for each hop\n    static PAYLOAD_TYPE_RAW_CUSTOM = 0x0F;    // custom packet as raw bytes, for applications with custom encryption, payloads, etc\n\n    constructor(header, path, payload) {\n\n\n        this.header = header;\n        this.path = path;\n        this.payload = payload;\n\n        // parsed info\n        this.route_type = this.getRouteType();\n        this.route_type_string = this.getRouteTypeString();\n        this.payload_type = this.getPayloadType();\n        this.payload_type_string = this.getPayloadTypeString();\n        this.payload_version = this.getPayloadVer();\n        this.is_marked_do_not_retransmit = this.isMarkedDoNotRetransmit();\n\n    }\n\n    static fromBytes(bytes) {\n        const bufferReader = new BufferReader(bytes);\n        const header = bufferReader.readByte();\n        const pathLen = bufferReader.readInt8();\n        const path = bufferReader.readBytes(pathLen);\n        const payload = bufferReader.readRemainingBytes();\n        return new Packet(header, path, payload);\n    }\n\n    getRouteType() {\n        return this.header & Packet.PH_ROUTE_MASK;\n    }\n\n    getRouteTypeString() {\n        switch(this.getRouteType()){\n            case Packet.ROUTE_TYPE_FLOOD: return \"FLOOD\";\n            case Packet.ROUTE_TYPE_DIRECT: return \"DIRECT\";\n            default: return null;\n        }\n    }\n\n    isRouteFlood() {\n        return this.getRouteType() === Packet.ROUTE_TYPE_FLOOD;\n    }\n\n    isRouteDirect() {\n        return this.getRouteType() === Packet.ROUTE_TYPE_DIRECT;\n    }\n\n    getPayloadType() {\n        return (this.header >> Packet.PH_TYPE_SHIFT) & Packet.PH_TYPE_MASK;\n    }\n\n    getPayloadTypeString() {\n        switch(this.getPayloadType()){\n            case Packet.PAYLOAD_TYPE_REQ: return \"REQ\";\n            case Packet.PAYLOAD_TYPE_RESPONSE: return \"RESPONSE\";\n            case Packet.PAYLOAD_TYPE_TXT_MSG: return \"TXT_MSG\";\n            case Packet.PAYLOAD_TYPE_ACK: return \"ACK\";\n            case Packet.PAYLOAD_TYPE_ADVERT: return \"ADVERT\";\n            case Packet.PAYLOAD_TYPE_GRP_TXT: return \"GRP_TXT\";\n            case Packet.PAYLOAD_TYPE_GRP_DATA: return \"GRP_DATA\";\n            case Packet.PAYLOAD_TYPE_ANON_REQ: return \"ANON_REQ\";\n            case Packet.PAYLOAD_TYPE_PATH: return \"PATH\";\n            case Packet.PAYLOAD_TYPE_TRACE: return \"TRACE\";\n            case Packet.PAYLOAD_TYPE_RAW_CUSTOM: return \"RAW_CUSTOM\";\n            default: return null;\n        }\n    }\n\n    getPayloadVer() {\n        return (this.header >> Packet.PH_VER_SHIFT) & Packet.PH_VER_MASK;\n    }\n\n    markDoNotRetransmit() {\n        this.header = 0xFF;\n    }\n\n    isMarkedDoNotRetransmit() {\n        return this.header === 0xFF;\n    }\n\n    parsePayload() {\n        switch(this.getPayloadType()){\n            case Packet.PAYLOAD_TYPE_PATH: return this.parsePayloadTypePath();\n            case Packet.PAYLOAD_TYPE_REQ: return this.parsePayloadTypeReq();\n            case Packet.PAYLOAD_TYPE_RESPONSE: return this.parsePayloadTypeResponse();\n            case Packet.PAYLOAD_TYPE_TXT_MSG: return this.parsePayloadTypeTxtMsg();\n            case Packet.PAYLOAD_TYPE_ACK: return this.parsePayloadTypeAck();\n            case Packet.PAYLOAD_TYPE_ADVERT: return this.parsePayloadTypeAdvert();\n            case Packet.PAYLOAD_TYPE_ANON_REQ: return this.parsePayloadTypeAnonReq();\n            default: return null;\n        }\n    }\n\n    parsePayloadTypePath() {\n\n        // parse bytes\n        const bufferReader = new BufferReader(this.payload);\n        const dest = bufferReader.readByte();\n        const src = bufferReader.readByte();\n        // todo other fields\n\n        return {\n            src: src,\n            dest: dest,\n        };\n\n    }\n\n    parsePayloadTypeReq() {\n\n        // parse bytes\n        const bufferReader = new BufferReader(this.payload);\n        const dest = bufferReader.readByte();\n        const src = bufferReader.readByte();\n        const encrypted = bufferReader.readRemainingBytes();\n\n        return {\n            src: src,\n            dest: dest,\n            encrypted: encrypted,\n        };\n\n    }\n\n    parsePayloadTypeResponse() {\n\n        // parse bytes\n        const bufferReader = new BufferReader(this.payload);\n        const dest = bufferReader.readByte();\n        const src = bufferReader.readByte();\n        // todo other fields\n\n        return {\n            src: src,\n            dest: dest,\n        };\n\n    }\n\n    parsePayloadTypeTxtMsg() {\n\n        // parse bytes\n        const bufferReader = new BufferReader(this.payload);\n        const dest = bufferReader.readByte();\n        const src = bufferReader.readByte();\n        // todo other fields\n\n        return {\n            src: src,\n            dest: dest,\n        };\n\n    }\n\n    parsePayloadTypeAck() {\n        return {\n            ack_code: this.payload,\n        };\n    }\n\n    parsePayloadTypeAdvert() {\n        const advert = Advert.fromBytes(this.payload);\n        return {\n            public_key: advert.publicKey,\n            timestamp: advert.timestamp,\n            app_data: advert.parseAppData(),\n        };\n    }\n\n    parsePayloadTypeAnonReq() {\n\n        // parse bytes\n        const bufferReader = new BufferReader(this.payload);\n        const dest = bufferReader.readByte();\n        const srcPublicKey = bufferReader.readBytes(32);\n        // todo other fields\n\n        return {\n            src: srcPublicKey,\n            dest: dest,\n        };\n\n    }\n\n}\n\nexport default Packet;\n", "class RandomUtils {\n\n    static getRandomInt(min, max) {\n        min = Math.ceil(min);\n        max = Math.floor(max);\n        return Math.floor(Math.random() * (max - min + 1)) + min;\n    }\n\n}\n\nexport default RandomUtils;\n", "import BufferWriter from \"../buffer_writer.js\";\nimport BufferReader from \"../buffer_reader.js\";\nimport Constants from \"../constants.js\";\nimport EventEmitter from \"../events.js\";\nimport BufferUtils from \"../buffer_utils.js\";\nimport Packet from \"../packet.js\";\nimport RandomUtils from \"../random_utils.js\";\n\nclass Connection extends EventEmitter {\n\n    async onConnected() {\n\n        // tell device what protocol version we support\n        try {\n            await this.deviceQuery(Constants.SupportedCompanionProtocolVersion);\n        } catch(e) {\n            // ignore\n        }\n\n        // tell clients we are connected\n        this.emit(\"connected\");\n\n    }\n\n    onDisconnected() {\n        this.emit(\"disconnected\");\n    }\n\n    async close() {\n        throw new Error(\"This method must be implemented by the subclass.\");\n    }\n\n    async sendToRadioFrame(data) {\n        throw new Error(\"This method must be implemented by the subclass.\");\n    }\n\n    async sendCommandAppStart() {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.AppStart);\n        data.writeByte(1); // appVer\n        data.writeBytes(new Uint8Array(6)); // reserved\n        data.writeString(\"test\"); // appName\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSendTxtMsg(txtType, attempt, senderTimestamp, pubKeyPrefix, text) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SendTxtMsg);\n        data.writeByte(txtType);\n        data.writeByte(attempt);\n        data.writeUInt32LE(senderTimestamp);\n        data.writeBytes(pubKeyPrefix.slice(0, 6)); // only the first 6 bytes of pubKey are sent\n        data.writeString(text);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSendChannelTxtMsg(txtType, channelIdx, senderTimestamp, text) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SendChannelTxtMsg);\n        data.writeByte(txtType);\n        data.writeByte(channelIdx);\n        data.writeUInt32LE(senderTimestamp);\n        data.writeString(text);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandGetContacts(since) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.GetContacts);\n        if(since){\n            data.writeUInt32LE(since);\n        }\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandGetDeviceTime() {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.GetDeviceTime);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSetDeviceTime(epochSecs) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SetDeviceTime);\n        data.writeUInt32LE(epochSecs);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSendSelfAdvert(type) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SendSelfAdvert);\n        data.writeByte(type);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSetAdvertName(name) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SetAdvertName);\n        data.writeString(name);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandAddUpdateContact(publicKey, type, flags, outPathLen, outPath, advName, lastAdvert, advLat, advLon) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.AddUpdateContact);\n        data.writeBytes(publicKey);\n        data.writeByte(type);\n        data.writeByte(flags);\n        data.writeByte(outPathLen); // todo writeInt8\n        data.writeBytes(outPath); // 64 bytes\n        data.writeCString(advName, 32); // 32 bytes\n        data.writeUInt32LE(lastAdvert);\n        data.writeUInt32LE(advLat);\n        data.writeUInt32LE(advLon);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSyncNextMessage() {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SyncNextMessage);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSetRadioParams(radioFreq, radioBw, radioSf, radioCr) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SetRadioParams);\n        data.writeUInt32LE(radioFreq);\n        data.writeUInt32LE(radioBw);\n        data.writeByte(radioSf);\n        data.writeByte(radioCr);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSetTxPower(txPower) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SetTxPower);\n        data.writeByte(txPower);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandResetPath(pubKey) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.ResetPath);\n        data.writeBytes(pubKey); // 32 bytes\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSetAdvertLatLon(lat, lon) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SetAdvertLatLon);\n        data.writeInt32LE(lat);\n        data.writeInt32LE(lon);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandRemoveContact(pubKey) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.RemoveContact);\n        data.writeBytes(pubKey); // 32 bytes\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandShareContact(pubKey) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.ShareContact);\n        data.writeBytes(pubKey); // 32 bytes\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    // provide a public key to export that contact\n    // not providing a public key will export local identity as a contact instead\n    async sendCommandExportContact(pubKey = null) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.ExportContact);\n        if(pubKey){\n            data.writeBytes(pubKey); // 32 bytes\n        }\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandImportContact(advertPacketBytes) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.ImportContact);\n        data.writeBytes(advertPacketBytes); // raw advert packet bytes\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandReboot() {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.Reboot);\n        data.writeString(\"reboot\");\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandGetBatteryVoltage() {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.GetBatteryVoltage);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandDeviceQuery(appTargetVer) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.DeviceQuery);\n        data.writeByte(appTargetVer); // e.g: 1\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandExportPrivateKey() {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.ExportPrivateKey);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandImportPrivateKey(privateKey) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.ImportPrivateKey);\n        data.writeBytes(privateKey);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSendRawData(path, rawData) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SendRawData);\n        data.writeByte(path.length);\n        data.writeBytes(path);\n        data.writeBytes(rawData);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSendLogin(publicKey, password) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SendLogin);\n        data.writeBytes(publicKey); // 32 bytes - id of repeater or room server\n        data.writeString(password); // password is remainder of frame, max 15 characters\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSendStatusReq(publicKey) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SendStatusReq);\n        data.writeBytes(publicKey); // 32 bytes - id of repeater or room server\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSendTelemetryReq(publicKey) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SendTelemetryReq);\n        data.writeByte(0); // reserved\n        data.writeByte(0); // reserved\n        data.writeByte(0); // reserved\n        data.writeBytes(publicKey); // 32 bytes - id of destination node\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSendBinaryReq(publicKey, requestCodeAndParams) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SendBinaryReq);\n        data.writeBytes(publicKey); // 32 bytes - public key of contact to send request to\n        data.writeBytes(requestCodeAndParams);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandGetChannel(channelIdx) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.GetChannel);\n        data.writeByte(channelIdx);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSetChannel(channelIdx, name, secret) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SetChannel);\n        data.writeByte(channelIdx);\n        data.writeCString(name, 32);\n        data.writeBytes(secret);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSignStart() {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SignStart);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSignData(dataToSign) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SignData);\n        data.writeBytes(dataToSign);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSignFinish() {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SignFinish);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSendTracePath(tag, auth, path) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SendTracePath);\n        data.writeUInt32LE(tag);\n        data.writeUInt32LE(auth);\n        data.writeByte(0); // flags\n        data.writeBytes(path);\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    async sendCommandSetOtherParams(manualAddContacts) {\n        const data = new BufferWriter();\n        data.writeByte(Constants.CommandCodes.SetOtherParams);\n        data.writeByte(manualAddContacts); // 0 or 1\n        await this.sendToRadioFrame(data.toBytes());\n    }\n\n    onFrameReceived(frame) {\n\n        // emit received frame\n        this.emit(\"rx\", frame);\n\n        const bufferReader = new BufferReader(frame);\n        const responseCode = bufferReader.readByte();\n\n        if(responseCode === Constants.ResponseCodes.Ok){\n            this.onOkResponse(bufferReader);\n        } else if(responseCode === Constants.ResponseCodes.Err){\n            this.onErrResponse(bufferReader);\n        } else if(responseCode === Constants.ResponseCodes.SelfInfo){\n            this.onSelfInfoResponse(bufferReader);\n        } else if(responseCode === Constants.ResponseCodes.CurrTime){\n            this.onCurrTimeResponse(bufferReader);\n        } else if(responseCode === Constants.ResponseCodes.NoMoreMessages){\n            this.onNoMoreMessagesResponse(bufferReader);\n        } else if(responseCode === Constants.ResponseCodes.ContactMsgRecv){\n            this.onContactMsgRecvResponse(bufferReader);\n        } else if(responseCode === Constants.ResponseCodes.ChannelMsgRecv){\n            this.onChannelMsgRecvResponse(bufferReader);\n        } else if(responseCode === Constants.ResponseCodes.ContactsStart){\n            this.onContactsStartResponse(bufferReader);\n        } else if(responseCode === Constants.ResponseCodes.Contact){\n            this.onContactResponse(bufferReader);\n        } else if(responseCode === Constants.ResponseCodes.EndOfContacts){\n            this.onEndOfContactsResponse(bufferReader);\n        } else if(responseCode === Constants.ResponseCodes.Sent){\n            this.onSentResponse(bufferReader);\n        } else if(responseCode === Constants.ResponseCodes.ExportContact){\n            this.onExportContactResponse(bufferReader);\n        } else if(responseCode === Constants.ResponseCodes.BatteryVoltage){\n            this.onBatteryVoltageResponse(bufferReader);\n        } else if(responseCode === Constants.ResponseCodes.DeviceInfo){\n            this.onDeviceInfoResponse(bufferReader);\n        } else if(responseCode === Constants.ResponseCodes.PrivateKey){\n            this.onPrivateKeyResponse(bufferReader);\n        } else if(responseCode === Constants.ResponseCodes.Disabled){\n            this.onDisabledResponse(bufferReader);\n        } else if(responseCode === Constants.ResponseCodes.ChannelInfo){\n            this.onChannelInfoResponse(bufferReader);\n        } else if(responseCode === Constants.ResponseCodes.SignStart){\n            this.onSignStartResponse(bufferReader);\n        } else if(responseCode === Constants.ResponseCodes.Signature){\n            this.onSignatureResponse(bufferReader);\n        } else if(responseCode === Constants.PushCodes.Advert){\n            this.onAdvertPush(bufferReader);\n        } else if(responseCode === Constants.PushCodes.PathUpdated){\n            this.onPathUpdatedPush(bufferReader);\n        } else if(responseCode === Constants.PushCodes.SendConfirmed){\n            this.onSendConfirmedPush(bufferReader);\n        } else if(responseCode === Constants.PushCodes.MsgWaiting){\n            this.onMsgWaitingPush(bufferReader);\n        } else if(responseCode === Constants.PushCodes.RawData){\n            this.onRawDataPush(bufferReader);\n        } else if(responseCode === Constants.PushCodes.LoginSuccess){\n            this.onLoginSuccessPush(bufferReader);\n        } else if(responseCode === Constants.PushCodes.StatusResponse){\n            this.onStatusResponsePush(bufferReader);\n        } else if(responseCode === Constants.PushCodes.LogRxData){\n            this.onLogRxDataPush(bufferReader);\n        } else if(responseCode === Constants.PushCodes.TelemetryResponse){\n            this.onTelemetryResponsePush(bufferReader);\n        } else if(responseCode === Constants.PushCodes.TraceData){\n            this.onTraceDataPush(bufferReader);\n        } else if(responseCode === Constants.PushCodes.NewAdvert){\n            this.onNewAdvertPush(bufferReader);\n        } else if(responseCode === Constants.PushCodes.BinaryResponse){\n            this.onBinaryResponsePush(bufferReader);\n        } else {\n            console.log(`unhandled frame: code=${responseCode}`, frame);\n        }\n\n    }\n\n    onAdvertPush(bufferReader) {\n        this.emit(Constants.PushCodes.Advert, {\n            publicKey: bufferReader.readBytes(32),\n        });\n    }\n\n    onPathUpdatedPush(bufferReader) {\n        this.emit(Constants.PushCodes.PathUpdated, {\n            publicKey: bufferReader.readBytes(32),\n        });\n    }\n\n    onSendConfirmedPush(bufferReader) {\n        this.emit(Constants.PushCodes.SendConfirmed, {\n            ackCode: bufferReader.readUInt32LE(),\n            roundTrip: bufferReader.readUInt32LE(),\n        });\n    }\n\n    onMsgWaitingPush(bufferReader) {\n        this.emit(Constants.PushCodes.MsgWaiting, {\n\n        });\n    }\n\n    onRawDataPush(bufferReader) {\n        this.emit(Constants.PushCodes.RawData, {\n            lastSnr: bufferReader.readInt8() / 4,\n            lastRssi: bufferReader.readInt8(),\n            reserved: bufferReader.readByte(),\n            payload: bufferReader.readRemainingBytes(),\n        });\n    }\n\n    onLoginSuccessPush(bufferReader) {\n        this.emit(Constants.PushCodes.LoginSuccess, {\n            reserved: bufferReader.readByte(), // reserved\n            pubKeyPrefix: bufferReader.readBytes(6), // 6 bytes of public key this login success is from\n        });\n    }\n\n    onStatusResponsePush(bufferReader) {\n        this.emit(Constants.PushCodes.StatusResponse, {\n            reserved: bufferReader.readByte(), // reserved\n            pubKeyPrefix: bufferReader.readBytes(6), // 6 bytes of public key this status response is from\n            statusData: bufferReader.readRemainingBytes(),\n        });\n    }\n\n    onLogRxDataPush(bufferReader) {\n        this.emit(Constants.PushCodes.LogRxData, {\n            lastSnr: bufferReader.readInt8() / 4,\n            lastRssi: bufferReader.readInt8(),\n            raw: bufferReader.readRemainingBytes(),\n        });\n    }\n\n    onTelemetryResponsePush(bufferReader) {\n        this.emit(Constants.PushCodes.TelemetryResponse, {\n            reserved: bufferReader.readByte(), // reserved\n            pubKeyPrefix: bufferReader.readBytes(6), // 6 bytes of public key this telemetry response is from\n            lppSensorData: bufferReader.readRemainingBytes(),\n        });\n    }\n\n    onBinaryResponsePush(bufferReader) {\n        this.emit(Constants.PushCodes.BinaryResponse, {\n            reserved: bufferReader.readByte(), // reserved\n            tag: bufferReader.readUInt32LE(), // 4 bytes tag\n            responseData: bufferReader.readRemainingBytes(),\n        });\n    }\n\n    onTraceDataPush(bufferReader) {\n        const reserved = bufferReader.readByte();\n        const pathLen = bufferReader.readUInt8();\n        this.emit(Constants.PushCodes.TraceData, {\n            reserved: reserved,\n            pathLen: pathLen,\n            flags: bufferReader.readUInt8(),\n            tag: bufferReader.readUInt32LE(),\n            authCode: bufferReader.readUInt32LE(),\n            pathHashes: bufferReader.readBytes(pathLen),\n            pathSnrs: bufferReader.readBytes(pathLen),\n            lastSnr: bufferReader.readInt8() / 4,\n        });\n    }\n\n    onNewAdvertPush(bufferReader) {\n        this.emit(Constants.PushCodes.NewAdvert, {\n            publicKey: bufferReader.readBytes(32),\n            type: bufferReader.readByte(),\n            flags: bufferReader.readByte(),\n            outPathLen: bufferReader.readInt8(),\n            outPath: bufferReader.readBytes(64),\n            advName: bufferReader.readCString(32),\n            lastAdvert: bufferReader.readUInt32LE(),\n            advLat: bufferReader.readUInt32LE(),\n            advLon: bufferReader.readUInt32LE(),\n            lastMod: bufferReader.readUInt32LE(),\n        });\n    }\n\n    onOkResponse(bufferReader) {\n        this.emit(Constants.ResponseCodes.Ok, {\n\n        });\n    }\n\n    onErrResponse(bufferReader) {\n        const errCode = bufferReader.getRemainingBytesCount() > 0 ? bufferReader.readByte() : null;\n        this.emit(Constants.ResponseCodes.Err, {\n            errCode: errCode,\n        });\n    }\n\n    onContactsStartResponse(bufferReader) {\n        this.emit(Constants.ResponseCodes.ContactsStart, {\n            count: bufferReader.readUInt32LE(),\n        });\n    }\n\n    onContactResponse(bufferReader) {\n        this.emit(Constants.ResponseCodes.Contact, {\n            publicKey: bufferReader.readBytes(32),\n            type: bufferReader.readByte(),\n            flags: bufferReader.readByte(),\n            outPathLen: bufferReader.readInt8(),\n            outPath: bufferReader.readBytes(64),\n            advName: bufferReader.readCString(32),\n            lastAdvert: bufferReader.readUInt32LE(),\n            advLat: bufferReader.readUInt32LE(),\n            advLon: bufferReader.readUInt32LE(),\n            lastMod: bufferReader.readUInt32LE(),\n        });\n    }\n\n    onEndOfContactsResponse(bufferReader) {\n        this.emit(Constants.ResponseCodes.EndOfContacts, {\n            mostRecentLastmod: bufferReader.readUInt32LE(),\n        });\n    }\n\n    onSentResponse(bufferReader) {\n        this.emit(Constants.ResponseCodes.Sent, {\n            result: bufferReader.readInt8(),\n            expectedAckCrc: bufferReader.readUInt32LE(),\n            estTimeout: bufferReader.readUInt32LE(),\n        });\n    }\n\n    onExportContactResponse(bufferReader) {\n        this.emit(Constants.ResponseCodes.ExportContact, {\n            advertPacketBytes: bufferReader.readRemainingBytes(),\n        });\n    }\n\n    onBatteryVoltageResponse(bufferReader) {\n        this.emit(Constants.ResponseCodes.BatteryVoltage, {\n            batteryMilliVolts: bufferReader.readUInt16LE(),\n        });\n    }\n\n    onDeviceInfoResponse(bufferReader) {\n        this.emit(Constants.ResponseCodes.DeviceInfo, {\n            firmwareVer: bufferReader.readInt8(),\n            reserved: bufferReader.readBytes(6), // reserved\n            firmware_build_date: bufferReader.readCString(12), // eg. \"19 Feb 2025\"\n            manufacturerModel: bufferReader.readString(), // remainder of frame\n        });\n    }\n\n    onPrivateKeyResponse(bufferReader) {\n        this.emit(Constants.ResponseCodes.PrivateKey, {\n            privateKey: bufferReader.readBytes(64),\n        });\n    }\n\n    onDisabledResponse(bufferReader) {\n        this.emit(Constants.ResponseCodes.Disabled, {\n\n        });\n    }\n\n    onChannelInfoResponse(bufferReader) {\n\n        const idx = bufferReader.readUInt8();\n        const name = bufferReader.readCString(32);\n        const remainingBytesLength = bufferReader.getRemainingBytesCount();\n\n        // 128-bit keys\n        if(remainingBytesLength === 16){\n            this.emit(Constants.ResponseCodes.ChannelInfo, {\n                channelIdx: idx,\n                name: name,\n                secret: bufferReader.readBytes(remainingBytesLength),\n            });\n        } else {\n            console.log(`ChannelInfo has unexpected key length: ${remainingBytesLength}`);\n        }\n\n    }\n\n    onSignStartResponse(bufferReader) {\n        this.emit(Constants.ResponseCodes.SignStart, {\n            reserved: bufferReader.readByte(),\n            maxSignDataLen: bufferReader.readUInt32LE(),\n        });\n    }\n\n    onSignatureResponse(bufferReader) {\n        this.emit(Constants.ResponseCodes.Signature, {\n            signature: bufferReader.readBytes(64),\n        });\n    }\n\n    onSelfInfoResponse(bufferReader) {\n        this.emit(Constants.ResponseCodes.SelfInfo, {\n            type: bufferReader.readByte(),\n            txPower: bufferReader.readByte(),\n            maxTxPower: bufferReader.readByte(),\n            publicKey: bufferReader.readBytes(32),\n            advLat: bufferReader.readInt32LE(),\n            advLon: bufferReader.readInt32LE(),\n            reserved: bufferReader.readBytes(3),\n            manualAddContacts: bufferReader.readByte(),\n            radioFreq: bufferReader.readUInt32LE(),\n            radioBw: bufferReader.readUInt32LE(),\n            radioSf: bufferReader.readByte(),\n            radioCr: bufferReader.readByte(),\n            name: bufferReader.readString(),\n        });\n    }\n\n    onCurrTimeResponse(bufferReader) {\n        this.emit(Constants.ResponseCodes.CurrTime, {\n            epochSecs: bufferReader.readUInt32LE(),\n        });\n    }\n\n    onNoMoreMessagesResponse(bufferReader) {\n        this.emit(Constants.ResponseCodes.NoMoreMessages, {\n\n        });\n    }\n\n    onContactMsgRecvResponse(bufferReader) {\n        this.emit(Constants.ResponseCodes.ContactMsgRecv, {\n            pubKeyPrefix: bufferReader.readBytes(6),\n            pathLen: bufferReader.readByte(),\n            txtType: bufferReader.readByte(),\n            senderTimestamp: bufferReader.readUInt32LE(),\n            text: bufferReader.readString(),\n        });\n    }\n\n    onChannelMsgRecvResponse(bufferReader) {\n        this.emit(Constants.ResponseCodes.ChannelMsgRecv, {\n            channelIdx: bufferReader.readInt8(), // reserved (0 for now, ie. 'public')\n            pathLen: bufferReader.readByte(), // 0xFF if was sent direct, otherwise hop count for flood-mode\n            txtType: bufferReader.readByte(),\n            senderTimestamp: bufferReader.readUInt32LE(),\n            text: bufferReader.readString(),\n        });\n    }\n\n    getSelfInfo(timeoutMillis = null) {\n        return new Promise(async (resolve, reject) => {\n\n            // listen for response\n            this.once(Constants.ResponseCodes.SelfInfo, (selfInfo) => {\n                resolve(selfInfo);\n            });\n\n            // timeout after provided milliseconds if device did not respond\n            if(timeoutMillis != null){\n                setTimeout(reject, timeoutMillis);\n            }\n\n            // request self info\n            await this.sendCommandAppStart();\n\n        });\n    }\n\n    async sendAdvert(type) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive ok\n                const onOk = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve();\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Ok, onOk);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // send advert\n                await this.sendCommandSendSelfAdvert(type);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    async sendFloodAdvert() {\n        return await this.sendAdvert(Constants.SelfAdvertTypes.Flood);\n    }\n\n    async sendZeroHopAdvert() {\n        return await this.sendAdvert(Constants.SelfAdvertTypes.ZeroHop);\n    }\n\n    setAdvertName(name) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive ok\n                const onOk = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve();\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Ok, onOk);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // set advert name\n                await this.sendCommandSetAdvertName(name);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    setAdvertLatLong(latitude, longitude) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive ok\n                const onOk = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve();\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Ok, onOk);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // set advert lat lon\n                await this.sendCommandSetAdvertLatLon(latitude, longitude);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    setTxPower(txPower) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive ok\n                const onOk = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve();\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Ok, onOk);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // set tx power\n                await this.sendCommandSetTxPower(txPower);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    setRadioParams(radioFreq, radioBw, radioSf, radioCr) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive ok\n                const onOk = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve();\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Ok, onOk);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // set tx power\n                await this.sendCommandSetRadioParams(radioFreq, radioBw, radioSf, radioCr);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    getContacts() {\n        return new Promise(async (resolve, reject) => {\n\n            // add contacts we receive to a list\n            const contacts = [];\n            const onContactReceived = (contact) => {\n                contacts.push(contact);\n            }\n\n            // listen for contacts\n            this.on(Constants.ResponseCodes.Contact, onContactReceived);\n\n            // there's no more contacts to receive, stop listening and resolve the promise\n            this.once(Constants.ResponseCodes.EndOfContacts, () => {\n                this.off(Constants.ResponseCodes.Contact, onContactReceived);\n                resolve(contacts);\n            });\n\n            // request contacts from device\n            await this.sendCommandGetContacts();\n\n        });\n    }\n\n    async findContactByName(name) {\n\n        // get contacts\n        const contacts = await this.getContacts();\n\n        // find first contact matching name exactly\n        return contacts.find((contact) => {\n            return contact.advName === name;\n        });\n\n    }\n\n    async findContactByPublicKeyPrefix(pubKeyPrefix) {\n\n        // get contacts\n        const contacts = await this.getContacts();\n\n        // find first contact matching pub key prefix\n        return contacts.find((contact) => {\n            const contactPubKeyPrefix = contact.publicKey.subarray(0, pubKeyPrefix.length);\n            return BufferUtils.areBuffersEqual(pubKeyPrefix, contactPubKeyPrefix);\n        });\n\n    }\n\n    sendTextMessage(contactPublicKey, text, type) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive sent response\n                const onSent = (response) => {\n                    this.off(Constants.ResponseCodes.Sent, onSent);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve(response);\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.Sent, onSent);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Sent, onSent);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // compose message\n                const txtType = type ?? Constants.TxtTypes.Plain;\n                const attempt = 0;\n                const senderTimestamp = Math.floor(Date.now() / 1000);\n\n                // send message\n                await this.sendCommandSendTxtMsg(txtType, attempt, senderTimestamp, contactPublicKey, text);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    sendChannelTextMessage(channelIdx, text) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive ok\n                const onOk = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve();\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Ok, onOk);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // compose message\n                const txtType = Constants.TxtTypes.Plain;\n                const senderTimestamp = Math.floor(Date.now() / 1000);\n\n                // send message\n                await this.sendCommandSendChannelTxtMsg(txtType, channelIdx, senderTimestamp, text);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    syncNextMessage() {\n        return new Promise(async (resolve, reject) => {\n\n            // resolve promise when we receive a contact message\n            const onContactMessageReceived = (message) => {\n                this.off(Constants.ResponseCodes.ContactMsgRecv, onContactMessageReceived);\n                this.off(Constants.ResponseCodes.ChannelMsgRecv, onChannelMessageReceived);\n                this.off(Constants.ResponseCodes.NoMoreMessages, onNoMoreMessagesReceived);\n                resolve({\n                    contactMessage: message,\n                });\n            }\n\n            // resolve promise when we receive a channel message\n            const onChannelMessageReceived = (message) => {\n                this.off(Constants.ResponseCodes.ContactMsgRecv, onContactMessageReceived);\n                this.off(Constants.ResponseCodes.ChannelMsgRecv, onChannelMessageReceived);\n                this.off(Constants.ResponseCodes.NoMoreMessages, onNoMoreMessagesReceived);\n                resolve({\n                    channelMessage: message,\n                });\n            }\n\n            // resolve promise when we have no more messages to receive\n            const onNoMoreMessagesReceived = () => {\n                this.off(Constants.ResponseCodes.ContactMsgRecv, onContactMessageReceived);\n                this.off(Constants.ResponseCodes.ChannelMsgRecv, onChannelMessageReceived);\n                this.off(Constants.ResponseCodes.NoMoreMessages, onNoMoreMessagesReceived);\n                resolve(null);\n            }\n\n            // listen for events\n            this.once(Constants.ResponseCodes.ContactMsgRecv, onContactMessageReceived);\n            this.once(Constants.ResponseCodes.ChannelMsgRecv, onChannelMessageReceived);\n            this.once(Constants.ResponseCodes.NoMoreMessages, onNoMoreMessagesReceived);\n\n            // sync next message from device\n            await this.sendCommandSyncNextMessage();\n\n        });\n    }\n\n    async getWaitingMessages() {\n\n        const waitingMessages = [];\n\n        while(true){\n\n            // get next message, otherwise stop if nothing is returned\n            const message = await this.syncNextMessage();\n            if(!message){\n                break;\n            }\n\n            // add to waiting messages list\n            waitingMessages.push(message);\n\n        }\n\n        return waitingMessages;\n\n    }\n\n    getDeviceTime() {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive sent response\n                const onCurrTime = (response) => {\n                    this.off(Constants.ResponseCodes.CurrTime, onCurrTime);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve(response);\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.CurrTime, onCurrTime);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.CurrTime, onCurrTime);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // get device time\n                await this.sendCommandGetDeviceTime();\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    setDeviceTime(epochSecs) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive ok\n                const onOk = (response) => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve(response);\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Ok, onOk);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // set device time\n                await this.sendCommandSetDeviceTime(epochSecs);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    async syncDeviceTime() {\n        await this.setDeviceTime(Math.floor(Date.now() / 1000));\n    }\n\n    importContact(advertPacketBytes) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive ok\n                const onOk = (response) => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve(response);\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Ok, onOk);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // import contact\n                await this.sendCommandImportContact(advertPacketBytes);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    exportContact(pubKey = null) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive export contact response\n                const onExportContact = (response) => {\n                    this.off(Constants.ResponseCodes.ExportContact, onExportContact);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve(response);\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.ExportContact, onExportContact);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.ExportContact, onExportContact);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // export contact\n                await this.sendCommandExportContact(pubKey);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    shareContact(pubKey) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive ok\n                const onOk = (response) => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve(response);\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Ok, onOk);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // share contact\n                await this.sendCommandShareContact(pubKey);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    removeContact(pubKey) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive ok\n                const onOk = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve();\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Ok, onOk);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // remove contact\n                await this.sendCommandRemoveContact(pubKey);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    addOrUpdateContact(publicKey, type, flags, outPathLen, outPath, advName, lastAdvert, advLat, advLon) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive ok\n                const onOk = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve();\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Ok, onOk);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // add or update contact\n                await this.sendCommandAddUpdateContact(publicKey, type, flags, outPathLen, outPath, advName, lastAdvert, advLat, advLon);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    setContactPath(contact, path) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // create empty out path\n                const maxPathLength = 64;\n                const outPath = new Uint8Array(maxPathLength);\n\n                // fill out path with the provided path\n                for(var i = 0; i < path.length && i < maxPathLength; i++){\n                    outPath[i] = path[i];\n                }\n\n                // update contact details with new path and path length\n                contact.outPathLen = path.length;\n                contact.outPath = outPath;\n\n                // update contact\n                return await this.addOrUpdateContact(contact.publicKey, contact.type, contact.flags, contact.outPathLen, contact.outPath, contact.advName, contact.lastAdvert, contact.advLat, contact.advLon);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    resetPath(pubKey) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive ok\n                const onOk = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve();\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Ok, onOk);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // reset path\n                await this.sendCommandResetPath(pubKey);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    reboot() {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // assume device rebooted after a short delay\n                setTimeout(() => {\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve();\n                }, 1000);\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // reboot\n                await this.sendCommandReboot();\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    getBatteryVoltage() {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive battery voltage\n                const onBatteryVoltage = (response) => {\n                    this.off(Constants.ResponseCodes.BatteryVoltage, onBatteryVoltage);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve(response);\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.BatteryVoltage, onBatteryVoltage);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.BatteryVoltage, onBatteryVoltage);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // get battery voltage\n                await this.sendCommandGetBatteryVoltage();\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    deviceQuery(appTargetVer) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive device info\n                const onDeviceInfo = (response) => {\n                    this.off(Constants.ResponseCodes.DeviceInfo, onDeviceInfo);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve(response);\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.DeviceInfo, onDeviceInfo);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.DeviceInfo, onDeviceInfo);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // query device\n                await this.sendCommandDeviceQuery(appTargetVer);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    exportPrivateKey() {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive private Key\n                const onPrivateKey = (response) => {\n                    this.off(Constants.ResponseCodes.PrivateKey, onPrivateKey);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    this.off(Constants.ResponseCodes.Disabled, onDisabled);\n                    resolve(response);\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.PrivateKey, onPrivateKey);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    this.off(Constants.ResponseCodes.Disabled, onDisabled);\n                    reject();\n                }\n\n                // reject promise when we receive disabled\n                const onDisabled = () => {\n                    this.off(Constants.ResponseCodes.PrivateKey, onPrivateKey);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    this.off(Constants.ResponseCodes.Disabled, onDisabled);\n                    reject(\"disabled\");\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.PrivateKey, onPrivateKey);\n                this.once(Constants.ResponseCodes.Err, onErr);\n                this.once(Constants.ResponseCodes.Disabled, onDisabled);\n\n                // export private key\n                await this.sendCommandExportPrivateKey();\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    importPrivateKey(privateKey) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive ok\n                const onOk = (response) => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    this.off(Constants.ResponseCodes.Disabled, onDisabled);\n                    resolve(response);\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    this.off(Constants.ResponseCodes.Disabled, onDisabled);\n                    reject();\n                }\n\n                // reject promise when we receive disabled\n                const onDisabled = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    this.off(Constants.ResponseCodes.Disabled, onDisabled);\n                    reject(\"disabled\");\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Ok, onOk);\n                this.once(Constants.ResponseCodes.Err, onErr);\n                this.once(Constants.ResponseCodes.Disabled, onDisabled);\n\n                // import private key\n                await this.sendCommandImportPrivateKey(privateKey);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    login(contactPublicKey, password, extraTimeoutMillis = 1000) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // get public key prefix we expect in the login response\n                const publicKeyPrefix = contactPublicKey.subarray(0, 6);\n\n                // listen for sent response so we can get estimated timeout\n                var timeoutHandler = null;\n                const onSent = (response) => {\n\n                    // remove error listener since we received sent response\n                    this.off(Constants.ResponseCodes.Err, onErr);\n\n                    // reject login request as timed out after estimated delay, plus a bit extra\n                    const estTimeout = response.estTimeout + extraTimeoutMillis;\n                    timeoutHandler = setTimeout(() => {\n                        this.off(Constants.ResponseCodes.Err, onErr);\n                        this.off(Constants.ResponseCodes.Sent, onSent);\n                        this.off(Constants.PushCodes.LoginSuccess, onLoginSuccess);\n                        reject(\"timeout\");\n                    }, estTimeout);\n\n                }\n\n                // resolve promise when we receive login success push code\n                const onLoginSuccess = (response) => {\n\n                    // make sure login success response is for this login request\n                    if(!BufferUtils.areBuffersEqual(publicKeyPrefix, response.pubKeyPrefix)){\n                        console.log(\"onLoginSuccess is not for this login request, ignoring...\");\n                        return;\n                    }\n\n                    // login successful\n                    clearTimeout(timeoutHandler);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    this.off(Constants.ResponseCodes.Sent, onSent);\n                    this.off(Constants.PushCodes.LoginSuccess, onLoginSuccess);\n                    resolve(response);\n\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    clearTimeout(timeoutHandler);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    this.off(Constants.ResponseCodes.Sent, onSent);\n                    this.off(Constants.PushCodes.LoginSuccess, onLoginSuccess);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Err, onErr);\n                this.once(Constants.ResponseCodes.Sent, onSent);\n                this.once(Constants.PushCodes.LoginSuccess, onLoginSuccess);\n\n                // login\n                await this.sendCommandSendLogin(contactPublicKey, password);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    getStatus(contactPublicKey, extraTimeoutMillis = 1000) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // get public key prefix we expect in the status response\n                const publicKeyPrefix = contactPublicKey.subarray(0, 6);\n\n                // listen for sent response so we can get estimated timeout\n                var timeoutHandler = null;\n                const onSent = (response) => {\n\n                    // remove error listener since we received sent response\n                    this.off(Constants.ResponseCodes.Err, onErr);\n\n                    // reject login request as timed out after estimated delay, plus a bit extra\n                    const estTimeout = response.estTimeout + extraTimeoutMillis;\n                    timeoutHandler = setTimeout(() => {\n                        this.off(Constants.ResponseCodes.Err, onErr);\n                        this.off(Constants.ResponseCodes.Sent, onSent);\n                        this.off(Constants.PushCodes.StatusResponse, onStatusResponsePush);\n                        reject(\"timeout\");\n                    }, estTimeout);\n\n                }\n\n                // resolve promise when we receive status response push code\n                const onStatusResponsePush = (response) => {\n\n                    // make sure login success response is for this login request\n                    if(!BufferUtils.areBuffersEqual(publicKeyPrefix, response.pubKeyPrefix)){\n                        console.log(\"onStatusResponsePush is not for this status request, ignoring...\");\n                        return;\n                    }\n\n                    // status request successful\n                    clearTimeout(timeoutHandler);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    this.off(Constants.ResponseCodes.Sent, onSent);\n                    this.off(Constants.PushCodes.StatusResponse, onStatusResponsePush);\n\n                    // parse repeater stats from status data\n                    const bufferReader = new BufferReader(response.statusData);\n                    const repeaterStats = {\n                        batt_milli_volts: bufferReader.readUInt16LE(), // uint16_t batt_milli_volts;\n                        curr_tx_queue_len: bufferReader.readUInt16LE(), // uint16_t curr_tx_queue_len;\n                        noise_floor: bufferReader.readInt16LE(), // int16_t noise_floor;\n                        last_rssi: bufferReader.readInt16LE(), // int16_t  last_rssi;\n                        n_packets_recv: bufferReader.readUInt32LE(), // uint32_t n_packets_recv;\n                        n_packets_sent: bufferReader.readUInt32LE(), // uint32_t n_packets_sent;\n                        total_air_time_secs: bufferReader.readUInt32LE(), // uint32_t total_air_time_secs;\n                        total_up_time_secs: bufferReader.readUInt32LE(), // uint32_t total_up_time_secs;\n                        n_sent_flood: bufferReader.readUInt32LE(), // uint32_t n_sent_flood\n                        n_sent_direct: bufferReader.readUInt32LE(), // uint32_t n_sent_direct\n                        n_recv_flood: bufferReader.readUInt32LE(), // uint32_t n_recv_flood\n                        n_recv_direct: bufferReader.readUInt32LE(), // uint32_t n_recv_direct\n                        err_events: bufferReader.readUInt16LE(), // uint16_t err_events\n                        last_snr: bufferReader.readInt16LE(), // int16_t last_snr\n                        n_direct_dups: bufferReader.readUInt16LE(), // uint16_t n_direct_dups\n                        n_flood_dups: bufferReader.readUInt16LE(), // uint16_t n_flood_dups\n                    }\n\n                    resolve(repeaterStats);\n\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    clearTimeout(timeoutHandler);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    this.off(Constants.ResponseCodes.Sent, onSent);\n                    this.off(Constants.PushCodes.StatusResponse, onStatusResponsePush);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Err, onErr);\n                this.once(Constants.ResponseCodes.Sent, onSent);\n                this.once(Constants.PushCodes.StatusResponse, onStatusResponsePush);\n\n                // request status\n                await this.sendCommandSendStatusReq(contactPublicKey);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    getTelemetry(contactPublicKey, extraTimeoutMillis = 1000) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // get public key prefix we expect in the telemetry response\n                const publicKeyPrefix = contactPublicKey.subarray(0, 6);\n\n                // listen for sent response so we can get estimated timeout\n                var timeoutHandler = null;\n                const onSent = (response) => {\n\n                    // remove error listener since we received sent response\n                    this.off(Constants.ResponseCodes.Err, onErr);\n\n                    // reject as timed out after estimated delay, plus a bit extra\n                    const estTimeout = response.estTimeout + extraTimeoutMillis;\n                    timeoutHandler = setTimeout(() => {\n                        this.off(Constants.ResponseCodes.Err, onErr);\n                        this.off(Constants.ResponseCodes.Sent, onSent);\n                        this.off(Constants.PushCodes.TelemetryResponse, onTelemetryResponsePush);\n                        reject(\"timeout\");\n                    }, estTimeout);\n\n                }\n\n                // resolve promise when we receive telemetry response push code\n                const onTelemetryResponsePush = (response) => {\n\n                    // make sure telemetry response is for this telemetry request\n                    if(!BufferUtils.areBuffersEqual(publicKeyPrefix, response.pubKeyPrefix)){\n                        console.log(\"onTelemetryResponsePush is not for this telemetry request, ignoring...\");\n                        return;\n                    }\n\n                    // telemetry request successful\n                    clearTimeout(timeoutHandler);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    this.off(Constants.ResponseCodes.Sent, onSent);\n                    this.off(Constants.PushCodes.TelemetryResponse, onTelemetryResponsePush);\n\n                    resolve(response);\n\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    clearTimeout(timeoutHandler);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    this.off(Constants.ResponseCodes.Sent, onSent);\n                    this.off(Constants.PushCodes.TelemetryResponse, onTelemetryResponsePush);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Err, onErr);\n                this.once(Constants.ResponseCodes.Sent, onSent);\n                this.once(Constants.PushCodes.TelemetryResponse, onTelemetryResponsePush);\n\n                // request telemetry\n                await this.sendCommandSendTelemetryReq(contactPublicKey);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    sendBinaryRequest(contactPublicKey, requestCodeAndParams, extraTimeoutMillis = 1000) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // we need the tag for this request (provided in sent listener), so we can listen for the response\n                var tag = null;\n\n                // listen for sent response so we can get estimated timeout\n                var timeoutHandler = null;\n                const onSent = (response) => {\n\n                    tag = response.expectedAckCrc;\n\n                    // remove error listener since we received sent response\n                    this.off(Constants.ResponseCodes.Err, onErr);\n\n                    // reject as timed out after estimated delay, plus a bit extra\n                    const estTimeout = response.estTimeout + extraTimeoutMillis;\n                    timeoutHandler = setTimeout(() => {\n                        this.off(Constants.ResponseCodes.Err, onErr);\n                        this.off(Constants.ResponseCodes.Sent, onSent);\n                        this.off(Constants.PushCodes.BinaryResponse, onBinaryResponsePush);\n                        reject(\"timeout\");\n                    }, estTimeout);\n\n                }\n\n                // resolve promise when we receive binary response push code\n                const onBinaryResponsePush = (response) => {\n\n                    // make sure tag matches\n                    if(tag !== response.tag){\n                        console.log(\"onBinaryResponse is not for this request tag, ignoring...\");\n                        return;\n                    }\n\n                    // binary request successful\n                    clearTimeout(timeoutHandler);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    this.off(Constants.ResponseCodes.Sent, onSent);\n                    this.off(Constants.PushCodes.BinaryResponse, onBinaryResponsePush);\n\n                    resolve(response.responseData);\n\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    clearTimeout(timeoutHandler);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    this.off(Constants.ResponseCodes.Sent, onSent);\n                    this.off(Constants.PushCodes.BinaryResponse, onBinaryResponsePush);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Err, onErr);\n                this.once(Constants.ResponseCodes.Sent, onSent);\n                this.once(Constants.PushCodes.BinaryResponse, onBinaryResponsePush);\n\n                // send binary request\n                await this.sendCommandSendBinaryReq(contactPublicKey, requestCodeAndParams);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    // @deprecated migrate to using tracePath instead. pingRepeaterZeroHop will be removed in a future update\n    pingRepeaterZeroHop(contactPublicKey, timeoutMillis) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // create raw data using custom packet\n                const bufferWriter = new BufferWriter();\n                bufferWriter.writeUInt32LE(Date.now()); // timestamp millis so every ping is unique\n                bufferWriter.writeBytes([0x70, 0x69, 0x6E, 0x67]); // \"ping\" as bytes\n                bufferWriter.writeBytes(contactPublicKey.subarray(0, 2)); // 2 bytes from the repeaters public key, so we don't use another repeaters ping response\n                const rawBytes = bufferWriter.toBytes();\n\n                var startMillis = Date.now();\n\n                // resolve promise when we receive expected response\n                const onLogRxDataPush = (response) => {\n\n                    // calculate round trip time\n                    const endMillis = Date.now();\n                    const durationMillis = endMillis - startMillis;\n\n                    // parse packet from rx data, and make sure it's expected type\n                    const packet = Packet.fromBytes(response.raw);\n                    if(packet.payload_type !== Packet.PAYLOAD_TYPE_RAW_CUSTOM){\n                        return;\n                    }\n\n                    // make sure the payload we sent, is the payload we received\n                    if(!BufferUtils.areBuffersEqual(packet.payload, rawBytes)){\n                        return;\n                    }\n\n                    // ping successful remove all listeners\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    this.off(Constants.PushCodes.LogRxData, onLogRxDataPush);\n\n                    // send back results\n                    resolve({\n                        rtt: durationMillis,\n                        snr: response.lastSnr,\n                        rssi: response.lastRssi,\n                    });\n\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    this.off(Constants.PushCodes.LogRxData, onLogRxDataPush);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Err, onErr);\n                this.on(Constants.PushCodes.LogRxData, onLogRxDataPush);\n\n                // check if a timeout was provided\n                if(timeoutMillis != null){\n                    setTimeout(() => {\n\n                        // stop listening for events\n                        this.off(Constants.ResponseCodes.Err, onErr);\n                        this.off(Constants.PushCodes.LogRxData, onLogRxDataPush);\n\n                        // reject since it timed out\n                        reject(\"timeout\");\n\n                    }, timeoutMillis);\n                }\n\n                // send raw data to repeater, for it to repeat zero hop\n                await this.sendCommandSendRawData([\n                    // we set the repeater we want to ping as the path\n                    // it should repeat our packet, and we can listen for it\n                    contactPublicKey.subarray(0, 1),\n                ], rawBytes);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    getChannel(channelIdx) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive channel info response\n                const onChannelInfoResponse = (response) => {\n                    this.off(Constants.ResponseCodes.ChannelInfo, onChannelInfoResponse);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve(response);\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.ChannelInfo, onChannelInfoResponse);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.ChannelInfo, onChannelInfoResponse);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // get channel\n                await this.sendCommandGetChannel(channelIdx);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    setChannel(channelIdx, name, secret) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive ok\n                const onOk = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve();\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Ok, onOk);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // set channel\n                await this.sendCommandSetChannel(channelIdx, name, secret);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    async deleteChannel(channelIdx) {\n        return await this.setChannel(channelIdx, \"\", new Uint8Array(16));\n    }\n\n    getChannels() {\n        return new Promise(async (resolve, reject) => {\n\n            // get channels until we get an error\n            var channelIdx = 0;\n            const channels = [];\n            while(true){\n\n                // try to get next channel\n                try {\n                    const channel = await this.getChannel(channelIdx);\n                    channels.push(channel);\n                } catch(e){\n                    break;\n                }\n\n                channelIdx++;\n\n            }\n\n            return resolve(channels);\n\n        });\n    }\n\n    async findChannelByName(name) {\n\n        // get channels\n        const channels = await this.getChannels();\n\n        // find first channel matching name exactly\n        return channels.find((channel) => {\n            return channel.name === name;\n        });\n\n    }\n\n    async findChannelBySecret(secret) {\n\n        // get channels\n        const channels = await this.getChannels();\n\n        // find first channel matching secret\n        return channels.find((channel) => {\n            return BufferUtils.areBuffersEqual(secret, channel.secret);\n        });\n\n    }\n\n    async sign(data) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                const chunkSize = 128;\n                const bufferReader = new BufferReader(data);\n\n                const sendNextChunk = async () =>  {\n\n                    // get next chunk\n                    var chunk;\n                    if(bufferReader.getRemainingBytesCount() >= chunkSize){\n                        chunk = bufferReader.readBytes(chunkSize);\n                    } else {\n                        chunk = bufferReader.readRemainingBytes();\n                    }\n\n                    // send chunk\n                    await this.sendCommandSignData(chunk);\n\n                }\n\n                // listen for ok to send next chunk\n                const onOk = async (response) => {\n\n                    // check if more chunks to send\n                    if(bufferReader.getRemainingBytesCount() > 0){\n                        await sendNextChunk();\n                        return;\n                    }\n\n                    // no more chunks to send, tell device we are done\n                    await this.sendCommandSignFinish();\n\n                }\n\n                // listen for sign start\n                const onSignStart = async (response) => {\n\n                    this.off(Constants.ResponseCodes.SignStart, onSignStart);\n\n                    // check if data to sign is too long\n                    if(bufferReader.getRemainingBytesCount() > response.maxSignDataLen){\n                        this.off(Constants.ResponseCodes.ok, onOk);\n                        this.off(Constants.ResponseCodes.err, onErr);\n                        this.off(Constants.ResponseCodes.SignStart, onSignStart);\n                        this.off(Constants.ResponseCodes.Signature, onSignature);\n                        reject(\"data_too_long\");\n                        return;\n                    }\n\n                    // start first chunk of data\n                    await sendNextChunk();\n\n                }\n\n                // resolve when we receive signature\n                const onSignature = (response) => {\n                    this.off(Constants.ResponseCodes.ok, onOk);\n                    this.off(Constants.ResponseCodes.err, onErr);\n                    this.off(Constants.ResponseCodes.SignStart, onSignStart);\n                    this.off(Constants.ResponseCodes.Signature, onSignature);\n                    resolve(response.signature);\n                }\n\n                // reject promise when we receive err\n                const onErr = (response) => {\n                    this.off(Constants.ResponseCodes.ok, onOk);\n                    this.off(Constants.ResponseCodes.err, onErr);\n                    this.off(Constants.ResponseCodes.SignStart, onSignStart);\n                    this.off(Constants.ResponseCodes.Signature, onSignature);\n                    reject(response);\n                }\n\n                // listen for events\n                this.on(Constants.ResponseCodes.Ok, onOk);\n                this.on(Constants.ResponseCodes.SignStart, onSignStart);\n                this.on(Constants.ResponseCodes.Signature, onSignature);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // request device to start signing data\n                await this.sendCommandSignStart();\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    tracePath(path, extraTimeoutMillis = 0) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // generate a random tag for this trace, so we can listen for the correct response\n                const tag = RandomUtils.getRandomInt(0, 4294967295);\n\n                // listen for sent response so we can get estimated timeout\n                var timeoutHandler = null;\n                const onSent = (response) => {\n\n                    // remove error listener since we received sent response\n                    this.off(Constants.ResponseCodes.Err, onErr);\n\n                    // reject trace request as timed out after estimated delay, plus a bit extra\n                    const estTimeout = response.estTimeout + extraTimeoutMillis;\n                    timeoutHandler = setTimeout(() => {\n                        this.off(Constants.ResponseCodes.Sent, onSent);\n                        this.off(Constants.PushCodes.TraceData, onTraceDataPush);\n                        this.off(Constants.ResponseCodes.Err, onErr);\n                        reject(\"timeout\");\n                    }, estTimeout);\n\n                }\n\n                // resolve promise when we receive trace data\n                const onTraceDataPush = (response) => {\n\n                    // make sure tag matches\n                    if(response.tag !== tag){\n                        console.log(\"ignoring trace data for a different trace request\");\n                        return;\n                    }\n\n                    // resolve\n                    clearTimeout(timeoutHandler);\n                    this.off(Constants.ResponseCodes.Sent, onSent);\n                    this.off(Constants.PushCodes.TraceData, onTraceDataPush);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve(response);\n\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    clearTimeout(timeoutHandler);\n                    this.off(Constants.ResponseCodes.Sent, onSent);\n                    this.off(Constants.PushCodes.TraceData, onTraceDataPush);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Sent, onSent);\n                this.on(Constants.PushCodes.TraceData, onTraceDataPush);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // trace path\n                await this.sendCommandSendTracePath(tag, 0, path);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    setOtherParams(manualAddContacts) {\n        return new Promise(async (resolve, reject) => {\n            try {\n\n                // resolve promise when we receive ok\n                const onOk = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    resolve();\n                }\n\n                // reject promise when we receive err\n                const onErr = () => {\n                    this.off(Constants.ResponseCodes.Ok, onOk);\n                    this.off(Constants.ResponseCodes.Err, onErr);\n                    reject();\n                }\n\n                // listen for events\n                this.once(Constants.ResponseCodes.Ok, onOk);\n                this.once(Constants.ResponseCodes.Err, onErr);\n\n                // set other params\n                await this.sendCommandSetOtherParams(manualAddContacts);\n\n            } catch(e) {\n                reject(e);\n            }\n        });\n    }\n\n    async setAutoAddContacts() {\n        return await this.setOtherParams(false);\n    }\n\n    async setManualAddContacts() {\n        return await this.setOtherParams(true);\n    }\n\n    // REQ_TYPE_GET_NEIGHBOURS from Repeater role\n    // https://github.com/meshcore-dev/MeshCore/pull/833\n    // Repeater must be running firmware v1.9.0+\n    async getNeighbours(publicKey,\n        count = 10,\n        offset = 0,\n        orderBy = 0, // 0=newest_to_oldest, 1=oldest_to_newest, 2=strongest_to_weakest, 3=weakest_to_strongest\n        pubKeyPrefixLength = 8,\n    ) {\n\n        // get neighbours:\n        // req_data[0] = REQ_TYPE_GET_NEIGHBOURS\n        // req_data[1] = request_version=0\n        // req_data[2] = count=10 how many neighbours to fetch\n        // req_data[3..4] = offset=0 (uint16_t)\n        // req_data[5] = order_by=0\n        // req_data[6] = pubkey_prefix_len=8\n        // req_data[7..10] = random blob (help hash)\n        const bufferWriter = new BufferWriter();\n        bufferWriter.writeByte(Constants.BinaryRequestTypes.GetNeighbours);\n        bufferWriter.writeByte(0); // request_version=0\n        bufferWriter.writeByte(count);\n        bufferWriter.writeUInt16LE(offset);\n        bufferWriter.writeByte(orderBy);\n        bufferWriter.writeByte(pubKeyPrefixLength);\n        bufferWriter.writeUInt32LE(RandomUtils.getRandomInt(0, 4294967295)); // 4 bytes random blob\n\n        // send binary request\n        const responseData = await this.sendBinaryRequest(publicKey, bufferWriter.toBytes());\n\n        // parse response\n        const bufferReader = new BufferReader(responseData);\n        const totalNeighboursCount = bufferReader.readUInt16LE();\n        const resultsCount = bufferReader.readUInt16LE();\n\n        // parse neighbours list\n        const neighbours = [];\n        for(var i = 0; i < resultsCount; i++){\n\n            // read info\n            const publicKeyPrefix = bufferReader.readBytes(pubKeyPrefixLength);\n            const heardSecondsAgo = bufferReader.readUInt32LE();\n            const snr = bufferReader.readInt8() / 4;\n\n            // add to list\n            neighbours.push({\n                publicKeyPrefix: publicKeyPrefix,\n                heardSecondsAgo: heardSecondsAgo,\n                snr: snr,\n            });\n\n        }\n\n        return {\n            totalNeighboursCount: totalNeighboursCount,\n            neighbours: neighbours,\n        };\n\n    }\n\n}\n\nexport default Connection;\n", "import BufferWriter from \"../buffer_writer.js\";\nimport BufferReader from \"../buffer_reader.js\";\nimport Constants from \"../constants.js\";\nimport Connection from \"./connection.js\";\n\nclass SerialConnection extends Connection {\n\n    constructor() {\n        super();\n        this.readBuffer = [];\n        if(this.constructor === SerialConnection){\n            throw new Error(\"SerialConnection is an abstract class and can't be instantiated.\");\n        }\n    }\n\n    async write(bytes) {\n        throw new Error(\"Not Implemented: write must be implemented by SerialConnection sub class.\");\n    }\n\n    async writeFrame(frameType, frameData) {\n\n        // create frame\n        const frame = new BufferWriter();\n\n        // add frame header\n        frame.writeByte(frameType);\n        frame.writeUInt16LE(frameData.length);\n\n        // add frame data\n        frame.writeBytes(frameData);\n\n        // write frame to device\n        await this.write(frame.toBytes());\n\n    }\n\n    async sendToRadioFrame(data) {\n        // write \"app to radio\" frame 0x3c \"<\"\n        this.emit(\"tx\", data);\n        await this.writeFrame(0x3c, data);\n    }\n\n    async onDataReceived(value) {\n\n        // append received bytes to read buffer\n        this.readBuffer = [\n            ...this.readBuffer,\n            ...value,\n        ];\n\n        // process read buffer while there is enough bytes for a frame header\n        // 3 bytes frame header = (1 byte frame type) + (2 bytes frame length as unsigned 16-bit little endian)\n        const frameHeaderLength = 3;\n        while(this.readBuffer.length >= frameHeaderLength){\n            try {\n\n                // extract frame header\n                const frameHeader = new BufferReader(this.readBuffer.slice(0, frameHeaderLength));\n\n                // ensure frame type supported\n                const frameType = frameHeader.readByte();\n                if(frameType !== Constants.SerialFrameTypes.Incoming && frameType !== Constants.SerialFrameTypes.Outgoing){\n                    // unexpected byte, lets skip it and try again\n                    this.readBuffer = this.readBuffer.slice(1);\n                    continue;\n                }\n\n                // ensure frame length valid\n                const frameLength = frameHeader.readUInt16LE();\n                if(!frameLength){\n                    // unexpected byte, lets skip it and try again\n                    this.readBuffer = this.readBuffer.slice(1);\n                    continue;\n                }\n\n                // check if we have received enough bytes for this frame, otherwise wait until more bytes received\n                const requiredLength = frameHeaderLength + frameLength;\n                if(this.readBuffer.length < requiredLength){\n                    break;\n                }\n\n                // get frame data, and remove it and its frame header from the read buffer\n                const frameData = this.readBuffer.slice(frameHeaderLength, requiredLength);\n                this.readBuffer = this.readBuffer.slice(requiredLength);\n\n                // handle received frame\n                this.onFrameReceived(frameData);\n\n            } catch(e) {\n                console.error(\"Failed to process frame\", e);\n                break;\n            }\n        }\n\n    }\n\n}\n\nexport default SerialConnection;\n", "import SerialConnection from \"./serial_connection.js\";\n\nclass WebSerialConnection extends SerialConnection {\n\n    constructor(serialPort) {\n\n        super();\n\n        this.serialPort = serialPort;\n        this.reader = serialPort.readable.getReader();\n        this.writable = serialPort.writable;\n        this.readLoop();\n\n        // listen for disconnect\n        this.serialPort.addEventListener(\"disconnect\", () => {\n            this.onDisconnected();\n        });\n\n        // fire connected callback after constructor has returned\n        setTimeout(async () => {\n            await this.onConnected();\n        }, 0);\n\n    }\n\n    static async open() {\n\n        // ensure browser supports web serial\n        if(!navigator.serial){\n            alert(\"Web Serial is not supported in this browser\");\n            return null;\n        }\n\n        // ask user to select device\n        const serialPort = await navigator.serial.requestPort({\n            filters: [],\n        });\n\n        // open port\n        await serialPort.open({\n            baudRate: 115200,\n        });\n\n        return new WebSerialConnection(serialPort);\n\n    }\n\n    async close() {\n\n        // release reader lock\n        try {\n            this.reader.releaseLock();\n        } catch(e) {\n            // console.log(\"failed to release lock on serial port readable, ignoring...\", e);\n        }\n\n        // close serial port\n        try {\n            await this.serialPort.close();\n        } catch(e) {\n            // console.log(\"failed to close serial port, ignoring...\", e);\n        }\n\n    }\n\n    /* override */ async write(bytes) {\n        const writer = this.writable.getWriter();\n        try {\n            await writer.write(new Uint8Array(bytes));\n        } finally {\n            writer.releaseLock();\n        }\n    }\n\n    async readLoop() {\n        try {\n            while(true){\n\n                // read bytes until reader indicates it's done\n                const { value, done } = await this.reader.read();\n                if(done){\n                    break;\n                }\n\n                // pass to super class handler\n                await this.onDataReceived(value);\n\n            }\n        } catch(error) {\n\n            // ignore error if reader was released\n            if(error instanceof TypeError){\n                return;\n            }\n\n            console.error('Error reading from serial port: ', error);\n\n        } finally {\n            this.reader.releaseLock();\n        }\n    }\n\n}\n\nexport default WebSerialConnection;\n", "// @ts-expect-error - meshcore.js doesn't have type definitions\nimport { WebSerialConnection, Constants } from '@liamcottle/meshcore.js';\n\n// DOM elements\nlet connectBtn: HTMLButtonElement;\nlet disconnectBtn: HTMLButtonElement;\nlet connectionStatusEl: HTMLElement;\nlet loadBtn: HTMLButtonElement;\nlet writeBtn: HTMLButtonElement;\nlet rebootBtn: HTMLButtonElement;\nlet statusLog: HTMLElement;\n\n// Config inputs\nlet radioNameInput: HTMLInputElement;\nlet nodeTypeSelect: HTMLSelectElement;\nlet privateKeyInput: HTMLInputElement;\nlet publicKeyInput: HTMLInputElement;\nlet latitudeInput: HTMLInputElement;\nlet longitudeInput: HTMLInputElement;\nlet frequencyInput: HTMLInputElement;\nlet bandwidthInput: HTMLInputElement;\nlet spreadingFactorInput: HTMLInputElement;\nlet codingRateInput: HTMLInputElement;\nlet txPowerInput: HTMLInputElement;\nlet maxTxPowerInput: HTMLInputElement;\nlet deviceTimeInput: HTMLInputElement;\nlet syncTimeBtn: HTMLButtonElement;\nlet usaPresetBtn: HTMLButtonElement;\nlet manualAddContactsCheckbox: HTMLInputElement;\nlet firmwareInfoEl: HTMLElement;\nlet modelInfoEl: HTMLElement;\nlet rxDelayInput: HTMLInputElement;\nlet advertIntervalInput: HTMLInputElement;\nlet multiAcksInput: HTMLInputElement;\nlet advertLocPolicySelect: HTMLSelectElement;\nlet telemetryBaseSelect: HTMLSelectElement;\nlet telemetryLocSelect: HTMLSelectElement;\nlet telemetryEnvSelect: HTMLSelectElement;\nlet blePinInput: HTMLInputElement;\n\n// State\nlet connection: typeof WebSerialConnection | null = null;\nlet timeIntervalId: number | null = null;\n\n// Track which fields have been modified since loading\nconst dirtyFields: Set<string> = new Set();\n\n// Hex validation and conversion\nfunction isValidHex(str: string): boolean {\n  return /^[0-9a-fA-F]*$/.test(str);\n}\n\nfunction hexToBytes(hex: string): Uint8Array {\n  const bytes = new Uint8Array(hex.length / 2);\n  for (let i = 0; i < bytes.length; i++) {\n    bytes[i] = parseInt(hex.substr(i * 2, 2), 16);\n  }\n  return bytes;\n}\n\nfunction bytesToHex(bytes: Uint8Array | number[]): string {\n  return Array.from(bytes)\n    .map((b) => b.toString(16).padStart(2, '0'))\n    .join('');\n}\n\n// Logging\nfunction log(message: string, type: 'info' | 'success' | 'error' | 'warn' = 'info'): void {\n  const timestamp = new Date().toLocaleTimeString('en-US', { hour12: false });\n  const line = document.createElement('div');\n  line.className = `log-${type}`;\n  line.textContent = `[${timestamp}] ${message}`;\n  statusLog.appendChild(line);\n  statusLog.scrollTop = statusLog.scrollHeight;\n}\n\n// Connection status UI\nfunction updateConnectionStatus(status: 'disconnected' | 'connecting' | 'connected'): void {\n  connectionStatusEl.className = `connection-status ${status}`;\n  const isConnected = status === 'connected';\n\n  switch (status) {\n    case 'disconnected':\n      connectionStatusEl.textContent = 'Disconnected';\n      connectBtn.disabled = false;\n      disconnectBtn.disabled = true;\n      loadBtn.disabled = true;\n      writeBtn.disabled = true;\n      rebootBtn.disabled = true;\n      break;\n    case 'connecting':\n      connectionStatusEl.textContent = 'Connecting...';\n      connectBtn.disabled = true;\n      disconnectBtn.disabled = true;\n      loadBtn.disabled = true;\n      writeBtn.disabled = true;\n      rebootBtn.disabled = true;\n      break;\n    case 'connected':\n      connectionStatusEl.textContent = 'Connected';\n      connectBtn.disabled = true;\n      disconnectBtn.disabled = false;\n      loadBtn.disabled = !isConnected;\n      writeBtn.disabled = !isConnected;\n      rebootBtn.disabled = !isConnected;\n      break;\n  }\n}\n\n// Types for meshcore.js responses\ninterface SelfInfoResponse {\n  type: number;\n  txPower: number;\n  maxTxPower: number;\n  publicKey: Uint8Array;\n  advLat: number;\n  advLon: number;\n  reserved: Uint8Array;\n  manualAddContacts: number;\n  radioFreq: number;\n  radioBw: number;\n  radioSf: number;\n  radioCr: number;\n  name: string;\n}\n\ninterface CurrTimeResponse {\n  epochSecs: number;\n}\n\ninterface PrivateKeyResponse {\n  privateKey: Uint8Array;\n}\n\ninterface DeviceInfoResponse {\n  firmwareVer: number;\n  reserved: Uint8Array;\n  firmware_build_date: string;\n  manufacturerModel: string;\n}\n\n// Command codes not exposed by meshcore.js\nconst CMD_SET_TUNING_PARAMS = 0x15;\nconst CMD_SET_DEVICE_PIN = 0x25;\nconst CMD_SET_OTHER_PARAMS = 0x26;\n\n// Helper to parse \"reserved\" bytes from SelfInfo which actually contain:\n// byte 0: multi_acks\n// byte 1: advert_loc_policy\n// byte 2: telemetry_mode (combined: base | (loc << 2) | (env << 4))\ninterface ParsedOtherParams {\n  multiAcks: number;\n  advertLocPolicy: number;\n  telemetryModeBase: number;\n  telemetryModeLoc: number;\n  telemetryModeEnv: number;\n}\n\nfunction parseReservedBytes(reserved: Uint8Array): ParsedOtherParams {\n  const multiAcks = reserved[0] || 0;\n  const advertLocPolicy = reserved[1] || 0;\n  const telemetryMode = reserved[2] || 0;\n\n  return {\n    multiAcks,\n    advertLocPolicy,\n    telemetryModeBase: telemetryMode & 0b11,\n    telemetryModeLoc: (telemetryMode >> 2) & 0b11,\n    telemetryModeEnv: (telemetryMode >> 4) & 0b11,\n  };\n}\n\n// Helper to send raw command bytes\nasync function sendRawCommand(conn: typeof WebSerialConnection, bytes: Uint8Array): Promise<void> {\n  await conn.sendToRadioFrame(bytes);\n}\n\n// Wait for a specific response code\nfunction waitForResponse<T>(\n  conn: typeof WebSerialConnection,\n  responseCode: number,\n  timeoutMs: number = 5000,\n): Promise<T | null> {\n  return new Promise((resolve) => {\n    const timeout = setTimeout(() => {\n      conn.off(responseCode, handler);\n      resolve(null);\n    }, timeoutMs);\n\n    const handler = (data: T) => {\n      clearTimeout(timeout);\n      conn.off(responseCode, handler);\n      resolve(data);\n    };\n\n    conn.on(responseCode, handler);\n  });\n}\n\n// Connect to radio\nasync function connectToRadio(): Promise<void> {\n  try {\n    updateConnectionStatus('connecting');\n    log('Opening serial connection...');\n\n    connection = await WebSerialConnection.open();\n    if (!connection) {\n      log('Connection cancelled or failed', 'error');\n      updateConnectionStatus('disconnected');\n      return;\n    }\n\n    // Handle disconnection\n    connection.on('disconnected', () => {\n      log('Disconnected from radio', 'warn');\n      updateConnectionStatus('disconnected');\n      connection = null;\n    });\n\n    await new Promise<void>((resolve, reject) => {\n      const timeout = setTimeout(() => reject(new Error('Connection timeout')), 10000);\n      connection.on('connected', () => {\n        clearTimeout(timeout);\n        log('Connected to radio', 'success');\n        updateConnectionStatus('connected');\n        resolve();\n      });\n    });\n  } catch (e) {\n    const msg = e instanceof Error ? e.message : String(e);\n    log(`Connection error: ${msg}`, 'error');\n    updateConnectionStatus('disconnected');\n    if (connection) {\n      try {\n        connection.close();\n      } catch {\n        // Ignore close errors\n      }\n      connection = null;\n    }\n  }\n}\n\n// Disconnect from radio\nfunction disconnectFromRadio(): void {\n  if (connection) {\n    connection.close();\n    connection = null;\n  }\n  log('Disconnected');\n  updateConnectionStatus('disconnected');\n}\n\n// Load all values from radio\nasync function loadFromRadio(): Promise<void> {\n  if (!connection) {\n    log('Not connected', 'error');\n    return;\n  }\n\n  log('Loading configuration from radio...', 'info');\n\n  try {\n    // Get self info (name, radio params, location, tx power)\n    log('Requesting self info...');\n    const selfInfoPromise = waitForResponse<SelfInfoResponse>(\n      connection,\n      Constants.ResponseCodes.SelfInfo,\n      5000,\n    );\n    await connection.sendCommandAppStart();\n    const selfInfo = await selfInfoPromise;\n\n    if (selfInfo) {\n      // Name\n      radioNameInput.value = selfInfo.name || '';\n      log(`Name: ${selfInfo.name || '(not set)'}`);\n\n      // Node type\n      nodeTypeSelect.value = String(selfInfo.type);\n      const nodeTypes = ['None', 'Chat', 'Repeater', 'Room'];\n      log(`Node type: ${nodeTypes[selfInfo.type] || selfInfo.type}`);\n\n      // Public key (read-only)\n      publicKeyInput.value = bytesToHex(selfInfo.publicKey);\n\n      // TX Power\n      txPowerInput.value = String(selfInfo.txPower);\n      maxTxPowerInput.value = String(selfInfo.maxTxPower);\n      log(`TX Power: ${selfInfo.txPower} dBm (max: ${selfInfo.maxTxPower})`);\n\n      // Manual add contacts\n      manualAddContactsCheckbox.checked = selfInfo.manualAddContacts === 1;\n      log(`Manual add contacts: ${selfInfo.manualAddContacts === 1 ? 'Yes' : 'No'}`);\n\n      // Parse the \"reserved\" bytes which contain multi_acks, advert_loc_policy, and telemetry_mode\n      const otherParams = parseReservedBytes(selfInfo.reserved);\n\n      // Multi acks\n      multiAcksInput.value = String(otherParams.multiAcks);\n      log(`Multi acks: ${otherParams.multiAcks}`);\n\n      // Advert location policy\n      advertLocPolicySelect.value = String(otherParams.advertLocPolicy);\n      const policyNames = ['Never', 'Always', 'Contacts Only'];\n      log(\n        `Advert loc policy: ${policyNames[otherParams.advertLocPolicy] || otherParams.advertLocPolicy}`,\n      );\n\n      // Telemetry modes\n      telemetryBaseSelect.value = String(otherParams.telemetryModeBase);\n      telemetryLocSelect.value = String(otherParams.telemetryModeLoc);\n      telemetryEnvSelect.value = String(otherParams.telemetryModeEnv);\n      const modeNames = ['Off', 'Local', 'On Request', 'Always'];\n      log(\n        `Telemetry: base=${modeNames[otherParams.telemetryModeBase]}, ` +\n          `loc=${modeNames[otherParams.telemetryModeLoc]}, ` +\n          `env=${modeNames[otherParams.telemetryModeEnv]}`,\n      );\n\n      // Location (advLat/advLon are stored as int * 1e6)\n      const lat = selfInfo.advLat / 1e6;\n      const lon = selfInfo.advLon / 1e6;\n      latitudeInput.value = lat !== 0 ? lat.toFixed(6) : '';\n      longitudeInput.value = lon !== 0 ? lon.toFixed(6) : '';\n      log(`Location: ${lat.toFixed(6)}, ${lon.toFixed(6)}`);\n\n      // Radio params (radioFreq/radioBw are stored as Hz * 1000, so /1000 for kHz, /1000000 for MHz)\n      const freqMHz = selfInfo.radioFreq / 1000; // stored as kHz\n      const bwKHz = selfInfo.radioBw / 1000; // stored as Hz\n      frequencyInput.value = freqMHz.toFixed(3);\n      bandwidthInput.value = bwKHz.toFixed(3);\n      spreadingFactorInput.value = String(selfInfo.radioSf);\n      codingRateInput.value = String(selfInfo.radioCr);\n      log(`Radio: ${freqMHz} MHz, BW ${bwKHz} kHz, SF${selfInfo.radioSf}, CR${selfInfo.radioCr}`);\n\n      log('Self info loaded', 'success');\n    } else {\n      log('Failed to get self info (timeout)', 'error');\n    }\n\n    // Get device time\n    log('Requesting device time...');\n    const timePromise = waitForResponse<CurrTimeResponse>(\n      connection,\n      Constants.ResponseCodes.CurrTime,\n      5000,\n    );\n    await connection.sendCommandGetDeviceTime();\n    const timeResp = await timePromise;\n\n    if (timeResp) {\n      deviceTimeInput.value = String(timeResp.epochSecs);\n      const date = new Date(timeResp.epochSecs * 1000);\n      log(`Device time: ${timeResp.epochSecs} (${date.toISOString()})`);\n      startTimeAutoIncrement();\n    } else {\n      log('Failed to get device time (timeout)', 'warn');\n    }\n\n    // Try to export private key\n    log('Requesting private key...');\n\n    // Listen for both PrivateKey and Disabled responses\n    const keyPromise = new Promise<\n      { type: 'key'; data: PrivateKeyResponse } | { type: 'disabled' } | null\n    >((resolve) => {\n      const timeout = setTimeout(() => {\n        connection.off(Constants.ResponseCodes.PrivateKey, keyHandler);\n        connection.off(Constants.ResponseCodes.Disabled, disabledHandler);\n        resolve(null);\n      }, 5000);\n\n      const keyHandler = (data: PrivateKeyResponse) => {\n        clearTimeout(timeout);\n        connection.off(Constants.ResponseCodes.PrivateKey, keyHandler);\n        connection.off(Constants.ResponseCodes.Disabled, disabledHandler);\n        resolve({ type: 'key', data });\n      };\n\n      const disabledHandler = () => {\n        clearTimeout(timeout);\n        connection.off(Constants.ResponseCodes.PrivateKey, keyHandler);\n        connection.off(Constants.ResponseCodes.Disabled, disabledHandler);\n        resolve({ type: 'disabled' });\n      };\n\n      connection.on(Constants.ResponseCodes.PrivateKey, keyHandler);\n      connection.on(Constants.ResponseCodes.Disabled, disabledHandler);\n    });\n\n    await connection.sendCommandExportPrivateKey();\n    const keyResp = await keyPromise;\n\n    if (keyResp?.type === 'key') {\n      const keyHex = bytesToHex(keyResp.data.privateKey);\n      privateKeyInput.value = keyHex;\n      log(`Private key: ${keyHex.substring(0, 16)}...`);\n    } else if (keyResp?.type === 'disabled') {\n      privateKeyInput.value = '';\n      privateKeyInput.placeholder = 'Export disabled on device';\n      log('Private key export is disabled on this device', 'warn');\n    } else {\n      log('Failed to get private key (timeout)', 'warn');\n    }\n\n    // Get device info\n    log('Requesting device info...');\n    const deviceInfoPromise = waitForResponse<DeviceInfoResponse>(\n      connection,\n      Constants.ResponseCodes.DeviceInfo,\n      5000,\n    );\n    await connection.sendCommandDeviceQuery(1);\n    const deviceInfo = await deviceInfoPromise;\n\n    if (deviceInfo) {\n      firmwareInfoEl.textContent = `v${deviceInfo.firmwareVer} (${deviceInfo.firmware_build_date})`;\n      modelInfoEl.textContent = deviceInfo.manufacturerModel || '-';\n      log(`Device: ${deviceInfo.manufacturerModel}, firmware v${deviceInfo.firmwareVer}`);\n    } else {\n      log('Failed to get device info (timeout)', 'warn');\n    }\n\n    // Clear dirty flags since we just loaded fresh values\n    clearDirtyFlags();\n    log('Configuration loaded successfully', 'success');\n  } catch (e) {\n    const msg = e instanceof Error ? e.message : String(e);\n    log(`Error loading configuration: ${msg}`, 'error');\n  }\n}\n\n// Write all values to radio\nasync function writeToRadio(): Promise<void> {\n  if (!connection) {\n    log('Not connected', 'error');\n    return;\n  }\n\n  if (dirtyFields.size === 0) {\n    log('No fields modified, nothing to write', 'info');\n    return;\n  }\n\n  log('Writing modified configuration to radio...', 'info');\n\n  try {\n    // Wait for OK response helper\n    const waitForOk = async (timeoutMs: number = 3000): Promise<boolean> => {\n      const resp = await waitForResponse<unknown>(\n        connection,\n        Constants.ResponseCodes.Ok,\n        timeoutMs,\n      );\n      return resp !== null;\n    };\n\n    // Set name (if modified)\n    if (dirtyFields.has('name')) {\n      const name = radioNameInput.value.trim();\n      if (name) {\n        log(`Setting name to: ${name}`);\n        await connection.sendCommandSetAdvertName(name);\n        if (await waitForOk()) {\n          log('Name set', 'success');\n        } else {\n          log('Failed to set name (no response)', 'error');\n        }\n      }\n    }\n\n    // Set node type (if modified) - uses SendSelfAdvert command\n    if (dirtyFields.has('nodeType')) {\n      const nodeType = parseInt(nodeTypeSelect.value);\n      const nodeTypes = ['None', 'Chat', 'Repeater', 'Room'];\n      log(`Setting node type to: ${nodeTypes[nodeType]}`);\n      await connection.sendCommandSendSelfAdvert(nodeType);\n      if (await waitForOk()) {\n        log('Node type set', 'success');\n      } else {\n        log('Failed to set node type (no response)', 'error');\n      }\n    }\n\n    // Set other params (if modified) - combines manual_add_contacts, telemetry modes, advert_loc_policy, multi_acks\n    if (dirtyFields.has('otherParams')) {\n      const manualAdd = manualAddContactsCheckbox.checked ? 1 : 0;\n      const multiAcks = parseInt(multiAcksInput.value) || 0;\n      const advertLocPolicy = parseInt(advertLocPolicySelect.value) || 0;\n      const telemetryBase = parseInt(telemetryBaseSelect.value) || 0;\n      const telemetryLoc = parseInt(telemetryLocSelect.value) || 0;\n      const telemetryEnv = parseInt(telemetryEnvSelect.value) || 0;\n\n      // Combine telemetry modes into single byte: base | (loc << 2) | (env << 4)\n      const telemetryMode =\n        (telemetryBase & 0b11) | ((telemetryLoc & 0b11) << 2) | ((telemetryEnv & 0b11) << 4);\n\n      log(\n        `Setting other params: manual_add=${manualAdd}, multi_acks=${multiAcks}, ` +\n          `advert_loc_policy=${advertLocPolicy}, telemetry=${telemetryMode}`,\n      );\n\n      // Build command: 0x26 + manual_add (1) + telemetry_mode (1) + advert_loc_policy (1) + multi_acks (1)\n      const cmd = new Uint8Array(5);\n      cmd[0] = CMD_SET_OTHER_PARAMS;\n      cmd[1] = manualAdd;\n      cmd[2] = telemetryMode;\n      cmd[3] = advertLocPolicy;\n      cmd[4] = multiAcks;\n\n      await sendRawCommand(connection, cmd);\n      if (await waitForOk()) {\n        log('Other params set', 'success');\n      } else {\n        log('Failed to set other params (no response)', 'error');\n      }\n    }\n\n    // Set private key (if modified and valid)\n    if (dirtyFields.has('privateKey')) {\n      const keyHex = privateKeyInput.value.trim().toLowerCase();\n      if (keyHex) {\n        if (keyHex.length !== 128) {\n          log(`Private key must be 64 bytes (128 hex chars), got ${keyHex.length}`, 'error');\n        } else if (!isValidHex(keyHex)) {\n          log('Private key contains invalid hex characters', 'error');\n        } else {\n          log('Setting private key...');\n          const keyBytes = hexToBytes(keyHex);\n          await connection.sendCommandImportPrivateKey(keyBytes);\n          if (await waitForOk()) {\n            log('Private key set', 'success');\n          } else {\n            log('Failed to set private key (no response or error)', 'error');\n          }\n        }\n      }\n    }\n\n    // Set radio params (if modified)\n    if (dirtyFields.has('radio')) {\n      const freq = parseFloat(frequencyInput.value);\n      const bw = parseFloat(bandwidthInput.value);\n      const sf = parseInt(spreadingFactorInput.value);\n      const cr = parseInt(codingRateInput.value);\n\n      if (!isNaN(freq) && !isNaN(bw) && !isNaN(sf) && !isNaN(cr)) {\n        log(`Setting radio params: ${freq} MHz, BW ${bw} kHz, SF${sf}, CR${cr}`);\n        // meshcore.js expects freq and bw in Hz*1000 units (so MHz*1000000 and kHz*1000)\n        await connection.sendCommandSetRadioParams(\n          Math.round(freq * 1000), // freq in kHz\n          Math.round(bw * 1000), // bw in Hz\n          sf,\n          cr,\n        );\n        if (await waitForOk()) {\n          log('Radio params set', 'success');\n        } else {\n          log('Failed to set radio params (no response)', 'error');\n        }\n      }\n    }\n\n    // Set TX power (if modified)\n    if (dirtyFields.has('txPower')) {\n      const txPower = parseInt(txPowerInput.value);\n      if (!isNaN(txPower)) {\n        log(`Setting TX power to: ${txPower} dBm`);\n        await connection.sendCommandSetTxPower(txPower);\n        if (await waitForOk()) {\n          log('TX power set', 'success');\n        } else {\n          log('Failed to set TX power (no response)', 'error');\n        }\n      }\n    }\n\n    // Set coordinates (if modified)\n    if (dirtyFields.has('location')) {\n      const lat = parseFloat(latitudeInput.value);\n      const lon = parseFloat(longitudeInput.value);\n\n      if (!isNaN(lat) && !isNaN(lon)) {\n        log(`Setting location to: ${lat.toFixed(6)}, ${lon.toFixed(6)}`);\n        // meshcore.js expects lat/lon as int32 * 1e6\n        await connection.sendCommandSetAdvertLatLon(Math.round(lat * 1e6), Math.round(lon * 1e6));\n        if (await waitForOk()) {\n          log('Location set', 'success');\n        } else {\n          log('Failed to set location (no response)', 'error');\n        }\n      }\n    }\n\n    // Set device time (if modified)\n    if (dirtyFields.has('time')) {\n      const deviceTime = parseInt(deviceTimeInput.value);\n      if (!isNaN(deviceTime)) {\n        log(`Setting device time to: ${deviceTime}`);\n        await connection.sendCommandSetDeviceTime(deviceTime);\n        if (await waitForOk()) {\n          log('Device time set', 'success');\n        } else {\n          log('Failed to set device time (no response)', 'error');\n        }\n      }\n    }\n\n    // Set tuning params (if modified)\n    if (dirtyFields.has('tuning')) {\n      const rxDelay = parseInt(rxDelayInput.value);\n      const advertInterval = parseInt(advertIntervalInput.value);\n\n      if (!isNaN(rxDelay) && !isNaN(advertInterval)) {\n        log(`Setting tuning: RX delay ${rxDelay}ms, advert interval ${advertInterval}s`);\n\n        // Build command: 0x15 + rx_delay (4 bytes LE) + advert_interval (4 bytes LE) + 2 reserved bytes\n        const cmd = new Uint8Array(11);\n        cmd[0] = CMD_SET_TUNING_PARAMS;\n        // rx_delay as little-endian uint32\n        cmd[1] = rxDelay & 0xff;\n        cmd[2] = (rxDelay >> 8) & 0xff;\n        cmd[3] = (rxDelay >> 16) & 0xff;\n        cmd[4] = (rxDelay >> 24) & 0xff;\n        // advert_interval as little-endian uint32\n        cmd[5] = advertInterval & 0xff;\n        cmd[6] = (advertInterval >> 8) & 0xff;\n        cmd[7] = (advertInterval >> 16) & 0xff;\n        cmd[8] = (advertInterval >> 24) & 0xff;\n        // 2 reserved bytes (already 0)\n\n        await sendRawCommand(connection, cmd);\n        if (await waitForOk()) {\n          log('Tuning params set', 'success');\n        } else {\n          log('Failed to set tuning params (no response)', 'error');\n        }\n      }\n    }\n\n    // Set BLE PIN (if modified)\n    if (dirtyFields.has('blePin')) {\n      const pin = parseInt(blePinInput.value);\n      if (!isNaN(pin) && pin >= 0 && pin <= 999999) {\n        log(`Setting BLE PIN to: ${pin}`);\n\n        // Build command: 0x25 + pin (4 bytes LE)\n        const cmd = new Uint8Array(5);\n        cmd[0] = CMD_SET_DEVICE_PIN;\n        cmd[1] = pin & 0xff;\n        cmd[2] = (pin >> 8) & 0xff;\n        cmd[3] = (pin >> 16) & 0xff;\n        cmd[4] = (pin >> 24) & 0xff;\n\n        await sendRawCommand(connection, cmd);\n        if (await waitForOk()) {\n          log('BLE PIN set', 'success');\n        } else {\n          log('Failed to set BLE PIN (no response)', 'error');\n        }\n      } else if (blePinInput.value.trim() !== '') {\n        log('Invalid BLE PIN (must be 0-999999)', 'warn');\n      }\n    }\n\n    // Clear dirty flags after successful write\n    clearDirtyFlags();\n    log('Configuration written successfully', 'success');\n  } catch (e) {\n    const msg = e instanceof Error ? e.message : String(e);\n    log(`Error writing configuration: ${msg}`, 'error');\n  }\n}\n\n// Reboot radio\nasync function rebootRadio(): Promise<void> {\n  if (!connection) {\n    log('Not connected', 'error');\n    return;\n  }\n\n  log('Rebooting radio...', 'warn');\n\n  try {\n    await connection.sendCommandReboot();\n    log('Reboot command sent. Radio will disconnect.', 'success');\n  } catch (e) {\n    const msg = e instanceof Error ? e.message : String(e);\n    log(`Error sending reboot command: ${msg}`, 'error');\n  }\n}\n\n// Start auto-incrementing the time field\nfunction startTimeAutoIncrement(): void {\n  // Clear any existing interval\n  if (timeIntervalId !== null) {\n    clearInterval(timeIntervalId);\n  }\n\n  // Increment the time field every second\n  timeIntervalId = window.setInterval(() => {\n    const currentValue = parseInt(deviceTimeInput.value);\n    if (!isNaN(currentValue)) {\n      deviceTimeInput.value = String(currentValue + 1);\n    }\n  }, 1000);\n}\n\n// Clear all dirty flags (called after loading)\nfunction clearDirtyFlags(): void {\n  dirtyFields.clear();\n}\n\n// Mark a field as dirty\nfunction markDirty(fieldName: string): void {\n  dirtyFields.add(fieldName);\n}\n\n// Sync time button handler\nfunction syncCurrentTime(): void {\n  const now = Math.floor(Date.now() / 1000);\n  deviceTimeInput.value = String(now);\n  log(`Set time to current: ${now} (${new Date().toISOString()})`);\n  markDirty('time');\n  startTimeAutoIncrement();\n}\n\n// USA preset button handler\nfunction applyUsaPreset(): void {\n  frequencyInput.value = '910.525';\n  bandwidthInput.value = '62.5';\n  spreadingFactorInput.value = '7';\n  codingRateInput.value = '5';\n  txPowerInput.value = '22';\n  markDirty('radio');\n  markDirty('txPower');\n  log('Applied USA preset: 910.525 MHz, BW 62.5 kHz, SF7, CR5, 22 dBm');\n}\n\n// Private key input validation - only allow hex characters\nfunction validateHexInput(event: Event): void {\n  const input = event.target as HTMLInputElement;\n  const cleaned = input.value.replace(/[^0-9a-fA-F]/g, '').toLowerCase();\n  if (cleaned !== input.value) {\n    input.value = cleaned;\n  }\n}\n\n// Initialize\ndocument.addEventListener('DOMContentLoaded', () => {\n  // Get DOM elements\n  connectBtn = document.getElementById('connect-btn') as HTMLButtonElement;\n  disconnectBtn = document.getElementById('disconnect-btn') as HTMLButtonElement;\n  connectionStatusEl = document.getElementById('connection-status')!;\n  loadBtn = document.getElementById('load-btn') as HTMLButtonElement;\n  writeBtn = document.getElementById('write-btn') as HTMLButtonElement;\n  rebootBtn = document.getElementById('reboot-btn') as HTMLButtonElement;\n  statusLog = document.getElementById('status-log')!;\n\n  radioNameInput = document.getElementById('radio-name') as HTMLInputElement;\n  nodeTypeSelect = document.getElementById('node-type') as HTMLSelectElement;\n  privateKeyInput = document.getElementById('private-key') as HTMLInputElement;\n  publicKeyInput = document.getElementById('public-key') as HTMLInputElement;\n  latitudeInput = document.getElementById('latitude') as HTMLInputElement;\n  longitudeInput = document.getElementById('longitude') as HTMLInputElement;\n  frequencyInput = document.getElementById('frequency') as HTMLInputElement;\n  bandwidthInput = document.getElementById('bandwidth') as HTMLInputElement;\n  spreadingFactorInput = document.getElementById('spreading-factor') as HTMLInputElement;\n  codingRateInput = document.getElementById('coding-rate') as HTMLInputElement;\n  txPowerInput = document.getElementById('tx-power') as HTMLInputElement;\n  maxTxPowerInput = document.getElementById('max-tx-power') as HTMLInputElement;\n  deviceTimeInput = document.getElementById('device-time') as HTMLInputElement;\n  syncTimeBtn = document.getElementById('sync-time-btn') as HTMLButtonElement;\n  usaPresetBtn = document.getElementById('usa-preset-btn') as HTMLButtonElement;\n  manualAddContactsCheckbox = document.getElementById('manual-add-contacts') as HTMLInputElement;\n  firmwareInfoEl = document.getElementById('firmware-info')!;\n  modelInfoEl = document.getElementById('model-info')!;\n  rxDelayInput = document.getElementById('rx-delay') as HTMLInputElement;\n  advertIntervalInput = document.getElementById('advert-interval') as HTMLInputElement;\n  multiAcksInput = document.getElementById('multi-acks') as HTMLInputElement;\n  advertLocPolicySelect = document.getElementById('advert-loc-policy') as HTMLSelectElement;\n  telemetryBaseSelect = document.getElementById('telemetry-base') as HTMLSelectElement;\n  telemetryLocSelect = document.getElementById('telemetry-loc') as HTMLSelectElement;\n  telemetryEnvSelect = document.getElementById('telemetry-env') as HTMLSelectElement;\n  blePinInput = document.getElementById('ble-pin') as HTMLInputElement;\n\n  const serialNotSupported = document.getElementById('serial-not-supported')!;\n\n  // Check for Web Serial support\n  if (!navigator.serial) {\n    serialNotSupported.style.display = 'block';\n    connectBtn.disabled = true;\n    log('Web Serial API not supported in this browser', 'error');\n    return;\n  }\n\n  // Event listeners\n  connectBtn.addEventListener('click', connectToRadio);\n  disconnectBtn.addEventListener('click', disconnectFromRadio);\n  loadBtn.addEventListener('click', loadFromRadio);\n  writeBtn.addEventListener('click', writeToRadio);\n  rebootBtn.addEventListener('click', rebootRadio);\n  syncTimeBtn.addEventListener('click', syncCurrentTime);\n\n  // Validate hex input for private key\n  privateKeyInput.addEventListener('input', validateHexInput);\n\n  // USA preset button\n  usaPresetBtn.addEventListener('click', applyUsaPreset);\n\n  // Mark fields as dirty when user edits them\n  radioNameInput.addEventListener('input', () => markDirty('name'));\n  nodeTypeSelect.addEventListener('change', () => markDirty('nodeType'));\n  privateKeyInput.addEventListener('input', () => markDirty('privateKey'));\n  latitudeInput.addEventListener('input', () => markDirty('location'));\n  longitudeInput.addEventListener('input', () => markDirty('location'));\n  frequencyInput.addEventListener('input', () => markDirty('radio'));\n  bandwidthInput.addEventListener('input', () => markDirty('radio'));\n  spreadingFactorInput.addEventListener('input', () => markDirty('radio'));\n  codingRateInput.addEventListener('input', () => markDirty('radio'));\n  txPowerInput.addEventListener('input', () => markDirty('txPower'));\n  manualAddContactsCheckbox.addEventListener('change', () => markDirty('otherParams'));\n  deviceTimeInput.addEventListener('input', () => markDirty('time'));\n  rxDelayInput.addEventListener('input', () => markDirty('tuning'));\n  advertIntervalInput.addEventListener('input', () => markDirty('tuning'));\n  multiAcksInput.addEventListener('input', () => markDirty('otherParams'));\n  advertLocPolicySelect.addEventListener('change', () => markDirty('otherParams'));\n  telemetryBaseSelect.addEventListener('change', () => markDirty('otherParams'));\n  telemetryLocSelect.addEventListener('change', () => markDirty('otherParams'));\n  telemetryEnvSelect.addEventListener('change', () => markDirty('otherParams'));\n  blePinInput.addEventListener('input', () => markDirty('blePin'));\n\n  // Set initial time (don't mark as dirty - this is just initialization)\n  const now = Math.floor(Date.now() / 1000);\n  deviceTimeInput.value = String(now);\n  startTimeAutoIncrement();\n\n  log('Ready. Connect to a radio to begin.');\n});\n"],
  "mappings": "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",
  "names": ["crypto", "init_crypto", "__esmMin", "isBytes", "a", "anumber", "n", "abytes", "b", "lengths", "aexists", "instance", "checkFinished", "aoutput", "out", "min", "clean", "arrays", "i", "createView", "arr", "bytesToHex", "bytes", "hasHexBuiltin", "hex", "hexes", "asciiToBase16", "ch", "asciis", "hexToBytes", "hl", "al", "array", "ai", "hi", "n1", "n2", "char", "utf8ToBytes", "str", "toBytes", "data", "concatBytes", "sum", "res", "pad", "createHasher", "hashCons", "hashC", "msg", "tmp", "randomBytes", "bytesLength", "crypto", "Hash", "init_utils", "__esmMin", "init_crypto", "_", "setBigUint64", "view", "byteOffset", "value", "isLE", "_32n", "_u32_max", "wh", "wl", "h", "l", "HashMD", "SHA512_IV", "init_md", "__esmMin", "init_utils", "Hash", "blockLen", "outputLen", "padOffset", "createView", "data", "aexists", "toBytes", "abytes", "buffer", "len", "pos", "take", "dataView", "out", "aoutput", "clean", "i", "oview", "outLen", "state", "res", "to", "length", "finished", "destroyed", "fromBig", "n", "le", "U32_MASK64", "_32n", "split", "lst", "len", "Ah", "Al", "i", "h", "l", "add", "Bh", "Bl", "shrSH", "shrSL", "rotrSH", "rotrSL", "rotrBH", "rotrBL", "add3L", "add3H", "add4L", "add4H", "add5L", "add5H", "init_u64", "__esmMin", "_l", "s", "Cl", "low", "Ch", "Dl", "Dh", "El", "Eh", "K512", "SHA512_Kh", "SHA512_Kl", "SHA512_W_H", "SHA512_W_L", "SHA512", "sha512", "init_sha2", "__esmMin", "init_md", "init_u64", "init_utils", "split", "n", "HashMD", "outputLen", "SHA512_IV", "Ah", "Al", "Bh", "Bl", "Ch", "Cl", "Dh", "Dl", "Eh", "El", "Fh", "Fl", "Gh", "Gl", "Hh", "Hl", "view", "offset", "i", "W15h", "W15l", "s0h", "rotrSH", "shrSH", "s0l", "rotrSL", "shrSL", "W2h", "W2l", "s1h", "rotrBH", "s1l", "rotrBL", "SUMl", "add4L", "SUMh", "add4H", "sigma1h", "sigma1l", "CHIh", "CHIl", "T1ll", "add5L", "T1h", "add5H", "T1l", "sigma0h", "sigma0l", "MAJh", "MAJl", "add", "All", "add3L", "add3H", "clean", "createHasher", "_abool2", "value", "title", "prefix", "_abytes2", "length", "bytes", "isBytes", "len", "needsLen", "ofLen", "got", "hexToNumber", "hex", "_0n", "bytesToNumberBE", "bytesToHex", "bytesToNumberLE", "abytes", "numberToBytesBE", "n", "hexToBytes", "numberToBytesLE", "ensureBytes", "expectedLength", "res", "e", "equalBytes", "a", "b", "diff", "i", "copyBytes", "inRange", "min", "max", "isPosBig", "aInRange", "bitLen", "_1n", "isHash", "val", "_validateObject", "object", "fields", "optFields", "checkField", "fieldName", "expectedType", "isOpt", "current", "k", "v", "memoized", "fn", "map", "arg", "args", "computed", "bitMask", "notImplemented", "init_utils", "__esmMin", "mod", "a", "b", "result", "_0n", "pow2", "x", "power", "modulo", "res", "invert", "number", "y", "_1n", "u", "v", "q", "r", "m", "n", "assertIsSquare", "Fp", "root", "sqrt3mod4", "p1div4", "_4n", "sqrt5mod8", "p5div8", "_5n", "_8n", "n2", "_2n", "nv", "i", "sqrt9mod16", "P", "Fp_", "Field", "tn", "tonelliShanks", "c1", "c2", "c3", "c4", "_7n", "_16n", "tv1", "tv2", "tv3", "tv4", "e1", "e2", "e3", "_3n", "Q", "S", "Z", "_Fp", "FpLegendre", "cc", "Q1div2", "M", "c", "t", "R", "t_tmp", "exponent", "FpSqrt", "_9n", "validateField", "field", "initial", "opts", "FIELD_FIELDS", "map", "val", "_validateObject", "FpPow", "num", "p", "d", "FpInvertBatch", "nums", "passZero", "inverted", "multipliedAcc", "acc", "invertedAcc", "p1mod2", "powered", "yes", "zero", "no", "nLength", "nBitLength", "anumber", "_nBitLength", "nByteLength", "ORDER", "bitLenOrOpts", "isLE", "_nbitLength", "_sqrt", "modFromBytes", "allowedLengths", "_opts", "BITS", "BYTES", "sqrtP", "f", "bitMask", "lhs", "rhs", "numberToBytesLE", "numberToBytesBE", "bytes", "skipValidation", "padded", "scalar", "bytesToNumberLE", "bytesToNumberBE", "lst", "FpSqrtEven", "elm", "isNegativeLE", "init_modular", "__esmMin", "init_utils", "negateCt", "condition", "item", "neg", "normalizeZ", "c", "points", "invertedZs", "FpInvertBatch", "p", "i", "validateW", "W", "bits", "calcWOpts", "scalarBits", "windows", "windowSize", "maxNumber", "mask", "bitMask", "shiftBy", "calcOffsets", "n", "window", "wOpts", "wbits", "nextN", "_1n", "offsetStart", "offset", "isZero", "isNeg", "isNegF", "validateMSMPoints", "validateMSMScalars", "scalars", "field", "s", "getW", "P", "pointWindowSizes", "assert0", "_0n", "pippenger", "fieldN", "plength", "slength", "zero", "bitLen", "MASK", "buckets", "lastBits", "sum", "j", "scalar", "resI", "sumI", "createField", "order", "isLE", "validateField", "Field", "_createCurveFields", "type", "CURVE", "curveOpts", "FpFnLE", "val", "Fp", "Fn", "params", "pointPrecomputes", "wNAF", "init_curve", "__esmMin", "init_utils", "init_modular", "Point", "elm", "d", "point", "base", "precomputes", "f", "wo", "offsetF", "acc", "transform", "comp", "prev", "isEdValidXY", "Fp", "CURVE", "x", "y", "x2", "y2", "left", "right", "edwards", "params", "extraOpts", "validated", "_createCurveFields", "Fn", "cofactor", "_validateObject", "MASK", "_2n", "_1n", "modP", "n", "uvRatio", "u", "v", "_0n", "acoord", "title", "banZero", "min", "aInRange", "aextpoint", "other", "Point", "toAffineMemo", "memoized", "p", "iz", "X", "Y", "Z", "is0", "_8n", "zz", "assertValidMemo", "a", "d", "T", "X2", "Y2", "Z2", "Z4", "aX2", "XY", "ZT", "bytes", "zip215", "len", "copyBytes", "_abytes2", "_abool2", "normed", "lastByte", "bytesToNumberLE", "max", "isValid", "isXOdd", "isLastByteOdd", "ensureBytes", "windowSize", "isLazy", "wnaf", "X1", "Y1", "Z1", "X1Z2", "X2Z1", "Y1Z2", "Y2Z1", "A", "B", "C", "x1y1", "E", "G", "F", "H", "X3", "Y3", "T3", "Z3", "T1", "T2", "D", "scalar", "f", "normalizeZ", "acc", "invertedZ", "bytesToHex", "points", "scalars", "pippenger", "wNAF", "eddsa", "cHash", "eddsaOpts", "prehash", "BASE", "randomBytes", "adjustScalarBytes", "domain", "data", "ctx", "phflag", "modN_LE", "hash", "getPrivateScalar", "key", "lengths", "hashed", "head", "prefix", "getExtendedPublicKey", "secretKey", "point", "pointBytes", "getPublicKey", "hashDomainToScalar", "context", "msgs", "msg", "concatBytes", "sign", "options", "r", "R", "k", "s", "rs", "verifyOpts", "verify", "sig", "publicKey", "mid", "SB", "_size", "randomSecretKey", "seed", "keygen", "utils", "isValidSecretKey", "isBytes", "isValidPublicKey", "size", "is25519", "_eddsa_legacy_opts_to_new", "c", "Field", "curveOpts", "_eddsa_new_output_to_legacy", "twistedEdwards", "EDDSA", "PrimeEdwardsPoint", "init_edwards", "__esmMin", "init_utils", "init_curve", "init_modular", "ep", "_bytes", "notImplemented", "_hex", "i2osp", "value", "length", "anum", "res", "i", "strxor", "a", "b", "arr", "item", "normDST", "DST", "isBytes", "utf8ToBytes", "expand_message_xmd", "msg", "lenInBytes", "H", "abytes", "concatBytes", "b_in_bytes", "r_in_bytes", "ell", "DST_prime", "Z_pad", "l_i_b_str", "b_0", "args", "expand_message_xof", "k", "dkLen", "hash_to_field", "count", "options", "_validateObject", "p", "m", "hash", "expand", "isHash", "log2p", "L", "len_in_bytes", "prb", "u", "e", "j", "elm_offset", "tv", "mod", "os2ip", "createHasher", "Point", "mapToCurve", "defaults", "map", "num", "clear", "initial", "P", "opts", "u0", "u1", "optsDst", "scalars", "N", "_DST_scalar", "init_hash_to_curve", "__esmMin", "init_utils", "init_modular", "bytesToNumberBE", "validateOpts", "curve", "_validateObject", "montgomery", "curveDef", "CURVE", "P", "type", "adjustScalarBytes", "powPminus2", "rand", "is25519", "randomBytes_", "randomBytes", "montgomeryBits", "fieldLen", "Gu", "a24", "minScalar", "_2n", "maxAdded", "_1n", "maxScalar", "modP", "n", "mod", "GuBytes", "encodeU", "u", "numberToBytesLE", "decodeU", "_u", "ensureBytes", "bytesToNumberLE", "decodeScalar", "scalar", "scalarMult", "pu", "montgomeryLadder", "_0n", "scalarMultBase", "cswap", "swap", "x_2", "x_3", "dummy", "aInRange", "k", "x_1", "z_2", "z_3", "t", "k_t", "A", "AA", "B", "BB", "E", "C", "D", "DA", "CB", "dacb", "da_cb", "z2", "lengths", "randomSecretKey", "seed", "abytes", "keygen", "secretKey", "publicKey", "init_montgomery", "__esmMin", "init_utils", "init_modular", "ed25519_exports", "__export", "ED25519_TORSION_SUBGROUP", "RistrettoPoint", "ed25519", "ed25519_hasher", "ed25519ctx", "ed25519ph", "edwardsToMontgomery", "edwardsToMontgomeryPriv", "edwardsToMontgomeryPub", "encodeToCurve", "hashToCurve", "hashToRistretto255", "hash_to_ristretto255", "ristretto255", "ristretto255_hasher", "x25519", "ed25519_pow_2_252_3", "x", "_10n", "_20n", "_40n", "_80n", "P", "ed25519_CURVE_p", "b2", "b4", "pow2", "_2n", "b5", "_1n", "b10", "_5n", "b20", "b40", "b80", "b160", "b240", "b250", "adjustScalarBytes", "bytes", "uvRatio", "u", "v", "v3", "mod", "v7", "pow", "vx2", "root1", "root2", "ED25519_SQRT_M1", "useRoot1", "useRoot2", "noRoot", "isNegativeLE", "ed25519_domain", "data", "ctx", "phflag", "concatBytes", "utf8ToBytes", "map_to_curve_elligator2_curve25519", "ELL2_C4", "_8n", "ELL2_J", "tv1", "Fp", "xd", "x1n", "tv2", "gxd", "gx1", "tv3", "y11", "y12", "ELL2_C3", "e1", "y1", "x2n", "y21", "ELL2_C2", "y22", "gx2", "e2", "y2", "e3", "xn", "y", "e4", "map_to_curve_elligator2_edwards25519", "xMn", "xMd", "yMn", "yMd", "ELL2_C1_EDWARDS", "yn", "yd", "e", "xd_inv", "yd_inv", "FpInvertBatch", "calcElligatorRistrettoMap", "r0", "d", "ed25519_CURVE", "n", "r", "SQRT_M1", "Ns", "ONE_MINUS_D_SQ", "c", "D", "Ns_D_is_sq", "s", "s_", "Nt", "D_MINUS_ONE_SQ", "s2", "W0", "W1", "SQRT_AD_MINUS_ONE", "W2", "W3", "ristretto255_map", "abytes", "r1", "bytes255ToNumberLE", "R1", "r2", "R2", "_RistrettoPoint", "edwardsPub", "ensureBytes", "edwardsPriv", "_0n", "_3n", "Fn", "ed25519Defaults", "ELL2_C1", "INVSQRT_A_MINUS_D", "invertSqrt", "MAX_255B", "init_ed25519", "__esmMin", "init_sha2", "init_utils", "init_curve", "init_edwards", "init_hash_to_curve", "init_modular", "init_montgomery", "Field", "sha512", "twistedEdwards", "montgomery", "pow_p_5_8", "FpSqrtEven", "createHasher", "scalars", "number", "bytesToNumberLE", "__RistrettoPoint", "PrimeEdwardsPoint", "ep", "ap", "other", "hex", "a", "equalBytes", "u1", "u2", "u1_2", "u2_2", "isValid", "I", "Dx", "Dy", "t", "points", "pippenger", "X", "Y", "Z", "T", "u2sq", "invsqrt", "D1", "D2", "zInv", "_x", "_y", "X1", "Y1", "X2", "Y2", "one", "two", "msg", "options", "DST", "xmd", "expand_message_xmd", "_DST_scalar", "BufferWriter", "bytes", "byte", "num", "string", "maxLength", "encodedString", "i", "buffer_writer_default", "BufferReader", "data", "count", "maxLength", "value", "bytes", "byte", "buffer_reader_default", "Constants", "__publicField", "constants_default", "EventEmitter", "event", "callback", "callbacks", "cb", "internalCallback", "data", "eventListener", "events_default", "BufferUtils", "uint8Array", "byte", "hex", "base64", "c", "byteArray1", "byteArray2", "i", "buffer_utils_default", "_Advert", "publicKey", "timestamp", "signature", "appData", "bytes", "bufferReader", "buffer_reader_default", "type", "ed25519", "bufferWriter", "buffer_writer_default", "flags", "lat", "lon", "name", "__publicField", "Advert", "advert_default", "_Packet", "header", "path", "payload", "bytes", "bufferReader", "buffer_reader_default", "pathLen", "dest", "src", "encrypted", "advert", "advert_default", "__publicField", "Packet", "packet_default", "RandomUtils", "min", "max", "random_utils_default", "Connection", "events_default", "constants_default", "data", "buffer_writer_default", "txtType", "attempt", "senderTimestamp", "pubKeyPrefix", "text", "channelIdx", "since", "epochSecs", "type", "name", "publicKey", "flags", "outPathLen", "outPath", "advName", "lastAdvert", "advLat", "advLon", "radioFreq", "radioBw", "radioSf", "radioCr", "txPower", "pubKey", "lat", "lon", "advertPacketBytes", "appTargetVer", "privateKey", "path", "rawData", "password", "requestCodeAndParams", "secret", "dataToSign", "tag", "auth", "manualAddContacts", "frame", "bufferReader", "buffer_reader_default", "responseCode", "reserved", "pathLen", "errCode", "idx", "remainingBytesLength", "timeoutMillis", "resolve", "reject", "selfInfo", "onOk", "onErr", "e", "latitude", "longitude", "contacts", "onContactReceived", "contact", "contactPubKeyPrefix", "buffer_utils_default", "contactPublicKey", "onSent", "response", "onContactMessageReceived", "message", "onChannelMessageReceived", "onNoMoreMessagesReceived", "waitingMessages", "onCurrTime", "onExportContact", "i", "onBatteryVoltage", "onDeviceInfo", "onPrivateKey", "onDisabled", "extraTimeoutMillis", "publicKeyPrefix", "timeoutHandler", "estTimeout", "onLoginSuccess", "onStatusResponsePush", "repeaterStats", "onTelemetryResponsePush", "onBinaryResponsePush", "bufferWriter", "rawBytes", "startMillis", "onLogRxDataPush", "durationMillis", "packet", "packet_default", "onChannelInfoResponse", "channels", "channel", "sendNextChunk", "chunk", "onSignStart", "onSignature", "random_utils_default", "onTraceDataPush", "count", "offset", "orderBy", "pubKeyPrefixLength", "responseData", "totalNeighboursCount", "resultsCount", "neighbours", "heardSecondsAgo", "snr", "connection_default", "SerialConnection", "_SerialConnection", "connection_default", "bytes", "frameType", "frameData", "frame", "buffer_writer_default", "data", "value", "frameHeaderLength", "frameHeader", "buffer_reader_default", "constants_default", "frameLength", "requiredLength", "e", "serial_connection_default", "WebSerialConnection", "_WebSerialConnection", "serial_connection_default", "serialPort", "bytes", "writer", "value", "done", "error", "web_serial_connection_default", "connectBtn", "disconnectBtn", "connectionStatusEl", "loadBtn", "writeBtn", "rebootBtn", "statusLog", "radioNameInput", "nodeTypeSelect", "privateKeyInput", "publicKeyInput", "latitudeInput", "longitudeInput", "frequencyInput", "bandwidthInput", "spreadingFactorInput", "codingRateInput", "txPowerInput", "maxTxPowerInput", "deviceTimeInput", "syncTimeBtn", "usaPresetBtn", "manualAddContactsCheckbox", "firmwareInfoEl", "modelInfoEl", "rxDelayInput", "advertIntervalInput", "multiAcksInput", "advertLocPolicySelect", "telemetryBaseSelect", "telemetryLocSelect", "telemetryEnvSelect", "blePinInput", "connection", "timeIntervalId", "dirtyFields", "isValidHex", "str", "hexToBytes", "hex", "bytes", "i", "bytesToHex", "b", "log", "message", "type", "timestamp", "line", "updateConnectionStatus", "status", "isConnected", "CMD_SET_TUNING_PARAMS", "CMD_SET_DEVICE_PIN", "CMD_SET_OTHER_PARAMS", "parseReservedBytes", "reserved", "multiAcks", "advertLocPolicy", "telemetryMode", "sendRawCommand", "conn", "waitForResponse", "responseCode", "timeoutMs", "resolve", "timeout", "handler", "data", "connectToRadio", "web_serial_connection_default", "reject", "e", "msg", "disconnectFromRadio", "loadFromRadio", "selfInfoPromise", "constants_default", "selfInfo", "otherParams", "modeNames", "lat", "lon", "freqMHz", "bwKHz", "timePromise", "timeResp", "date", "startTimeAutoIncrement", "keyPromise", "keyHandler", "disabledHandler", "keyResp", "keyHex", "deviceInfoPromise", "deviceInfo", "clearDirtyFlags", "writeToRadio", "waitForOk", "name", "nodeType", "manualAdd", "telemetryBase", "telemetryLoc", "telemetryEnv", "cmd", "keyBytes", "freq", "bw", "sf", "cr", "txPower", "deviceTime", "rxDelay", "advertInterval", "pin", "rebootRadio", "currentValue", "markDirty", "fieldName", "syncCurrentTime", "now", "applyUsaPreset", "validateHexInput", "event", "input", "cleaned", "serialNotSupported"]
}
