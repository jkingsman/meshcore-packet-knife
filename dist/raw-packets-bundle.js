"use strict";(()=>{var Vc=Object.create;var Cr=Object.defineProperty;var Kc=Object.getOwnPropertyDescriptor;var zc=Object.getOwnPropertyNames;var Gc=Object.getPrototypeOf,Yc=Object.prototype.hasOwnProperty;var Wc=(r,e,t)=>e in r?Cr(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Wt=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+r+'" is not supported')});var He=(r,e)=>()=>(r&&(e=r(r=0)),e);var G=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Eo=(r,e)=>{for(var t in e)Cr(r,t,{get:e[t],enumerable:!0})},bo=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of zc(e))!Yc.call(r,s)&&s!==t&&Cr(r,s,{get:()=>e[s],enumerable:!(n=Kc(e,s))||n.enumerable});return r};var nn=(r,e,t)=>(t=r!=null?Vc(Gc(r)):{},bo(e||!r||!r.__esModule?Cr(t,"default",{value:r,enumerable:!0}):t,r)),jc=r=>bo(Cr({},"__esModule",{value:!0}),r);var W=(r,e,t)=>Wc(r,typeof e!="symbol"?e+"":e,t);var _e=G(Be=>{"use strict";Object.defineProperty(Be,"__esModule",{value:!0});Be.RequestType=Be.AdvertFlags=Be.DeviceRole=Be.PayloadVersion=Be.ControlSubType=Be.PayloadType=Be.RouteType=void 0;var Ao;(function(r){r[r.TransportFlood=0]="TransportFlood",r[r.Flood=1]="Flood",r[r.Direct=2]="Direct",r[r.TransportDirect=3]="TransportDirect"})(Ao||(Be.RouteType=Ao={}));var wo;(function(r){r[r.Request=0]="Request",r[r.Response=1]="Response",r[r.TextMessage=2]="TextMessage",r[r.Ack=3]="Ack",r[r.Advert=4]="Advert",r[r.GroupText=5]="GroupText",r[r.GroupData=6]="GroupData",r[r.AnonRequest=7]="AnonRequest",r[r.Path=8]="Path",r[r.Trace=9]="Trace",r[r.Multipart=10]="Multipart",r[r.Control=11]="Control",r[r.RawCustom=15]="RawCustom"})(wo||(Be.PayloadType=wo={}));var Do;(function(r){r[r.NodeDiscoverReq=128]="NodeDiscoverReq",r[r.NodeDiscoverResp=144]="NodeDiscoverResp"})(Do||(Be.ControlSubType=Do={}));var _o;(function(r){r[r.Version1=0]="Version1",r[r.Version2=1]="Version2",r[r.Version3=2]="Version3",r[r.Version4=3]="Version4"})(_o||(Be.PayloadVersion=_o={}));var Ro;(function(r){r[r.Unknown=0]="Unknown",r[r.ChatNode=1]="ChatNode",r[r.Repeater=2]="Repeater",r[r.RoomServer=3]="RoomServer",r[r.Sensor=4]="Sensor"})(Ro||(Be.DeviceRole=Ro={}));var So;(function(r){r[r.HasLocation=16]="HasLocation",r[r.HasFeature1=32]="HasFeature1",r[r.HasFeature2=64]="HasFeature2",r[r.HasName=128]="HasName"})(So||(Be.AdvertFlags=So={}));var To;(function(r){r[r.GetStats=1]="GetStats",r[r.Keepalive=2]="Keepalive",r[r.GetTelemetryData=3]="GetTelemetryData",r[r.GetMinMaxAvgData=4]="GetMinMaxAvgData",r[r.GetAccessList=5]="GetAccessList"})(To||(Be.RequestType=To={}))});var he=G(jt=>{"use strict";Object.defineProperty(jt,"__esModule",{value:!0});jt.byteToHex=Fo;jt.bytesToHex=$c;jt.numberToHex=Zc;jt.hexToBytes=Xc;function Fo(r){return r.toString(16).padStart(2,"0").toUpperCase()}function $c(r){return Array.from(r).map(Fo).join("")}function Zc(r,e=8){return(r>>>0).toString(16).padStart(e,"0").toUpperCase()}function Xc(r){let e=r.replace(/\s/g,"").toUpperCase();if(!/^[0-9A-F]*$/.test(e))throw new Error("Invalid hex string: invalid characters at position 0");if(e.length%2!==0)throw new Error("Invalid hex string: odd length");let t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2)t[n/2]=parseInt(e.substr(n,2),16);return t}});var $t=G(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.getRouteTypeName=Qc;mt.getPayloadTypeName=Jc;mt.getPayloadVersionName=ef;mt.getDeviceRoleName=tf;mt.getRequestTypeName=rf;mt.getControlSubTypeName=nf;var te=_e();function Qc(r){switch(r){case te.RouteType.Flood:return"Flood";case te.RouteType.Direct:return"Direct";case te.RouteType.TransportFlood:return"TransportFlood";case te.RouteType.TransportDirect:return"TransportDirect";default:return`Unknown (${r})`}}function Jc(r){switch(r){case te.PayloadType.RawCustom:return"RawCustom";case te.PayloadType.Trace:return"Trace";case te.PayloadType.Advert:return"Advert";case te.PayloadType.GroupText:return"GroupText";case te.PayloadType.GroupData:return"GroupData";case te.PayloadType.Request:return"Request";case te.PayloadType.Response:return"Response";case te.PayloadType.TextMessage:return"TextMessage";case te.PayloadType.AnonRequest:return"AnonRequest";case te.PayloadType.Ack:return"Ack";case te.PayloadType.Path:return"Path";case te.PayloadType.Multipart:return"Multipart";case te.PayloadType.Control:return"Control";default:return`Unknown (0x${r.toString(16)})`}}function ef(r){switch(r){case te.PayloadVersion.Version1:return"Version 1";case te.PayloadVersion.Version2:return"Version 2";case te.PayloadVersion.Version3:return"Version 3";case te.PayloadVersion.Version4:return"Version 4";default:return`Unknown (${r})`}}function tf(r){switch(r){case te.DeviceRole.Unknown:return"Unknown";case te.DeviceRole.ChatNode:return"Chat Node";case te.DeviceRole.Repeater:return"Repeater";case te.DeviceRole.RoomServer:return"Room Server";case te.DeviceRole.Sensor:return"Sensor";default:return`Unknown (${r})`}}function rf(r){switch(r){case te.RequestType.GetStats:return"Get Stats";case te.RequestType.Keepalive:return"Keepalive (deprecated)";case te.RequestType.GetTelemetryData:return"Get Telemetry Data";case te.RequestType.GetMinMaxAvgData:return"Get Min/Max/Avg Data";case te.RequestType.GetAccessList:return"Get Access List";default:return`Unknown (${r})`}}function nf(r){switch(r){case te.ControlSubType.NodeDiscoverReq:return"Node Discover Request";case te.ControlSubType.NodeDiscoverResp:return"Node Discover Response";default:return`Unknown (0x${r.toString(16)})`}}});var sn=G(()=>{});var X=G((on,Po)=>{(function(r,e){typeof on=="object"?Po.exports=on=e():typeof define=="function"&&define.amd?define([],e):r.CryptoJS=e()})(on,function(){var r=r||function(e,t){var n;if(typeof window<"u"&&window.crypto&&(n=window.crypto),typeof self<"u"&&self.crypto&&(n=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(n=globalThis.crypto),!n&&typeof window<"u"&&window.msCrypto&&(n=window.msCrypto),!n&&typeof global<"u"&&global.crypto&&(n=global.crypto),!n&&typeof Wt=="function")try{n=sn()}catch{}var s=function(){if(n){if(typeof n.getRandomValues=="function")try{return n.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof n.randomBytes=="function")try{return n.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function x(){}return function(y){var B;return x.prototype=y,B=new x,x.prototype=null,B}}(),i={},a=i.lib={},c=a.Base=function(){return{extend:function(x){var y=o(this);return x&&y.mixIn(x),(!y.hasOwnProperty("init")||this.init===y.init)&&(y.init=function(){y.$super.init.apply(this,arguments)}),y.init.prototype=y,y.$super=this,y},create:function(){var x=this.extend();return x.init.apply(x,arguments),x},init:function(){},mixIn:function(x){for(var y in x)x.hasOwnProperty(y)&&(this[y]=x[y]);x.hasOwnProperty("toString")&&(this.toString=x.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),l=a.WordArray=c.extend({init:function(x,y){x=this.words=x||[],y!=t?this.sigBytes=y:this.sigBytes=x.length*4},toString:function(x){return(x||u).stringify(this)},concat:function(x){var y=this.words,B=x.words,E=this.sigBytes,b=x.sigBytes;if(this.clamp(),E%4)for(var C=0;C<b;C++){var T=B[C>>>2]>>>24-C%4*8&255;y[E+C>>>2]|=T<<24-(E+C)%4*8}else for(var _=0;_<b;_+=4)y[E+_>>>2]=B[_>>>2];return this.sigBytes+=b,this},clamp:function(){var x=this.words,y=this.sigBytes;x[y>>>2]&=4294967295<<32-y%4*8,x.length=e.ceil(y/4)},clone:function(){var x=c.clone.call(this);return x.words=this.words.slice(0),x},random:function(x){for(var y=[],B=0;B<x;B+=4)y.push(s());return new l.init(y,x)}}),f=i.enc={},u=f.Hex={stringify:function(x){for(var y=x.words,B=x.sigBytes,E=[],b=0;b<B;b++){var C=y[b>>>2]>>>24-b%4*8&255;E.push((C>>>4).toString(16)),E.push((C&15).toString(16))}return E.join("")},parse:function(x){for(var y=x.length,B=[],E=0;E<y;E+=2)B[E>>>3]|=parseInt(x.substr(E,2),16)<<24-E%8*4;return new l.init(B,y/2)}},d=f.Latin1={stringify:function(x){for(var y=x.words,B=x.sigBytes,E=[],b=0;b<B;b++){var C=y[b>>>2]>>>24-b%4*8&255;E.push(String.fromCharCode(C))}return E.join("")},parse:function(x){for(var y=x.length,B=[],E=0;E<y;E++)B[E>>>2]|=(x.charCodeAt(E)&255)<<24-E%4*8;return new l.init(B,y)}},p=f.Utf8={stringify:function(x){try{return decodeURIComponent(escape(d.stringify(x)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(x){return d.parse(unescape(encodeURIComponent(x)))}},m=a.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(x){typeof x=="string"&&(x=p.parse(x)),this._data.concat(x),this._nDataBytes+=x.sigBytes},_process:function(x){var y,B=this._data,E=B.words,b=B.sigBytes,C=this.blockSize,T=C*4,_=b/T;x?_=e.ceil(_):_=e.max((_|0)-this._minBufferSize,0);var w=_*C,S=e.min(w*4,b);if(w){for(var A=0;A<w;A+=C)this._doProcessBlock(E,A);y=E.splice(0,w),B.sigBytes-=S}return new l.init(y,S)},clone:function(){var x=c.clone.call(this);return x._data=this._data.clone(),x},_minBufferSize:0}),g=a.Hasher=m.extend({cfg:c.extend(),init:function(x){this.cfg=this.cfg.extend(x),this.reset()},reset:function(){m.reset.call(this),this._doReset()},update:function(x){return this._append(x),this._process(),this},finalize:function(x){x&&this._append(x);var y=this._doFinalize();return y},blockSize:512/32,_createHelper:function(x){return function(y,B){return new x.init(B).finalize(y)}},_createHmacHelper:function(x){return function(y,B){return new v.HMAC.init(x,B).finalize(y)}}}),v=i.algo={};return i}(Math);return r})});var Er=G((an,Ho)=>{(function(r,e){typeof an=="object"?Ho.exports=an=e(X()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(an,function(r){return function(e){var t=r,n=t.lib,s=n.Base,o=n.WordArray,i=t.x64={},a=i.Word=s.extend({init:function(l,f){this.high=l,this.low=f}}),c=i.WordArray=s.extend({init:function(l,f){l=this.words=l||[],f!=e?this.sigBytes=f:this.sigBytes=l.length*8},toX32:function(){for(var l=this.words,f=l.length,u=[],d=0;d<f;d++){var p=l[d];u.push(p.high),u.push(p.low)}return o.create(u,this.sigBytes)},clone:function(){for(var l=s.clone.call(this),f=l.words=this.words.slice(0),u=f.length,d=0;d<u;d++)f[d]=f[d].clone();return l}})}(),r})});var Lo=G((cn,ko)=>{(function(r,e){typeof cn=="object"?ko.exports=cn=e(X()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(cn,function(r){return function(){if(typeof ArrayBuffer=="function"){var e=r,t=e.lib,n=t.WordArray,s=n.init,o=n.init=function(i){if(i instanceof ArrayBuffer&&(i=new Uint8Array(i)),(i instanceof Int8Array||typeof Uint8ClampedArray<"u"&&i instanceof Uint8ClampedArray||i instanceof Int16Array||i instanceof Uint16Array||i instanceof Int32Array||i instanceof Uint32Array||i instanceof Float32Array||i instanceof Float64Array)&&(i=new Uint8Array(i.buffer,i.byteOffset,i.byteLength)),i instanceof Uint8Array){for(var a=i.byteLength,c=[],l=0;l<a;l++)c[l>>>2]|=i[l]<<24-l%4*8;s.call(this,c,a)}else s.apply(this,arguments)};o.prototype=n}}(),r.lib.WordArray})});var Oo=G((fn,Io)=>{(function(r,e){typeof fn=="object"?Io.exports=fn=e(X()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(fn,function(r){return function(){var e=r,t=e.lib,n=t.WordArray,s=e.enc,o=s.Utf16=s.Utf16BE={stringify:function(a){for(var c=a.words,l=a.sigBytes,f=[],u=0;u<l;u+=2){var d=c[u>>>2]>>>16-u%4*8&65535;f.push(String.fromCharCode(d))}return f.join("")},parse:function(a){for(var c=a.length,l=[],f=0;f<c;f++)l[f>>>1]|=a.charCodeAt(f)<<16-f%2*16;return n.create(l,c*2)}};s.Utf16LE={stringify:function(a){for(var c=a.words,l=a.sigBytes,f=[],u=0;u<l;u+=2){var d=i(c[u>>>2]>>>16-u%4*8&65535);f.push(String.fromCharCode(d))}return f.join("")},parse:function(a){for(var c=a.length,l=[],f=0;f<c;f++)l[f>>>1]|=i(a.charCodeAt(f)<<16-f%2*16);return n.create(l,c*2)}};function i(a){return a<<8&4278255360|a>>>8&16711935}}(),r.enc.Utf16})});var gt=G((dn,qo)=>{(function(r,e){typeof dn=="object"?qo.exports=dn=e(X()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(dn,function(r){return function(){var e=r,t=e.lib,n=t.WordArray,s=e.enc,o=s.Base64={stringify:function(a){var c=a.words,l=a.sigBytes,f=this._map;a.clamp();for(var u=[],d=0;d<l;d+=3)for(var p=c[d>>>2]>>>24-d%4*8&255,m=c[d+1>>>2]>>>24-(d+1)%4*8&255,g=c[d+2>>>2]>>>24-(d+2)%4*8&255,v=p<<16|m<<8|g,x=0;x<4&&d+x*.75<l;x++)u.push(f.charAt(v>>>6*(3-x)&63));var y=f.charAt(64);if(y)for(;u.length%4;)u.push(y);return u.join("")},parse:function(a){var c=a.length,l=this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var u=0;u<l.length;u++)f[l.charCodeAt(u)]=u}var d=l.charAt(64);if(d){var p=a.indexOf(d);p!==-1&&(c=p)}return i(a,c,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function i(a,c,l){for(var f=[],u=0,d=0;d<c;d++)if(d%4){var p=l[a.charCodeAt(d-1)]<<d%4*2,m=l[a.charCodeAt(d)]>>>6-d%4*2,g=p|m;f[u>>>2]|=g<<24-u%4*8,u++}return n.create(f,u)}}(),r.enc.Base64})});var No=G((un,Uo)=>{(function(r,e){typeof un=="object"?Uo.exports=un=e(X()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(un,function(r){return function(){var e=r,t=e.lib,n=t.WordArray,s=e.enc,o=s.Base64url={stringify:function(a,c){c===void 0&&(c=!0);var l=a.words,f=a.sigBytes,u=c?this._safe_map:this._map;a.clamp();for(var d=[],p=0;p<f;p+=3)for(var m=l[p>>>2]>>>24-p%4*8&255,g=l[p+1>>>2]>>>24-(p+1)%4*8&255,v=l[p+2>>>2]>>>24-(p+2)%4*8&255,x=m<<16|g<<8|v,y=0;y<4&&p+y*.75<f;y++)d.push(u.charAt(x>>>6*(3-y)&63));var B=u.charAt(64);if(B)for(;d.length%4;)d.push(B);return d.join("")},parse:function(a,c){c===void 0&&(c=!0);var l=a.length,f=c?this._safe_map:this._map,u=this._reverseMap;if(!u){u=this._reverseMap=[];for(var d=0;d<f.length;d++)u[f.charCodeAt(d)]=d}var p=f.charAt(64);if(p){var m=a.indexOf(p);m!==-1&&(l=m)}return i(a,l,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function i(a,c,l){for(var f=[],u=0,d=0;d<c;d++)if(d%4){var p=l[a.charCodeAt(d-1)]<<d%4*2,m=l[a.charCodeAt(d)]>>>6-d%4*2,g=p|m;f[u>>>2]|=g<<24-u%4*8,u++}return n.create(f,u)}}(),r.enc.Base64url})});var vt=G((ln,Mo)=>{(function(r,e){typeof ln=="object"?Mo.exports=ln=e(X()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(ln,function(r){return function(e){var t=r,n=t.lib,s=n.WordArray,o=n.Hasher,i=t.algo,a=[];(function(){for(var p=0;p<64;p++)a[p]=e.abs(e.sin(p+1))*4294967296|0})();var c=i.MD5=o.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(p,m){for(var g=0;g<16;g++){var v=m+g,x=p[v];p[v]=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360}var y=this._hash.words,B=p[m+0],E=p[m+1],b=p[m+2],C=p[m+3],T=p[m+4],_=p[m+5],w=p[m+6],S=p[m+7],A=p[m+8],P=p[m+9],F=p[m+10],D=p[m+11],q=p[m+12],U=p[m+13],z=p[m+14],Y=p[m+15],R=y[0],L=y[1],I=y[2],k=y[3];R=l(R,L,I,k,B,7,a[0]),k=l(k,R,L,I,E,12,a[1]),I=l(I,k,R,L,b,17,a[2]),L=l(L,I,k,R,C,22,a[3]),R=l(R,L,I,k,T,7,a[4]),k=l(k,R,L,I,_,12,a[5]),I=l(I,k,R,L,w,17,a[6]),L=l(L,I,k,R,S,22,a[7]),R=l(R,L,I,k,A,7,a[8]),k=l(k,R,L,I,P,12,a[9]),I=l(I,k,R,L,F,17,a[10]),L=l(L,I,k,R,D,22,a[11]),R=l(R,L,I,k,q,7,a[12]),k=l(k,R,L,I,U,12,a[13]),I=l(I,k,R,L,z,17,a[14]),L=l(L,I,k,R,Y,22,a[15]),R=f(R,L,I,k,E,5,a[16]),k=f(k,R,L,I,w,9,a[17]),I=f(I,k,R,L,D,14,a[18]),L=f(L,I,k,R,B,20,a[19]),R=f(R,L,I,k,_,5,a[20]),k=f(k,R,L,I,F,9,a[21]),I=f(I,k,R,L,Y,14,a[22]),L=f(L,I,k,R,T,20,a[23]),R=f(R,L,I,k,P,5,a[24]),k=f(k,R,L,I,z,9,a[25]),I=f(I,k,R,L,C,14,a[26]),L=f(L,I,k,R,A,20,a[27]),R=f(R,L,I,k,U,5,a[28]),k=f(k,R,L,I,b,9,a[29]),I=f(I,k,R,L,S,14,a[30]),L=f(L,I,k,R,q,20,a[31]),R=u(R,L,I,k,_,4,a[32]),k=u(k,R,L,I,A,11,a[33]),I=u(I,k,R,L,D,16,a[34]),L=u(L,I,k,R,z,23,a[35]),R=u(R,L,I,k,E,4,a[36]),k=u(k,R,L,I,T,11,a[37]),I=u(I,k,R,L,S,16,a[38]),L=u(L,I,k,R,F,23,a[39]),R=u(R,L,I,k,U,4,a[40]),k=u(k,R,L,I,B,11,a[41]),I=u(I,k,R,L,C,16,a[42]),L=u(L,I,k,R,w,23,a[43]),R=u(R,L,I,k,P,4,a[44]),k=u(k,R,L,I,q,11,a[45]),I=u(I,k,R,L,Y,16,a[46]),L=u(L,I,k,R,b,23,a[47]),R=d(R,L,I,k,B,6,a[48]),k=d(k,R,L,I,S,10,a[49]),I=d(I,k,R,L,z,15,a[50]),L=d(L,I,k,R,_,21,a[51]),R=d(R,L,I,k,q,6,a[52]),k=d(k,R,L,I,C,10,a[53]),I=d(I,k,R,L,F,15,a[54]),L=d(L,I,k,R,E,21,a[55]),R=d(R,L,I,k,A,6,a[56]),k=d(k,R,L,I,Y,10,a[57]),I=d(I,k,R,L,w,15,a[58]),L=d(L,I,k,R,U,21,a[59]),R=d(R,L,I,k,T,6,a[60]),k=d(k,R,L,I,D,10,a[61]),I=d(I,k,R,L,b,15,a[62]),L=d(L,I,k,R,P,21,a[63]),y[0]=y[0]+R|0,y[1]=y[1]+L|0,y[2]=y[2]+I|0,y[3]=y[3]+k|0},_doFinalize:function(){var p=this._data,m=p.words,g=this._nDataBytes*8,v=p.sigBytes*8;m[v>>>5]|=128<<24-v%32;var x=e.floor(g/4294967296),y=g;m[(v+64>>>9<<4)+15]=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,m[(v+64>>>9<<4)+14]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,p.sigBytes=(m.length+1)*4,this._process();for(var B=this._hash,E=B.words,b=0;b<4;b++){var C=E[b];E[b]=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360}return B},clone:function(){var p=o.clone.call(this);return p._hash=this._hash.clone(),p}});function l(p,m,g,v,x,y,B){var E=p+(m&g|~m&v)+x+B;return(E<<y|E>>>32-y)+m}function f(p,m,g,v,x,y,B){var E=p+(m&v|g&~v)+x+B;return(E<<y|E>>>32-y)+m}function u(p,m,g,v,x,y,B){var E=p+(m^g^v)+x+B;return(E<<y|E>>>32-y)+m}function d(p,m,g,v,x,y,B){var E=p+(g^(m|~v))+x+B;return(E<<y|E>>>32-y)+m}t.MD5=o._createHelper(c),t.HmacMD5=o._createHmacHelper(c)}(Math),r.MD5})});var V0=G((xn,Vo)=>{(function(r,e){typeof xn=="object"?Vo.exports=xn=e(X()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(xn,function(r){return function(){var e=r,t=e.lib,n=t.WordArray,s=t.Hasher,o=e.algo,i=[],a=o.SHA1=s.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(c,l){for(var f=this._hash.words,u=f[0],d=f[1],p=f[2],m=f[3],g=f[4],v=0;v<80;v++){if(v<16)i[v]=c[l+v]|0;else{var x=i[v-3]^i[v-8]^i[v-14]^i[v-16];i[v]=x<<1|x>>>31}var y=(u<<5|u>>>27)+g+i[v];v<20?y+=(d&p|~d&m)+1518500249:v<40?y+=(d^p^m)+1859775393:v<60?y+=(d&p|d&m|p&m)-1894007588:y+=(d^p^m)-899497514,g=m,m=p,p=d<<30|d>>>2,d=u,u=y}f[0]=f[0]+u|0,f[1]=f[1]+d|0,f[2]=f[2]+p|0,f[3]=f[3]+m|0,f[4]=f[4]+g|0},_doFinalize:function(){var c=this._data,l=c.words,f=this._nDataBytes*8,u=c.sigBytes*8;return l[u>>>5]|=128<<24-u%32,l[(u+64>>>9<<4)+14]=Math.floor(f/4294967296),l[(u+64>>>9<<4)+15]=f,c.sigBytes=l.length*4,this._process(),this._hash},clone:function(){var c=s.clone.call(this);return c._hash=this._hash.clone(),c}});e.SHA1=s._createHelper(a),e.HmacSHA1=s._createHmacHelper(a)}(),r.SHA1})});var Zt=G((hn,Ko)=>{(function(r,e){typeof hn=="object"?Ko.exports=hn=e(X()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(hn,function(r){return function(e){var t=r,n=t.lib,s=n.WordArray,o=n.Hasher,i=t.algo,a=[],c=[];(function(){function u(g){for(var v=e.sqrt(g),x=2;x<=v;x++)if(!(g%x))return!1;return!0}function d(g){return(g-(g|0))*4294967296|0}for(var p=2,m=0;m<64;)u(p)&&(m<8&&(a[m]=d(e.pow(p,1/2))),c[m]=d(e.pow(p,1/3)),m++),p++})();var l=[],f=i.SHA256=o.extend({_doReset:function(){this._hash=new s.init(a.slice(0))},_doProcessBlock:function(u,d){for(var p=this._hash.words,m=p[0],g=p[1],v=p[2],x=p[3],y=p[4],B=p[5],E=p[6],b=p[7],C=0;C<64;C++){if(C<16)l[C]=u[d+C]|0;else{var T=l[C-15],_=(T<<25|T>>>7)^(T<<14|T>>>18)^T>>>3,w=l[C-2],S=(w<<15|w>>>17)^(w<<13|w>>>19)^w>>>10;l[C]=_+l[C-7]+S+l[C-16]}var A=y&B^~y&E,P=m&g^m&v^g&v,F=(m<<30|m>>>2)^(m<<19|m>>>13)^(m<<10|m>>>22),D=(y<<26|y>>>6)^(y<<21|y>>>11)^(y<<7|y>>>25),q=b+D+A+c[C]+l[C],U=F+P;b=E,E=B,B=y,y=x+q|0,x=v,v=g,g=m,m=q+U|0}p[0]=p[0]+m|0,p[1]=p[1]+g|0,p[2]=p[2]+v|0,p[3]=p[3]+x|0,p[4]=p[4]+y|0,p[5]=p[5]+B|0,p[6]=p[6]+E|0,p[7]=p[7]+b|0},_doFinalize:function(){var u=this._data,d=u.words,p=this._nDataBytes*8,m=u.sigBytes*8;return d[m>>>5]|=128<<24-m%32,d[(m+64>>>9<<4)+14]=e.floor(p/4294967296),d[(m+64>>>9<<4)+15]=p,u.sigBytes=d.length*4,this._process(),this._hash},clone:function(){var u=o.clone.call(this);return u._hash=this._hash.clone(),u}});t.SHA256=o._createHelper(f),t.HmacSHA256=o._createHmacHelper(f)}(Math),r.SHA256})});var Go=G((pn,zo)=>{(function(r,e,t){typeof pn=="object"?zo.exports=pn=e(X(),Zt()):typeof define=="function"&&define.amd?define(["./core","./sha256"],e):e(r.CryptoJS)})(pn,function(r){return function(){var e=r,t=e.lib,n=t.WordArray,s=e.algo,o=s.SHA256,i=s.SHA224=o.extend({_doReset:function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var a=o._doFinalize.call(this);return a.sigBytes-=4,a}});e.SHA224=o._createHelper(i),e.HmacSHA224=o._createHmacHelper(i)}(),r.SHA224})});var K0=G((yn,Yo)=>{(function(r,e,t){typeof yn=="object"?Yo.exports=yn=e(X(),Er()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],e):e(r.CryptoJS)})(yn,function(r){return function(){var e=r,t=e.lib,n=t.Hasher,s=e.x64,o=s.Word,i=s.WordArray,a=e.algo;function c(){return o.create.apply(o,arguments)}var l=[c(1116352408,3609767458),c(1899447441,602891725),c(3049323471,3964484399),c(3921009573,2173295548),c(961987163,4081628472),c(1508970993,3053834265),c(2453635748,2937671579),c(2870763221,3664609560),c(3624381080,2734883394),c(310598401,1164996542),c(607225278,1323610764),c(1426881987,3590304994),c(1925078388,4068182383),c(2162078206,991336113),c(2614888103,633803317),c(3248222580,3479774868),c(3835390401,2666613458),c(4022224774,944711139),c(264347078,2341262773),c(604807628,2007800933),c(770255983,1495990901),c(1249150122,1856431235),c(1555081692,3175218132),c(1996064986,2198950837),c(2554220882,3999719339),c(2821834349,766784016),c(2952996808,2566594879),c(3210313671,3203337956),c(3336571891,1034457026),c(3584528711,2466948901),c(113926993,3758326383),c(338241895,168717936),c(666307205,1188179964),c(773529912,1546045734),c(1294757372,1522805485),c(1396182291,2643833823),c(1695183700,2343527390),c(1986661051,1014477480),c(2177026350,1206759142),c(2456956037,344077627),c(2730485921,1290863460),c(2820302411,3158454273),c(3259730800,3505952657),c(3345764771,106217008),c(3516065817,3606008344),c(3600352804,1432725776),c(4094571909,1467031594),c(275423344,851169720),c(430227734,3100823752),c(506948616,1363258195),c(659060556,3750685593),c(883997877,3785050280),c(958139571,3318307427),c(1322822218,3812723403),c(1537002063,2003034995),c(1747873779,3602036899),c(1955562222,1575990012),c(2024104815,1125592928),c(2227730452,2716904306),c(2361852424,442776044),c(2428436474,593698344),c(2756734187,3733110249),c(3204031479,2999351573),c(3329325298,3815920427),c(3391569614,3928383900),c(3515267271,566280711),c(3940187606,3454069534),c(4118630271,4000239992),c(116418474,1914138554),c(174292421,2731055270),c(289380356,3203993006),c(460393269,320620315),c(685471733,587496836),c(852142971,1086792851),c(1017036298,365543100),c(1126000580,2618297676),c(1288033470,3409855158),c(1501505948,4234509866),c(1607167915,987167468),c(1816402316,1246189591)],f=[];(function(){for(var d=0;d<80;d++)f[d]=c()})();var u=a.SHA512=n.extend({_doReset:function(){this._hash=new i.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(d,p){for(var m=this._hash.words,g=m[0],v=m[1],x=m[2],y=m[3],B=m[4],E=m[5],b=m[6],C=m[7],T=g.high,_=g.low,w=v.high,S=v.low,A=x.high,P=x.low,F=y.high,D=y.low,q=B.high,U=B.low,z=E.high,Y=E.low,R=b.high,L=b.low,I=C.high,k=C.low,Q=T,re=_,de=w,$=S,Fe=A,qe=P,xt=F,Qe=D,be=q,xe=U,Je=z,Ke=Y,ht=R,pt=L,Gt=I,St=k,we=0;we<80;we++){var De,ze,Yt=f[we];if(we<16)ze=Yt.high=d[p+we*2]|0,De=Yt.low=d[p+we*2+1]|0;else{var zr=f[we-15],et=zr.high,Tt=zr.low,I0=(et>>>1|Tt<<31)^(et>>>8|Tt<<24)^et>>>7,Gr=(Tt>>>1|et<<31)^(Tt>>>8|et<<24)^(Tt>>>7|et<<25),Yr=f[we-2],tt=Yr.high,Ft=Yr.low,Wr=(tt>>>19|Ft<<13)^(tt<<3|Ft>>>29)^tt>>>6,jr=(Ft>>>19|tt<<13)^(Ft<<3|tt>>>29)^(Ft>>>6|tt<<26),$r=f[we-7],Zr=$r.high,O0=$r.low,Xr=f[we-16],q0=Xr.high,Qr=Xr.low;De=Gr+O0,ze=I0+Zr+(De>>>0<Gr>>>0?1:0),De=De+jr,ze=ze+Wr+(De>>>0<jr>>>0?1:0),De=De+Qr,ze=ze+q0+(De>>>0<Qr>>>0?1:0),Yt.high=ze,Yt.low=De}var U0=be&Je^~be&ht,gr=xe&Ke^~xe&pt,Jr=Q&de^Q&Fe^de&Fe,en=re&$^re&qe^$&qe,N0=(Q>>>28|re<<4)^(Q<<30|re>>>2)^(Q<<25|re>>>7),tn=(re>>>28|Q<<4)^(re<<30|Q>>>2)^(re<<25|Q>>>7),Pt=(be>>>14|xe<<18)^(be>>>18|xe<<14)^(be<<23|xe>>>9),vr=(xe>>>14|be<<18)^(xe>>>18|be<<14)^(xe<<23|be>>>9),rn=l[we],H=rn.high,O=rn.low,V=St+vr,J=Gt+Pt+(V>>>0<St>>>0?1:0),V=V+gr,J=J+U0+(V>>>0<gr>>>0?1:0),V=V+O,J=J+H+(V>>>0<O>>>0?1:0),V=V+De,J=J+ze+(V>>>0<De>>>0?1:0),ne=tn+en,ie=N0+Jr+(ne>>>0<tn>>>0?1:0);Gt=ht,St=pt,ht=Je,pt=Ke,Je=be,Ke=xe,xe=Qe+V|0,be=xt+J+(xe>>>0<Qe>>>0?1:0)|0,xt=Fe,Qe=qe,Fe=de,qe=$,de=Q,$=re,re=V+ne|0,Q=J+ie+(re>>>0<V>>>0?1:0)|0}_=g.low=_+re,g.high=T+Q+(_>>>0<re>>>0?1:0),S=v.low=S+$,v.high=w+de+(S>>>0<$>>>0?1:0),P=x.low=P+qe,x.high=A+Fe+(P>>>0<qe>>>0?1:0),D=y.low=D+Qe,y.high=F+xt+(D>>>0<Qe>>>0?1:0),U=B.low=U+xe,B.high=q+be+(U>>>0<xe>>>0?1:0),Y=E.low=Y+Ke,E.high=z+Je+(Y>>>0<Ke>>>0?1:0),L=b.low=L+pt,b.high=R+ht+(L>>>0<pt>>>0?1:0),k=C.low=k+St,C.high=I+Gt+(k>>>0<St>>>0?1:0)},_doFinalize:function(){var d=this._data,p=d.words,m=this._nDataBytes*8,g=d.sigBytes*8;p[g>>>5]|=128<<24-g%32,p[(g+128>>>10<<5)+30]=Math.floor(m/4294967296),p[(g+128>>>10<<5)+31]=m,d.sigBytes=p.length*4,this._process();var v=this._hash.toX32();return v},clone:function(){var d=n.clone.call(this);return d._hash=this._hash.clone(),d},blockSize:1024/32});e.SHA512=n._createHelper(u),e.HmacSHA512=n._createHmacHelper(u)}(),r.SHA512})});var jo=G((mn,Wo)=>{(function(r,e,t){typeof mn=="object"?Wo.exports=mn=e(X(),Er(),K0()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./sha512"],e):e(r.CryptoJS)})(mn,function(r){return function(){var e=r,t=e.x64,n=t.Word,s=t.WordArray,o=e.algo,i=o.SHA512,a=o.SHA384=i.extend({_doReset:function(){this._hash=new s.init([new n.init(3418070365,3238371032),new n.init(1654270250,914150663),new n.init(2438529370,812702999),new n.init(355462360,4144912697),new n.init(1731405415,4290775857),new n.init(2394180231,1750603025),new n.init(3675008525,1694076839),new n.init(1203062813,3204075428)])},_doFinalize:function(){var c=i._doFinalize.call(this);return c.sigBytes-=16,c}});e.SHA384=i._createHelper(a),e.HmacSHA384=i._createHmacHelper(a)}(),r.SHA384})});var Zo=G((gn,$o)=>{(function(r,e,t){typeof gn=="object"?$o.exports=gn=e(X(),Er()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],e):e(r.CryptoJS)})(gn,function(r){return function(e){var t=r,n=t.lib,s=n.WordArray,o=n.Hasher,i=t.x64,a=i.Word,c=t.algo,l=[],f=[],u=[];(function(){for(var m=1,g=0,v=0;v<24;v++){l[m+5*g]=(v+1)*(v+2)/2%64;var x=g%5,y=(2*m+3*g)%5;m=x,g=y}for(var m=0;m<5;m++)for(var g=0;g<5;g++)f[m+5*g]=g+(2*m+3*g)%5*5;for(var B=1,E=0;E<24;E++){for(var b=0,C=0,T=0;T<7;T++){if(B&1){var _=(1<<T)-1;_<32?C^=1<<_:b^=1<<_-32}B&128?B=B<<1^113:B<<=1}u[E]=a.create(b,C)}})();var d=[];(function(){for(var m=0;m<25;m++)d[m]=a.create()})();var p=c.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var m=this._state=[],g=0;g<25;g++)m[g]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(m,g){for(var v=this._state,x=this.blockSize/2,y=0;y<x;y++){var B=m[g+2*y],E=m[g+2*y+1];B=(B<<8|B>>>24)&16711935|(B<<24|B>>>8)&4278255360,E=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360;var b=v[y];b.high^=E,b.low^=B}for(var C=0;C<24;C++){for(var T=0;T<5;T++){for(var _=0,w=0,S=0;S<5;S++){var b=v[T+5*S];_^=b.high,w^=b.low}var A=d[T];A.high=_,A.low=w}for(var T=0;T<5;T++)for(var P=d[(T+4)%5],F=d[(T+1)%5],D=F.high,q=F.low,_=P.high^(D<<1|q>>>31),w=P.low^(q<<1|D>>>31),S=0;S<5;S++){var b=v[T+5*S];b.high^=_,b.low^=w}for(var U=1;U<25;U++){var _,w,b=v[U],z=b.high,Y=b.low,R=l[U];R<32?(_=z<<R|Y>>>32-R,w=Y<<R|z>>>32-R):(_=Y<<R-32|z>>>64-R,w=z<<R-32|Y>>>64-R);var L=d[f[U]];L.high=_,L.low=w}var I=d[0],k=v[0];I.high=k.high,I.low=k.low;for(var T=0;T<5;T++)for(var S=0;S<5;S++){var U=T+5*S,b=v[U],Q=d[U],re=d[(T+1)%5+5*S],de=d[(T+2)%5+5*S];b.high=Q.high^~re.high&de.high,b.low=Q.low^~re.low&de.low}var b=v[0],$=u[C];b.high^=$.high,b.low^=$.low}},_doFinalize:function(){var m=this._data,g=m.words,v=this._nDataBytes*8,x=m.sigBytes*8,y=this.blockSize*32;g[x>>>5]|=1<<24-x%32,g[(e.ceil((x+1)/y)*y>>>5)-1]|=128,m.sigBytes=g.length*4,this._process();for(var B=this._state,E=this.cfg.outputLength/8,b=E/8,C=[],T=0;T<b;T++){var _=B[T],w=_.high,S=_.low;w=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,S=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,C.push(S),C.push(w)}return new s.init(C,E)},clone:function(){for(var m=o.clone.call(this),g=m._state=this._state.slice(0),v=0;v<25;v++)g[v]=g[v].clone();return m}});t.SHA3=o._createHelper(p),t.HmacSHA3=o._createHmacHelper(p)}(Math),r.SHA3})});var Qo=G((vn,Xo)=>{(function(r,e){typeof vn=="object"?Xo.exports=vn=e(X()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(vn,function(r){return function(e){var t=r,n=t.lib,s=n.WordArray,o=n.Hasher,i=t.algo,a=s.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),c=s.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),l=s.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),f=s.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=s.create([0,1518500249,1859775393,2400959708,2840853838]),d=s.create([1352829926,1548603684,1836072691,2053994217,0]),p=i.RIPEMD160=o.extend({_doReset:function(){this._hash=s.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(E,b){for(var C=0;C<16;C++){var T=b+C,_=E[T];E[T]=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360}var w=this._hash.words,S=u.words,A=d.words,P=a.words,F=c.words,D=l.words,q=f.words,U,z,Y,R,L,I,k,Q,re,de;I=U=w[0],k=z=w[1],Q=Y=w[2],re=R=w[3],de=L=w[4];for(var $,C=0;C<80;C+=1)$=U+E[b+P[C]]|0,C<16?$+=m(z,Y,R)+S[0]:C<32?$+=g(z,Y,R)+S[1]:C<48?$+=v(z,Y,R)+S[2]:C<64?$+=x(z,Y,R)+S[3]:$+=y(z,Y,R)+S[4],$=$|0,$=B($,D[C]),$=$+L|0,U=L,L=R,R=B(Y,10),Y=z,z=$,$=I+E[b+F[C]]|0,C<16?$+=y(k,Q,re)+A[0]:C<32?$+=x(k,Q,re)+A[1]:C<48?$+=v(k,Q,re)+A[2]:C<64?$+=g(k,Q,re)+A[3]:$+=m(k,Q,re)+A[4],$=$|0,$=B($,q[C]),$=$+de|0,I=de,de=re,re=B(Q,10),Q=k,k=$;$=w[1]+Y+re|0,w[1]=w[2]+R+de|0,w[2]=w[3]+L+I|0,w[3]=w[4]+U+k|0,w[4]=w[0]+z+Q|0,w[0]=$},_doFinalize:function(){var E=this._data,b=E.words,C=this._nDataBytes*8,T=E.sigBytes*8;b[T>>>5]|=128<<24-T%32,b[(T+64>>>9<<4)+14]=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,E.sigBytes=(b.length+1)*4,this._process();for(var _=this._hash,w=_.words,S=0;S<5;S++){var A=w[S];w[S]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360}return _},clone:function(){var E=o.clone.call(this);return E._hash=this._hash.clone(),E}});function m(E,b,C){return E^b^C}function g(E,b,C){return E&b|~E&C}function v(E,b,C){return(E|~b)^C}function x(E,b,C){return E&C|b&~C}function y(E,b,C){return E^(b|~C)}function B(E,b){return E<<b|E>>>32-b}t.RIPEMD160=o._createHelper(p),t.HmacRIPEMD160=o._createHmacHelper(p)}(Math),r.RIPEMD160})});var br=G((Bn,Jo)=>{(function(r,e){typeof Bn=="object"?Jo.exports=Bn=e(X()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(Bn,function(r){(function(){var e=r,t=e.lib,n=t.Base,s=e.enc,o=s.Utf8,i=e.algo,a=i.HMAC=n.extend({init:function(c,l){c=this._hasher=new c.init,typeof l=="string"&&(l=o.parse(l));var f=c.blockSize,u=f*4;l.sigBytes>u&&(l=c.finalize(l)),l.clamp();for(var d=this._oKey=l.clone(),p=this._iKey=l.clone(),m=d.words,g=p.words,v=0;v<f;v++)m[v]^=1549556828,g[v]^=909522486;d.sigBytes=p.sigBytes=u,this.reset()},reset:function(){var c=this._hasher;c.reset(),c.update(this._iKey)},update:function(c){return this._hasher.update(c),this},finalize:function(c){var l=this._hasher,f=l.finalize(c);l.reset();var u=l.finalize(this._oKey.clone().concat(f));return u}})})()})});var ti=G((Cn,ei)=>{(function(r,e,t){typeof Cn=="object"?ei.exports=Cn=e(X(),Zt(),br()):typeof define=="function"&&define.amd?define(["./core","./sha256","./hmac"],e):e(r.CryptoJS)})(Cn,function(r){return function(){var e=r,t=e.lib,n=t.Base,s=t.WordArray,o=e.algo,i=o.SHA256,a=o.HMAC,c=o.PBKDF2=n.extend({cfg:n.extend({keySize:128/32,hasher:i,iterations:25e4}),init:function(l){this.cfg=this.cfg.extend(l)},compute:function(l,f){for(var u=this.cfg,d=a.create(u.hasher,l),p=s.create(),m=s.create([1]),g=p.words,v=m.words,x=u.keySize,y=u.iterations;g.length<x;){var B=d.update(f).finalize(m);d.reset();for(var E=B.words,b=E.length,C=B,T=1;T<y;T++){C=d.finalize(C),d.reset();for(var _=C.words,w=0;w<b;w++)E[w]^=_[w]}p.concat(B),v[0]++}return p.sigBytes=x*4,p}});e.PBKDF2=function(l,f,u){return c.create(u).compute(l,f)}}(),r.PBKDF2})});var rt=G((En,ri)=>{(function(r,e,t){typeof En=="object"?ri.exports=En=e(X(),V0(),br()):typeof define=="function"&&define.amd?define(["./core","./sha1","./hmac"],e):e(r.CryptoJS)})(En,function(r){return function(){var e=r,t=e.lib,n=t.Base,s=t.WordArray,o=e.algo,i=o.MD5,a=o.EvpKDF=n.extend({cfg:n.extend({keySize:128/32,hasher:i,iterations:1}),init:function(c){this.cfg=this.cfg.extend(c)},compute:function(c,l){for(var f,u=this.cfg,d=u.hasher.create(),p=s.create(),m=p.words,g=u.keySize,v=u.iterations;m.length<g;){f&&d.update(f),f=d.update(c).finalize(l),d.reset();for(var x=1;x<v;x++)f=d.finalize(f),d.reset();p.concat(f)}return p.sigBytes=g*4,p}});e.EvpKDF=function(c,l,f){return a.create(f).compute(c,l)}}(),r.EvpKDF})});var ue=G((bn,ni)=>{(function(r,e,t){typeof bn=="object"?ni.exports=bn=e(X(),rt()):typeof define=="function"&&define.amd?define(["./core","./evpkdf"],e):e(r.CryptoJS)})(bn,function(r){r.lib.Cipher||function(e){var t=r,n=t.lib,s=n.Base,o=n.WordArray,i=n.BufferedBlockAlgorithm,a=t.enc,c=a.Utf8,l=a.Base64,f=t.algo,u=f.EvpKDF,d=n.Cipher=i.extend({cfg:s.extend(),createEncryptor:function(A,P){return this.create(this._ENC_XFORM_MODE,A,P)},createDecryptor:function(A,P){return this.create(this._DEC_XFORM_MODE,A,P)},init:function(A,P,F){this.cfg=this.cfg.extend(F),this._xformMode=A,this._key=P,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(A){return this._append(A),this._process()},finalize:function(A){A&&this._append(A);var P=this._doFinalize();return P},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function A(P){return typeof P=="string"?S:T}return function(P){return{encrypt:function(F,D,q){return A(D).encrypt(P,F,D,q)},decrypt:function(F,D,q){return A(D).decrypt(P,F,D,q)}}}}()}),p=n.StreamCipher=d.extend({_doFinalize:function(){var A=this._process(!0);return A},blockSize:1}),m=t.mode={},g=n.BlockCipherMode=s.extend({createEncryptor:function(A,P){return this.Encryptor.create(A,P)},createDecryptor:function(A,P){return this.Decryptor.create(A,P)},init:function(A,P){this._cipher=A,this._iv=P}}),v=m.CBC=function(){var A=g.extend();A.Encryptor=A.extend({processBlock:function(F,D){var q=this._cipher,U=q.blockSize;P.call(this,F,D,U),q.encryptBlock(F,D),this._prevBlock=F.slice(D,D+U)}}),A.Decryptor=A.extend({processBlock:function(F,D){var q=this._cipher,U=q.blockSize,z=F.slice(D,D+U);q.decryptBlock(F,D),P.call(this,F,D,U),this._prevBlock=z}});function P(F,D,q){var U,z=this._iv;z?(U=z,this._iv=e):U=this._prevBlock;for(var Y=0;Y<q;Y++)F[D+Y]^=U[Y]}return A}(),x=t.pad={},y=x.Pkcs7={pad:function(A,P){for(var F=P*4,D=F-A.sigBytes%F,q=D<<24|D<<16|D<<8|D,U=[],z=0;z<D;z+=4)U.push(q);var Y=o.create(U,D);A.concat(Y)},unpad:function(A){var P=A.words[A.sigBytes-1>>>2]&255;A.sigBytes-=P}},B=n.BlockCipher=d.extend({cfg:d.cfg.extend({mode:v,padding:y}),reset:function(){var A;d.reset.call(this);var P=this.cfg,F=P.iv,D=P.mode;this._xformMode==this._ENC_XFORM_MODE?A=D.createEncryptor:(A=D.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==A?this._mode.init(this,F&&F.words):(this._mode=A.call(D,this,F&&F.words),this._mode.__creator=A)},_doProcessBlock:function(A,P){this._mode.processBlock(A,P)},_doFinalize:function(){var A,P=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(P.pad(this._data,this.blockSize),A=this._process(!0)):(A=this._process(!0),P.unpad(A)),A},blockSize:128/32}),E=n.CipherParams=s.extend({init:function(A){this.mixIn(A)},toString:function(A){return(A||this.formatter).stringify(this)}}),b=t.format={},C=b.OpenSSL={stringify:function(A){var P,F=A.ciphertext,D=A.salt;return D?P=o.create([1398893684,1701076831]).concat(D).concat(F):P=F,P.toString(l)},parse:function(A){var P,F=l.parse(A),D=F.words;return D[0]==1398893684&&D[1]==1701076831&&(P=o.create(D.slice(2,4)),D.splice(0,4),F.sigBytes-=16),E.create({ciphertext:F,salt:P})}},T=n.SerializableCipher=s.extend({cfg:s.extend({format:C}),encrypt:function(A,P,F,D){D=this.cfg.extend(D);var q=A.createEncryptor(F,D),U=q.finalize(P),z=q.cfg;return E.create({ciphertext:U,key:F,iv:z.iv,algorithm:A,mode:z.mode,padding:z.padding,blockSize:A.blockSize,formatter:D.format})},decrypt:function(A,P,F,D){D=this.cfg.extend(D),P=this._parse(P,D.format);var q=A.createDecryptor(F,D).finalize(P.ciphertext);return q},_parse:function(A,P){return typeof A=="string"?P.parse(A,this):A}}),_=t.kdf={},w=_.OpenSSL={execute:function(A,P,F,D,q){if(D||(D=o.random(64/8)),q)var U=u.create({keySize:P+F,hasher:q}).compute(A,D);else var U=u.create({keySize:P+F}).compute(A,D);var z=o.create(U.words.slice(P),F*4);return U.sigBytes=P*4,E.create({key:U,iv:z,salt:D})}},S=n.PasswordBasedCipher=T.extend({cfg:T.cfg.extend({kdf:w}),encrypt:function(A,P,F,D){D=this.cfg.extend(D);var q=D.kdf.execute(F,A.keySize,A.ivSize,D.salt,D.hasher);D.iv=q.iv;var U=T.encrypt.call(this,A,P,q.key,D);return U.mixIn(q),U},decrypt:function(A,P,F,D){D=this.cfg.extend(D),P=this._parse(P,D.format);var q=D.kdf.execute(F,A.keySize,A.ivSize,P.salt,D.hasher);D.iv=q.iv;var U=T.decrypt.call(this,A,P,q.key,D);return U}})}()})});var oi=G((An,si)=>{(function(r,e,t){typeof An=="object"?si.exports=An=e(X(),ue()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(An,function(r){return r.mode.CFB=function(){var e=r.lib.BlockCipherMode.extend();e.Encryptor=e.extend({processBlock:function(n,s){var o=this._cipher,i=o.blockSize;t.call(this,n,s,i,o),this._prevBlock=n.slice(s,s+i)}}),e.Decryptor=e.extend({processBlock:function(n,s){var o=this._cipher,i=o.blockSize,a=n.slice(s,s+i);t.call(this,n,s,i,o),this._prevBlock=a}});function t(n,s,o,i){var a,c=this._iv;c?(a=c.slice(0),this._iv=void 0):a=this._prevBlock,i.encryptBlock(a,0);for(var l=0;l<o;l++)n[s+l]^=a[l]}return e}(),r.mode.CFB})});var ai=G((wn,ii)=>{(function(r,e,t){typeof wn=="object"?ii.exports=wn=e(X(),ue()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(wn,function(r){return r.mode.CTR=function(){var e=r.lib.BlockCipherMode.extend(),t=e.Encryptor=e.extend({processBlock:function(n,s){var o=this._cipher,i=o.blockSize,a=this._iv,c=this._counter;a&&(c=this._counter=a.slice(0),this._iv=void 0);var l=c.slice(0);o.encryptBlock(l,0),c[i-1]=c[i-1]+1|0;for(var f=0;f<i;f++)n[s+f]^=l[f]}});return e.Decryptor=t,e}(),r.mode.CTR})});var fi=G((Dn,ci)=>{(function(r,e,t){typeof Dn=="object"?ci.exports=Dn=e(X(),ue()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(Dn,function(r){return r.mode.CTRGladman=function(){var e=r.lib.BlockCipherMode.extend();function t(o){if((o>>24&255)===255){var i=o>>16&255,a=o>>8&255,c=o&255;i===255?(i=0,a===255?(a=0,c===255?c=0:++c):++a):++i,o=0,o+=i<<16,o+=a<<8,o+=c}else o+=1<<24;return o}function n(o){return(o[0]=t(o[0]))===0&&(o[1]=t(o[1])),o}var s=e.Encryptor=e.extend({processBlock:function(o,i){var a=this._cipher,c=a.blockSize,l=this._iv,f=this._counter;l&&(f=this._counter=l.slice(0),this._iv=void 0),n(f);var u=f.slice(0);a.encryptBlock(u,0);for(var d=0;d<c;d++)o[i+d]^=u[d]}});return e.Decryptor=s,e}(),r.mode.CTRGladman})});var ui=G((_n,di)=>{(function(r,e,t){typeof _n=="object"?di.exports=_n=e(X(),ue()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(_n,function(r){return r.mode.OFB=function(){var e=r.lib.BlockCipherMode.extend(),t=e.Encryptor=e.extend({processBlock:function(n,s){var o=this._cipher,i=o.blockSize,a=this._iv,c=this._keystream;a&&(c=this._keystream=a.slice(0),this._iv=void 0),o.encryptBlock(c,0);for(var l=0;l<i;l++)n[s+l]^=c[l]}});return e.Decryptor=t,e}(),r.mode.OFB})});var xi=G((Rn,li)=>{(function(r,e,t){typeof Rn=="object"?li.exports=Rn=e(X(),ue()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(Rn,function(r){return r.mode.ECB=function(){var e=r.lib.BlockCipherMode.extend();return e.Encryptor=e.extend({processBlock:function(t,n){this._cipher.encryptBlock(t,n)}}),e.Decryptor=e.extend({processBlock:function(t,n){this._cipher.decryptBlock(t,n)}}),e}(),r.mode.ECB})});var pi=G((Sn,hi)=>{(function(r,e,t){typeof Sn=="object"?hi.exports=Sn=e(X(),ue()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(Sn,function(r){return r.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,s=t*4,o=s-n%s,i=n+o-1;e.clamp(),e.words[i>>>2]|=o<<24-i%4*8,e.sigBytes+=o},unpad:function(e){var t=e.words[e.sigBytes-1>>>2]&255;e.sigBytes-=t}},r.pad.Ansix923})});var mi=G((Tn,yi)=>{(function(r,e,t){typeof Tn=="object"?yi.exports=Tn=e(X(),ue()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(Tn,function(r){return r.pad.Iso10126={pad:function(e,t){var n=t*4,s=n-e.sigBytes%n;e.concat(r.lib.WordArray.random(s-1)).concat(r.lib.WordArray.create([s<<24],1))},unpad:function(e){var t=e.words[e.sigBytes-1>>>2]&255;e.sigBytes-=t}},r.pad.Iso10126})});var vi=G((Fn,gi)=>{(function(r,e,t){typeof Fn=="object"?gi.exports=Fn=e(X(),ue()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(Fn,function(r){return r.pad.Iso97971={pad:function(e,t){e.concat(r.lib.WordArray.create([2147483648],1)),r.pad.ZeroPadding.pad(e,t)},unpad:function(e){r.pad.ZeroPadding.unpad(e),e.sigBytes--}},r.pad.Iso97971})});var Ci=G((Pn,Bi)=>{(function(r,e,t){typeof Pn=="object"?Bi.exports=Pn=e(X(),ue()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(Pn,function(r){return r.pad.ZeroPadding={pad:function(e,t){var n=t*4;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){for(var t=e.words,n=e.sigBytes-1,n=e.sigBytes-1;n>=0;n--)if(t[n>>>2]>>>24-n%4*8&255){e.sigBytes=n+1;break}}},r.pad.ZeroPadding})});var bi=G((Hn,Ei)=>{(function(r,e,t){typeof Hn=="object"?Ei.exports=Hn=e(X(),ue()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(Hn,function(r){return r.pad.NoPadding={pad:function(){},unpad:function(){}},r.pad.NoPadding})});var wi=G((kn,Ai)=>{(function(r,e,t){typeof kn=="object"?Ai.exports=kn=e(X(),ue()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(r.CryptoJS)})(kn,function(r){return function(e){var t=r,n=t.lib,s=n.CipherParams,o=t.enc,i=o.Hex,a=t.format,c=a.Hex={stringify:function(l){return l.ciphertext.toString(i)},parse:function(l){var f=i.parse(l);return s.create({ciphertext:f})}}}(),r.format.Hex})});var _i=G((Ln,Di)=>{(function(r,e,t){typeof Ln=="object"?Di.exports=Ln=e(X(),gt(),vt(),rt(),ue()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(r.CryptoJS)})(Ln,function(r){return function(){var e=r,t=e.lib,n=t.BlockCipher,s=e.algo,o=[],i=[],a=[],c=[],l=[],f=[],u=[],d=[],p=[],m=[];(function(){for(var x=[],y=0;y<256;y++)y<128?x[y]=y<<1:x[y]=y<<1^283;for(var B=0,E=0,y=0;y<256;y++){var b=E^E<<1^E<<2^E<<3^E<<4;b=b>>>8^b&255^99,o[B]=b,i[b]=B;var C=x[B],T=x[C],_=x[T],w=x[b]*257^b*16843008;a[B]=w<<24|w>>>8,c[B]=w<<16|w>>>16,l[B]=w<<8|w>>>24,f[B]=w;var w=_*16843009^T*65537^C*257^B*16843008;u[b]=w<<24|w>>>8,d[b]=w<<16|w>>>16,p[b]=w<<8|w>>>24,m[b]=w,B?(B=C^x[x[x[_^C]]],E^=x[x[E]]):B=E=1}})();var g=[0,1,2,4,8,16,32,64,128,27,54],v=s.AES=n.extend({_doReset:function(){var x;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var y=this._keyPriorReset=this._key,B=y.words,E=y.sigBytes/4,b=this._nRounds=E+6,C=(b+1)*4,T=this._keySchedule=[],_=0;_<C;_++)_<E?T[_]=B[_]:(x=T[_-1],_%E?E>6&&_%E==4&&(x=o[x>>>24]<<24|o[x>>>16&255]<<16|o[x>>>8&255]<<8|o[x&255]):(x=x<<8|x>>>24,x=o[x>>>24]<<24|o[x>>>16&255]<<16|o[x>>>8&255]<<8|o[x&255],x^=g[_/E|0]<<24),T[_]=T[_-E]^x);for(var w=this._invKeySchedule=[],S=0;S<C;S++){var _=C-S;if(S%4)var x=T[_];else var x=T[_-4];S<4||_<=4?w[S]=x:w[S]=u[o[x>>>24]]^d[o[x>>>16&255]]^p[o[x>>>8&255]]^m[o[x&255]]}}},encryptBlock:function(x,y){this._doCryptBlock(x,y,this._keySchedule,a,c,l,f,o)},decryptBlock:function(x,y){var B=x[y+1];x[y+1]=x[y+3],x[y+3]=B,this._doCryptBlock(x,y,this._invKeySchedule,u,d,p,m,i);var B=x[y+1];x[y+1]=x[y+3],x[y+3]=B},_doCryptBlock:function(x,y,B,E,b,C,T,_){for(var w=this._nRounds,S=x[y]^B[0],A=x[y+1]^B[1],P=x[y+2]^B[2],F=x[y+3]^B[3],D=4,q=1;q<w;q++){var U=E[S>>>24]^b[A>>>16&255]^C[P>>>8&255]^T[F&255]^B[D++],z=E[A>>>24]^b[P>>>16&255]^C[F>>>8&255]^T[S&255]^B[D++],Y=E[P>>>24]^b[F>>>16&255]^C[S>>>8&255]^T[A&255]^B[D++],R=E[F>>>24]^b[S>>>16&255]^C[A>>>8&255]^T[P&255]^B[D++];S=U,A=z,P=Y,F=R}var U=(_[S>>>24]<<24|_[A>>>16&255]<<16|_[P>>>8&255]<<8|_[F&255])^B[D++],z=(_[A>>>24]<<24|_[P>>>16&255]<<16|_[F>>>8&255]<<8|_[S&255])^B[D++],Y=(_[P>>>24]<<24|_[F>>>16&255]<<16|_[S>>>8&255]<<8|_[A&255])^B[D++],R=(_[F>>>24]<<24|_[S>>>16&255]<<16|_[A>>>8&255]<<8|_[P&255])^B[D++];x[y]=U,x[y+1]=z,x[y+2]=Y,x[y+3]=R},keySize:256/32});e.AES=n._createHelper(v)}(),r.AES})});var Si=G((In,Ri)=>{(function(r,e,t){typeof In=="object"?Ri.exports=In=e(X(),gt(),vt(),rt(),ue()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(r.CryptoJS)})(In,function(r){return function(){var e=r,t=e.lib,n=t.WordArray,s=t.BlockCipher,o=e.algo,i=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],l=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],f=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],u=o.DES=s.extend({_doReset:function(){for(var g=this._key,v=g.words,x=[],y=0;y<56;y++){var B=i[y]-1;x[y]=v[B>>>5]>>>31-B%32&1}for(var E=this._subKeys=[],b=0;b<16;b++){for(var C=E[b]=[],T=c[b],y=0;y<24;y++)C[y/6|0]|=x[(a[y]-1+T)%28]<<31-y%6,C[4+(y/6|0)]|=x[28+(a[y+24]-1+T)%28]<<31-y%6;C[0]=C[0]<<1|C[0]>>>31;for(var y=1;y<7;y++)C[y]=C[y]>>>(y-1)*4+3;C[7]=C[7]<<5|C[7]>>>27}for(var _=this._invSubKeys=[],y=0;y<16;y++)_[y]=E[15-y]},encryptBlock:function(g,v){this._doCryptBlock(g,v,this._subKeys)},decryptBlock:function(g,v){this._doCryptBlock(g,v,this._invSubKeys)},_doCryptBlock:function(g,v,x){this._lBlock=g[v],this._rBlock=g[v+1],d.call(this,4,252645135),d.call(this,16,65535),p.call(this,2,858993459),p.call(this,8,16711935),d.call(this,1,1431655765);for(var y=0;y<16;y++){for(var B=x[y],E=this._lBlock,b=this._rBlock,C=0,T=0;T<8;T++)C|=l[T][((b^B[T])&f[T])>>>0];this._lBlock=b,this._rBlock=E^C}var _=this._lBlock;this._lBlock=this._rBlock,this._rBlock=_,d.call(this,1,1431655765),p.call(this,8,16711935),p.call(this,2,858993459),d.call(this,16,65535),d.call(this,4,252645135),g[v]=this._lBlock,g[v+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function d(g,v){var x=(this._lBlock>>>g^this._rBlock)&v;this._rBlock^=x,this._lBlock^=x<<g}function p(g,v){var x=(this._rBlock>>>g^this._lBlock)&v;this._lBlock^=x,this._rBlock^=x<<g}e.DES=s._createHelper(u);var m=o.TripleDES=s.extend({_doReset:function(){var g=this._key,v=g.words;if(v.length!==2&&v.length!==4&&v.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var x=v.slice(0,2),y=v.length<4?v.slice(0,2):v.slice(2,4),B=v.length<6?v.slice(0,2):v.slice(4,6);this._des1=u.createEncryptor(n.create(x)),this._des2=u.createEncryptor(n.create(y)),this._des3=u.createEncryptor(n.create(B))},encryptBlock:function(g,v){this._des1.encryptBlock(g,v),this._des2.decryptBlock(g,v),this._des3.encryptBlock(g,v)},decryptBlock:function(g,v){this._des3.decryptBlock(g,v),this._des2.encryptBlock(g,v),this._des1.decryptBlock(g,v)},keySize:192/32,ivSize:64/32,blockSize:64/32});e.TripleDES=s._createHelper(m)}(),r.TripleDES})});var Fi=G((On,Ti)=>{(function(r,e,t){typeof On=="object"?Ti.exports=On=e(X(),gt(),vt(),rt(),ue()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(r.CryptoJS)})(On,function(r){return function(){var e=r,t=e.lib,n=t.StreamCipher,s=e.algo,o=s.RC4=n.extend({_doReset:function(){for(var c=this._key,l=c.words,f=c.sigBytes,u=this._S=[],d=0;d<256;d++)u[d]=d;for(var d=0,p=0;d<256;d++){var m=d%f,g=l[m>>>2]>>>24-m%4*8&255;p=(p+u[d]+g)%256;var v=u[d];u[d]=u[p],u[p]=v}this._i=this._j=0},_doProcessBlock:function(c,l){c[l]^=i.call(this)},keySize:256/32,ivSize:0});function i(){for(var c=this._S,l=this._i,f=this._j,u=0,d=0;d<4;d++){l=(l+1)%256,f=(f+c[l])%256;var p=c[l];c[l]=c[f],c[f]=p,u|=c[(c[l]+c[f])%256]<<24-d*8}return this._i=l,this._j=f,u}e.RC4=n._createHelper(o);var a=s.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var c=this.cfg.drop;c>0;c--)i.call(this)}});e.RC4Drop=n._createHelper(a)}(),r.RC4})});var Hi=G((qn,Pi)=>{(function(r,e,t){typeof qn=="object"?Pi.exports=qn=e(X(),gt(),vt(),rt(),ue()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(r.CryptoJS)})(qn,function(r){return function(){var e=r,t=e.lib,n=t.StreamCipher,s=e.algo,o=[],i=[],a=[],c=s.Rabbit=n.extend({_doReset:function(){for(var f=this._key.words,u=this.cfg.iv,d=0;d<4;d++)f[d]=(f[d]<<8|f[d]>>>24)&16711935|(f[d]<<24|f[d]>>>8)&4278255360;var p=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],m=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var d=0;d<4;d++)l.call(this);for(var d=0;d<8;d++)m[d]^=p[d+4&7];if(u){var g=u.words,v=g[0],x=g[1],y=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,B=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,E=y>>>16|B&4294901760,b=B<<16|y&65535;m[0]^=y,m[1]^=E,m[2]^=B,m[3]^=b,m[4]^=y,m[5]^=E,m[6]^=B,m[7]^=b;for(var d=0;d<4;d++)l.call(this)}},_doProcessBlock:function(f,u){var d=this._X;l.call(this),o[0]=d[0]^d[5]>>>16^d[3]<<16,o[1]=d[2]^d[7]>>>16^d[5]<<16,o[2]=d[4]^d[1]>>>16^d[7]<<16,o[3]=d[6]^d[3]>>>16^d[1]<<16;for(var p=0;p<4;p++)o[p]=(o[p]<<8|o[p]>>>24)&16711935|(o[p]<<24|o[p]>>>8)&4278255360,f[u+p]^=o[p]},blockSize:128/32,ivSize:64/32});function l(){for(var f=this._X,u=this._C,d=0;d<8;d++)i[d]=u[d];u[0]=u[0]+1295307597+this._b|0,u[1]=u[1]+3545052371+(u[0]>>>0<i[0]>>>0?1:0)|0,u[2]=u[2]+886263092+(u[1]>>>0<i[1]>>>0?1:0)|0,u[3]=u[3]+1295307597+(u[2]>>>0<i[2]>>>0?1:0)|0,u[4]=u[4]+3545052371+(u[3]>>>0<i[3]>>>0?1:0)|0,u[5]=u[5]+886263092+(u[4]>>>0<i[4]>>>0?1:0)|0,u[6]=u[6]+1295307597+(u[5]>>>0<i[5]>>>0?1:0)|0,u[7]=u[7]+3545052371+(u[6]>>>0<i[6]>>>0?1:0)|0,this._b=u[7]>>>0<i[7]>>>0?1:0;for(var d=0;d<8;d++){var p=f[d]+u[d],m=p&65535,g=p>>>16,v=((m*m>>>17)+m*g>>>15)+g*g,x=((p&4294901760)*p|0)+((p&65535)*p|0);a[d]=v^x}f[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,f[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,f[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,f[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,f[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,f[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,f[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,f[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.Rabbit=n._createHelper(c)}(),r.Rabbit})});var Li=G((Un,ki)=>{(function(r,e,t){typeof Un=="object"?ki.exports=Un=e(X(),gt(),vt(),rt(),ue()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(r.CryptoJS)})(Un,function(r){return function(){var e=r,t=e.lib,n=t.StreamCipher,s=e.algo,o=[],i=[],a=[],c=s.RabbitLegacy=n.extend({_doReset:function(){var f=this._key.words,u=this.cfg.iv,d=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],p=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var m=0;m<4;m++)l.call(this);for(var m=0;m<8;m++)p[m]^=d[m+4&7];if(u){var g=u.words,v=g[0],x=g[1],y=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,B=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,E=y>>>16|B&4294901760,b=B<<16|y&65535;p[0]^=y,p[1]^=E,p[2]^=B,p[3]^=b,p[4]^=y,p[5]^=E,p[6]^=B,p[7]^=b;for(var m=0;m<4;m++)l.call(this)}},_doProcessBlock:function(f,u){var d=this._X;l.call(this),o[0]=d[0]^d[5]>>>16^d[3]<<16,o[1]=d[2]^d[7]>>>16^d[5]<<16,o[2]=d[4]^d[1]>>>16^d[7]<<16,o[3]=d[6]^d[3]>>>16^d[1]<<16;for(var p=0;p<4;p++)o[p]=(o[p]<<8|o[p]>>>24)&16711935|(o[p]<<24|o[p]>>>8)&4278255360,f[u+p]^=o[p]},blockSize:128/32,ivSize:64/32});function l(){for(var f=this._X,u=this._C,d=0;d<8;d++)i[d]=u[d];u[0]=u[0]+1295307597+this._b|0,u[1]=u[1]+3545052371+(u[0]>>>0<i[0]>>>0?1:0)|0,u[2]=u[2]+886263092+(u[1]>>>0<i[1]>>>0?1:0)|0,u[3]=u[3]+1295307597+(u[2]>>>0<i[2]>>>0?1:0)|0,u[4]=u[4]+3545052371+(u[3]>>>0<i[3]>>>0?1:0)|0,u[5]=u[5]+886263092+(u[4]>>>0<i[4]>>>0?1:0)|0,u[6]=u[6]+1295307597+(u[5]>>>0<i[5]>>>0?1:0)|0,u[7]=u[7]+3545052371+(u[6]>>>0<i[6]>>>0?1:0)|0,this._b=u[7]>>>0<i[7]>>>0?1:0;for(var d=0;d<8;d++){var p=f[d]+u[d],m=p&65535,g=p>>>16,v=((m*m>>>17)+m*g>>>15)+g*g,x=((p&4294901760)*p|0)+((p&65535)*p|0);a[d]=v^x}f[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,f[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,f[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,f[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,f[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,f[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,f[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,f[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.RabbitLegacy=n._createHelper(c)}(),r.RabbitLegacy})});var Oi=G((Nn,Ii)=>{(function(r,e,t){typeof Nn=="object"?Ii.exports=Nn=e(X(),gt(),vt(),rt(),ue()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(r.CryptoJS)})(Nn,function(r){return function(){var e=r,t=e.lib,n=t.BlockCipher,s=e.algo;let o=16,i=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],a=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var c={pbox:[],sbox:[]};function l(m,g){let v=g>>24&255,x=g>>16&255,y=g>>8&255,B=g&255,E=m.sbox[0][v]+m.sbox[1][x];return E=E^m.sbox[2][y],E=E+m.sbox[3][B],E}function f(m,g,v){let x=g,y=v,B;for(let E=0;E<o;++E)x=x^m.pbox[E],y=l(m,x)^y,B=x,x=y,y=B;return B=x,x=y,y=B,y=y^m.pbox[o],x=x^m.pbox[o+1],{left:x,right:y}}function u(m,g,v){let x=g,y=v,B;for(let E=o+1;E>1;--E)x=x^m.pbox[E],y=l(m,x)^y,B=x,x=y,y=B;return B=x,x=y,y=B,y=y^m.pbox[1],x=x^m.pbox[0],{left:x,right:y}}function d(m,g,v){for(let b=0;b<4;b++){m.sbox[b]=[];for(let C=0;C<256;C++)m.sbox[b][C]=a[b][C]}let x=0;for(let b=0;b<o+2;b++)m.pbox[b]=i[b]^g[x],x++,x>=v&&(x=0);let y=0,B=0,E=0;for(let b=0;b<o+2;b+=2)E=f(m,y,B),y=E.left,B=E.right,m.pbox[b]=y,m.pbox[b+1]=B;for(let b=0;b<4;b++)for(let C=0;C<256;C+=2)E=f(m,y,B),y=E.left,B=E.right,m.sbox[b][C]=y,m.sbox[b][C+1]=B;return!0}var p=s.Blowfish=n.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var m=this._keyPriorReset=this._key,g=m.words,v=m.sigBytes/4;d(c,g,v)}},encryptBlock:function(m,g){var v=f(c,m[g],m[g+1]);m[g]=v.left,m[g+1]=v.right},decryptBlock:function(m,g){var v=u(c,m[g],m[g+1]);m[g]=v.left,m[g+1]=v.right},blockSize:64/32,keySize:128/32,ivSize:64/32});e.Blowfish=n._createHelper(p)}(),r.Blowfish})});var z0=G((Mn,qi)=>{(function(r,e,t){typeof Mn=="object"?qi.exports=Mn=e(X(),Er(),Lo(),Oo(),gt(),No(),vt(),V0(),Zt(),Go(),K0(),jo(),Zo(),Qo(),br(),ti(),rt(),ue(),oi(),ai(),fi(),ui(),xi(),pi(),mi(),vi(),Ci(),bi(),wi(),_i(),Si(),Fi(),Hi(),Li(),Oi()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./lib-typedarrays","./enc-utf16","./enc-base64","./enc-base64url","./md5","./sha1","./sha256","./sha224","./sha512","./sha384","./sha3","./ripemd160","./hmac","./pbkdf2","./evpkdf","./cipher-core","./mode-cfb","./mode-ctr","./mode-ctr-gladman","./mode-ofb","./mode-ecb","./pad-ansix923","./pad-iso10126","./pad-iso97971","./pad-zeropadding","./pad-nopadding","./format-hex","./aes","./tripledes","./rc4","./rabbit","./rabbit-legacy","./blowfish"],e):r.CryptoJS=e(r.CryptoJS)})(Mn,function(r){return r})});var Kn=G(Vn=>{"use strict";Object.defineProperty(Vn,"__esModule",{value:!0});Vn.ChannelCrypto=void 0;var Re=z0(),Xt=he(),G0=class{static decryptGroupTextMessage(e,t,n){try{let s=(0,Xt.hexToBytes)(n),o=(0,Xt.hexToBytes)(t),i=new Uint8Array(32);i.set(s,0);let a=(0,Re.HmacSHA256)(Re.enc.Hex.parse(e),Re.enc.Hex.parse((0,Xt.bytesToHex)(i))),l=(0,Xt.hexToBytes)(a.toString(Re.enc.Hex)).slice(0,2);if(l[0]!==o[0]||l[1]!==o[1])return{success:!1,error:"MAC verification failed"};let f=Re.enc.Hex.parse(n),u=Re.enc.Hex.parse(e),d=Re.AES.decrypt(Re.lib.CipherParams.create({ciphertext:u}),f,{mode:Re.mode.ECB,padding:Re.pad.NoPadding}),p=(0,Xt.hexToBytes)(d.toString(Re.enc.Hex));if(!p||p.length<5)return{success:!1,error:"Decrypted content too short"};let m=p[0]|p[1]<<8|p[2]<<16|p[3]<<24,g=p[4],v=p.slice(5),y=new TextDecoder("utf-8").decode(v),B=y.indexOf("\0");B>=0&&(y=y.substring(0,B));let E=y.indexOf(": "),b,C;if(E>0&&E<50){let T=y.substring(0,E);/[:\[\]]/.test(T)?C=y:(b=T,C=y.substring(E+2))}else C=y;return{success:!0,data:{timestamp:m,flags:g,sender:b,message:C}}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Decryption failed"}}}static calculateChannelHash(e){let t=(0,Re.SHA256)(Re.enc.Hex.parse(e));return(0,Xt.hexToBytes)(t.toString(Re.enc.Hex))[0].toString(16).padStart(2,"0")}};Vn.ChannelCrypto=G0});var W0=G(zn=>{"use strict";Object.defineProperty(zn,"__esModule",{value:!0});zn.MeshCoreKeyStore=void 0;var sf=Kn(),Y0=class{constructor(e){this.nodeKeys=new Map,this.channelHashToKeys=new Map,e?.channelSecrets&&this.addChannelSecrets(e.channelSecrets),e?.nodeKeys&&Object.entries(e.nodeKeys).forEach(([t,n])=>{this.addNodeKey(t,n)})}addNodeKey(e,t){let n=e.toUpperCase();this.nodeKeys.set(n,t)}hasChannelKey(e){let t=e.toLowerCase();return this.channelHashToKeys.has(t)}hasNodeKey(e){let t=e.toUpperCase();return this.nodeKeys.has(t)}getChannelKeys(e){let t=e.toLowerCase();return this.channelHashToKeys.get(t)||[]}getNodeKey(e){let t=e.toUpperCase();return this.nodeKeys.get(t)}addChannelSecrets(e){for(let t of e){let n=sf.ChannelCrypto.calculateChannelHash(t).toLowerCase();this.channelHashToKeys.has(n)||this.channelHashToKeys.set(n,[]),this.channelHashToKeys.get(n).push(t)}}};zn.MeshCoreKeyStore=Y0});var ia={};Eo(ia,{CURVE:()=>Yi,ExtendedPoint:()=>je,Point:()=>je,etc:()=>as,getPublicKey:()=>hf,getPublicKeyAsync:()=>xf,sign:()=>yf,signAsync:()=>pf,utils:()=>vf,verify:()=>gf,verifyAsync:()=>mf});var Yi,Ce,Gn,Ui,Ni,j0,$0,of,We,Ar,ke,af,Wi,cf,It,$n,Q0,ji,J0,nt,Mi,es,Bt,$i,ff,wr,Zi,Yn,Lt,M,Xi,Qi,df,Vi,Z0,Ye,je,st,Qt,Ji,ts,Ge,uf,Ki,lf,Wn,rs,ns,ea,ss,os,xf,hf,ta,ra,na,pf,yf,is,sa,mf,gf,as,vf,jn,Bf,oa,X0,Cf,zi,Gi,Ef,aa=He(()=>{Yi={p:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffedn,n:0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3edn,h:8n,a:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffecn,d:0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3n,Gx:0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,Gy:0x6666666666666666666666666666666666666666666666666666666666666658n},{p:Ce,n:Gn,Gx:Ui,Gy:Ni,a:j0,d:$0}=Yi,of=8n,We=32,Ar=64,ke=(r="")=>{throw new Error(r)},af=r=>typeof r=="bigint",Wi=r=>typeof r=="string",cf=r=>r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array",It=(r,e)=>!cf(r)||typeof e=="number"&&e>0&&r.length!==e?ke("Uint8Array expected"):r,$n=r=>new Uint8Array(r),Q0=r=>Uint8Array.from(r),ji=(r,e)=>r.toString(16).padStart(e,"0"),J0=r=>Array.from(It(r)).map(e=>ji(e,2)).join(""),nt={_0:48,_9:57,A:65,F:70,a:97,f:102},Mi=r=>{if(r>=nt._0&&r<=nt._9)return r-nt._0;if(r>=nt.A&&r<=nt.F)return r-(nt.A-10);if(r>=nt.a&&r<=nt.f)return r-(nt.a-10)},es=r=>{let e="hex invalid";if(!Wi(r))return ke(e);let t=r.length,n=t/2;if(t%2)return ke(e);let s=$n(n);for(let o=0,i=0;o<n;o++,i+=2){let a=Mi(r.charCodeAt(i)),c=Mi(r.charCodeAt(i+1));if(a===void 0||c===void 0)return ke(e);s[o]=a*16+c}return s},Bt=(r,e)=>It(Wi(r)?es(r):Q0(It(r)),e),$i=()=>globalThis?.crypto,ff=()=>$i()?.subtle??ke("crypto.subtle must be defined"),wr=(...r)=>{let e=$n(r.reduce((n,s)=>n+It(s).length,0)),t=0;return r.forEach(n=>{e.set(n,t),t+=n.length}),e},Zi=(r=We)=>$i().getRandomValues($n(r)),Yn=BigInt,Lt=(r,e,t,n="bad number: out of range")=>af(r)&&e<=r&&r<t?r:ke(n),M=(r,e=Ce)=>{let t=r%e;return t>=0n?t:e+t},Xi=r=>M(r,Gn),Qi=(r,e)=>{(r===0n||e<=0n)&&ke("no inverse n="+r+" mod="+e);let t=M(r,e),n=e,s=0n,o=1n,i=1n,a=0n;for(;t!==0n;){let c=n/t,l=n%t,f=s-i*c,u=o-a*c;n=t,t=l,s=i,o=a,i=f,a=u}return n===1n?M(s,e):ke("no inverse")},df=r=>{let e=as[r];return typeof e!="function"&&ke("hashes."+r+" not set"),e},Vi=r=>r instanceof je?r:ke("Point expected"),Z0=2n**256n,Ye=class Ye{constructor(e,t,n,s){W(this,"ex");W(this,"ey");W(this,"ez");W(this,"et");let o=Z0;this.ex=Lt(e,0n,o),this.ey=Lt(t,0n,o),this.ez=Lt(n,1n,o),this.et=Lt(s,0n,o),Object.freeze(this)}static fromAffine(e){return new Ye(e.x,e.y,1n,M(e.x*e.y))}static fromBytes(e,t=!1){let n=$0,s=Q0(It(e,We)),o=e[31];s[31]=o&-129;let i=ts(s);Lt(i,0n,t?Z0:Ce);let c=M(i*i),l=M(c-1n),f=M(n*c+1n),{isValid:u,value:d}=lf(l,f);u||ke("bad point: y not sqrt");let p=(d&1n)===1n,m=(o&128)!==0;return!t&&d===0n&&m&&ke("bad point: x==0, isLastByteOdd"),m!==p&&(d=M(-d)),new Ye(d,i,1n,M(d*i))}assertValidity(){let e=j0,t=$0,n=this;if(n.is0())throw new Error("bad point: ZERO");let{ex:s,ey:o,ez:i,et:a}=n,c=M(s*s),l=M(o*o),f=M(i*i),u=M(f*f),d=M(c*e),p=M(f*M(d+l)),m=M(u+M(t*M(c*l)));if(p!==m)throw new Error("bad point: equation left != right (1)");let g=M(s*o),v=M(i*a);if(g!==v)throw new Error("bad point: equation left != right (2)");return this}equals(e){let{ex:t,ey:n,ez:s}=this,{ex:o,ey:i,ez:a}=Vi(e),c=M(t*a),l=M(o*s),f=M(n*a),u=M(i*s);return c===l&&f===u}is0(){return this.equals(Qt)}negate(){return new Ye(M(-this.ex),this.ey,this.ez,M(-this.et))}double(){let{ex:e,ey:t,ez:n}=this,s=j0,o=M(e*e),i=M(t*t),a=M(2n*M(n*n)),c=M(s*o),l=e+t,f=M(M(l*l)-o-i),u=c+i,d=u-a,p=c-i,m=M(f*d),g=M(u*p),v=M(f*p),x=M(d*u);return new Ye(m,g,x,v)}add(e){let{ex:t,ey:n,ez:s,et:o}=this,{ex:i,ey:a,ez:c,et:l}=Vi(e),f=j0,u=$0,d=M(t*i),p=M(n*a),m=M(o*u*l),g=M(s*c),v=M((t+n)*(i+a)-d-p),x=M(g-m),y=M(g+m),B=M(p-f*d),E=M(v*x),b=M(y*B),C=M(v*B),T=M(x*y);return new Ye(E,b,T,C)}multiply(e,t=!0){if(!t&&(e===0n||this.is0()))return Qt;if(Lt(e,1n,Gn),e===1n)return this;if(this.equals(st))return Ef(e).p;let n=Qt,s=st;for(let o=this;e>0n;o=o.double(),e>>=1n)e&1n?n=n.add(o):t&&(s=s.add(o));return n}toAffine(){let{ex:e,ey:t,ez:n}=this;if(this.equals(Qt))return{x:0n,y:1n};let s=Qi(n,Ce);return M(n*s)!==1n&&ke("invalid inverse"),{x:M(e*s),y:M(t*s)}}toBytes(){let{x:e,y:t}=this.assertValidity().toAffine(),n=Ji(t);return n[31]|=e&1n?128:0,n}toHex(){return J0(this.toBytes())}clearCofactor(){return this.multiply(Yn(of),!1)}isSmallOrder(){return this.clearCofactor().is0()}isTorsionFree(){let e=this.multiply(Gn/2n,!1).double();return Gn%2n&&(e=e.add(this)),e.is0()}static fromHex(e,t){return Ye.fromBytes(Bt(e),t)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}toRawBytes(){return this.toBytes()}};W(Ye,"BASE"),W(Ye,"ZERO");je=Ye,st=new je(Ui,Ni,1n,M(Ui*Ni)),Qt=new je(0n,1n,1n,0n);je.BASE=st;je.ZERO=Qt;Ji=r=>es(ji(Lt(r,0n,Z0),Ar)).reverse(),ts=r=>Yn("0x"+J0(Q0(It(r)).reverse())),Ge=(r,e)=>{let t=r;for(;e-- >0n;)t*=t,t%=Ce;return t},uf=r=>{let t=r*r%Ce*r%Ce,n=Ge(t,2n)*t%Ce,s=Ge(n,1n)*r%Ce,o=Ge(s,5n)*s%Ce,i=Ge(o,10n)*o%Ce,a=Ge(i,20n)*i%Ce,c=Ge(a,40n)*a%Ce,l=Ge(c,80n)*c%Ce,f=Ge(l,80n)*c%Ce,u=Ge(f,10n)*o%Ce;return{pow_p_5_8:Ge(u,2n)*r%Ce,b2:t}},Ki=0x2b8324804fc1df0b2b4d00993dfbd7a72f431806ad2fe478c4ee1b274a0ea0b0n,lf=(r,e)=>{let t=M(e*e*e),n=M(t*t*e),s=uf(r*n).pow_p_5_8,o=M(r*t*s),i=M(e*o*o),a=o,c=M(o*Ki),l=i===r,f=i===M(-r),u=i===M(-r*Ki);return l&&(o=a),(f||u)&&(o=c),(M(o)&1n)===1n&&(o=M(-o)),{isValid:l||f,value:o}},Wn=r=>Xi(ts(r)),rs=(...r)=>as.sha512Async(...r),ns=(...r)=>df("sha512Sync")(...r),ea=r=>{let e=r.slice(0,We);e[0]&=248,e[31]&=127,e[31]|=64;let t=r.slice(We,Ar),n=Wn(e),s=st.multiply(n),o=s.toBytes();return{head:e,prefix:t,scalar:n,point:s,pointBytes:o}},ss=r=>rs(Bt(r,We)).then(ea),os=r=>ea(ns(Bt(r,We))),xf=r=>ss(r).then(e=>e.pointBytes),hf=r=>os(r).pointBytes,ta=r=>rs(r.hashable).then(r.finish),ra=r=>r.finish(ns(r.hashable)),na=(r,e,t)=>{let{pointBytes:n,scalar:s}=r,o=Wn(e),i=st.multiply(o).toBytes();return{hashable:wr(i,n,t),finish:l=>{let f=Xi(o+Wn(l)*s);return It(wr(i,Ji(f)),Ar)}}},pf=async(r,e)=>{let t=Bt(r),n=await ss(e),s=await rs(n.prefix,t);return ta(na(n,s,t))},yf=(r,e)=>{let t=Bt(r),n=os(e),s=ns(n.prefix,t);return ra(na(n,s,t))},is={zip215:!0},sa=(r,e,t,n=is)=>{r=Bt(r,Ar),e=Bt(e),t=Bt(t,We);let{zip215:s}=n,o,i,a,c,l=Uint8Array.of();try{o=je.fromHex(t,s),i=je.fromHex(r.slice(0,We),s),a=ts(r.slice(We,Ar)),c=st.multiply(a,!1),l=wr(i.toBytes(),o.toBytes(),e)}catch{}return{hashable:l,finish:u=>{if(c==null||!s&&o.isSmallOrder())return!1;let d=Wn(u);return i.add(o.multiply(d,!1)).add(c.negate()).clearCofactor().is0()}}},mf=async(r,e,t,n=is)=>ta(sa(r,e,t,n)),gf=(r,e,t,n=is)=>ra(sa(r,e,t,n)),as={sha512Async:async(...r)=>{let e=ff(),t=wr(...r);return $n(await e.digest("SHA-512",t.buffer))},sha512Sync:void 0,bytesToHex:J0,hexToBytes:es,concatBytes:wr,mod:M,invert:Qi,randomBytes:Zi},vf={getExtendedPublicKeyAsync:ss,getExtendedPublicKey:os,randomPrivateKey:()=>Zi(We),precompute:(r=8,e=st)=>(e.multiply(3n),e)},jn=8,Bf=256,oa=Math.ceil(Bf/jn)+1,X0=2**(jn-1),Cf=()=>{let r=[],e=st,t=e;for(let n=0;n<oa;n++){t=e,r.push(t);for(let s=1;s<X0;s++)t=t.add(e),r.push(t);e=t.double()}return r},Gi=(r,e)=>{let t=e.negate();return r?t:e},Ef=r=>{let e=zi||(zi=Cf()),t=Qt,n=st,s=2**jn,o=s,i=Yn(s-1),a=Yn(jn);for(let c=0;c<oa;c++){let l=Number(r&i);r>>=a,l>X0&&(l-=o,r+=1n);let f=c*X0,u=f,d=f+Math.abs(l)-1,p=c%2!==0,m=l<0;l===0?n=n.add(Gi(p,e[u])):t=t.add(Gi(m,e[d]))}return{p:t,f:n}}});var fa=G((ca,Zn)=>{var cs=(()=>{var r=typeof document<"u"?document.currentScript?.src:void 0;return async function(e={}){var t,n=e,s=typeof window=="object",o=typeof WorkerGlobalScope<"u",i=typeof process=="object"&&process.versions?.node&&process.type!="renderer",a=[],c="./this.program",l=(H,O)=>{throw O};typeof __filename<"u"?r=__filename:o&&(r=self.location.href);var f="";function u(H){return n.locateFile?n.locateFile(H,f):f+H}var d,p;if(i){var m=Wt("fs");f=__dirname+"/",p=H=>{H=B(H)?new URL(H):H;var O=m.readFileSync(H);return O},d=async(H,O=!0)=>{H=B(H)?new URL(H):H;var V=m.readFileSync(H,O?void 0:"utf8");return V},process.argv.length>1&&(c=process.argv[1].replace(/\\/g,"/")),a=process.argv.slice(2),l=(H,O)=>{throw process.exitCode=H,O}}else if(s||o){try{f=new URL(".",r).href}catch{}o&&(p=H=>{var O=new XMLHttpRequest;return O.open("GET",H,!1),O.responseType="arraybuffer",O.send(null),new Uint8Array(O.response)}),d=async H=>{if(B(H))return new Promise((V,J)=>{var ne=new XMLHttpRequest;ne.open("GET",H,!0),ne.responseType="arraybuffer",ne.onload=()=>{if(ne.status==200||ne.status==0&&ne.response){V(ne.response);return}J(ne.status)},ne.onerror=J,ne.send(null)});var O=await fetch(H,{credentials:"same-origin"});if(O.ok)return O.arrayBuffer();throw new Error(O.status+" : "+O.url)}}var g=console.log.bind(console),v=console.error.bind(console),x,y=!1,B=H=>H.startsWith("file://"),E,b,C,T,_,w,S,A,P,F,D,q,U,z=!1;function Y(){var H=C.buffer;n.HEAP8=T=new Int8Array(H),w=new Int16Array(H),n.HEAPU8=_=new Uint8Array(H),S=new Uint16Array(H),n.HEAP32=A=new Int32Array(H),n.HEAPU32=P=new Uint32Array(H),F=new Float32Array(H),D=new Float64Array(H),q=new BigInt64Array(H),U=new BigUint64Array(H)}function R(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)De(n.preRun.shift());pt(we)}function L(){z=!0,Pt.b()}function I(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)St(n.postRun.shift());pt(Gt)}var k=0,Q=null;function re(H){k++,n.monitorRunDependencies?.(k)}function de(H){if(k--,n.monitorRunDependencies?.(k),k==0&&Q){var O=Q;Q=null,O()}}function $(H){n.onAbort?.(H),H="Aborted("+H+")",v(H),y=!0,H+=". Build with -sASSERTIONS for more info.";var O=new WebAssembly.RuntimeError(H);throw b?.(O),O}var Fe;function qe(){return u("orlp-ed25519.wasm")}function xt(H){if(H==Fe&&x)return new Uint8Array(x);if(p)return p(H);throw"both async and sync fetching of the wasm failed"}async function Qe(H){if(!x)try{var O=await d(H);return new Uint8Array(O)}catch{}return xt(H)}async function be(H,O){try{var V=await Qe(H),J=await WebAssembly.instantiate(V,O);return J}catch(ne){v(`failed to asynchronously prepare wasm: ${ne}`),$(ne)}}async function xe(H,O,V){if(!H&&typeof WebAssembly.instantiateStreaming=="function"&&!B(O)&&!i)try{var J=fetch(O,{credentials:"same-origin"}),ne=await WebAssembly.instantiateStreaming(J,V);return ne}catch(ie){v(`wasm streaming compile failed: ${ie}`),v("falling back to ArrayBuffer instantiation")}return be(O,V)}function Je(){return{a:tn}}async function Ke(){function H(ie,se){return Pt=ie.exports,C=Pt.a,Y(),N0(Pt),de("wasm-instantiate"),Pt}re("wasm-instantiate");function O(ie){return H(ie.instance)}var V=Je();if(n.instantiateWasm)return new Promise((ie,se)=>{n.instantiateWasm(V,(ce,yt)=>{ie(H(ce,yt))})});Fe??(Fe=qe());var J=await xe(x,Fe,V),ne=O(J);return ne}class ht{constructor(O){W(this,"name","ExitStatus");this.message=`Program terminated with exit(${O})`,this.status=O}}var pt=H=>{for(;H.length>0;)H.shift()(n)},Gt=[],St=H=>Gt.push(H),we=[],De=H=>we.push(H),ze=!0,Yt=H=>gr(H),zr=()=>en(),et=H=>{var O=n["_"+H];return O},Tt=(H,O)=>{T.set(H,O)},I0=H=>{for(var O=0,V=0;V<H.length;++V){var J=H.charCodeAt(V);J<=127?O++:J<=2047?O+=2:J>=55296&&J<=57343?(O+=4,++V):O+=3}return O},Gr=(H,O,V,J)=>{if(!(J>0))return 0;for(var ne=V,ie=V+J-1,se=0;se<H.length;++se){var ce=H.codePointAt(se);if(ce<=127){if(V>=ie)break;O[V++]=ce}else if(ce<=2047){if(V+1>=ie)break;O[V++]=192|ce>>6,O[V++]=128|ce&63}else if(ce<=65535){if(V+2>=ie)break;O[V++]=224|ce>>12,O[V++]=128|ce>>6&63,O[V++]=128|ce&63}else{if(V+3>=ie)break;O[V++]=240|ce>>18,O[V++]=128|ce>>12&63,O[V++]=128|ce>>6&63,O[V++]=128|ce&63,se++}}return O[V]=0,V-ne},Yr=(H,O,V)=>Gr(H,_,O,V),tt=H=>Jr(H),Ft=H=>{var O=I0(H)+1,V=tt(O);return Yr(H,V,O),V},Wr=typeof TextDecoder<"u"?new TextDecoder:void 0,jr=(H,O=0,V=NaN)=>{for(var J=O+V,ne=O;H[ne]&&!(ne>=J);)++ne;if(ne-O>16&&H.buffer&&Wr)return Wr.decode(H.subarray(O,ne));for(var ie="";O<ne;){var se=H[O++];if(!(se&128)){ie+=String.fromCharCode(se);continue}var ce=H[O++]&63;if((se&224)==192){ie+=String.fromCharCode((se&31)<<6|ce);continue}var yt=H[O++]&63;if((se&240)==224?se=(se&15)<<12|ce<<6|yt:se=(se&7)<<18|ce<<12|yt<<6|H[O++]&63,se<65536)ie+=String.fromCharCode(se);else{var Ht=se-65536;ie+=String.fromCharCode(55296|Ht>>10,56320|Ht&1023)}}return ie},$r=(H,O)=>H?jr(_,H,O):"",Zr=(H,O,V,J,ne)=>{var ie={string:Pe=>{var Br=0;return Pe!=null&&Pe!==0&&(Br=Ft(Pe)),Br},array:Pe=>{var Br=tt(Pe.length);return Tt(Pe,Br),Br}};function se(Pe){return O==="string"?$r(Pe):O==="boolean"?!!Pe:Pe}var ce=et(H),yt=[],Ht=0;if(J)for(var kt=0;kt<J.length;kt++){var Co=ie[V[kt]];Co?(Ht===0&&(Ht=zr()),yt[kt]=Co(J[kt])):yt[kt]=J[kt]}var M0=ce(...yt);function Mc(Pe){return Ht!==0&&Yt(Ht),se(Pe)}return M0=Mc(M0),M0},O0=(H,O,V,J)=>{var ne=!V||V.every(se=>se==="number"||se==="boolean"),ie=O!=="string";return ie&&ne&&!J?et(H):(...se)=>Zr(H,O,V,se,J)};n.noExitRuntime&&(ze=n.noExitRuntime),n.print&&(g=n.print),n.printErr&&(v=n.printErr),n.wasmBinary&&(x=n.wasmBinary),n.arguments&&(a=n.arguments),n.thisProgram&&(c=n.thisProgram),n.ccall=Zr,n.cwrap=O0;var Xr,q0,Qr,U0,gr,Jr,en;function N0(H){n._orlp_derive_public_key=Xr=H.c,n._orlp_validate_keypair=q0=H.d,n._orlp_sign=Qr=H.e,n._orlp_verify=U0=H.f,gr=H.g,Jr=H.h,en=H.i}var tn={},Pt=await Ke();function vr(){if(k>0){Q=vr;return}if(R(),k>0){Q=vr;return}function H(){n.calledRun=!0,!y&&(L(),E?.(n),n.onRuntimeInitialized?.(),I())}n.setStatus?(n.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>n.setStatus(""),1),H()},1)):H()}function rn(){if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.shift()()}return rn(),vr(),z?t=n:t=new Promise((H,O)=>{E=H,b=O}),t}})();typeof ca=="object"&&typeof Zn=="object"?(Zn.exports=cs,Zn.exports.default=cs):typeof define=="function"&&define.amd&&define([],()=>cs)});var Qn=G(Jt=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.derivePublicKey=Af;Jt.validateKeyPair=wf;Jt.sign=Df;Jt.verify=_f;var Ue=he(),bf=fa();async function Xn(){return await bf()}async function Af(r){let e=await Xn(),t=(0,Ue.hexToBytes)(r);if(t.length!==64)throw new Error(`Invalid private key length: expected 64 bytes, got ${t.length}`);let n=1024,s=1088;if(e.HEAPU8.set(t,n),e.ccall("orlp_derive_public_key","number",["number","number"],[s,n])!==0)throw new Error("orlp key derivation failed: invalid private key");let i=new Uint8Array(32);return i.set(e.HEAPU8.subarray(s,s+32)),(0,Ue.bytesToHex)(i)}async function wf(r,e){try{let t=await Xn(),n=(0,Ue.hexToBytes)(r),s=(0,Ue.hexToBytes)(e);if(n.length!==64||s.length!==32)return!1;let o=2048,i=2112;return t.HEAPU8.set(n,o),t.HEAPU8.set(s,i),t.ccall("orlp_validate_keypair","number",["number","number"],[i,o])===1}catch{return!1}}async function Df(r,e,t){let n=await Xn(),s=(0,Ue.hexToBytes)(r),o=(0,Ue.hexToBytes)(e),i=(0,Ue.hexToBytes)(t);if(o.length!==64)throw new Error(`Invalid private key length: expected 64 bytes, got ${o.length}`);if(i.length!==32)throw new Error(`Invalid public key length: expected 32 bytes, got ${i.length}`);let a=1e5,c=2e5,l=3e5,f=4e5;n.HEAPU8.set(s,a),n.HEAPU8.set(o,c),n.HEAPU8.set(i,l),n.ccall("orlp_sign","void",["number","number","number","number","number"],[f,a,s.length,l,c]);let u=new Uint8Array(64);return u.set(n.HEAPU8.subarray(f,f+64)),(0,Ue.bytesToHex)(u)}async function _f(r,e,t){try{let n=await Xn(),s=(0,Ue.hexToBytes)(r),o=(0,Ue.hexToBytes)(e),i=(0,Ue.hexToBytes)(t);if(s.length!==64||i.length!==32)return!1;let a=5e5,c=6e5,l=7e5;return n.HEAPU8.set(s,c),n.HEAPU8.set(o,a),n.HEAPU8.set(i,l),n.ccall("orlp_verify","number",["number","number","number","number"],[c,a,o.length,l])===1}catch{return!1}}});var us=G($e=>{"use strict";var Rf=$e&&$e.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var s=Object.getOwnPropertyDescriptor(e,t);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,s)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Sf=$e&&$e.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Tf=$e&&$e.__importStar||function(){var r=function(e){return r=Object.getOwnPropertyNames||function(t){var n=[];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[n.length]=s);return n},r(e)};return function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n=r(e),s=0;s<n.length;s++)n[s]!=="default"&&Rf(t,e,n[s]);return Sf(t,e),t}}();Object.defineProperty($e,"__esModule",{value:!0});$e.Ed25519SignatureVerifier=void 0;var ds=Tf((aa(),jc(ia))),Ct=he(),da=Qn();async function Ff(r){if(typeof globalThis<"u"&&globalThis.crypto&&globalThis.crypto.subtle){let e=await globalThis.crypto.subtle.digest("SHA-512",r);return new Uint8Array(e)}if(typeof Wt<"u")try{let{createHash:e}=sn();return e("sha512").update(r).digest()}catch{}throw new Error("No SHA-512 implementation available")}function Pf(r){if(typeof Wt<"u")try{let{createHash:e}=sn();return e("sha512").update(r).digest()}catch{}try{let e=z0(),t=e.lib.WordArray.create(r),n=e.SHA512(t),s=new Uint8Array(64);for(let o=0;o<16;o++){let i=n.words[o]||0;s[o*4]=i>>>24&255,s[o*4+1]=i>>>16&255,s[o*4+2]=i>>>8&255,s[o*4+3]=i&255}return s}catch{throw new Error("No SHA-512 implementation available for synchronous operation")}}ds.etc.sha512Async=Ff;try{ds.etc.sha512Sync=Pf}catch(r){console.debug("Could not set up synchronous SHA-512:",r)}var fs=class{static async verifyAdvertisementSignature(e,t,n,s){try{let o=(0,Ct.hexToBytes)(e),i=(0,Ct.hexToBytes)(t),a=(0,Ct.hexToBytes)(s),c=this.constructAdvertSignedMessage(e,n,a);return await ds.verify(i,c,o)}catch(o){return console.error("Ed25519 signature verification failed:",o),!1}}static constructAdvertSignedMessage(e,t,n){let s=(0,Ct.hexToBytes)(e),o=new Uint8Array(4);o[0]=t&255,o[1]=t>>8&255,o[2]=t>>16&255,o[3]=t>>24&255;let i=new Uint8Array(36+n.length);return i.set(s,0),i.set(o,32),i.set(n,36),i}static getSignedMessageDescription(e,t,n){return`Public Key: ${e} + Timestamp: ${t} (${new Date(t*1e3).toISOString()}) + App Data: ${n}`}static getSignedMessageHex(e,t,n){let s=(0,Ct.hexToBytes)(n),o=this.constructAdvertSignedMessage(e,t,s);return(0,Ct.bytesToHex)(o)}static async derivePublicKey(e){try{let t=(0,Ct.hexToBytes)(e);if(t.length!==64)throw new Error(`Invalid private key length: expected 64 bytes, got ${t.length}`);return await(0,da.derivePublicKey)(e)}catch(t){throw new Error(`Failed to derive public key: ${t instanceof Error?t.message:"Unknown error"}`)}}static derivePublicKeySync(e){try{let t=(0,Ct.hexToBytes)(e);throw t.length!==64?new Error(`Invalid private key length: expected 64 bytes, got ${t.length}`):new Error("Synchronous key derivation not supported with WASM. Use derivePublicKey() instead.")}catch(t){throw new Error(`Failed to derive public key: ${t instanceof Error?t.message:"Unknown error"}`)}}static async validateKeyPair(e,t){try{return await(0,da.validateKeyPair)(e,t)}catch{return!1}}};$e.Ed25519SignatureVerifier=fs});var ua=G(Jn=>{"use strict";Object.defineProperty(Jn,"__esModule",{value:!0});Jn.AdvertPayloadDecoder=void 0;var fe=_e(),Et=he(),Hf=$t(),kf=us(),ls=class{static decode(e,t){try{if(e.length<101){let d={type:fe.PayloadType.Advert,version:fe.PayloadVersion.Version1,isValid:!1,errors:["Advertisement payload too short"],publicKey:"",timestamp:0,signature:"",appData:{flags:0,deviceRole:fe.DeviceRole.ChatNode,hasLocation:!1,hasName:!1}};return t?.includeSegments&&(d.segments=[{name:"Invalid Advert Data",description:"Advert payload too short (minimum 101 bytes required)",startByte:t.segmentOffset||0,endByte:(t.segmentOffset||0)+e.length-1,value:(0,Et.bytesToHex)(e)}]),d}let n=[],s=t?.segmentOffset||0,o=0,i=(0,Et.bytesToHex)(e.subarray(o,o+32));t?.includeSegments&&n.push({name:"Public Key",description:"Ed25519 public key",startByte:s+o,endByte:s+o+31,value:i}),o+=32;let a=this.readUint32LE(e,o);if(t?.includeSegments){let d=new Date(a*1e3);n.push({name:"Timestamp",description:`${a} (${d.toISOString().slice(0,19)}Z)`,startByte:s+o,endByte:s+o+3,value:(0,Et.bytesToHex)(e.subarray(o,o+4))})}o+=4;let c=(0,Et.bytesToHex)(e.subarray(o,o+64));t?.includeSegments&&n.push({name:"Signature",description:"Ed25519 signature",startByte:s+o,endByte:s+o+63,value:c}),o+=64;let l=e[o];if(t?.includeSegments){let d=l.toString(2).padStart(8,"0"),p=this.parseDeviceRole(l),g=` | Bits 0-3 (Role): ${(0,Hf.getDeviceRoleName)(p)} | Bit 4 (Location): ${l&fe.AdvertFlags.HasLocation?"Yes":"No"} | Bit 7 (Name): ${l&fe.AdvertFlags.HasName?"Yes":"No"}`;n.push({name:"App Flags",description:`Binary: ${d}${g}`,startByte:s+o,endByte:s+o,value:l.toString(16).padStart(2,"0").toUpperCase()})}o+=1;let f={type:fe.PayloadType.Advert,version:fe.PayloadVersion.Version1,isValid:!0,publicKey:i,timestamp:a,signature:c,appData:{flags:l,deviceRole:this.parseDeviceRole(l),hasLocation:!!(l&fe.AdvertFlags.HasLocation),hasName:!!(l&fe.AdvertFlags.HasName)}},u=o;if(l&fe.AdvertFlags.HasLocation&&e.length>=u+8){let d=this.readInt32LE(e,u)/1e6,p=this.readInt32LE(e,u+4)/1e6;f.appData.location={latitude:Math.round(d*1e6)/1e6,longitude:Math.round(p*1e6)/1e6},t?.includeSegments&&(n.push({name:"Latitude",description:`${d}\xB0 (${d})`,startByte:s+u,endByte:s+u+3,value:(0,Et.bytesToHex)(e.subarray(u,u+4))}),n.push({name:"Longitude",description:`${p}\xB0 (${p})`,startByte:s+u+4,endByte:s+u+7,value:(0,Et.bytesToHex)(e.subarray(u+4,u+8))})),u+=8}if(l&fe.AdvertFlags.HasFeature1&&(u+=2),l&fe.AdvertFlags.HasFeature2&&(u+=2),l&fe.AdvertFlags.HasName&&e.length>u){let d=e.subarray(u),p=new TextDecoder("utf-8").decode(d).replace(/\0.*$/,"");f.appData.name=this.sanitizeControlCharacters(p)||p,t?.includeSegments&&n.push({name:"Node Name",description:`Node name: "${f.appData.name}"`,startByte:s+u,endByte:s+e.length-1,value:(0,Et.bytesToHex)(d)})}return t?.includeSegments&&(f.segments=n),f}catch(n){return{type:fe.PayloadType.Advert,version:fe.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode advertisement payload"],publicKey:"",timestamp:0,signature:"",appData:{flags:0,deviceRole:fe.DeviceRole.ChatNode,hasLocation:!1,hasName:!1}}}}static async decodeWithVerification(e,t){let n=this.decode(e,t);if(!n||!n.isValid)return n;try{let o=e.subarray(100),i=(0,Et.bytesToHex)(o),a=await kf.Ed25519SignatureVerifier.verifyAdvertisementSignature(n.publicKey,n.signature,n.timestamp,i);n.signatureValid=a,a||(n.signatureError="Ed25519 signature verification failed",n.isValid=!1,n.errors||(n.errors=[]),n.errors.push("Invalid Ed25519 signature"))}catch(s){n.signatureValid=!1,n.signatureError=s instanceof Error?s.message:"Signature verification error",n.isValid=!1,n.errors||(n.errors=[]),n.errors.push("Signature verification failed: "+(s instanceof Error?s.message:"Unknown error"))}return n}static parseDeviceRole(e){switch(e&15){case 1:return fe.DeviceRole.ChatNode;case 2:return fe.DeviceRole.Repeater;case 3:return fe.DeviceRole.RoomServer;case 4:return fe.DeviceRole.Sensor;default:return fe.DeviceRole.ChatNode}}static readUint32LE(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24}static readInt32LE(e,t){let n=this.readUint32LE(e,t);return n>2147483647?n-4294967296:n}static sanitizeControlCharacters(e){return e&&e.trim().replace(/[\x00-\x1F\x7F]/g,"")||null}};Jn.AdvertPayloadDecoder=ls});var la=G(e0=>{"use strict";Object.defineProperty(e0,"__esModule",{value:!0});e0.TracePayloadDecoder=void 0;var er=_e(),tr=he(),xs=class{static decode(e,t,n){try{if(e.length<9){let g={type:er.PayloadType.Trace,version:er.PayloadVersion.Version1,isValid:!1,errors:["Trace payload too short (need at least tag(4) + auth(4) + flags(1))"],traceTag:"00000000",authCode:0,flags:0,pathHashes:[]};return n?.includeSegments&&(g.segments=[{name:"Invalid Trace Data",description:"Trace payload too short (minimum 9 bytes required)",startByte:n.segmentOffset||0,endByte:(n.segmentOffset||0)+e.length-1,value:(0,tr.bytesToHex)(e)}]),g}let s=0,o=[],i=n?.segmentOffset||0,a=this.readUint32LE(e,s),c=(0,tr.numberToHex)(a,8);n?.includeSegments&&o.push({name:"Trace Tag",description:`Unique identifier for this trace: 0x${a.toString(16).padStart(8,"0")}`,startByte:i+s,endByte:i+s+3,value:(0,tr.bytesToHex)(e.slice(s,s+4))}),s+=4;let l=this.readUint32LE(e,s);n?.includeSegments&&o.push({name:"Auth Code",description:`Authentication/verification code: ${l}`,startByte:i+s,endByte:i+s+3,value:(0,tr.bytesToHex)(e.slice(s,s+4))}),s+=4;let f=e[s];n?.includeSegments&&o.push({name:"Flags",description:`Application-defined control flags: 0x${f.toString(16).padStart(2,"0")} (${f.toString(2).padStart(8,"0")}b)`,startByte:i+s,endByte:i+s,value:f.toString(16).padStart(2,"0").toUpperCase()}),s+=1;let u=[],d=s;for(;s<e.length;)u.push((0,tr.byteToHex)(e[s])),s++;if(n?.includeSegments&&u.length>0){let g=u.join(" ");o.push({name:"Path Hashes",description:`Node hashes in trace path: ${g}`,startByte:i+d,endByte:i+e.length-1,value:(0,tr.bytesToHex)(e.slice(d))})}let p;t&&t.length>0&&(p=t.map(g=>{let v=parseInt(g,16);return(v>127?v-256:v)/4}));let m={type:er.PayloadType.Trace,version:er.PayloadVersion.Version1,isValid:!0,traceTag:c,authCode:l,flags:f,pathHashes:u,snrValues:p};return n?.includeSegments&&(m.segments=o),m}catch(s){return{type:er.PayloadType.Trace,version:er.PayloadVersion.Version1,isValid:!1,errors:[s instanceof Error?s.message:"Failed to decode trace payload"],traceTag:"00000000",authCode:0,flags:0,pathHashes:[]}}}static readUint32LE(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24}};e0.TracePayloadDecoder=xs});var xa=G(r0=>{"use strict";Object.defineProperty(r0,"__esModule",{value:!0});r0.GroupTextPayloadDecoder=void 0;var rr=_e(),Lf=Kn(),t0=he(),hs=class{static decode(e,t){try{if(e.length<3){let f={type:rr.PayloadType.GroupText,version:rr.PayloadVersion.Version1,isValid:!1,errors:["GroupText payload too short (need at least channel_hash(1) + MAC(2))"],channelHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0};return t?.includeSegments&&(f.segments=[{name:"Invalid GroupText Data",description:"GroupText payload too short (minimum 3 bytes required)",startByte:t.segmentOffset||0,endByte:(t.segmentOffset||0)+e.length-1,value:(0,t0.bytesToHex)(e)}]),f}let n=[],s=t?.segmentOffset||0,o=0,i=(0,t0.byteToHex)(e[o]);t?.includeSegments&&n.push({name:"Channel Hash",description:"First byte of SHA256 of channel's shared key",startByte:s+o,endByte:s+o,value:i}),o+=1;let a=(0,t0.bytesToHex)(e.subarray(o,o+2));t?.includeSegments&&n.push({name:"Cipher MAC",description:"MAC for encrypted data",startByte:s+o,endByte:s+o+1,value:a}),o+=2;let c=(0,t0.bytesToHex)(e.subarray(o));t?.includeSegments&&e.length>o&&n.push({name:"Ciphertext",description:"Encrypted message content (timestamp + flags + message)",startByte:s+o,endByte:s+e.length-1,value:c});let l={type:rr.PayloadType.GroupText,version:rr.PayloadVersion.Version1,isValid:!0,channelHash:i,cipherMac:a,ciphertext:c,ciphertextLength:e.length-3};if(t?.keyStore&&t.keyStore.hasChannelKey(i)){let f=t.keyStore.getChannelKeys(i);for(let u of f){let d=Lf.ChannelCrypto.decryptGroupTextMessage(c,a,u);if(d.success&&d.data){l.decrypted={timestamp:d.data.timestamp,flags:d.data.flags,sender:d.data.sender,message:d.data.message};break}}}return t?.includeSegments&&(l.segments=n),l}catch(n){return{type:rr.PayloadType.GroupText,version:rr.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode GroupText payload"],channelHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0}}}};r0.GroupTextPayloadDecoder=hs});var ha=G(n0=>{"use strict";Object.defineProperty(n0,"__esModule",{value:!0});n0.RequestPayloadDecoder=void 0;var ot=_e(),Dr=he(),ps=class{static decode(e,t){try{if(e.length<4){let u={type:ot.PayloadType.Request,version:ot.PayloadVersion.Version1,isValid:!1,errors:["Request payload too short (minimum 4 bytes: dest hash + source hash + MAC)"],timestamp:0,requestType:ot.RequestType.GetStats,requestData:"",destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:""};return t?.includeSegments&&(u.segments=[{name:"Invalid Request Data",description:"Request payload too short (minimum 4 bytes required: 1 for dest hash + 1 for source hash + 2 for MAC)",startByte:t.segmentOffset||0,endByte:(t.segmentOffset||0)+e.length-1,value:(0,Dr.bytesToHex)(e)}]),u}let n=[],s=t?.segmentOffset||0,o=0,i=(0,Dr.bytesToHex)(e.subarray(o,o+1));t?.includeSegments&&n.push({name:"Destination Hash",description:`First byte of destination node public key: 0x${i}`,startByte:s+o,endByte:s+o,value:i}),o+=1;let a=(0,Dr.bytesToHex)(e.subarray(o,o+1));t?.includeSegments&&n.push({name:"Source Hash",description:`First byte of source node public key: 0x${a}`,startByte:s+o,endByte:s+o,value:a}),o+=1;let c=(0,Dr.bytesToHex)(e.subarray(o,o+2));t?.includeSegments&&n.push({name:"Cipher MAC",description:"MAC for encrypted data verification (2 bytes)",startByte:s+o,endByte:s+o+1,value:c}),o+=2;let l=(0,Dr.bytesToHex)(e.subarray(o));t?.includeSegments&&e.length>o&&n.push({name:"Ciphertext",description:`Encrypted message data (${e.length-o} bytes). Contains encrypted plaintext with this structure:
\u2022 Timestamp (4 bytes) - send time as unix timestamp
\u2022 Request Type (1 byte) - type of request (GetStats, GetTelemetryData, etc.)
\u2022 Request Data (remaining bytes) - additional request-specific data`,startByte:s+o,endByte:s+e.length-1,value:l});let f={type:ot.PayloadType.Request,version:ot.PayloadVersion.Version1,isValid:!0,timestamp:0,requestType:ot.RequestType.GetStats,requestData:"",destinationHash:i,sourceHash:a,cipherMac:c,ciphertext:l};return t?.includeSegments&&(f.segments=n),f}catch(n){return{type:ot.PayloadType.Request,version:ot.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode request payload"],timestamp:0,requestType:ot.RequestType.GetStats,requestData:"",destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:""}}}};n0.RequestPayloadDecoder=ps});var pa=G(s0=>{"use strict";Object.defineProperty(s0,"__esModule",{value:!0});s0.ResponsePayloadDecoder=void 0;var nr=_e(),_r=he(),ys=class{static decode(e,t){try{if(e.length<4){let u={type:nr.PayloadType.Response,version:nr.PayloadVersion.Version1,isValid:!1,errors:["Response payload too short (minimum 4 bytes: dest + source + MAC)"],destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0};return t?.includeSegments&&(u.segments=[{name:"Invalid Response Data",description:"Response payload too short (minimum 4 bytes required)",startByte:t.segmentOffset||0,endByte:(t.segmentOffset||0)+e.length-1,value:(0,_r.bytesToHex)(e)}]),u}let n=[],s=t?.segmentOffset||0,o=0,i=(0,_r.byteToHex)(e[o]);t?.includeSegments&&n.push({name:"Destination Hash",description:"First byte of destination node public key",startByte:s+o,endByte:s+o,value:i}),o+=1;let a=(0,_r.byteToHex)(e[o]);t?.includeSegments&&n.push({name:"Source Hash",description:"First byte of source node public key",startByte:s+o,endByte:s+o,value:a}),o+=1;let c=(0,_r.bytesToHex)(e.subarray(o,o+2));t?.includeSegments&&n.push({name:"Cipher MAC",description:"MAC for encrypted data in next field",startByte:s+o,endByte:s+o+1,value:c}),o+=2;let l=(0,_r.bytesToHex)(e.subarray(o));t?.includeSegments&&e.length>o&&n.push({name:"Ciphertext",description:"Encrypted response data (tag + content)",startByte:s+o,endByte:s+e.length-1,value:l});let f={type:nr.PayloadType.Response,version:nr.PayloadVersion.Version1,isValid:!0,destinationHash:i,sourceHash:a,cipherMac:c,ciphertext:l,ciphertextLength:e.length-4};return t?.includeSegments&&(f.segments=n),f}catch(n){return{type:nr.PayloadType.Response,version:nr.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode response payload"],destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0}}}};s0.ResponsePayloadDecoder=ys});var ya=G(o0=>{"use strict";Object.defineProperty(o0,"__esModule",{value:!0});o0.AnonRequestPayloadDecoder=void 0;var sr=_e(),Rr=he(),ms=class{static decode(e,t){try{if(e.length<35){let u={type:sr.PayloadType.AnonRequest,version:sr.PayloadVersion.Version1,isValid:!1,errors:["AnonRequest payload too short (minimum 35 bytes: dest + public key + MAC)"],destinationHash:"",senderPublicKey:"",cipherMac:"",ciphertext:"",ciphertextLength:0};return t?.includeSegments&&(u.segments=[{name:"Invalid AnonRequest Data",description:"AnonRequest payload too short (minimum 35 bytes required: 1 for dest hash + 32 for public key + 2 for MAC)",startByte:t.segmentOffset||0,endByte:(t.segmentOffset||0)+e.length-1,value:(0,Rr.bytesToHex)(e)}]),u}let n=[],s=t?.segmentOffset||0,o=0,i=(0,Rr.byteToHex)(e[0]);t?.includeSegments&&n.push({name:"Destination Hash",description:`First byte of destination node public key: 0x${i}`,startByte:s+o,endByte:s+o,value:i}),o+=1;let a=(0,Rr.bytesToHex)(e.subarray(1,33));t?.includeSegments&&n.push({name:"Sender Public Key",description:"Ed25519 public key of the sender (32 bytes)",startByte:s+o,endByte:s+o+31,value:a}),o+=32;let c=(0,Rr.bytesToHex)(e.subarray(33,35));t?.includeSegments&&n.push({name:"Cipher MAC",description:"MAC for encrypted data verification (2 bytes)",startByte:s+o,endByte:s+o+1,value:c}),o+=2;let l=(0,Rr.bytesToHex)(e.subarray(35));t?.includeSegments&&e.length>35&&n.push({name:"Ciphertext",description:`Encrypted message data (${e.length-35} bytes). Contains encrypted plaintext with this structure:
\u2022 Timestamp (4 bytes) - send time as unix timestamp
\u2022 Sync Timestamp (4 bytes) - room server only, sender's "sync messages SINCE x" timestamp  
\u2022 Password (remaining bytes) - password for repeater/room`,startByte:s+o,endByte:s+e.length-1,value:l});let f={type:sr.PayloadType.AnonRequest,version:sr.PayloadVersion.Version1,isValid:!0,destinationHash:i,senderPublicKey:a,cipherMac:c,ciphertext:l,ciphertextLength:e.length-35};return t?.includeSegments&&(f.segments=n),f}catch(n){return{type:sr.PayloadType.AnonRequest,version:sr.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode AnonRequest payload"],destinationHash:"",senderPublicKey:"",cipherMac:"",ciphertext:"",ciphertextLength:0}}}};o0.AnonRequestPayloadDecoder=ms});var ma=G(i0=>{"use strict";Object.defineProperty(i0,"__esModule",{value:!0});i0.AckPayloadDecoder=void 0;var or=_e(),gs=he(),vs=class{static decode(e,t){try{if(e.length<4){let a={type:or.PayloadType.Ack,version:or.PayloadVersion.Version1,isValid:!1,errors:["Ack payload too short (minimum 4 bytes for checksum)"],checksum:""};return t?.includeSegments&&(a.segments=[{name:"Invalid Ack Data",description:"Ack payload too short (minimum 4 bytes required for checksum)",startByte:t.segmentOffset||0,endByte:(t.segmentOffset||0)+e.length-1,value:(0,gs.bytesToHex)(e)}]),a}let n=[],s=t?.segmentOffset||0,o=(0,gs.bytesToHex)(e.subarray(0,4));t?.includeSegments&&n.push({name:"Checksum",description:`CRC checksum of message timestamp, text, and sender pubkey: 0x${o}`,startByte:s,endByte:s+3,value:o}),t?.includeSegments&&e.length>4&&n.push({name:"Additional Data",description:"Extra data in Ack payload",startByte:s+4,endByte:s+e.length-1,value:(0,gs.bytesToHex)(e.subarray(4))});let i={type:or.PayloadType.Ack,version:or.PayloadVersion.Version1,isValid:!0,checksum:o};return t?.includeSegments&&(i.segments=n),i}catch(n){return{type:or.PayloadType.Ack,version:or.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode Ack payload"],checksum:""}}}};i0.AckPayloadDecoder=vs});var va=G(a0=>{"use strict";Object.defineProperty(a0,"__esModule",{value:!0});a0.PathPayloadDecoder=void 0;var bt=_e(),ga=he(),Bs=class{static decode(e){try{if(e.length<2)return{type:bt.PayloadType.Path,version:bt.PayloadVersion.Version1,isValid:!1,errors:["Path payload too short (minimum 2 bytes: path length + extra type)"],pathLength:0,pathHashes:[],extraType:0,extraData:""};let t=e[0];if(e.length<1+t+1)return{type:bt.PayloadType.Path,version:bt.PayloadVersion.Version1,isValid:!1,errors:[`Path payload too short (need ${1+t+1} bytes for path length + path + extra type)`],pathLength:t,pathHashes:[],extraType:0,extraData:""};let n=[];for(let i=0;i<t;i++)n.push((0,ga.byteToHex)(e[1+i]));let s=e[1+t],o="";return e.length>1+t+1&&(o=(0,ga.bytesToHex)(e.subarray(1+t+1))),{type:bt.PayloadType.Path,version:bt.PayloadVersion.Version1,isValid:!0,pathLength:t,pathHashes:n,extraType:s,extraData:o}}catch(t){return{type:bt.PayloadType.Path,version:bt.PayloadVersion.Version1,isValid:!1,errors:[t instanceof Error?t.message:"Failed to decode Path payload"],pathLength:0,pathHashes:[],extraType:0,extraData:""}}}};a0.PathPayloadDecoder=Bs});var Ba=G(c0=>{"use strict";Object.defineProperty(c0,"__esModule",{value:!0});c0.TextMessagePayloadDecoder=void 0;var ir=_e(),Sr=he(),Cs=class{static decode(e,t){try{if(e.length<4){let u={type:ir.PayloadType.TextMessage,version:ir.PayloadVersion.Version1,isValid:!1,errors:["TextMessage payload too short (minimum 4 bytes: dest + source + MAC)"],destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0};return t?.includeSegments&&(u.segments=[{name:"Invalid TextMessage Data",description:"TextMessage payload too short (minimum 4 bytes required)",startByte:t.segmentOffset||0,endByte:(t.segmentOffset||0)+e.length-1,value:(0,Sr.bytesToHex)(e)}]),u}let n=[],s=t?.segmentOffset||0,o=0,i=(0,Sr.byteToHex)(e[o]);t?.includeSegments&&n.push({name:"Destination Hash",description:"First byte of destination node public key",startByte:s+o,endByte:s+o,value:i}),o+=1;let a=(0,Sr.byteToHex)(e[o]);t?.includeSegments&&n.push({name:"Source Hash",description:"First byte of source node public key",startByte:s+o,endByte:s+o,value:a}),o+=1;let c=(0,Sr.bytesToHex)(e.subarray(o,o+2));t?.includeSegments&&n.push({name:"Cipher MAC",description:"MAC for encrypted data in next field",startByte:s+o,endByte:s+o+1,value:c}),o+=2;let l=(0,Sr.bytesToHex)(e.subarray(o));t?.includeSegments&&e.length>o&&n.push({name:"Ciphertext",description:"Encrypted message data (timestamp + message text)",startByte:s+o,endByte:s+e.length-1,value:l});let f={type:ir.PayloadType.TextMessage,version:ir.PayloadVersion.Version1,isValid:!0,destinationHash:i,sourceHash:a,cipherMac:c,ciphertext:l,ciphertextLength:e.length-4};return t?.includeSegments&&(f.segments=n),f}catch(n){return{type:ir.PayloadType.TextMessage,version:ir.PayloadVersion.Version1,isValid:!1,errors:[n instanceof Error?n.message:"Failed to decode TextMessage payload"],destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0}}}};c0.TextMessagePayloadDecoder=Cs});var Ca=G(f0=>{"use strict";Object.defineProperty(f0,"__esModule",{value:!0});f0.ControlPayloadDecoder=void 0;var ae=_e(),Ot=he(),If=$t(),Es=class{static decode(e,t){try{if(e.length<1)return this.createErrorPayload("Control payload too short (minimum 1 byte required)",e,t);let s=e[0]&240;switch(s){case ae.ControlSubType.NodeDiscoverReq:return this.decodeDiscoverReq(e,t);case ae.ControlSubType.NodeDiscoverResp:return this.decodeDiscoverResp(e,t);default:return this.createErrorPayload(`Unknown control sub-type: 0x${s.toString(16).padStart(2,"0")}`,e,t)}}catch(n){return this.createErrorPayload(n instanceof Error?n.message:"Failed to decode control payload",e,t)}}static decodeDiscoverReq(e,t){let n=[],s=t?.segmentOffset??0;if(e.length<6){let p={type:ae.PayloadType.Control,version:ae.PayloadVersion.Version1,isValid:!1,errors:["DISCOVER_REQ payload too short (minimum 6 bytes required)"],subType:ae.ControlSubType.NodeDiscoverReq,rawFlags:e[0],prefixOnly:!1,typeFilter:0,typeFilterNames:[],tag:0,since:0};return t?.includeSegments&&(p.segments=[{name:"Invalid DISCOVER_REQ Data",description:"DISCOVER_REQ payload too short (minimum 6 bytes required)",startByte:s,endByte:s+e.length-1,value:(0,Ot.bytesToHex)(e)}]),p}let o=0,i=e[o],a=(i&1)!==0;t?.includeSegments&&n.push({name:"Flags",description:`Sub-type: DISCOVER_REQ (0x8) | Prefix Only: ${a}`,startByte:s+o,endByte:s+o,value:i.toString(16).padStart(2,"0").toUpperCase()}),o+=1;let c=e[o],l=this.parseTypeFilter(c);t?.includeSegments&&n.push({name:"Type Filter",description:`Filter mask: 0b${c.toString(2).padStart(8,"0")} | Types: ${l.length>0?l.join(", "):"None"}`,startByte:s+o,endByte:s+o,value:c.toString(16).padStart(2,"0").toUpperCase()}),o+=1;let f=this.readUint32LE(e,o);t?.includeSegments&&n.push({name:"Tag",description:`Random tag for response matching: 0x${f.toString(16).padStart(8,"0")}`,startByte:s+o,endByte:s+o+3,value:(0,Ot.bytesToHex)(e.slice(o,o+4))}),o+=4;let u=0;if(e.length>=o+4&&(u=this.readUint32LE(e,o),t?.includeSegments)){let p=u>0?new Date(u*1e3).toISOString().slice(0,19)+"Z":"N/A";n.push({name:"Since",description:`Filter timestamp: ${u} (${p})`,startByte:s+o,endByte:s+o+3,value:(0,Ot.bytesToHex)(e.slice(o,o+4))})}let d={type:ae.PayloadType.Control,version:ae.PayloadVersion.Version1,isValid:!0,subType:ae.ControlSubType.NodeDiscoverReq,rawFlags:i,prefixOnly:a,typeFilter:c,typeFilterNames:l,tag:f,since:u};return t?.includeSegments&&(d.segments=n),d}static decodeDiscoverResp(e,t){let n=[],s=t?.segmentOffset??0;if(e.length<14){let y={type:ae.PayloadType.Control,version:ae.PayloadVersion.Version1,isValid:!1,errors:["DISCOVER_RESP payload too short (minimum 14 bytes required)"],subType:ae.ControlSubType.NodeDiscoverResp,rawFlags:e.length>0?e[0]:0,nodeType:ae.DeviceRole.Unknown,nodeTypeName:"Unknown",snr:0,tag:0,publicKey:"",publicKeyLength:0};return t?.includeSegments&&(y.segments=[{name:"Invalid DISCOVER_RESP Data",description:"DISCOVER_RESP payload too short (minimum 14 bytes required)",startByte:s,endByte:s+e.length-1,value:(0,Ot.bytesToHex)(e)}]),y}let o=0,i=e[o],a=i&15,c=(0,If.getDeviceRoleName)(a);t?.includeSegments&&n.push({name:"Flags",description:`Sub-type: DISCOVER_RESP (0x9) | Node Type: ${c}`,startByte:s+o,endByte:s+o,value:i.toString(16).padStart(2,"0").toUpperCase()}),o+=1;let l=e[o],f=l>127?l-256:l,u=f/4;t?.includeSegments&&n.push({name:"SNR",description:`Inbound SNR: ${u.toFixed(2)} dB (raw: ${l}, signed: ${f})`,startByte:s+o,endByte:s+o,value:l.toString(16).padStart(2,"0").toUpperCase()}),o+=1;let d=this.readUint32LE(e,o);t?.includeSegments&&n.push({name:"Tag",description:`Reflected tag from request: 0x${d.toString(16).padStart(8,"0")}`,startByte:s+o,endByte:s+o+3,value:(0,Ot.bytesToHex)(e.slice(o,o+4))}),o+=4;let m=e.length-o,g=e.slice(o,o+m),v=(0,Ot.bytesToHex)(g);if(t?.includeSegments){let y=m===32?"Full Public Key":"Public Key Prefix";n.push({name:y,description:`${y} (${m} bytes)`,startByte:s+o,endByte:s+o+m-1,value:v})}let x={type:ae.PayloadType.Control,version:ae.PayloadVersion.Version1,isValid:!0,subType:ae.ControlSubType.NodeDiscoverResp,rawFlags:i,nodeType:a,nodeTypeName:c,snr:u,tag:d,publicKey:v,publicKeyLength:m};return t?.includeSegments&&(x.segments=n),x}static parseTypeFilter(e){let t=[];return e&1<<ae.DeviceRole.ChatNode&&t.push("Chat"),e&1<<ae.DeviceRole.Repeater&&t.push("Repeater"),e&1<<ae.DeviceRole.RoomServer&&t.push("Room"),e&1<<ae.DeviceRole.Sensor&&t.push("Sensor"),t}static createErrorPayload(e,t,n){let s={type:ae.PayloadType.Control,version:ae.PayloadVersion.Version1,isValid:!1,errors:[e],subType:ae.ControlSubType.NodeDiscoverReq,rawFlags:t.length>0?t[0]:0,prefixOnly:!1,typeFilter:0,typeFilterNames:[],tag:0,since:0};return n?.includeSegments&&(s.segments=[{name:"Invalid Control Data",description:e,startByte:n.segmentOffset??0,endByte:(n.segmentOffset??0)+t.length-1,value:(0,Ot.bytesToHex)(t)}]),s}static readUint32LE(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}};f0.ControlPayloadDecoder=Es});var As=G(d0=>{"use strict";Object.defineProperty(d0,"__esModule",{value:!0});d0.MeshCorePacketDecoder=void 0;var ee=_e(),Ne=he(),ar=$t(),Of=W0(),Ea=ua(),qf=la(),Uf=xa(),Nf=ha(),Mf=pa(),Vf=ya(),Kf=ma(),zf=va(),Gf=Ba(),Yf=Ca(),bs=class{static decode(e,t){return this.parseInternal(e,!1,t).packet}static async decodeWithVerification(e,t){return(await this.parseInternalAsync(e,!1,t)).packet}static analyzeStructure(e,t){return this.parseInternal(e,!0,t).structure}static async analyzeStructureWithVerification(e,t){return(await this.parseInternalAsync(e,!0,t)).structure}static parseInternal(e,t,n){let s=(0,Ne.hexToBytes)(e),o=[];if(s.length<2){let i={messageHash:"",routeType:ee.RouteType.Flood,payloadType:ee.PayloadType.RawCustom,payloadVersion:ee.PayloadVersion.Version1,pathLength:0,path:null,payload:{raw:"",decoded:null},totalBytes:s.length,isValid:!1,errors:["Packet too short (minimum 2 bytes required)"]},a={segments:[],totalBytes:s.length,rawHex:e.toUpperCase(),messageHash:"",payload:{segments:[],hex:"",startByte:0,type:"Unknown"}};return{packet:i,structure:a}}try{let i=0,a=s[0],c=a&3,l=a>>2&15,f=a>>6&3;t&&o.push({name:"Header",description:"Header byte breakdown",startByte:0,endByte:0,value:`0x${a.toString(16).padStart(2,"0")}`,headerBreakdown:{fullBinary:a.toString(2).padStart(8,"0"),fields:[{bits:"0-1",field:"Route Type",value:(0,ar.getRouteTypeName)(c),binary:(a&3).toString(2).padStart(2,"0")},{bits:"2-5",field:"Payload Type",value:(0,ar.getPayloadTypeName)(l),binary:(a>>2&15).toString(2).padStart(4,"0")},{bits:"6-7",field:"Version",value:f.toString(),binary:(a>>6&3).toString(2).padStart(2,"0")}]}}),i=1;let u;if(c===ee.RouteType.TransportFlood||c===ee.RouteType.TransportDirect){if(s.length<i+4)throw new Error("Packet too short for transport codes");let C=s[i]|s[i+1]<<8,T=s[i+2]|s[i+3]<<8;if(u=[C,T],t){let _=s[i]|s[i+1]<<8|s[i+2]<<16|s[i+3]<<24;o.push({name:"Transport Code",description:"Used for Direct/Response routing",startByte:i,endByte:i+3,value:`0x${_.toString(16).padStart(8,"0")}`})}i+=4}if(s.length<i+1)throw new Error("Packet too short for path length");let d=s[i];if(t){let C=`Path contains ${d} bytes`;c===ee.RouteType.Direct||c===ee.RouteType.TransportDirect?C=`For "Direct" packets, this contains routing instructions. ${d} bytes of routing instructions (decreases as packet travels)`:(c===ee.RouteType.Flood||c===ee.RouteType.TransportFlood)&&(C=`${d} bytes showing route taken (increases as packet floods)`),o.push({name:"Path Length",description:C,startByte:i,endByte:i,value:`0x${d.toString(16).padStart(2,"0")}`})}if(i+=1,s.length<i+d)throw new Error("Packet too short for path data");let p=s.subarray(i,i+d),m=d>0?Array.from(p).map(Ne.byteToHex):null;if(t&&d>0)if(l===ee.PayloadType.Trace){let C=[];for(let T=0;T<d;T++){let _=s[i+T],S=(_>127?_-256:_)/4;C.push(`${S.toFixed(2)}dB (0x${_.toString(16).padStart(2,"0")})`)}o.push({name:"Path SNR Data",description:`SNR values collected during trace: ${C.join(", ")}`,startByte:i,endByte:i+d-1,value:(0,Ne.bytesToHex)(s.slice(i,i+d))})}else{let C="Routing path information";c===ee.RouteType.Direct||c===ee.RouteType.TransportDirect?C="Routing instructions (bytes are stripped at each hop as packet travels to destination)":(c===ee.RouteType.Flood||c===ee.RouteType.TransportFlood)&&(C="Historical route taken (bytes are added as packet floods through network)"),o.push({name:"Path Data",description:C,startByte:i,endByte:i+d-1,value:(0,Ne.bytesToHex)(s.slice(i,i+d))})}i+=d;let g=s.subarray(i),v=(0,Ne.bytesToHex)(g);t&&s.length>i&&o.push({name:"Payload",description:`${(0,ar.getPayloadTypeName)(l)} payload data`,startByte:i,endByte:s.length-1,value:(0,Ne.bytesToHex)(s.slice(i))});let x=null,y=[];if(l===ee.PayloadType.Advert){let C=Ea.AdvertPayloadDecoder.decode(g,{includeSegments:t,segmentOffset:0});x=C,C?.segments&&(y.push(...C.segments),delete C.segments)}else if(l===ee.PayloadType.Trace){let C=qf.TracePayloadDecoder.decode(g,m,{includeSegments:t,segmentOffset:0});x=C,C?.segments&&(y.push(...C.segments),delete C.segments)}else if(l===ee.PayloadType.GroupText){let C=Uf.GroupTextPayloadDecoder.decode(g,{...n,includeSegments:t,segmentOffset:0});x=C,C?.segments&&(y.push(...C.segments),delete C.segments)}else if(l===ee.PayloadType.Request){let C=Nf.RequestPayloadDecoder.decode(g,{includeSegments:t,segmentOffset:0});x=C,C?.segments&&(y.push(...C.segments),delete C.segments)}else if(l===ee.PayloadType.Response){let C=Mf.ResponsePayloadDecoder.decode(g,{includeSegments:t,segmentOffset:0});x=C,C?.segments&&(y.push(...C.segments),delete C.segments)}else if(l===ee.PayloadType.AnonRequest){let C=Vf.AnonRequestPayloadDecoder.decode(g,{includeSegments:t,segmentOffset:0});x=C,C?.segments&&(y.push(...C.segments),delete C.segments)}else if(l===ee.PayloadType.Ack){let C=Kf.AckPayloadDecoder.decode(g,{includeSegments:t,segmentOffset:0});x=C,C?.segments&&(y.push(...C.segments),delete C.segments)}else if(l===ee.PayloadType.Path)x=zf.PathPayloadDecoder.decode(g);else if(l===ee.PayloadType.TextMessage){let C=Gf.TextMessagePayloadDecoder.decode(g,{includeSegments:t,segmentOffset:0});x=C,C?.segments&&(y.push(...C.segments),delete C.segments)}else if(l===ee.PayloadType.Control){let C=Yf.ControlPayloadDecoder.decode(g,{includeSegments:t,segmentOffset:0});x=C,C?.segments&&(y.push(...C.segments),delete C.segments)}t&&y.length===0&&s.length>i&&y.push({name:`${(0,ar.getPayloadTypeName)(l)} Payload`,description:`Raw ${(0,ar.getPayloadTypeName)(l)} payload data (${g.length} bytes)`,startByte:0,endByte:g.length-1,value:(0,Ne.bytesToHex)(g)});let B=this.calculateMessageHash(s,c,l,f),E={messageHash:B,routeType:c,payloadType:l,payloadVersion:f,transportCodes:u,pathLength:d,path:m,payload:{raw:v,decoded:x},totalBytes:s.length,isValid:!0},b={segments:o,totalBytes:s.length,rawHex:e.toUpperCase(),messageHash:B,payload:{segments:y,hex:v,startByte:i,type:(0,ar.getPayloadTypeName)(l)}};return{packet:E,structure:b}}catch(i){let a={messageHash:"",routeType:ee.RouteType.Flood,payloadType:ee.PayloadType.RawCustom,payloadVersion:ee.PayloadVersion.Version1,pathLength:0,path:null,payload:{raw:"",decoded:null},totalBytes:s.length,isValid:!1,errors:[i instanceof Error?i.message:"Unknown decoding error"]},c={segments:[],totalBytes:s.length,rawHex:e.toUpperCase(),messageHash:"",payload:{segments:[],hex:"",startByte:0,type:"Unknown"}};return{packet:a,structure:c}}}static async parseInternalAsync(e,t,n){let s=this.parseInternal(e,t,n);if(s.packet.payloadType===ee.PayloadType.Advert&&s.packet.payload.decoded)try{let o=s.packet.payload.decoded,i=await Ea.AdvertPayloadDecoder.decodeWithVerification((0,Ne.hexToBytes)(s.packet.payload.raw),{includeSegments:t,segmentOffset:0});i&&(s.packet.payload.decoded=i,i.isValid||(s.packet.isValid=!1,s.packet.errors=i.errors||["Invalid advertisement signature"]),t&&i.segments&&(s.structure.payload.segments=i.segments,delete i.segments))}catch(o){console.error("Signature verification failed:",o)}return s}static validate(e){let t=(0,Ne.hexToBytes)(e),n=[];if(t.length<2)return n.push("Packet too short (minimum 2 bytes required)"),{isValid:!1,errors:n};try{let s=1,i=t[0]&3;if((i===ee.RouteType.TransportFlood||i===ee.RouteType.TransportDirect)&&(t.length<s+4&&n.push("Packet too short for transport codes"),s+=4),t.length<s+1)n.push("Packet too short for path length");else{let a=t[s];s+=1,t.length<s+a&&n.push("Packet too short for path data"),s+=a}s>=t.length&&n.push("No payload data found")}catch(s){n.push(s instanceof Error?s.message:"Validation error")}return{isValid:n.length===0,errors:n.length>0?n:void 0}}static calculateMessageHash(e,t,n,s){if(n===ee.PayloadType.Trace&&e.length>=13){let f=1;if((t===ee.RouteType.TransportFlood||t===ee.RouteType.TransportDirect)&&(f+=4),e.length>f){let u=e[f];f+=1+u}if(e.length>=f+4){let u=e[f]|e[f+1]<<8|e[f+2]<<16|e[f+3]<<24;return(0,Ne.numberToHex)(u,8)}}let o=n<<2|s<<6,i=1;if((t===ee.RouteType.TransportFlood||t===ee.RouteType.TransportDirect)&&(i+=4),e.length>i){let f=e[i];i+=1+f}let a=e.slice(i),c=[o,...Array.from(a)],l=0;for(let f=0;f<c.length;f++)l=(l<<5)-l+c[f]&4294967295;return(0,Ne.numberToHex)(l,8)}static createKeyStore(e){return new Of.MeshCoreKeyStore(e)}};d0.MeshCorePacketDecoder=bs});var Ds=G(cr=>{"use strict";Object.defineProperty(cr,"__esModule",{value:!0});cr.createAuthToken=Wf;cr.verifyAuthToken=jf;cr.parseAuthToken=$f;cr.decodeAuthTokenPayload=Zf;var Aa=Qn(),wa=he();function ba(r){let e="";if(typeof Buffer<"u")e=Buffer.from(r).toString("base64");else{let t=String.fromCharCode(...Array.from(r));e=btoa(t)}return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function ws(r){let e=r.replace(/-/g,"+").replace(/_/g,"/");for(;e.length%4;)e+="=";if(typeof Buffer<"u")return new Uint8Array(Buffer.from(e,"base64"));{let t=atob(e),n=new Uint8Array(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s);return n}}async function Wf(r,e,t){let n={alg:"Ed25519",typ:"JWT"};r.publicKey?r.publicKey=r.publicKey.toUpperCase():r.publicKey=t.toUpperCase(),r.iat||(r.iat=Math.floor(Date.now()/1e3));let s=JSON.stringify(n),o=JSON.stringify(r),i=new TextEncoder().encode(s),a=new TextEncoder().encode(o),c=ba(i),l=ba(a),f=`${c}.${l}`,u=new TextEncoder().encode(f),d=(0,wa.bytesToHex)(u),p=await(0,Aa.sign)(d,e,r.publicKey);return`${c}.${l}.${p}`}async function jf(r,e){try{let t=r.split(".");if(t.length!==3)return null;let[n,s,o]=t,i=ws(n),a=ws(s),c=new TextDecoder().decode(i),l=new TextDecoder().decode(a),f=JSON.parse(c),u=JSON.parse(l);if(f.alg!=="Ed25519"||f.typ!=="JWT"||!u.publicKey||!u.iat||e&&u.publicKey.toUpperCase()!==e.toUpperCase()||u.exp&&Math.floor(Date.now()/1e3)>u.exp)return null;let d=`${n}.${s}`,p=new TextEncoder().encode(d),m=(0,wa.bytesToHex)(p);return await(0,Aa.verify)(o,m,u.publicKey)?u:null}catch{return null}}function $f(r){try{let e=r.split(".");return e.length!==3?null:{header:e[0],payload:e[1],signature:e[2]}}catch{return null}}function Zf(r){try{let e=r.split(".");if(e.length!==3)return null;let t=ws(e[1]),n=new TextDecoder().decode(t);return JSON.parse(n)}catch{return null}}});var Da=G(K=>{"use strict";var Xf=K&&K.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var s=Object.getOwnPropertyDescriptor(e,t);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,s)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Qf=K&&K.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),_s=K&&K.__importStar||function(){var r=function(e){return r=Object.getOwnPropertyNames||function(t){var n=[];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[n.length]=s);return n},r(e)};return function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n=r(e),s=0;s<n.length;s++)n[s]!=="default"&&Xf(t,e,n[s]);return Qf(t,e),t}}();Object.defineProperty(K,"__esModule",{value:!0});K.Utils=K.decodeAuthTokenPayload=K.parseAuthToken=K.verifyAuthToken=K.createAuthToken=K.getControlSubTypeName=K.getRequestTypeName=K.getDeviceRoleName=K.getPayloadVersionName=K.getPayloadTypeName=K.getRouteTypeName=K.numberToHex=K.byteToHex=K.bytesToHex=K.hexToBytes=K.Ed25519SignatureVerifier=K.ChannelCrypto=K.MeshCoreKeyStore=K.ControlSubType=K.RequestType=K.AdvertFlags=K.DeviceRole=K.PayloadVersion=K.PayloadType=K.RouteType=K.MeshCoreDecoder=K.MeshCorePacketDecoder=void 0;var Jf=As();Object.defineProperty(K,"MeshCorePacketDecoder",{enumerable:!0,get:function(){return Jf.MeshCorePacketDecoder}});var ed=As();Object.defineProperty(K,"MeshCoreDecoder",{enumerable:!0,get:function(){return ed.MeshCorePacketDecoder}});var qt=_e();Object.defineProperty(K,"RouteType",{enumerable:!0,get:function(){return qt.RouteType}});Object.defineProperty(K,"PayloadType",{enumerable:!0,get:function(){return qt.PayloadType}});Object.defineProperty(K,"PayloadVersion",{enumerable:!0,get:function(){return qt.PayloadVersion}});Object.defineProperty(K,"DeviceRole",{enumerable:!0,get:function(){return qt.DeviceRole}});Object.defineProperty(K,"AdvertFlags",{enumerable:!0,get:function(){return qt.AdvertFlags}});Object.defineProperty(K,"RequestType",{enumerable:!0,get:function(){return qt.RequestType}});Object.defineProperty(K,"ControlSubType",{enumerable:!0,get:function(){return qt.ControlSubType}});var td=W0();Object.defineProperty(K,"MeshCoreKeyStore",{enumerable:!0,get:function(){return td.MeshCoreKeyStore}});var rd=Kn();Object.defineProperty(K,"ChannelCrypto",{enumerable:!0,get:function(){return rd.ChannelCrypto}});var nd=us();Object.defineProperty(K,"Ed25519SignatureVerifier",{enumerable:!0,get:function(){return nd.Ed25519SignatureVerifier}});var l0=he();Object.defineProperty(K,"hexToBytes",{enumerable:!0,get:function(){return l0.hexToBytes}});Object.defineProperty(K,"bytesToHex",{enumerable:!0,get:function(){return l0.bytesToHex}});Object.defineProperty(K,"byteToHex",{enumerable:!0,get:function(){return l0.byteToHex}});Object.defineProperty(K,"numberToHex",{enumerable:!0,get:function(){return l0.numberToHex}});var fr=$t();Object.defineProperty(K,"getRouteTypeName",{enumerable:!0,get:function(){return fr.getRouteTypeName}});Object.defineProperty(K,"getPayloadTypeName",{enumerable:!0,get:function(){return fr.getPayloadTypeName}});Object.defineProperty(K,"getPayloadVersionName",{enumerable:!0,get:function(){return fr.getPayloadVersionName}});Object.defineProperty(K,"getDeviceRoleName",{enumerable:!0,get:function(){return fr.getDeviceRoleName}});Object.defineProperty(K,"getRequestTypeName",{enumerable:!0,get:function(){return fr.getRequestTypeName}});Object.defineProperty(K,"getControlSubTypeName",{enumerable:!0,get:function(){return fr.getControlSubTypeName}});var x0=Ds();Object.defineProperty(K,"createAuthToken",{enumerable:!0,get:function(){return x0.createAuthToken}});Object.defineProperty(K,"verifyAuthToken",{enumerable:!0,get:function(){return x0.verifyAuthToken}});Object.defineProperty(K,"parseAuthToken",{enumerable:!0,get:function(){return x0.parseAuthToken}});Object.defineProperty(K,"decodeAuthTokenPayload",{enumerable:!0,get:function(){return x0.decodeAuthTokenPayload}});var sd=_s($t()),od=_s(he()),id=_s(Ds()),u0=Qn();K.Utils={...sd,...od,...id,derivePublicKey:u0.derivePublicKey,validateKeyPair:u0.validateKeyPair,sign:u0.sign,verify:u0.verify}});var Ut,Ra=He(()=>{Ut=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});function at(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Ps(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function pe(r,...e){if(!at(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function Hs(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function Ta(r,e){pe(r);let t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function Tr(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}function p0(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Nt(r){if(pe(r),Fa)return r.toHex();let e="";for(let t=0;t<r.length;t++)e+=ad[r[t]];return e}function Sa(r){if(r>=it._0&&r<=it._9)return r-it._0;if(r>=it.A&&r<=it.F)return r-(it.A-10);if(r>=it.a&&r<=it.f)return r-(it.a-10)}function y0(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);if(Fa)return Uint8Array.fromHex(r);let e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(t);for(let s=0,o=0;s<t;s++,o+=2){let i=Sa(r.charCodeAt(o)),a=Sa(r.charCodeAt(o+1));if(i===void 0||a===void 0){let c=r[o]+r[o+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+o)}n[s]=i*16+a}return n}function ct(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}function ks(r){return typeof r=="string"&&(r=ct(r)),pe(r),r}function Te(...r){let e=0;for(let n=0;n<r.length;n++){let s=r[n];pe(s),e+=s.length}let t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){let o=r[n];t.set(o,s),s+=o.length}return t}function Pa(r){let e=n=>r().update(ks(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function Fr(r=32){if(Ut&&typeof Ut.getRandomValues=="function")return Ut.getRandomValues(new Uint8Array(r));if(Ut&&typeof Ut.randomBytes=="function")return Uint8Array.from(Ut.randomBytes(r));throw new Error("crypto.getRandomValues must be defined")}var Fa,ad,it,h0,dr=He(()=>{Ra();Fa=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",ad=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));it={_0:48,_9:57,A:65,F:70,a:97,f:102};h0=class{}});function cd(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);let s=BigInt(32),o=BigInt(4294967295),i=Number(t>>s&o),a=Number(t&o),c=n?4:0,l=n?0:4;r.setUint32(e+c,i,n),r.setUint32(e+l,a,n)}var m0,ge,Ha=He(()=>{dr();m0=class extends h0{constructor(e,t,n,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.buffer=new Uint8Array(e),this.view=p0(this.buffer)}update(e){Hs(this),e=ks(e),pe(e);let{view:t,buffer:n,blockLen:s}=this,o=e.length;for(let i=0;i<o;){let a=Math.min(s-this.pos,o-i);if(a===s){let c=p0(e);for(;s<=o-i;i+=s)this.process(c,i);continue}n.set(e.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Hs(this),Ta(e,this),this.finished=!0;let{buffer:t,view:n,blockLen:s,isLE:o}=this,{pos:i}=this;t[i++]=128,Tr(this.buffer.subarray(i)),this.padOffset>s-i&&(this.process(n,0),i=0);for(let u=i;u<s;u++)t[u]=0;cd(n,s-8,BigInt(this.length*8),o),this.process(n,0);let a=p0(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=c/4,f=this.get();if(l>f.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<l;u++)a.setUint32(4*u,f[u],o)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:n,length:s,finished:o,destroyed:i,pos:a}=this;return e.destroyed=i,e.finished=o,e.length=s,e.pos=a,s%t&&e.buffer.set(n),e}clone(){return this._cloneInto()}},ge=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])});function fd(r,e=!1){return e?{h:Number(r&g0),l:Number(r>>ka&g0)}:{h:Number(r>>ka&g0)|0,l:Number(r&g0)|0}}function La(r,e=!1){let t=r.length,n=new Uint32Array(t),s=new Uint32Array(t);for(let o=0;o<t;o++){let{h:i,l:a}=fd(r[o],e);[n[o],s[o]]=[i,a]}return[n,s]}function Ze(r,e,t,n){let s=(e>>>0)+(n>>>0);return{h:r+t+(s/2**32|0)|0,l:s|0}}var g0,ka,Ls,Is,Mt,Vt,Pr,Hr,Ia,Oa,qa,Ua,Na,Ma,Va=He(()=>{g0=BigInt(4294967295),ka=BigInt(32);Ls=(r,e,t)=>r>>>t,Is=(r,e,t)=>r<<32-t|e>>>t,Mt=(r,e,t)=>r>>>t|e<<32-t,Vt=(r,e,t)=>r<<32-t|e>>>t,Pr=(r,e,t)=>r<<64-t|e>>>t-32,Hr=(r,e,t)=>r>>>t-32|e<<64-t;Ia=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),Oa=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,qa=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),Ua=(r,e,t,n,s)=>e+t+n+s+(r/2**32|0)|0,Na=(r,e,t,n,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),Ma=(r,e,t,n,s,o)=>e+t+n+s+o+(r/2**32|0)|0});var Ka,ud,ld,wt,Dt,Os,ur,za=He(()=>{Ha();Va();dr();Ka=La(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),ud=Ka[0],ld=Ka[1],wt=new Uint32Array(80),Dt=new Uint32Array(80),Os=class extends m0{constructor(e=64){super(128,e,16,!1),this.Ah=ge[0]|0,this.Al=ge[1]|0,this.Bh=ge[2]|0,this.Bl=ge[3]|0,this.Ch=ge[4]|0,this.Cl=ge[5]|0,this.Dh=ge[6]|0,this.Dl=ge[7]|0,this.Eh=ge[8]|0,this.El=ge[9]|0,this.Fh=ge[10]|0,this.Fl=ge[11]|0,this.Gh=ge[12]|0,this.Gl=ge[13]|0,this.Hh=ge[14]|0,this.Hl=ge[15]|0}get(){let{Ah:e,Al:t,Bh:n,Bl:s,Ch:o,Cl:i,Dh:a,Dl:c,Eh:l,El:f,Fh:u,Fl:d,Gh:p,Gl:m,Hh:g,Hl:v}=this;return[e,t,n,s,o,i,a,c,l,f,u,d,p,m,g,v]}set(e,t,n,s,o,i,a,c,l,f,u,d,p,m,g,v){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=o|0,this.Cl=i|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=f|0,this.Fh=u|0,this.Fl=d|0,this.Gh=p|0,this.Gl=m|0,this.Hh=g|0,this.Hl=v|0}process(e,t){for(let B=0;B<16;B++,t+=4)wt[B]=e.getUint32(t),Dt[B]=e.getUint32(t+=4);for(let B=16;B<80;B++){let E=wt[B-15]|0,b=Dt[B-15]|0,C=Mt(E,b,1)^Mt(E,b,8)^Ls(E,b,7),T=Vt(E,b,1)^Vt(E,b,8)^Is(E,b,7),_=wt[B-2]|0,w=Dt[B-2]|0,S=Mt(_,w,19)^Pr(_,w,61)^Ls(_,w,6),A=Vt(_,w,19)^Hr(_,w,61)^Is(_,w,6),P=qa(T,A,Dt[B-7],Dt[B-16]),F=Ua(P,C,S,wt[B-7],wt[B-16]);wt[B]=F|0,Dt[B]=P|0}let{Ah:n,Al:s,Bh:o,Bl:i,Ch:a,Cl:c,Dh:l,Dl:f,Eh:u,El:d,Fh:p,Fl:m,Gh:g,Gl:v,Hh:x,Hl:y}=this;for(let B=0;B<80;B++){let E=Mt(u,d,14)^Mt(u,d,18)^Pr(u,d,41),b=Vt(u,d,14)^Vt(u,d,18)^Hr(u,d,41),C=u&p^~u&g,T=d&m^~d&v,_=Na(y,b,T,ld[B],Dt[B]),w=Ma(_,x,E,C,ud[B],wt[B]),S=_|0,A=Mt(n,s,28)^Pr(n,s,34)^Pr(n,s,39),P=Vt(n,s,28)^Hr(n,s,34)^Hr(n,s,39),F=n&o^n&a^o&a,D=s&i^s&c^i&c;x=g|0,y=v|0,g=p|0,v=m|0,p=u|0,m=d|0,{h:u,l:d}=Ze(l|0,f|0,w|0,S|0),l=a|0,f=c|0,a=o|0,c=i|0,o=n|0,i=s|0;let q=Ia(S,P,D);n=Oa(q,w,A,F),s=q|0}({h:n,l:s}=Ze(this.Ah|0,this.Al|0,n|0,s|0)),{h:o,l:i}=Ze(this.Bh|0,this.Bl|0,o|0,i|0),{h:a,l:c}=Ze(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:f}=Ze(this.Dh|0,this.Dl|0,l|0,f|0),{h:u,l:d}=Ze(this.Eh|0,this.El|0,u|0,d|0),{h:p,l:m}=Ze(this.Fh|0,this.Fl|0,p|0,m|0),{h:g,l:v}=Ze(this.Gh|0,this.Gl|0,g|0,v|0),{h:x,l:y}=Ze(this.Hh|0,this.Hl|0,x|0,y|0),this.set(n,s,o,i,a,c,l,f,u,d,p,m,g,v,x,y)}roundClean(){Tr(wt,Dt)}destroy(){Tr(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},ur=Pa(()=>new Os)});function v0(r,e=""){if(typeof r!="boolean"){let t=e&&`"${e}"`;throw new Error(t+"expected boolean, got type="+typeof r)}return r}function kr(r,e,t=""){let n=at(r),s=r?.length,o=e!==void 0;if(!n||o&&s!==e){let i=t&&`"${t}" `,a=o?` of length ${e}`:"",c=n?`length=${s}`:`type=${typeof r}`;throw new Error(i+"expected Uint8Array"+a+", got "+c)}return r}function Ga(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?Ns:BigInt("0x"+r)}function B0(r){return Ga(Nt(r))}function Ie(r){return pe(r),Ga(Nt(Uint8Array.from(r).reverse()))}function Ms(r,e){return y0(r.toString(16).padStart(e*2,"0"))}function C0(r,e){return Ms(r,e).reverse()}function ye(r,e,t){let n;if(typeof e=="string")try{n=y0(e)}catch(o){throw new Error(r+" must be hex string or Uint8Array, cause: "+o)}else if(at(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");let s=n.length;if(typeof t=="number"&&s!==t)throw new Error(r+" of length "+t+" expected, got "+s);return n}function Ya(r,e){if(r.length!==e.length)return!1;let t=0;for(let n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}function Vs(r){return Uint8Array.from(r)}function xd(r,e,t){return qs(r)&&qs(e)&&qs(t)&&e<=r&&r<t}function lr(r,e,t,n){if(!xd(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function Wa(r){let e;for(e=0;r>Ns;r>>=Us,e+=1);return e}function ja(r){return typeof r=="function"&&Number.isSafeInteger(r.outputLen)}function ft(r,e,t={}){if(!r||typeof r!="object")throw new Error("expected valid options object");function n(s,o,i){let a=r[s];if(i&&a===void 0)return;let c=typeof a;if(c!==o||a===null)throw new Error(`param "${s}" is invalid: expected ${o}, got ${c}`)}Object.entries(e).forEach(([s,o])=>n(s,o,!1)),Object.entries(t).forEach(([s,o])=>n(s,o,!0))}function zs(r){let e=new WeakMap;return(t,...n)=>{let s=e.get(t);if(s!==void 0)return s;let o=r(t,...n);return e.set(t,o),o}}var Ns,Us,qs,Lr,Ks,Kt=He(()=>{dr();dr();Ns=BigInt(0),Us=BigInt(1);qs=r=>typeof r=="bigint"&&Ns<=r;Lr=r=>(Us<<BigInt(r))-Us;Ks=()=>{throw new Error("not implemented")}});function oe(r,e){let t=r%e;return t>=Ae?t:e+t}function Oe(r,e,t){let n=r;for(;e-- >Ae;)n*=n,n%=t;return n}function $a(r,e){if(r===Ae)throw new Error("invert: expected non-zero number");if(e<=Ae)throw new Error("invert: expected positive modulus, got "+e);let t=oe(r,e),n=e,s=Ae,o=Ee,i=Ee,a=Ae;for(;t!==Ae;){let l=n/t,f=n%t,u=s-i*l,d=o-a*l;n=t,t=f,s=i,o=a,i=u,a=d}if(n!==Ee)throw new Error("invert: does not exist");return oe(s,e)}function Gs(r,e,t){if(!r.eql(r.sqr(e),t))throw new Error("Cannot find square root")}function rc(r,e){let t=(r.ORDER+Ee)/Qa,n=r.pow(e,t);return Gs(r,n,e),n}function yd(r,e){let t=(r.ORDER-Ja)/ec,n=r.mul(e,zt),s=r.pow(n,t),o=r.mul(e,s),i=r.mul(r.mul(o,zt),s),a=r.mul(o,r.sub(i,r.ONE));return Gs(r,a,e),a}function md(r){let e=ut(r),t=nc(r),n=t(e,e.neg(e.ONE)),s=t(e,n),o=t(e,e.neg(n)),i=(r+hd)/tc;return(a,c)=>{let l=a.pow(c,i),f=a.mul(l,n),u=a.mul(l,s),d=a.mul(l,o),p=a.eql(a.sqr(f),c),m=a.eql(a.sqr(u),c);l=a.cmov(l,f,p),f=a.cmov(d,u,m);let g=a.eql(a.sqr(f),c),v=a.cmov(l,f,g);return Gs(a,v,c),v}}function nc(r){if(r<Xa)throw new Error("sqrt is not defined for small field");let e=r-Ee,t=0;for(;e%zt===Ae;)e/=zt,t++;let n=zt,s=ut(r);for(;Za(s,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(t===1)return rc;let o=s.pow(n,e),i=(e+Ee)/zt;return function(c,l){if(c.is0(l))return l;if(Za(c,l)!==1)throw new Error("Cannot find square root");let f=t,u=c.mul(c.ONE,o),d=c.pow(l,e),p=c.pow(l,i);for(;!c.eql(d,c.ONE);){if(c.is0(d))return c.ZERO;let m=1,g=c.sqr(d);for(;!c.eql(g,c.ONE);)if(m++,g=c.sqr(g),m===f)throw new Error("Cannot find square root");let v=Ee<<BigInt(f-m-1),x=c.pow(u,v);f=m,u=c.sqr(x),d=c.mul(d,u),p=c.mul(p,x)}return p}}function gd(r){return r%Qa===Xa?rc:r%ec===Ja?yd:r%tc===pd?md(r):nc(r)}function sc(r){let e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},t=vd.reduce((n,s)=>(n[s]="function",n),e);return ft(r,t),r}function Bd(r,e,t){if(t<Ae)throw new Error("invalid exponent, negatives unsupported");if(t===Ae)return r.ONE;if(t===Ee)return e;let n=r.ONE,s=e;for(;t>Ae;)t&Ee&&(n=r.mul(n,s)),s=r.sqr(s),t>>=Ee;return n}function xr(r,e,t=!1){let n=new Array(e.length).fill(t?r.ZERO:void 0),s=e.reduce((i,a,c)=>r.is0(a)?i:(n[c]=i,r.mul(i,a)),r.ONE),o=r.inv(s);return e.reduceRight((i,a,c)=>r.is0(a)?i:(n[c]=r.mul(i,n[c]),r.mul(i,a)),o),n}function Za(r,e){let t=(r.ORDER-Ee)/zt,n=r.pow(e,t),s=r.eql(n,r.ONE),o=r.eql(n,r.ZERO),i=r.eql(n,r.neg(r.ONE));if(!s&&!o&&!i)throw new Error("invalid Legendre symbol result");return s?1:o?0:-1}function oc(r,e){e!==void 0&&Ps(e);let t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function ut(r,e,t=!1,n={}){if(r<=Ae)throw new Error("invalid field: expected ORDER > 0, got "+r);let s,o,i=!1,a;if(typeof e=="object"&&e!=null){if(n.sqrt||t)throw new Error("cannot specify opts in two arguments");let d=e;d.BITS&&(s=d.BITS),d.sqrt&&(o=d.sqrt),typeof d.isLE=="boolean"&&(t=d.isLE),typeof d.modFromBytes=="boolean"&&(i=d.modFromBytes),a=d.allowedLengths}else typeof e=="number"&&(s=e),n.sqrt&&(o=n.sqrt);let{nBitLength:c,nByteLength:l}=oc(r,s);if(l>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let f,u=Object.freeze({ORDER:r,isLE:t,BITS:c,BYTES:l,MASK:Lr(c),ZERO:Ae,ONE:Ee,allowedLengths:a,create:d=>oe(d,r),isValid:d=>{if(typeof d!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof d);return Ae<=d&&d<r},is0:d=>d===Ae,isValidNot0:d=>!u.is0(d)&&u.isValid(d),isOdd:d=>(d&Ee)===Ee,neg:d=>oe(-d,r),eql:(d,p)=>d===p,sqr:d=>oe(d*d,r),add:(d,p)=>oe(d+p,r),sub:(d,p)=>oe(d-p,r),mul:(d,p)=>oe(d*p,r),pow:(d,p)=>Bd(u,d,p),div:(d,p)=>oe(d*$a(p,r),r),sqrN:d=>d*d,addN:(d,p)=>d+p,subN:(d,p)=>d-p,mulN:(d,p)=>d*p,inv:d=>$a(d,r),sqrt:o||(d=>(f||(f=gd(r)),f(u,d))),toBytes:d=>t?C0(d,l):Ms(d,l),fromBytes:(d,p=!0)=>{if(a){if(!a.includes(d.length)||d.length>l)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+d.length);let g=new Uint8Array(l);g.set(d,t?0:g.length-d.length),d=g}if(d.length!==l)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+d.length);let m=t?Ie(d):B0(d);if(i&&(m=oe(m,r)),!p&&!u.isValid(m))throw new Error("invalid field element: outside of range 0..ORDER");return m},invertBatch:d=>xr(u,d),cmov:(d,p,m)=>m?p:d});return Object.freeze(u)}function ic(r,e){if(!r.isOdd)throw new Error("Field doesn't have isOdd");let t=r.sqrt(e);return r.isOdd(t)?r.neg(t):t}var Ae,Ee,zt,Xa,Qa,Ja,hd,ec,pd,tc,dt,vd,hr=He(()=>{Kt();Ae=BigInt(0),Ee=BigInt(1),zt=BigInt(2),Xa=BigInt(3),Qa=BigInt(4),Ja=BigInt(5),hd=BigInt(7),ec=BigInt(8),pd=BigInt(9),tc=BigInt(16);dt=(r,e)=>(oe(r,e)&Ee)===Ee,vd=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"]});function ac(r,e){let t=e.negate();return r?t:e}function Ir(r,e){let t=xr(r.Fp,e.map(n=>n.Z));return e.map((n,s)=>r.fromAffine(n.toAffine(t[s])))}function uc(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function Ys(r,e){uc(r,e);let t=Math.ceil(e/r)+1,n=2**(r-1),s=2**r,o=Lr(r),i=BigInt(r);return{windows:t,windowSize:n,mask:o,maxNumber:s,shiftBy:i}}function cc(r,e,t){let{windowSize:n,mask:s,maxNumber:o,shiftBy:i}=t,a=Number(r&s),c=r>>i;a>n&&(a-=o,c+=$s);let l=e*n,f=l+Math.abs(a)-1,u=a===0,d=a<0,p=e%2!==0;return{nextN:c,offset:f,isZero:u,isNeg:d,isNegF:p,offsetF:l}}function Cd(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function Ed(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}function js(r){return lc.get(r)||1}function fc(r){if(r!==E0)throw new Error("invalid wNAF")}function A0(r,e,t,n){Cd(t,r),Ed(n,e);let s=t.length,o=n.length;if(s!==o)throw new Error("arrays of points and scalars must have equal length");let i=r.ZERO,a=Wa(BigInt(s)),c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);let l=Lr(c),f=new Array(Number(l)+1).fill(i),u=Math.floor((e.BITS-1)/c)*c,d=i;for(let p=u;p>=0;p-=c){f.fill(i);for(let g=0;g<o;g++){let v=n[g],x=Number(v>>BigInt(p)&l);f[x]=f[x].add(t[g])}let m=i;for(let g=f.length-1,v=i;g>0;g--)v=v.add(f[g]),m=m.add(v);if(d=d.add(m),p!==0)for(let g=0;g<c;g++)d=d.double()}return d}function dc(r,e,t){if(e){if(e.ORDER!==r)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return sc(e),e}else return ut(r,{isLE:t})}function xc(r,e,t={},n){if(n===void 0&&(n=r==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${r} CURVE object`);for(let c of["p","n","h"]){let l=e[c];if(!(typeof l=="bigint"&&l>E0))throw new Error(`CURVE.${c} must be positive bigint`)}let s=dc(e.p,t.Fp,n),o=dc(e.n,t.Fn,n),a=["Gx","Gy","a",r==="weierstrass"?"b":"d"];for(let c of a)if(!s.isValid(e[c]))throw new Error(`CURVE.${c} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:s,Fn:o}}var E0,$s,Ws,lc,b0,Zs=He(()=>{Kt();hr();E0=BigInt(0),$s=BigInt(1);Ws=new WeakMap,lc=new WeakMap;b0=class{constructor(e,t){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=t}_unsafeLadder(e,t,n=this.ZERO){let s=e;for(;t>E0;)t&$s&&(n=n.add(s)),s=s.double(),t>>=$s;return n}precomputeWindow(e,t){let{windows:n,windowSize:s}=Ys(t,this.bits),o=[],i=e,a=i;for(let c=0;c<n;c++){a=i,o.push(a);for(let l=1;l<s;l++)a=a.add(i),o.push(a);i=a.double()}return o}wNAF(e,t,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let s=this.ZERO,o=this.BASE,i=Ys(e,this.bits);for(let a=0;a<i.windows;a++){let{nextN:c,offset:l,isZero:f,isNeg:u,isNegF:d,offsetF:p}=cc(n,a,i);n=c,f?o=o.add(ac(d,t[p])):s=s.add(ac(u,t[l]))}return fc(n),{p:s,f:o}}wNAFUnsafe(e,t,n,s=this.ZERO){let o=Ys(e,this.bits);for(let i=0;i<o.windows&&n!==E0;i++){let{nextN:a,offset:c,isZero:l,isNeg:f}=cc(n,i,o);if(n=a,!l){let u=t[c];s=s.add(f?u.negate():u)}}return fc(n),s}getPrecomputes(e,t,n){let s=Ws.get(t);return s||(s=this.precomputeWindow(t,e),e!==1&&(typeof n=="function"&&(s=n(s)),Ws.set(t,s))),s}cached(e,t,n){let s=js(e);return this.wNAF(s,this.getPrecomputes(s,e,n),t)}unsafe(e,t,n,s){let o=js(e);return o===1?this._unsafeLadder(e,t,s):this.wNAFUnsafe(o,this.getPrecomputes(o,e,n),t,s)}createCache(e,t){uc(t,this.bits),lc.set(e,t),Ws.delete(e)}hasCache(e){return js(e)!==1}}});function Ad(r,e,t,n){let s=r.sqr(t),o=r.sqr(n),i=r.add(r.mul(e.a,s),o),a=r.add(r.ONE,r.mul(e.d,r.mul(s,o)));return r.eql(i,a)}function wd(r,e={}){let t=xc("edwards",r,e,e.FpFnLE),{Fp:n,Fn:s}=t,o=t.CURVE,{h:i}=o;ft(e,{},{uvRatio:"function"});let a=Xs<<BigInt(s.BYTES*8)-me,c=v=>n.create(v),l=e.uvRatio||((v,x)=>{try{return{isValid:!0,value:n.sqrt(n.div(v,x))}}catch{return{isValid:!1,value:_t}}});if(!Ad(n,o,o.Gx,o.Gy))throw new Error("bad curve params: generator point");function f(v,x,y=!1){let B=y?me:_t;return lr("coordinate "+v,x,B,a),x}function u(v){if(!(v instanceof m))throw new Error("ExtendedPoint expected")}let d=zs((v,x)=>{let{X:y,Y:B,Z:E}=v,b=v.is0();x==null&&(x=b?bd:n.inv(E));let C=c(y*x),T=c(B*x),_=n.mul(E,x);if(b)return{x:_t,y:me};if(_!==me)throw new Error("invZ was invalid");return{x:C,y:T}}),p=zs(v=>{let{a:x,d:y}=o;if(v.is0())throw new Error("bad point: ZERO");let{X:B,Y:E,Z:b,T:C}=v,T=c(B*B),_=c(E*E),w=c(b*b),S=c(w*w),A=c(T*x),P=c(w*c(A+_)),F=c(S+c(y*c(T*_)));if(P!==F)throw new Error("bad point: equation left != right (1)");let D=c(B*E),q=c(b*C);if(D!==q)throw new Error("bad point: equation left != right (2)");return!0});class m{constructor(x,y,B,E){this.X=f("x",x),this.Y=f("y",y),this.Z=f("z",B,!0),this.T=f("t",E),Object.freeze(this)}static CURVE(){return o}static fromAffine(x){if(x instanceof m)throw new Error("extended point not allowed");let{x:y,y:B}=x||{};return f("x",y),f("y",B),new m(y,B,me,c(y*B))}static fromBytes(x,y=!1){let B=n.BYTES,{a:E,d:b}=o;x=Vs(kr(x,B,"point")),v0(y,"zip215");let C=Vs(x),T=x[B-1];C[B-1]=T&-129;let _=Ie(C),w=y?a:n.ORDER;lr("point.y",_,_t,w);let S=c(_*_),A=c(S-me),P=c(b*S-E),{isValid:F,value:D}=l(A,P);if(!F)throw new Error("bad point: invalid y coordinate");let q=(D&me)===me,U=(T&128)!==0;if(!y&&D===_t&&U)throw new Error("bad point: x=0 and x_0=1");return U!==q&&(D=c(-D)),m.fromAffine({x:D,y:_})}static fromHex(x,y=!1){return m.fromBytes(ye("point",x),y)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(x=8,y=!0){return g.createCache(this,x),y||this.multiply(Xs),this}assertValidity(){p(this)}equals(x){u(x);let{X:y,Y:B,Z:E}=this,{X:b,Y:C,Z:T}=x,_=c(y*T),w=c(b*E),S=c(B*T),A=c(C*E);return _===w&&S===A}is0(){return this.equals(m.ZERO)}negate(){return new m(c(-this.X),this.Y,this.Z,c(-this.T))}double(){let{a:x}=o,{X:y,Y:B,Z:E}=this,b=c(y*y),C=c(B*B),T=c(Xs*c(E*E)),_=c(x*b),w=y+B,S=c(c(w*w)-b-C),A=_+C,P=A-T,F=_-C,D=c(S*P),q=c(A*F),U=c(S*F),z=c(P*A);return new m(D,q,z,U)}add(x){u(x);let{a:y,d:B}=o,{X:E,Y:b,Z:C,T}=this,{X:_,Y:w,Z:S,T:A}=x,P=c(E*_),F=c(b*w),D=c(T*B*A),q=c(C*S),U=c((E+b)*(_+w)-P-F),z=q-D,Y=q+D,R=c(F-y*P),L=c(U*z),I=c(Y*R),k=c(U*R),Q=c(z*Y);return new m(L,I,Q,k)}subtract(x){return this.add(x.negate())}multiply(x){if(!s.isValidNot0(x))throw new Error("invalid scalar: expected 1 <= sc < curve.n");let{p:y,f:B}=g.cached(this,x,E=>Ir(m,E));return Ir(m,[y,B])[0]}multiplyUnsafe(x,y=m.ZERO){if(!s.isValid(x))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return x===_t?m.ZERO:this.is0()||x===me?this:g.unsafe(this,x,B=>Ir(m,B),y)}isSmallOrder(){return this.multiplyUnsafe(i).is0()}isTorsionFree(){return g.unsafe(this,o.n).is0()}toAffine(x){return d(this,x)}clearCofactor(){return i===me?this:this.multiplyUnsafe(i)}toBytes(){let{x,y}=this.toAffine(),B=n.toBytes(y);return B[B.length-1]|=x&me?128:0,B}toHex(){return Nt(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(x){return Ir(m,x)}static msm(x,y){return A0(m,s,x,y)}_setWindowSize(x){this.precompute(x)}toRawBytes(){return this.toBytes()}}m.BASE=new m(o.Gx,o.Gy,me,c(o.Gx*o.Gy)),m.ZERO=new m(_t,me,me,_t),m.Fp=n,m.Fn=s;let g=new b0(m,s.BITS);return m.BASE.precompute(8),m}function Dd(r,e,t={}){if(typeof e!="function")throw new Error('"hash" function param is required');ft(t,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:n}=t,{BASE:s,Fp:o,Fn:i}=r,a=t.randomBytes||Fr,c=t.adjustScalarBytes||(w=>w),l=t.domain||((w,S,A)=>{if(v0(A,"phflag"),S.length||A)throw new Error("Contexts/pre-hash are not supported");return w});function f(w){return i.create(Ie(w))}function u(w){let S=B.secretKey;w=ye("private key",w,S);let A=ye("hashed private key",e(w),2*S),P=c(A.slice(0,S)),F=A.slice(S,2*S),D=f(P);return{head:P,prefix:F,scalar:D}}function d(w){let{head:S,prefix:A,scalar:P}=u(w),F=s.multiply(P),D=F.toBytes();return{head:S,prefix:A,scalar:P,point:F,pointBytes:D}}function p(w){return d(w).pointBytes}function m(w=Uint8Array.of(),...S){let A=Te(...S);return f(e(l(A,ye("context",w),!!n)))}function g(w,S,A={}){w=ye("message",w),n&&(w=n(w));let{prefix:P,scalar:F,pointBytes:D}=d(S),q=m(A.context,P,w),U=s.multiply(q).toBytes(),z=m(A.context,U,D,w),Y=i.create(q+z*F);if(!i.isValid(Y))throw new Error("sign failed: invalid s");let R=Te(U,i.toBytes(Y));return kr(R,B.signature,"result")}let v={zip215:!0};function x(w,S,A,P=v){let{context:F,zip215:D}=P,q=B.signature;w=ye("signature",w,q),S=ye("message",S),A=ye("publicKey",A,B.publicKey),D!==void 0&&v0(D,"zip215"),n&&(S=n(S));let U=q/2,z=w.subarray(0,U),Y=Ie(w.subarray(U,q)),R,L,I;try{R=r.fromBytes(A,D),L=r.fromBytes(z,D),I=s.multiplyUnsafe(Y)}catch{return!1}if(!D&&R.isSmallOrder())return!1;let k=m(F,L.toBytes(),R.toBytes(),S);return L.add(R.multiplyUnsafe(k)).subtract(I).clearCofactor().is0()}let y=o.BYTES,B={secretKey:y,publicKey:y,signature:2*y,seed:y};function E(w=a(B.seed)){return kr(w,B.seed,"seed")}function b(w){let S=_.randomSecretKey(w);return{secretKey:S,publicKey:p(S)}}function C(w){return at(w)&&w.length===i.BYTES}function T(w,S){try{return!!r.fromBytes(w,S)}catch{return!1}}let _={getExtendedPublicKey:d,randomSecretKey:E,isValidSecretKey:C,isValidPublicKey:T,toMontgomery(w){let{y:S}=r.fromBytes(w),A=B.publicKey,P=A===32;if(!P&&A!==57)throw new Error("only defined for 25519 and 448");let F=P?o.div(me+S,me-S):o.div(S-me,S+me);return o.toBytes(F)},toMontgomerySecret(w){let S=B.secretKey;kr(w,S);let A=e(w.subarray(0,S));return c(A).subarray(0,S)},randomPrivateKey:E,precompute(w=8,S=r.BASE){return S.precompute(w,!1)}};return Object.freeze({keygen:b,getPublicKey:p,sign:g,verify:x,utils:_,Point:r,lengths:B})}function _d(r){let e={a:r.a,d:r.d,p:r.Fp.ORDER,n:r.n,h:r.h,Gx:r.Gx,Gy:r.Gy},t=r.Fp,n=ut(e.n,r.nBitLength,!0),s={Fp:t,Fn:n,uvRatio:r.uvRatio},o={randomBytes:r.randomBytes,adjustScalarBytes:r.adjustScalarBytes,domain:r.domain,prehash:r.prehash,mapToCurve:r.mapToCurve};return{CURVE:e,curveOpts:s,hash:r.hash,eddsaOpts:o}}function Rd(r,e){let t=e.Point;return Object.assign({},e,{ExtendedPoint:t,CURVE:r,nBitLength:t.Fn.BITS,nByteLength:t.Fn.BYTES})}function D0(r){let{CURVE:e,curveOpts:t,hash:n,eddsaOpts:s}=_d(r),o=wd(e,t),i=Dd(o,n,s);return Rd(r,i)}var _t,me,Xs,bd,w0,hc=He(()=>{Kt();Zs();hr();_t=BigInt(0),me=BigInt(1),Xs=BigInt(2),bd=BigInt(8);w0=class{constructor(e){this.ep=e}static fromBytes(e){Ks()}static fromHex(e){Ks()}get x(){return this.toAffine().x}get y(){return this.toAffine().y}clearCofactor(){return this}assertValidity(){this.ep.assertValidity()}toAffine(e){return this.ep.toAffine(e)}toHex(){return Nt(this.toBytes())}toString(){return this.toHex()}isTorsionFree(){return!0}isSmallOrder(){return!1}add(e){return this.assertSame(e),this.init(this.ep.add(e.ep))}subtract(e){return this.assertSame(e),this.init(this.ep.subtract(e.ep))}multiply(e){return this.init(this.ep.multiply(e))}multiplyUnsafe(e){return this.init(this.ep.multiplyUnsafe(e))}double(){return this.init(this.ep.double())}negate(){return this.init(this.ep.negate())}precompute(e,t){return this.init(this.ep.precompute(e,t))}toRawBytes(){return this.toBytes()}}});function Rt(r,e){if(Or(r),Or(e),r<0||r>=1<<8*e)throw new Error("invalid I2OSP input: "+r);let t=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)t[n]=r&255,r>>>=8;return new Uint8Array(t)}function Td(r,e){let t=new Uint8Array(r.length);for(let n=0;n<r.length;n++)t[n]=r[n]^e[n];return t}function Or(r){if(!Number.isSafeInteger(r))throw new Error("number expected")}function pc(r){if(!at(r)&&typeof r!="string")throw new Error("DST must be Uint8Array or string");return typeof r=="string"?ct(r):r}function _0(r,e,t,n){pe(r),Or(t),e=pc(e),e.length>255&&(e=n(Te(ct("H2C-OVERSIZE-DST-"),e)));let{outputLen:s,blockLen:o}=n,i=Math.ceil(t/s);if(t>65535||i>255)throw new Error("expand_message_xmd: invalid lenInBytes");let a=Te(e,Rt(e.length,1)),c=Rt(0,o),l=Rt(t,2),f=new Array(i),u=n(Te(c,r,l,Rt(0,1),a));f[0]=n(Te(u,Rt(1,1),a));for(let p=1;p<=i;p++){let m=[Td(u,f[p-1]),Rt(p+1,1),a];f[p]=n(Te(...m))}return Te(...f).slice(0,t)}function Fd(r,e,t,n,s){if(pe(r),Or(t),e=pc(e),e.length>255){let o=Math.ceil(2*n/8);e=s.create({dkLen:o}).update(ct("H2C-OVERSIZE-DST-")).update(e).digest()}if(t>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return s.create({dkLen:t}).update(r).update(Rt(t,2)).update(e).update(Rt(e.length,1)).digest()}function Qs(r,e,t){ft(t,{p:"bigint",m:"number",k:"number",hash:"function"});let{p:n,k:s,m:o,hash:i,expand:a,DST:c}=t;if(!ja(t.hash))throw new Error("expected valid hash");pe(r),Or(e);let l=n.toString(2).length,f=Math.ceil((l+s)/8),u=e*o*f,d;if(a==="xmd")d=_0(r,c,u,i);else if(a==="xof")d=Fd(r,c,u,s,i);else if(a==="_internal_pass")d=r;else throw new Error('expand must be "xmd" or "xof"');let p=new Array(e);for(let m=0;m<e;m++){let g=new Array(o);for(let v=0;v<o;v++){let x=f*(v+m*o),y=d.subarray(x,x+f);g[v]=oe(Sd(y),n)}p[m]=g}return p}function yc(r,e,t){if(typeof e!="function")throw new Error("mapToCurve() must be defined");function n(o){return r.fromAffine(e(o))}function s(o){let i=o.clearCofactor();return i.equals(r.ZERO)?r.ZERO:(i.assertValidity(),i)}return{defaults:t,hashToCurve(o,i){let a=Object.assign({},t,i),c=Qs(o,2,a),l=n(c[0]),f=n(c[1]);return s(l.add(f))},encodeToCurve(o,i){let a=t.encodeDST?{DST:t.encodeDST}:{},c=Object.assign({},t,a,i),l=Qs(o,1,c),f=n(l[0]);return s(f)},mapToCurve(o){if(!Array.isArray(o))throw new Error("expected array of bigints");for(let i of o)if(typeof i!="bigint")throw new Error("expected array of bigints");return s(n(o))},hashToScalar(o,i){let a=r.Fn.ORDER,c=Object.assign({},t,{p:a,m:1,DST:Js},i);return Qs(o,1,c)[0][0]}}}var Sd,Js,mc=He(()=>{Kt();hr();Sd=B0;Js=ct("HashToScalar-")});function Pd(r){return ft(r,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...r})}function gc(r){let e=Pd(r),{P:t,type:n,adjustScalarBytes:s,powPminus2:o,randomBytes:i}=e,a=n==="x25519";if(!a&&n!=="x448")throw new Error("invalid type");let c=i||Fr,l=a?255:448,f=a?32:56,u=BigInt(a?9:5),d=BigInt(a?121665:39081),p=a?R0**BigInt(254):R0**BigInt(447),m=a?BigInt(8)*R0**BigInt(251)-pr:BigInt(4)*R0**BigInt(445)-pr,g=p+m+pr,v=F=>oe(F,t),x=y(u);function y(F){return C0(v(F),f)}function B(F){let D=ye("u coordinate",F,f);return a&&(D[31]&=127),v(Ie(D))}function E(F){return Ie(s(ye("scalar",F,f)))}function b(F,D){let q=_(B(D),E(F));if(q===qr)throw new Error("invalid private or public key received");return y(q)}function C(F){return b(F,x)}function T(F,D,q){let U=v(F*(D-q));return D=v(D-U),q=v(q+U),{x_2:D,x_3:q}}function _(F,D){lr("u",F,qr,t),lr("scalar",D,p,g);let q=D,U=F,z=pr,Y=qr,R=F,L=pr,I=qr;for(let Q=BigInt(l-1);Q>=qr;Q--){let re=q>>Q&pr;I^=re,{x_2:z,x_3:R}=T(I,z,R),{x_2:Y,x_3:L}=T(I,Y,L),I=re;let de=z+Y,$=v(de*de),Fe=z-Y,qe=v(Fe*Fe),xt=$-qe,Qe=R+L,be=R-L,xe=v(be*de),Je=v(Qe*Fe),Ke=xe+Je,ht=xe-Je;R=v(Ke*Ke),L=v(U*v(ht*ht)),z=v($*qe),Y=v(xt*($+v(d*xt)))}({x_2:z,x_3:R}=T(I,z,R)),{x_2:Y,x_3:L}=T(I,Y,L);let k=o(Y);return v(z*k)}let w={secretKey:f,publicKey:f,seed:f},S=(F=c(f))=>(pe(F,w.seed),F);function A(F){let D=S(F);return{secretKey:D,publicKey:C(D)}}return{keygen:A,getSharedSecret:(F,D)=>b(F,D),getPublicKey:F=>C(F),scalarMult:b,scalarMultBase:C,utils:{randomSecretKey:S,randomPrivateKey:S},GuBytes:x.slice(),lengths:w}}var qr,pr,R0,vc=He(()=>{Kt();hr();qr=BigInt(0),pr=BigInt(1),R0=BigInt(2)});var Fc={};Eo(Fc,{ED25519_TORSION_SUBGROUP:()=>jd,RistrettoPoint:()=>Xd,ed25519:()=>Me,ed25519_hasher:()=>io,ed25519ctx:()=>kd,ed25519ph:()=>Ld,edwardsToMontgomery:()=>$d,edwardsToMontgomeryPriv:()=>Zd,edwardsToMontgomeryPub:()=>Tc,encodeToCurve:()=>Jd,hashToCurve:()=>Qd,hashToRistretto255:()=>eu,hash_to_ristretto255:()=>tu,ristretto255:()=>Wd,ristretto255_hasher:()=>ao,x25519:()=>Id});function wc(r){let e=BigInt(10),t=BigInt(20),n=BigInt(40),s=BigInt(80),o=lt,a=r*r%o*r%o,c=Oe(a,S0,o)*a%o,l=Oe(c,Xe,o)*r%o,f=Oe(l,Ac,o)*l%o,u=Oe(f,e,o)*f%o,d=Oe(u,t,o)*u%o,p=Oe(d,n,o)*d%o,m=Oe(p,s,o)*p%o,g=Oe(m,s,o)*p%o,v=Oe(g,e,o)*f%o;return{pow_p_5_8:Oe(v,S0,o)*r%o,b2:a}}function Dc(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function so(r,e){let t=lt,n=oe(e*e*e,t),s=oe(n*n*e,t),o=wc(r*s).pow_p_5_8,i=oe(r*n*o,t),a=oe(e*i*i,t),c=i,l=oe(i*eo,t),f=a===r,u=a===oe(-r,t),d=a===oe(-r*eo,t);return f&&(i=c),(u||d)&&(i=l),dt(i,t)&&(i=oe(-i,t)),{isValid:f||u,value:i}}function Rc(r,e,t){if(e.length>255)throw new Error("Context is too big");return Te(ct("SigEd25519 no Ed25519 collisions"),new Uint8Array([t?1:0,e.length]),e,r)}function Ud(r){let e=(lt-Ac)/no,t=BigInt(486662),n=N.sqr(r);n=N.mul(n,S0);let s=N.add(n,N.ONE),o=N.neg(t),i=N.sqr(s),a=N.mul(i,s),c=N.mul(n,t);c=N.mul(c,o),c=N.add(c,i),c=N.mul(c,o);let l=N.sqr(a);i=N.sqr(l),l=N.mul(l,a),l=N.mul(l,c),i=N.mul(i,l);let f=N.pow(i,e);f=N.mul(f,l);let u=N.mul(f,Bc);i=N.sqr(f),i=N.mul(i,a);let d=N.eql(i,c),p=N.cmov(u,f,d),m=N.mul(o,n),g=N.mul(f,r);g=N.mul(g,qd);let v=N.mul(g,Bc),x=N.mul(c,n);i=N.sqr(g),i=N.mul(i,a);let y=N.eql(i,x),B=N.cmov(v,g,y);i=N.sqr(p),i=N.mul(i,a);let E=N.eql(i,c),b=N.cmov(m,o,E),C=N.cmov(B,p,E),T=N.isOdd(C);return C=N.cmov(C,N.neg(C),E!==T),{xMn:b,xMd:s,yMn:C,yMd:Xe}}function Md(r){let{xMn:e,xMd:t,yMn:n,yMd:s}=Ud(r),o=N.mul(e,s);o=N.mul(o,Nd);let i=N.mul(t,n),a=N.sub(e,t),c=N.add(e,t),l=N.mul(i,c),f=N.eql(l,N.ZERO);o=N.cmov(o,N.ZERO,f),i=N.cmov(i,N.ONE,f),a=N.cmov(a,N.ONE,f),c=N.cmov(c,N.ONE,f);let[u,d]=xr(N,[i,c],!0);return{x:N.mul(o,u),y:N.mul(a,d)}}function Ec(r){let{d:e}=Ur,t=lt,n=x=>N.create(x),s=n(to*r*r),o=n((s+Xe)*zd),i=BigInt(-1),a=n((i-e*s)*n(s+e)),{isValid:c,value:l}=so(o,a),f=n(l*r);dt(f,t)||(f=n(-f)),c||(l=f),c||(i=s);let u=n(i*(s-Xe)*Gd-a),d=l*l,p=n((l+l)*a),m=n(u*Vd),g=n(Xe-d),v=n(Xe+d);return new Me.Point(n(p*v),n(g*m),n(m*v),n(p*g))}function Sc(r){pe(r,64);let e=ro(r.subarray(0,32)),t=Ec(e),n=ro(r.subarray(32,64)),s=Ec(n);return new Ve(t.add(s))}function Tc(r){return Me.utils.toMontgomery(ye("pub",r))}function Zd(r){return Me.utils.toMontgomerySecret(ye("pub",r))}var Hd,Xe,S0,bc,Ac,no,lt,Ur,eo,N,_c,oo,Me,kd,Ld,Id,Od,qd,Bc,Nd,io,to,Vd,Kd,zd,Gd,Cc,Yd,ro,Ve,Wd,ao,jd,$d,Xd,Qd,Jd,eu,tu,Pc=He(()=>{za();dr();Zs();hc();mc();hr();vc();Kt();Hd=BigInt(0),Xe=BigInt(1),S0=BigInt(2),bc=BigInt(3),Ac=BigInt(5),no=BigInt(8),lt=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),Ur={p:lt,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:no,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};eo=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");N=ut(Ur.p,{isLE:!0}),_c=ut(Ur.n,{isLE:!0}),oo={...Ur,Fp:N,hash:ur,adjustScalarBytes:Dc,uvRatio:so},Me=D0(oo);kd=D0({...oo,domain:Rc}),Ld=D0(Object.assign({},oo,{domain:Rc,prehash:ur})),Id=(()=>{let r=N.ORDER;return gc({P:r,type:"x25519",powPminus2:e=>{let{pow_p_5_8:t,b2:n}=wc(e);return oe(Oe(t,bc,r)*n,r)},adjustScalarBytes:Dc})})(),Od=(lt+bc)/no,qd=N.pow(S0,Od),Bc=N.sqrt(N.neg(N.ONE));Nd=ic(N,N.neg(BigInt(486664)));io=yc(Me.Point,r=>Md(r[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:lt,m:1,k:128,expand:"xmd",hash:ur}),to=eo,Vd=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Kd=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),zd=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Gd=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),Cc=r=>so(Xe,r),Yd=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),ro=r=>Me.Point.Fp.create(Ie(r)&Yd);Ve=class r extends w0{constructor(e){super(e)}static fromAffine(e){return new r(Me.Point.fromAffine(e))}assertSame(e){if(!(e instanceof r))throw new Error("RistrettoPoint expected")}init(e){return new r(e)}static hashToCurve(e){return Sc(ye("ristrettoHash",e,64))}static fromBytes(e){pe(e,32);let{a:t,d:n}=Ur,s=lt,o=E=>N.create(E),i=ro(e);if(!Ya(N.toBytes(i),e)||dt(i,s))throw new Error("invalid ristretto255 encoding 1");let a=o(i*i),c=o(Xe+t*a),l=o(Xe-t*a),f=o(c*c),u=o(l*l),d=o(t*n*f-u),{isValid:p,value:m}=Cc(o(d*u)),g=o(m*l),v=o(m*g*d),x=o((i+i)*g);dt(x,s)&&(x=o(-x));let y=o(c*v),B=o(x*y);if(!p||dt(B,s)||y===Hd)throw new Error("invalid ristretto255 encoding 2");return new r(new Me.Point(x,y,Xe,B))}static fromHex(e){return r.fromBytes(ye("ristrettoHex",e,32))}static msm(e,t){return A0(r,Me.Point.Fn,e,t)}toBytes(){let{X:e,Y:t,Z:n,T:s}=this.ep,o=lt,i=v=>N.create(v),a=i(i(n+t)*i(n-t)),c=i(e*t),l=i(c*c),{value:f}=Cc(i(a*l)),u=i(f*a),d=i(f*c),p=i(u*d*s),m;if(dt(s*p,o)){let v=i(t*to),x=i(e*to);e=v,t=x,m=i(u*Kd)}else m=d;dt(e*p,o)&&(t=i(-t));let g=i((n-t)*m);return dt(g,o)&&(g=i(-g)),N.toBytes(g)}equals(e){this.assertSame(e);let{X:t,Y:n}=this.ep,{X:s,Y:o}=e.ep,i=l=>N.create(l),a=i(t*o)===i(n*s),c=i(n*o)===i(t*s);return a||c}is0(){return this.equals(r.ZERO)}};Ve.BASE=new Ve(Me.Point.BASE);Ve.ZERO=new Ve(Me.Point.ZERO);Ve.Fp=N;Ve.Fn=_c;Wd={Point:Ve},ao={hashToCurve(r,e){let t=e?.DST||"ristretto255_XMD:SHA-512_R255MAP_RO_",n=_0(r,t,64,ur);return Sc(n)},hashToScalar(r,e={DST:Js}){let t=_0(r,e.DST,64,ur);return _c.create(Ie(t))}},jd=["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"];$d=Tc;Xd=Ve,Qd=io.hashToCurve,Jd=io.encodeToCurve,eu=ao.hashToCurve,tu=ao.hashToCurve});var kc=G((P0,Hc)=>{(function(r,e,t){typeof P0=="object"?Hc.exports=P0=e(X(),Zt(),br()):typeof define=="function"&&define.amd?define(["./core","./sha256","./hmac"],e):e(r.CryptoJS)})(P0,function(r){return r.HmacSHA256})});var Ic=G((H0,Lc)=>{(function(r,e){typeof H0=="object"?Lc.exports=H0=e(X()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(H0,function(r){return r.enc.Hex})});var Kr=nn(Da(),1);var Rs=class{constructor(){this.buffer=[]}toBytes(){return new Uint8Array(this.buffer)}writeBytes(e){this.buffer=[...this.buffer,...e]}writeByte(e){this.writeBytes([e])}writeUInt16LE(e){let t=new Uint8Array(2);new DataView(t.buffer).setUint16(0,e,!0),this.writeBytes(t)}writeUInt32LE(e){let t=new Uint8Array(4);new DataView(t.buffer).setUint32(0,e,!0),this.writeBytes(t)}writeInt32LE(e){let t=new Uint8Array(4);new DataView(t.buffer).setInt32(0,e,!0),this.writeBytes(t)}writeString(e){this.writeBytes(new TextEncoder().encode(e))}writeCString(e,t){let n=new Uint8Array(new ArrayBuffer(t)),s=new TextEncoder().encode(e);for(var o=0;o<t&&o<s.length;o++)n[o]=s[o];n[n.length-1]=0,this.writeBytes(n)}},Z=Rs;var Ss=class{constructor(e){this.pointer=0,this.buffer=new Uint8Array(e)}getRemainingBytesCount(){return this.buffer.length-this.pointer}readByte(){return this.readBytes(1)[0]}readBytes(e){let t=this.buffer.slice(this.pointer,this.pointer+e);return this.pointer+=e,t}readRemainingBytes(){return this.readBytes(this.getRemainingBytesCount())}readString(){return new TextDecoder().decode(this.readRemainingBytes())}readCString(e){let t=[],n=this.readBytes(e);for(let s of n){if(s===0)return new TextDecoder().decode(new Uint8Array(t));t.push(s)}}readInt8(){let e=this.readBytes(1);return new DataView(e.buffer).getInt8(0)}readUInt8(){let e=this.readBytes(1);return new DataView(e.buffer).getUint8(0)}readUInt16LE(){let e=this.readBytes(2);return new DataView(e.buffer).getUint16(0,!0)}readUInt16BE(){let e=this.readBytes(2);return new DataView(e.buffer).getUint16(0,!1)}readUInt32LE(){let e=this.readBytes(4);return new DataView(e.buffer).getUint32(0,!0)}readUInt32BE(){let e=this.readBytes(4);return new DataView(e.buffer).getUint32(0,!1)}readInt16LE(){let e=this.readBytes(2);return new DataView(e.buffer).getInt16(0,!0)}readInt16BE(){let e=this.readBytes(2);return new DataView(e.buffer).getInt16(0,!1)}readInt32LE(){let e=this.readBytes(4);return new DataView(e.buffer).getInt32(0,!0)}readInt24BE(){var e=this.readByte()<<16|this.readByte()<<8|this.readByte();return e&8388608&&(e-=16777216),e}},le=Ss;var Se=class{};W(Se,"SupportedCompanionProtocolVersion",1),W(Se,"SerialFrameTypes",{Incoming:62,Outgoing:60}),W(Se,"Ble",{ServiceUuid:"6E400001-B5A3-F393-E0A9-E50E24DCCA9E",CharacteristicUuidRx:"6E400002-B5A3-F393-E0A9-E50E24DCCA9E",CharacteristicUuidTx:"6E400003-B5A3-F393-E0A9-E50E24DCCA9E"}),W(Se,"CommandCodes",{AppStart:1,SendTxtMsg:2,SendChannelTxtMsg:3,GetContacts:4,GetDeviceTime:5,SetDeviceTime:6,SendSelfAdvert:7,SetAdvertName:8,AddUpdateContact:9,SyncNextMessage:10,SetRadioParams:11,SetTxPower:12,ResetPath:13,SetAdvertLatLon:14,RemoveContact:15,ShareContact:16,ExportContact:17,ImportContact:18,Reboot:19,GetBatteryVoltage:20,SetTuningParams:21,DeviceQuery:22,ExportPrivateKey:23,ImportPrivateKey:24,SendRawData:25,SendLogin:26,SendStatusReq:27,GetChannel:31,SetChannel:32,SignStart:33,SignData:34,SignFinish:35,SendTracePath:36,SetOtherParams:38,SendTelemetryReq:39,SendBinaryReq:50}),W(Se,"ResponseCodes",{Ok:0,Err:1,ContactsStart:2,Contact:3,EndOfContacts:4,SelfInfo:5,Sent:6,ContactMsgRecv:7,ChannelMsgRecv:8,CurrTime:9,NoMoreMessages:10,ExportContact:11,BatteryVoltage:12,DeviceInfo:13,PrivateKey:14,Disabled:15,ChannelInfo:18,SignStart:19,Signature:20}),W(Se,"PushCodes",{Advert:128,PathUpdated:129,SendConfirmed:130,MsgWaiting:131,RawData:132,LoginSuccess:133,LoginFail:134,StatusResponse:135,LogRxData:136,TraceData:137,NewAdvert:138,TelemetryResponse:139,BinaryResponse:140}),W(Se,"ErrorCodes",{UnsupportedCmd:1,NotFound:2,TableFull:3,BadState:4,FileIoError:5,IllegalArg:6}),W(Se,"AdvType",{None:0,Chat:1,Repeater:2,Room:3}),W(Se,"SelfAdvertTypes",{ZeroHop:0,Flood:1}),W(Se,"TxtTypes",{Plain:0,CliData:1,SignedPlain:2}),W(Se,"BinaryRequestTypes",{GetTelemetryData:3,GetAvgMinMax:4,GetAccessList:5,GetNeighbours:6});var h=Se;var Ts=class{constructor(){this.eventListenersMap=new Map}on(e,t){this.eventListenersMap.has(e)||this.eventListenersMap.set(e,[]),this.eventListenersMap.get(e).push(t)}off(e,t){if(this.eventListenersMap.has(e)){let n=this.eventListenersMap.get(e).filter(s=>s!==t);this.eventListenersMap.set(e,n)}}once(e,t){let n=(...s)=>{this.off(e,n),setTimeout(()=>t(...s),0)};this.on(e,n)}emit(e,...t){if(this.eventListenersMap.has(e))for(let n of this.eventListenersMap.get(e))setTimeout(()=>n(...t),0)}},_a=Ts;var Fs=class{static bytesToHex(e){return Array.from(e).map(t=>t.toString(16).padStart(2,"0")).join("")}static hexToBytes(e){return Uint8Array.from(e.match(/.{1,2}/g).map(t=>parseInt(t,16)))}static base64ToBytes(e){return Uint8Array.from(atob(e),t=>t.charCodeAt(0))}static areBuffersEqual(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}},At=Fs;var ve=class ve{constructor(e,t,n,s){this.publicKey=e,this.timestamp=t,this.signature=n,this.appData=s,this.parsed=this.parseAppData()}static fromBytes(e){let t=new le(e),n=t.readBytes(32),s=t.readUInt32LE(),o=t.readBytes(64),i=t.readRemainingBytes();return new ve(n,s,o,i)}getFlags(){return this.appData[0]}getType(){return this.getFlags()&15}getTypeString(){let e=this.getType();return e===ve.ADV_TYPE_NONE?"NONE":e===ve.ADV_TYPE_CHAT?"CHAT":e===ve.ADV_TYPE_REPEATER?"REPEATER":e===ve.ADV_TYPE_ROOM?"ROOM":null}async isVerified(){let{ed25519:e}=await Promise.resolve().then(()=>(Pc(),Fc)),t=new Z;return t.writeBytes(this.publicKey),t.writeUInt32LE(this.timestamp),t.writeBytes(this.appData),e.verify(this.signature,t.toBytes(),this.publicKey)}parseAppData(){let e=new le(this.appData),t=e.readByte();var n=null,s=null;t&ve.ADV_LATLON_MASK&&(n=e.readInt32LE(),s=e.readInt32LE());var o=null;return t&ve.ADV_NAME_MASK&&(o=e.readString()),{type:this.getTypeString(),lat:n,lon:s,name:o}}};W(ve,"ADV_TYPE_NONE",0),W(ve,"ADV_TYPE_CHAT",1),W(ve,"ADV_TYPE_REPEATER",2),W(ve,"ADV_TYPE_ROOM",3),W(ve,"ADV_LATLON_MASK",16),W(ve,"ADV_BATTERY_MASK",32),W(ve,"ADV_TEMPERATURE_MASK",64),W(ve,"ADV_NAME_MASK",128);var co=ve,fo=co;var j=class j{constructor(e,t,n){this.header=e,this.path=t,this.payload=n,this.route_type=this.getRouteType(),this.route_type_string=this.getRouteTypeString(),this.payload_type=this.getPayloadType(),this.payload_type_string=this.getPayloadTypeString(),this.payload_version=this.getPayloadVer(),this.is_marked_do_not_retransmit=this.isMarkedDoNotRetransmit()}static fromBytes(e){let t=new le(e),n=t.readByte(),s=t.readInt8(),o=t.readBytes(s),i=t.readRemainingBytes();return new j(n,o,i)}getRouteType(){return this.header&j.PH_ROUTE_MASK}getRouteTypeString(){switch(this.getRouteType()){case j.ROUTE_TYPE_FLOOD:return"FLOOD";case j.ROUTE_TYPE_DIRECT:return"DIRECT";default:return null}}isRouteFlood(){return this.getRouteType()===j.ROUTE_TYPE_FLOOD}isRouteDirect(){return this.getRouteType()===j.ROUTE_TYPE_DIRECT}getPayloadType(){return this.header>>j.PH_TYPE_SHIFT&j.PH_TYPE_MASK}getPayloadTypeString(){switch(this.getPayloadType()){case j.PAYLOAD_TYPE_REQ:return"REQ";case j.PAYLOAD_TYPE_RESPONSE:return"RESPONSE";case j.PAYLOAD_TYPE_TXT_MSG:return"TXT_MSG";case j.PAYLOAD_TYPE_ACK:return"ACK";case j.PAYLOAD_TYPE_ADVERT:return"ADVERT";case j.PAYLOAD_TYPE_GRP_TXT:return"GRP_TXT";case j.PAYLOAD_TYPE_GRP_DATA:return"GRP_DATA";case j.PAYLOAD_TYPE_ANON_REQ:return"ANON_REQ";case j.PAYLOAD_TYPE_PATH:return"PATH";case j.PAYLOAD_TYPE_TRACE:return"TRACE";case j.PAYLOAD_TYPE_RAW_CUSTOM:return"RAW_CUSTOM";default:return null}}getPayloadVer(){return this.header>>j.PH_VER_SHIFT&j.PH_VER_MASK}markDoNotRetransmit(){this.header=255}isMarkedDoNotRetransmit(){return this.header===255}parsePayload(){switch(this.getPayloadType()){case j.PAYLOAD_TYPE_PATH:return this.parsePayloadTypePath();case j.PAYLOAD_TYPE_REQ:return this.parsePayloadTypeReq();case j.PAYLOAD_TYPE_RESPONSE:return this.parsePayloadTypeResponse();case j.PAYLOAD_TYPE_TXT_MSG:return this.parsePayloadTypeTxtMsg();case j.PAYLOAD_TYPE_ACK:return this.parsePayloadTypeAck();case j.PAYLOAD_TYPE_ADVERT:return this.parsePayloadTypeAdvert();case j.PAYLOAD_TYPE_ANON_REQ:return this.parsePayloadTypeAnonReq();default:return null}}parsePayloadTypePath(){let e=new le(this.payload),t=e.readByte();return{src:e.readByte(),dest:t}}parsePayloadTypeReq(){let e=new le(this.payload),t=e.readByte(),n=e.readByte(),s=e.readRemainingBytes();return{src:n,dest:t,encrypted:s}}parsePayloadTypeResponse(){let e=new le(this.payload),t=e.readByte();return{src:e.readByte(),dest:t}}parsePayloadTypeTxtMsg(){let e=new le(this.payload),t=e.readByte();return{src:e.readByte(),dest:t}}parsePayloadTypeAck(){return{ack_code:this.payload}}parsePayloadTypeAdvert(){let e=fo.fromBytes(this.payload);return{public_key:e.publicKey,timestamp:e.timestamp,app_data:e.parseAppData()}}parsePayloadTypeAnonReq(){let e=new le(this.payload),t=e.readByte();return{src:e.readBytes(32),dest:t}}};W(j,"PH_ROUTE_MASK",3),W(j,"PH_TYPE_SHIFT",2),W(j,"PH_TYPE_MASK",15),W(j,"PH_VER_SHIFT",6),W(j,"PH_VER_MASK",3),W(j,"ROUTE_TYPE_RESERVED1",0),W(j,"ROUTE_TYPE_FLOOD",1),W(j,"ROUTE_TYPE_DIRECT",2),W(j,"ROUTE_TYPE_RESERVED2",3),W(j,"PAYLOAD_TYPE_REQ",0),W(j,"PAYLOAD_TYPE_RESPONSE",1),W(j,"PAYLOAD_TYPE_TXT_MSG",2),W(j,"PAYLOAD_TYPE_ACK",3),W(j,"PAYLOAD_TYPE_ADVERT",4),W(j,"PAYLOAD_TYPE_GRP_TXT",5),W(j,"PAYLOAD_TYPE_GRP_DATA",6),W(j,"PAYLOAD_TYPE_ANON_REQ",7),W(j,"PAYLOAD_TYPE_PATH",8),W(j,"PAYLOAD_TYPE_TRACE",9),W(j,"PAYLOAD_TYPE_RAW_CUSTOM",15);var uo=j,T0=uo;var lo=class{static getRandomInt(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}},xo=lo;var ho=class extends _a{async onConnected(){try{await this.deviceQuery(h.SupportedCompanionProtocolVersion)}catch{}this.emit("connected")}onDisconnected(){this.emit("disconnected")}async close(){throw new Error("This method must be implemented by the subclass.")}async sendToRadioFrame(e){throw new Error("This method must be implemented by the subclass.")}async sendCommandAppStart(){let e=new Z;e.writeByte(h.CommandCodes.AppStart),e.writeByte(1),e.writeBytes(new Uint8Array(6)),e.writeString("test"),await this.sendToRadioFrame(e.toBytes())}async sendCommandSendTxtMsg(e,t,n,s,o){let i=new Z;i.writeByte(h.CommandCodes.SendTxtMsg),i.writeByte(e),i.writeByte(t),i.writeUInt32LE(n),i.writeBytes(s.slice(0,6)),i.writeString(o),await this.sendToRadioFrame(i.toBytes())}async sendCommandSendChannelTxtMsg(e,t,n,s){let o=new Z;o.writeByte(h.CommandCodes.SendChannelTxtMsg),o.writeByte(e),o.writeByte(t),o.writeUInt32LE(n),o.writeString(s),await this.sendToRadioFrame(o.toBytes())}async sendCommandGetContacts(e){let t=new Z;t.writeByte(h.CommandCodes.GetContacts),e&&t.writeUInt32LE(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandGetDeviceTime(){let e=new Z;e.writeByte(h.CommandCodes.GetDeviceTime),await this.sendToRadioFrame(e.toBytes())}async sendCommandSetDeviceTime(e){let t=new Z;t.writeByte(h.CommandCodes.SetDeviceTime),t.writeUInt32LE(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandSendSelfAdvert(e){let t=new Z;t.writeByte(h.CommandCodes.SendSelfAdvert),t.writeByte(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandSetAdvertName(e){let t=new Z;t.writeByte(h.CommandCodes.SetAdvertName),t.writeString(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandAddUpdateContact(e,t,n,s,o,i,a,c,l){let f=new Z;f.writeByte(h.CommandCodes.AddUpdateContact),f.writeBytes(e),f.writeByte(t),f.writeByte(n),f.writeByte(s),f.writeBytes(o),f.writeCString(i,32),f.writeUInt32LE(a),f.writeUInt32LE(c),f.writeUInt32LE(l),await this.sendToRadioFrame(f.toBytes())}async sendCommandSyncNextMessage(){let e=new Z;e.writeByte(h.CommandCodes.SyncNextMessage),await this.sendToRadioFrame(e.toBytes())}async sendCommandSetRadioParams(e,t,n,s){let o=new Z;o.writeByte(h.CommandCodes.SetRadioParams),o.writeUInt32LE(e),o.writeUInt32LE(t),o.writeByte(n),o.writeByte(s),await this.sendToRadioFrame(o.toBytes())}async sendCommandSetTxPower(e){let t=new Z;t.writeByte(h.CommandCodes.SetTxPower),t.writeByte(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandResetPath(e){let t=new Z;t.writeByte(h.CommandCodes.ResetPath),t.writeBytes(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandSetAdvertLatLon(e,t){let n=new Z;n.writeByte(h.CommandCodes.SetAdvertLatLon),n.writeInt32LE(e),n.writeInt32LE(t),await this.sendToRadioFrame(n.toBytes())}async sendCommandRemoveContact(e){let t=new Z;t.writeByte(h.CommandCodes.RemoveContact),t.writeBytes(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandShareContact(e){let t=new Z;t.writeByte(h.CommandCodes.ShareContact),t.writeBytes(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandExportContact(e=null){let t=new Z;t.writeByte(h.CommandCodes.ExportContact),e&&t.writeBytes(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandImportContact(e){let t=new Z;t.writeByte(h.CommandCodes.ImportContact),t.writeBytes(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandReboot(){let e=new Z;e.writeByte(h.CommandCodes.Reboot),e.writeString("reboot"),await this.sendToRadioFrame(e.toBytes())}async sendCommandGetBatteryVoltage(){let e=new Z;e.writeByte(h.CommandCodes.GetBatteryVoltage),await this.sendToRadioFrame(e.toBytes())}async sendCommandDeviceQuery(e){let t=new Z;t.writeByte(h.CommandCodes.DeviceQuery),t.writeByte(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandExportPrivateKey(){let e=new Z;e.writeByte(h.CommandCodes.ExportPrivateKey),await this.sendToRadioFrame(e.toBytes())}async sendCommandImportPrivateKey(e){let t=new Z;t.writeByte(h.CommandCodes.ImportPrivateKey),t.writeBytes(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandSendRawData(e,t){let n=new Z;n.writeByte(h.CommandCodes.SendRawData),n.writeByte(e.length),n.writeBytes(e),n.writeBytes(t),await this.sendToRadioFrame(n.toBytes())}async sendCommandSendLogin(e,t){let n=new Z;n.writeByte(h.CommandCodes.SendLogin),n.writeBytes(e),n.writeString(t),await this.sendToRadioFrame(n.toBytes())}async sendCommandSendStatusReq(e){let t=new Z;t.writeByte(h.CommandCodes.SendStatusReq),t.writeBytes(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandSendTelemetryReq(e){let t=new Z;t.writeByte(h.CommandCodes.SendTelemetryReq),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeBytes(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandSendBinaryReq(e,t){let n=new Z;n.writeByte(h.CommandCodes.SendBinaryReq),n.writeBytes(e),n.writeBytes(t),await this.sendToRadioFrame(n.toBytes())}async sendCommandGetChannel(e){let t=new Z;t.writeByte(h.CommandCodes.GetChannel),t.writeByte(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandSetChannel(e,t,n){let s=new Z;s.writeByte(h.CommandCodes.SetChannel),s.writeByte(e),s.writeCString(t,32),s.writeBytes(n),await this.sendToRadioFrame(s.toBytes())}async sendCommandSignStart(){let e=new Z;e.writeByte(h.CommandCodes.SignStart),await this.sendToRadioFrame(e.toBytes())}async sendCommandSignData(e){let t=new Z;t.writeByte(h.CommandCodes.SignData),t.writeBytes(e),await this.sendToRadioFrame(t.toBytes())}async sendCommandSignFinish(){let e=new Z;e.writeByte(h.CommandCodes.SignFinish),await this.sendToRadioFrame(e.toBytes())}async sendCommandSendTracePath(e,t,n){let s=new Z;s.writeByte(h.CommandCodes.SendTracePath),s.writeUInt32LE(e),s.writeUInt32LE(t),s.writeByte(0),s.writeBytes(n),await this.sendToRadioFrame(s.toBytes())}async sendCommandSetOtherParams(e){let t=new Z;t.writeByte(h.CommandCodes.SetOtherParams),t.writeByte(e),await this.sendToRadioFrame(t.toBytes())}onFrameReceived(e){this.emit("rx",e);let t=new le(e),n=t.readByte();n===h.ResponseCodes.Ok?this.onOkResponse(t):n===h.ResponseCodes.Err?this.onErrResponse(t):n===h.ResponseCodes.SelfInfo?this.onSelfInfoResponse(t):n===h.ResponseCodes.CurrTime?this.onCurrTimeResponse(t):n===h.ResponseCodes.NoMoreMessages?this.onNoMoreMessagesResponse(t):n===h.ResponseCodes.ContactMsgRecv?this.onContactMsgRecvResponse(t):n===h.ResponseCodes.ChannelMsgRecv?this.onChannelMsgRecvResponse(t):n===h.ResponseCodes.ContactsStart?this.onContactsStartResponse(t):n===h.ResponseCodes.Contact?this.onContactResponse(t):n===h.ResponseCodes.EndOfContacts?this.onEndOfContactsResponse(t):n===h.ResponseCodes.Sent?this.onSentResponse(t):n===h.ResponseCodes.ExportContact?this.onExportContactResponse(t):n===h.ResponseCodes.BatteryVoltage?this.onBatteryVoltageResponse(t):n===h.ResponseCodes.DeviceInfo?this.onDeviceInfoResponse(t):n===h.ResponseCodes.PrivateKey?this.onPrivateKeyResponse(t):n===h.ResponseCodes.Disabled?this.onDisabledResponse(t):n===h.ResponseCodes.ChannelInfo?this.onChannelInfoResponse(t):n===h.ResponseCodes.SignStart?this.onSignStartResponse(t):n===h.ResponseCodes.Signature?this.onSignatureResponse(t):n===h.PushCodes.Advert?this.onAdvertPush(t):n===h.PushCodes.PathUpdated?this.onPathUpdatedPush(t):n===h.PushCodes.SendConfirmed?this.onSendConfirmedPush(t):n===h.PushCodes.MsgWaiting?this.onMsgWaitingPush(t):n===h.PushCodes.RawData?this.onRawDataPush(t):n===h.PushCodes.LoginSuccess?this.onLoginSuccessPush(t):n===h.PushCodes.StatusResponse?this.onStatusResponsePush(t):n===h.PushCodes.LogRxData?this.onLogRxDataPush(t):n===h.PushCodes.TelemetryResponse?this.onTelemetryResponsePush(t):n===h.PushCodes.TraceData?this.onTraceDataPush(t):n===h.PushCodes.NewAdvert?this.onNewAdvertPush(t):n===h.PushCodes.BinaryResponse?this.onBinaryResponsePush(t):console.log(`unhandled frame: code=${n}`,e)}onAdvertPush(e){this.emit(h.PushCodes.Advert,{publicKey:e.readBytes(32)})}onPathUpdatedPush(e){this.emit(h.PushCodes.PathUpdated,{publicKey:e.readBytes(32)})}onSendConfirmedPush(e){this.emit(h.PushCodes.SendConfirmed,{ackCode:e.readUInt32LE(),roundTrip:e.readUInt32LE()})}onMsgWaitingPush(e){this.emit(h.PushCodes.MsgWaiting,{})}onRawDataPush(e){this.emit(h.PushCodes.RawData,{lastSnr:e.readInt8()/4,lastRssi:e.readInt8(),reserved:e.readByte(),payload:e.readRemainingBytes()})}onLoginSuccessPush(e){this.emit(h.PushCodes.LoginSuccess,{reserved:e.readByte(),pubKeyPrefix:e.readBytes(6)})}onStatusResponsePush(e){this.emit(h.PushCodes.StatusResponse,{reserved:e.readByte(),pubKeyPrefix:e.readBytes(6),statusData:e.readRemainingBytes()})}onLogRxDataPush(e){this.emit(h.PushCodes.LogRxData,{lastSnr:e.readInt8()/4,lastRssi:e.readInt8(),raw:e.readRemainingBytes()})}onTelemetryResponsePush(e){this.emit(h.PushCodes.TelemetryResponse,{reserved:e.readByte(),pubKeyPrefix:e.readBytes(6),lppSensorData:e.readRemainingBytes()})}onBinaryResponsePush(e){this.emit(h.PushCodes.BinaryResponse,{reserved:e.readByte(),tag:e.readUInt32LE(),responseData:e.readRemainingBytes()})}onTraceDataPush(e){let t=e.readByte(),n=e.readUInt8();this.emit(h.PushCodes.TraceData,{reserved:t,pathLen:n,flags:e.readUInt8(),tag:e.readUInt32LE(),authCode:e.readUInt32LE(),pathHashes:e.readBytes(n),pathSnrs:e.readBytes(n),lastSnr:e.readInt8()/4})}onNewAdvertPush(e){this.emit(h.PushCodes.NewAdvert,{publicKey:e.readBytes(32),type:e.readByte(),flags:e.readByte(),outPathLen:e.readInt8(),outPath:e.readBytes(64),advName:e.readCString(32),lastAdvert:e.readUInt32LE(),advLat:e.readUInt32LE(),advLon:e.readUInt32LE(),lastMod:e.readUInt32LE()})}onOkResponse(e){this.emit(h.ResponseCodes.Ok,{})}onErrResponse(e){let t=e.getRemainingBytesCount()>0?e.readByte():null;this.emit(h.ResponseCodes.Err,{errCode:t})}onContactsStartResponse(e){this.emit(h.ResponseCodes.ContactsStart,{count:e.readUInt32LE()})}onContactResponse(e){this.emit(h.ResponseCodes.Contact,{publicKey:e.readBytes(32),type:e.readByte(),flags:e.readByte(),outPathLen:e.readInt8(),outPath:e.readBytes(64),advName:e.readCString(32),lastAdvert:e.readUInt32LE(),advLat:e.readUInt32LE(),advLon:e.readUInt32LE(),lastMod:e.readUInt32LE()})}onEndOfContactsResponse(e){this.emit(h.ResponseCodes.EndOfContacts,{mostRecentLastmod:e.readUInt32LE()})}onSentResponse(e){this.emit(h.ResponseCodes.Sent,{result:e.readInt8(),expectedAckCrc:e.readUInt32LE(),estTimeout:e.readUInt32LE()})}onExportContactResponse(e){this.emit(h.ResponseCodes.ExportContact,{advertPacketBytes:e.readRemainingBytes()})}onBatteryVoltageResponse(e){this.emit(h.ResponseCodes.BatteryVoltage,{batteryMilliVolts:e.readUInt16LE()})}onDeviceInfoResponse(e){this.emit(h.ResponseCodes.DeviceInfo,{firmwareVer:e.readInt8(),reserved:e.readBytes(6),firmware_build_date:e.readCString(12),manufacturerModel:e.readString()})}onPrivateKeyResponse(e){this.emit(h.ResponseCodes.PrivateKey,{privateKey:e.readBytes(64)})}onDisabledResponse(e){this.emit(h.ResponseCodes.Disabled,{})}onChannelInfoResponse(e){let t=e.readUInt8(),n=e.readCString(32),s=e.getRemainingBytesCount();s===16?this.emit(h.ResponseCodes.ChannelInfo,{channelIdx:t,name:n,secret:e.readBytes(s)}):console.log(`ChannelInfo has unexpected key length: ${s}`)}onSignStartResponse(e){this.emit(h.ResponseCodes.SignStart,{reserved:e.readByte(),maxSignDataLen:e.readUInt32LE()})}onSignatureResponse(e){this.emit(h.ResponseCodes.Signature,{signature:e.readBytes(64)})}onSelfInfoResponse(e){this.emit(h.ResponseCodes.SelfInfo,{type:e.readByte(),txPower:e.readByte(),maxTxPower:e.readByte(),publicKey:e.readBytes(32),advLat:e.readInt32LE(),advLon:e.readInt32LE(),reserved:e.readBytes(3),manualAddContacts:e.readByte(),radioFreq:e.readUInt32LE(),radioBw:e.readUInt32LE(),radioSf:e.readByte(),radioCr:e.readByte(),name:e.readString()})}onCurrTimeResponse(e){this.emit(h.ResponseCodes.CurrTime,{epochSecs:e.readUInt32LE()})}onNoMoreMessagesResponse(e){this.emit(h.ResponseCodes.NoMoreMessages,{})}onContactMsgRecvResponse(e){this.emit(h.ResponseCodes.ContactMsgRecv,{pubKeyPrefix:e.readBytes(6),pathLen:e.readByte(),txtType:e.readByte(),senderTimestamp:e.readUInt32LE(),text:e.readString()})}onChannelMsgRecvResponse(e){this.emit(h.ResponseCodes.ChannelMsgRecv,{channelIdx:e.readInt8(),pathLen:e.readByte(),txtType:e.readByte(),senderTimestamp:e.readUInt32LE(),text:e.readString()})}getSelfInfo(e=null){return new Promise(async(t,n)=>{this.once(h.ResponseCodes.SelfInfo,s=>{t(s)}),e!=null&&setTimeout(n,e),await this.sendCommandAppStart()})}async sendAdvert(e){return new Promise(async(t,n)=>{try{let s=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),t()},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandSendSelfAdvert(e)}catch(s){n(s)}})}async sendFloodAdvert(){return await this.sendAdvert(h.SelfAdvertTypes.Flood)}async sendZeroHopAdvert(){return await this.sendAdvert(h.SelfAdvertTypes.ZeroHop)}setAdvertName(e){return new Promise(async(t,n)=>{try{let s=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),t()},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandSetAdvertName(e)}catch(s){n(s)}})}setAdvertLatLong(e,t){return new Promise(async(n,s)=>{try{let o=()=>{this.off(h.ResponseCodes.Ok,o),this.off(h.ResponseCodes.Err,i),n()},i=()=>{this.off(h.ResponseCodes.Ok,o),this.off(h.ResponseCodes.Err,i),s()};this.once(h.ResponseCodes.Ok,o),this.once(h.ResponseCodes.Err,i),await this.sendCommandSetAdvertLatLon(e,t)}catch(o){s(o)}})}setTxPower(e){return new Promise(async(t,n)=>{try{let s=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),t()},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandSetTxPower(e)}catch(s){n(s)}})}setRadioParams(e,t,n,s){return new Promise(async(o,i)=>{try{let a=()=>{this.off(h.ResponseCodes.Ok,a),this.off(h.ResponseCodes.Err,c),o()},c=()=>{this.off(h.ResponseCodes.Ok,a),this.off(h.ResponseCodes.Err,c),i()};this.once(h.ResponseCodes.Ok,a),this.once(h.ResponseCodes.Err,c),await this.sendCommandSetRadioParams(e,t,n,s)}catch(a){i(a)}})}getContacts(){return new Promise(async(e,t)=>{let n=[],s=o=>{n.push(o)};this.on(h.ResponseCodes.Contact,s),this.once(h.ResponseCodes.EndOfContacts,()=>{this.off(h.ResponseCodes.Contact,s),e(n)}),await this.sendCommandGetContacts()})}async findContactByName(e){return(await this.getContacts()).find(n=>n.advName===e)}async findContactByPublicKeyPrefix(e){return(await this.getContacts()).find(n=>{let s=n.publicKey.subarray(0,e.length);return At.areBuffersEqual(e,s)})}sendTextMessage(e,t,n){return new Promise(async(s,o)=>{try{let i=u=>{this.off(h.ResponseCodes.Sent,i),this.off(h.ResponseCodes.Err,a),s(u)},a=()=>{this.off(h.ResponseCodes.Sent,i),this.off(h.ResponseCodes.Err,a),o()};this.once(h.ResponseCodes.Sent,i),this.once(h.ResponseCodes.Err,a);let c=n??h.TxtTypes.Plain,l=0,f=Math.floor(Date.now()/1e3);await this.sendCommandSendTxtMsg(c,l,f,e,t)}catch(i){o(i)}})}sendChannelTextMessage(e,t){return new Promise(async(n,s)=>{try{let o=()=>{this.off(h.ResponseCodes.Ok,o),this.off(h.ResponseCodes.Err,i),n()},i=()=>{this.off(h.ResponseCodes.Ok,o),this.off(h.ResponseCodes.Err,i),s()};this.once(h.ResponseCodes.Ok,o),this.once(h.ResponseCodes.Err,i);let a=h.TxtTypes.Plain,c=Math.floor(Date.now()/1e3);await this.sendCommandSendChannelTxtMsg(a,e,c,t)}catch(o){s(o)}})}syncNextMessage(){return new Promise(async(e,t)=>{let n=i=>{this.off(h.ResponseCodes.ContactMsgRecv,n),this.off(h.ResponseCodes.ChannelMsgRecv,s),this.off(h.ResponseCodes.NoMoreMessages,o),e({contactMessage:i})},s=i=>{this.off(h.ResponseCodes.ContactMsgRecv,n),this.off(h.ResponseCodes.ChannelMsgRecv,s),this.off(h.ResponseCodes.NoMoreMessages,o),e({channelMessage:i})},o=()=>{this.off(h.ResponseCodes.ContactMsgRecv,n),this.off(h.ResponseCodes.ChannelMsgRecv,s),this.off(h.ResponseCodes.NoMoreMessages,o),e(null)};this.once(h.ResponseCodes.ContactMsgRecv,n),this.once(h.ResponseCodes.ChannelMsgRecv,s),this.once(h.ResponseCodes.NoMoreMessages,o),await this.sendCommandSyncNextMessage()})}async getWaitingMessages(){let e=[];for(;;){let t=await this.syncNextMessage();if(!t)break;e.push(t)}return e}getDeviceTime(){return new Promise(async(e,t)=>{try{let n=o=>{this.off(h.ResponseCodes.CurrTime,n),this.off(h.ResponseCodes.Err,s),e(o)},s=()=>{this.off(h.ResponseCodes.CurrTime,n),this.off(h.ResponseCodes.Err,s),t()};this.once(h.ResponseCodes.CurrTime,n),this.once(h.ResponseCodes.Err,s),await this.sendCommandGetDeviceTime()}catch(n){t(n)}})}setDeviceTime(e){return new Promise(async(t,n)=>{try{let s=i=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),t(i)},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandSetDeviceTime(e)}catch(s){n(s)}})}async syncDeviceTime(){await this.setDeviceTime(Math.floor(Date.now()/1e3))}importContact(e){return new Promise(async(t,n)=>{try{let s=i=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),t(i)},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandImportContact(e)}catch(s){n(s)}})}exportContact(e=null){return new Promise(async(t,n)=>{try{let s=i=>{this.off(h.ResponseCodes.ExportContact,s),this.off(h.ResponseCodes.Err,o),t(i)},o=()=>{this.off(h.ResponseCodes.ExportContact,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.ExportContact,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandExportContact(e)}catch(s){n(s)}})}shareContact(e){return new Promise(async(t,n)=>{try{let s=i=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),t(i)},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandShareContact(e)}catch(s){n(s)}})}removeContact(e){return new Promise(async(t,n)=>{try{let s=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),t()},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandRemoveContact(e)}catch(s){n(s)}})}addOrUpdateContact(e,t,n,s,o,i,a,c,l){return new Promise(async(f,u)=>{try{let d=()=>{this.off(h.ResponseCodes.Ok,d),this.off(h.ResponseCodes.Err,p),f()},p=()=>{this.off(h.ResponseCodes.Ok,d),this.off(h.ResponseCodes.Err,p),u()};this.once(h.ResponseCodes.Ok,d),this.once(h.ResponseCodes.Err,p),await this.sendCommandAddUpdateContact(e,t,n,s,o,i,a,c,l)}catch(d){u(d)}})}setContactPath(e,t){return new Promise(async(n,s)=>{try{let a=new Uint8Array(64);for(var o=0;o<t.length&&o<64;o++)a[o]=t[o];return e.outPathLen=t.length,e.outPath=a,await this.addOrUpdateContact(e.publicKey,e.type,e.flags,e.outPathLen,e.outPath,e.advName,e.lastAdvert,e.advLat,e.advLon)}catch(i){s(i)}})}resetPath(e){return new Promise(async(t,n)=>{try{let s=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),t()},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandResetPath(e)}catch(s){n(s)}})}reboot(){return new Promise(async(e,t)=>{try{let n=()=>{this.off(h.ResponseCodes.Err,n),t()};setTimeout(()=>{this.off(h.ResponseCodes.Err,n),e()},1e3),this.once(h.ResponseCodes.Err,n),await this.sendCommandReboot()}catch(n){t(n)}})}getBatteryVoltage(){return new Promise(async(e,t)=>{try{let n=o=>{this.off(h.ResponseCodes.BatteryVoltage,n),this.off(h.ResponseCodes.Err,s),e(o)},s=()=>{this.off(h.ResponseCodes.BatteryVoltage,n),this.off(h.ResponseCodes.Err,s),t()};this.once(h.ResponseCodes.BatteryVoltage,n),this.once(h.ResponseCodes.Err,s),await this.sendCommandGetBatteryVoltage()}catch(n){t(n)}})}deviceQuery(e){return new Promise(async(t,n)=>{try{let s=i=>{this.off(h.ResponseCodes.DeviceInfo,s),this.off(h.ResponseCodes.Err,o),t(i)},o=()=>{this.off(h.ResponseCodes.DeviceInfo,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.DeviceInfo,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandDeviceQuery(e)}catch(s){n(s)}})}exportPrivateKey(){return new Promise(async(e,t)=>{try{let n=i=>{this.off(h.ResponseCodes.PrivateKey,n),this.off(h.ResponseCodes.Err,s),this.off(h.ResponseCodes.Disabled,o),e(i)},s=()=>{this.off(h.ResponseCodes.PrivateKey,n),this.off(h.ResponseCodes.Err,s),this.off(h.ResponseCodes.Disabled,o),t()},o=()=>{this.off(h.ResponseCodes.PrivateKey,n),this.off(h.ResponseCodes.Err,s),this.off(h.ResponseCodes.Disabled,o),t("disabled")};this.once(h.ResponseCodes.PrivateKey,n),this.once(h.ResponseCodes.Err,s),this.once(h.ResponseCodes.Disabled,o),await this.sendCommandExportPrivateKey()}catch(n){t(n)}})}importPrivateKey(e){return new Promise(async(t,n)=>{try{let s=a=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),this.off(h.ResponseCodes.Disabled,i),t(a)},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),this.off(h.ResponseCodes.Disabled,i),n()},i=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),this.off(h.ResponseCodes.Disabled,i),n("disabled")};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),this.once(h.ResponseCodes.Disabled,i),await this.sendCommandImportPrivateKey(e)}catch(s){n(s)}})}login(e,t,n=1e3){return new Promise(async(s,o)=>{try{let a=e.subarray(0,6);var i=null;let c=u=>{this.off(h.ResponseCodes.Err,f);let d=u.estTimeout+n;i=setTimeout(()=>{this.off(h.ResponseCodes.Err,f),this.off(h.ResponseCodes.Sent,c),this.off(h.PushCodes.LoginSuccess,l),o("timeout")},d)},l=u=>{if(!At.areBuffersEqual(a,u.pubKeyPrefix)){console.log("onLoginSuccess is not for this login request, ignoring...");return}clearTimeout(i),this.off(h.ResponseCodes.Err,f),this.off(h.ResponseCodes.Sent,c),this.off(h.PushCodes.LoginSuccess,l),s(u)},f=()=>{clearTimeout(i),this.off(h.ResponseCodes.Err,f),this.off(h.ResponseCodes.Sent,c),this.off(h.PushCodes.LoginSuccess,l),o()};this.once(h.ResponseCodes.Err,f),this.once(h.ResponseCodes.Sent,c),this.once(h.PushCodes.LoginSuccess,l),await this.sendCommandSendLogin(e,t)}catch(a){o(a)}})}getStatus(e,t=1e3){return new Promise(async(n,s)=>{try{let i=e.subarray(0,6);var o=null;let a=f=>{this.off(h.ResponseCodes.Err,l);let u=f.estTimeout+t;o=setTimeout(()=>{this.off(h.ResponseCodes.Err,l),this.off(h.ResponseCodes.Sent,a),this.off(h.PushCodes.StatusResponse,c),s("timeout")},u)},c=f=>{if(!At.areBuffersEqual(i,f.pubKeyPrefix)){console.log("onStatusResponsePush is not for this status request, ignoring...");return}clearTimeout(o),this.off(h.ResponseCodes.Err,l),this.off(h.ResponseCodes.Sent,a),this.off(h.PushCodes.StatusResponse,c);let u=new le(f.statusData),d={batt_milli_volts:u.readUInt16LE(),curr_tx_queue_len:u.readUInt16LE(),noise_floor:u.readInt16LE(),last_rssi:u.readInt16LE(),n_packets_recv:u.readUInt32LE(),n_packets_sent:u.readUInt32LE(),total_air_time_secs:u.readUInt32LE(),total_up_time_secs:u.readUInt32LE(),n_sent_flood:u.readUInt32LE(),n_sent_direct:u.readUInt32LE(),n_recv_flood:u.readUInt32LE(),n_recv_direct:u.readUInt32LE(),err_events:u.readUInt16LE(),last_snr:u.readInt16LE(),n_direct_dups:u.readUInt16LE(),n_flood_dups:u.readUInt16LE()};n(d)},l=()=>{clearTimeout(o),this.off(h.ResponseCodes.Err,l),this.off(h.ResponseCodes.Sent,a),this.off(h.PushCodes.StatusResponse,c),s()};this.once(h.ResponseCodes.Err,l),this.once(h.ResponseCodes.Sent,a),this.once(h.PushCodes.StatusResponse,c),await this.sendCommandSendStatusReq(e)}catch(i){s(i)}})}getTelemetry(e,t=1e3){return new Promise(async(n,s)=>{try{let i=e.subarray(0,6);var o=null;let a=f=>{this.off(h.ResponseCodes.Err,l);let u=f.estTimeout+t;o=setTimeout(()=>{this.off(h.ResponseCodes.Err,l),this.off(h.ResponseCodes.Sent,a),this.off(h.PushCodes.TelemetryResponse,c),s("timeout")},u)},c=f=>{if(!At.areBuffersEqual(i,f.pubKeyPrefix)){console.log("onTelemetryResponsePush is not for this telemetry request, ignoring...");return}clearTimeout(o),this.off(h.ResponseCodes.Err,l),this.off(h.ResponseCodes.Sent,a),this.off(h.PushCodes.TelemetryResponse,c),n(f)},l=()=>{clearTimeout(o),this.off(h.ResponseCodes.Err,l),this.off(h.ResponseCodes.Sent,a),this.off(h.PushCodes.TelemetryResponse,c),s()};this.once(h.ResponseCodes.Err,l),this.once(h.ResponseCodes.Sent,a),this.once(h.PushCodes.TelemetryResponse,c),await this.sendCommandSendTelemetryReq(e)}catch(i){s(i)}})}sendBinaryRequest(e,t,n=1e3){return new Promise(async(s,o)=>{try{var i=null,a=null;let c=u=>{i=u.expectedAckCrc,this.off(h.ResponseCodes.Err,f);let d=u.estTimeout+n;a=setTimeout(()=>{this.off(h.ResponseCodes.Err,f),this.off(h.ResponseCodes.Sent,c),this.off(h.PushCodes.BinaryResponse,l),o("timeout")},d)},l=u=>{if(i!==u.tag){console.log("onBinaryResponse is not for this request tag, ignoring...");return}clearTimeout(a),this.off(h.ResponseCodes.Err,f),this.off(h.ResponseCodes.Sent,c),this.off(h.PushCodes.BinaryResponse,l),s(u.responseData)},f=()=>{clearTimeout(a),this.off(h.ResponseCodes.Err,f),this.off(h.ResponseCodes.Sent,c),this.off(h.PushCodes.BinaryResponse,l),o()};this.once(h.ResponseCodes.Err,f),this.once(h.ResponseCodes.Sent,c),this.once(h.PushCodes.BinaryResponse,l),await this.sendCommandSendBinaryReq(e,t)}catch(c){o(c)}})}pingRepeaterZeroHop(e,t){return new Promise(async(n,s)=>{try{let i=new Z;i.writeUInt32LE(Date.now()),i.writeBytes([112,105,110,103]),i.writeBytes(e.subarray(0,2));let a=i.toBytes();var o=Date.now();let c=f=>{let d=Date.now()-o,p=T0.fromBytes(f.raw);p.payload_type===T0.PAYLOAD_TYPE_RAW_CUSTOM&&At.areBuffersEqual(p.payload,a)&&(this.off(h.ResponseCodes.Err,l),this.off(h.PushCodes.LogRxData,c),n({rtt:d,snr:f.lastSnr,rssi:f.lastRssi}))},l=()=>{this.off(h.ResponseCodes.Err,l),this.off(h.PushCodes.LogRxData,c),s()};this.once(h.ResponseCodes.Err,l),this.on(h.PushCodes.LogRxData,c),t!=null&&setTimeout(()=>{this.off(h.ResponseCodes.Err,l),this.off(h.PushCodes.LogRxData,c),s("timeout")},t),await this.sendCommandSendRawData([e.subarray(0,1)],a)}catch(i){s(i)}})}getChannel(e){return new Promise(async(t,n)=>{try{let s=i=>{this.off(h.ResponseCodes.ChannelInfo,s),this.off(h.ResponseCodes.Err,o),t(i)},o=()=>{this.off(h.ResponseCodes.ChannelInfo,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.ChannelInfo,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandGetChannel(e)}catch(s){n(s)}})}setChannel(e,t,n){return new Promise(async(s,o)=>{try{let i=()=>{this.off(h.ResponseCodes.Ok,i),this.off(h.ResponseCodes.Err,a),s()},a=()=>{this.off(h.ResponseCodes.Ok,i),this.off(h.ResponseCodes.Err,a),o()};this.once(h.ResponseCodes.Ok,i),this.once(h.ResponseCodes.Err,a),await this.sendCommandSetChannel(e,t,n)}catch(i){o(i)}})}async deleteChannel(e){return await this.setChannel(e,"",new Uint8Array(16))}getChannels(){return new Promise(async(e,t)=>{var n=0;let s=[];for(;;){try{let o=await this.getChannel(n);s.push(o)}catch{break}n++}return e(s)})}async findChannelByName(e){return(await this.getChannels()).find(n=>n.name===e)}async findChannelBySecret(e){return(await this.getChannels()).find(n=>At.areBuffersEqual(e,n.secret))}async sign(e){return new Promise(async(t,n)=>{try{let o=new le(e),i=async()=>{var u;o.getRemainingBytesCount()>=128?u=o.readBytes(128):u=o.readRemainingBytes(),await this.sendCommandSignData(u)},a=async u=>{if(o.getRemainingBytesCount()>0){await i();return}await this.sendCommandSignFinish()},c=async u=>{if(this.off(h.ResponseCodes.SignStart,c),o.getRemainingBytesCount()>u.maxSignDataLen){this.off(h.ResponseCodes.ok,a),this.off(h.ResponseCodes.err,f),this.off(h.ResponseCodes.SignStart,c),this.off(h.ResponseCodes.Signature,l),n("data_too_long");return}await i()},l=u=>{this.off(h.ResponseCodes.ok,a),this.off(h.ResponseCodes.err,f),this.off(h.ResponseCodes.SignStart,c),this.off(h.ResponseCodes.Signature,l),t(u.signature)},f=u=>{this.off(h.ResponseCodes.ok,a),this.off(h.ResponseCodes.err,f),this.off(h.ResponseCodes.SignStart,c),this.off(h.ResponseCodes.Signature,l),n(u)};this.on(h.ResponseCodes.Ok,a),this.on(h.ResponseCodes.SignStart,c),this.on(h.ResponseCodes.Signature,l),this.once(h.ResponseCodes.Err,f),await this.sendCommandSignStart()}catch(s){n(s)}})}tracePath(e,t=0){return new Promise(async(n,s)=>{try{let i=xo.getRandomInt(0,4294967295);var o=null;let a=f=>{this.off(h.ResponseCodes.Err,l);let u=f.estTimeout+t;o=setTimeout(()=>{this.off(h.ResponseCodes.Sent,a),this.off(h.PushCodes.TraceData,c),this.off(h.ResponseCodes.Err,l),s("timeout")},u)},c=f=>{if(f.tag!==i){console.log("ignoring trace data for a different trace request");return}clearTimeout(o),this.off(h.ResponseCodes.Sent,a),this.off(h.PushCodes.TraceData,c),this.off(h.ResponseCodes.Err,l),n(f)},l=()=>{clearTimeout(o),this.off(h.ResponseCodes.Sent,a),this.off(h.PushCodes.TraceData,c),this.off(h.ResponseCodes.Err,l),s()};this.once(h.ResponseCodes.Sent,a),this.on(h.PushCodes.TraceData,c),this.once(h.ResponseCodes.Err,l),await this.sendCommandSendTracePath(i,0,e)}catch(i){s(i)}})}setOtherParams(e){return new Promise(async(t,n)=>{try{let s=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),t()},o=()=>{this.off(h.ResponseCodes.Ok,s),this.off(h.ResponseCodes.Err,o),n()};this.once(h.ResponseCodes.Ok,s),this.once(h.ResponseCodes.Err,o),await this.sendCommandSetOtherParams(e)}catch(s){n(s)}})}async setAutoAddContacts(){return await this.setOtherParams(!1)}async setManualAddContacts(){return await this.setOtherParams(!0)}async getNeighbours(e,t=10,n=0,s=0,o=8){let i=new Z;i.writeByte(h.BinaryRequestTypes.GetNeighbours),i.writeByte(0),i.writeByte(t),i.writeUInt16LE(n),i.writeByte(s),i.writeByte(o),i.writeUInt32LE(xo.getRandomInt(0,4294967295));let a=await this.sendBinaryRequest(e,i.toBytes()),c=new le(a),l=c.readUInt16LE(),f=c.readUInt16LE(),u=[];for(var d=0;d<f;d++){let p=c.readBytes(o),m=c.readUInt32LE(),g=c.readInt8()/4;u.push({publicKeyPrefix:p,heardSecondsAgo:m,snr:g})}return{totalNeighboursCount:l,neighbours:u}}},Nr=ho;var po=class r extends Nr{constructor(){if(super(),this.readBuffer=[],this.constructor===r)throw new Error("SerialConnection is an abstract class and can't be instantiated.")}async write(e){throw new Error("Not Implemented: write must be implemented by SerialConnection sub class.")}async writeFrame(e,t){let n=new Z;n.writeByte(e),n.writeUInt16LE(t.length),n.writeBytes(t),await this.write(n.toBytes())}async sendToRadioFrame(e){this.emit("tx",e),await this.writeFrame(60,e)}async onDataReceived(e){this.readBuffer=[...this.readBuffer,...e];let t=3;for(;this.readBuffer.length>=t;)try{let n=new le(this.readBuffer.slice(0,t)),s=n.readByte();if(s!==h.SerialFrameTypes.Incoming&&s!==h.SerialFrameTypes.Outgoing){this.readBuffer=this.readBuffer.slice(1);continue}let o=n.readUInt16LE();if(!o){this.readBuffer=this.readBuffer.slice(1);continue}let i=t+o;if(this.readBuffer.length<i)break;let a=this.readBuffer.slice(t,i);this.readBuffer=this.readBuffer.slice(i),this.onFrameReceived(a)}catch(n){console.error("Failed to process frame",n);break}}},F0=po;var yo=class r extends F0{constructor(e){super(),this.serialPort=e,this.reader=e.readable.getReader(),this.writable=e.writable,this.readLoop(),this.serialPort.addEventListener("disconnect",()=>{this.onDisconnected()}),setTimeout(async()=>{await this.onConnected()},0)}static async open(){if(!navigator.serial)return alert("Web Serial is not supported in this browser"),null;let e=await navigator.serial.requestPort({filters:[]});return await e.open({baudRate:115200}),new r(e)}async close(){try{this.reader.releaseLock()}catch{}try{await this.serialPort.close()}catch{}}async write(e){let t=this.writable.getWriter();try{await t.write(new Uint8Array(e))}finally{t.releaseLock()}}async readLoop(){try{for(;;){let{value:e,done:t}=await this.reader.read();if(t)break;await this.onDataReceived(e)}}catch(e){if(e instanceof TypeError)return;console.error("Error reading from serial port: ",e)}finally{this.reader.releaseLock()}}},mo=yo;var ru=nn(Zt(),1),nu=nn(kc(),1),su=nn(Ic(),1),Oc="abcdefghijklmnopqrstuvwxyz0123456789",Px=Oc.length,Hx=Oc+"-";function go(r){return String(r).replace(/[&<>"']/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[e]||e)}function ou(r){return Array.from(r).map(e=>e.toString(16).padStart(2,"0")).join("")}var mr,Vr,Mr,vo,Uc,qc,Nc,k0,Le=null,L0=0;function yr(r){switch(Mr.className=`connection-status ${r}`,r){case"disconnected":Mr.textContent="Disconnected",mr.disabled=!1,Vr.disabled=!0;break;case"connecting":Mr.textContent="Connecting...",mr.disabled=!0,Vr.disabled=!0;break;case"connected":Mr.textContent="Connected",mr.disabled=!0,Vr.disabled=!1;break}}function Bo(){Uc.textContent=`${L0} packet${L0!==1?"s":""} received`}function iu(r){let e=r.toLowerCase();return e.includes("grouptext")?"pill-grouptext":e.includes("advert")?"pill-advert":"pill-payload"}function au(r,e){let t=k0.querySelector(".empty-state-row");t&&t.remove();let n="Unknown",s="Unknown";try{let u=Kr.MeshCorePacketDecoder.decode(r);n=Kr.Utils.getRouteTypeName(u.routeType),s=Kr.Utils.getPayloadTypeName(u.payloadType)}catch{}let o=document.createElement("tr"),i=document.createElement("td");i.className="timestamp-col",i.textContent=e.toLocaleTimeString("en-US",{hour12:!1}),o.appendChild(i);let a=document.createElement("td");a.innerHTML=`<span class="pill pill-route">${go(n)}</span><span class="pill ${iu(s)}">${go(s)}</span>`,o.appendChild(a);let c=document.createElement("td");c.className="packet-hex",c.textContent=r,c.title=r,o.appendChild(c);let l=document.createElement("td"),f=`./index.html?packet=${encodeURIComponent(r)}`;l.innerHTML=`<a href="${f}" target="_blank" class="analyze-link">Analyze</a>`,o.appendChild(l),k0.appendChild(o),L0++,Bo(),Nc.checked&&o.scrollIntoView({behavior:"smooth",block:"end"})}function cu(){k0.innerHTML='<tr class="empty-state-row"><td colspan="4" class="empty-state">No packets received yet. Connect to a radio to start receiving packets.</td></tr>',L0=0,Bo()}function fu(r){r.on(h.PushCodes.LogRxData,e=>{let t=ou(e.raw);au(t,new Date)}),r.on("disconnected",()=>{yr("disconnected"),Le=null})}async function du(){try{if(yr("connecting"),Le=await mo.open(),!Le){yr("disconnected");return}fu(Le),await new Promise((r,e)=>{let t=setTimeout(()=>e(new Error("Timeout")),1e4);Le.on("connected",async()=>{clearTimeout(t),yr("connected");try{let n=await Le.getSelfInfo();if(n){let s=(n.radioFreq/1e3).toFixed(3),o=(n.radioBw/1e3).toFixed(1),i=n.name||"Unknown";vo.textContent=`${i} | ${s} MHz | BW ${o} kHz | SF${n.radioSf} | CR${n.radioCr}`}}catch{}try{await Le.syncDeviceTime()}catch{}r()})})}catch(r){if(console.error("Connection error:",r),yr("disconnected"),Le){try{Le.close()}catch{}Le=null}}}function uu(){if(Le){try{Le.close()}catch{}Le=null}yr("disconnected"),vo.textContent=""}document.addEventListener("DOMContentLoaded",()=>{mr=document.getElementById("connect-btn"),Vr=document.getElementById("disconnect-btn"),Mr=document.getElementById("connection-status"),vo=document.getElementById("radio-info"),Uc=document.getElementById("packet-count"),qc=document.getElementById("clear-btn"),Nc=document.getElementById("auto-scroll"),k0=document.getElementById("packet-body");let r=document.getElementById("serial-not-supported");navigator.serial||(r.style.display="block",mr.disabled=!0),mr.addEventListener("click",du),Vr.addEventListener("click",uu),qc.addEventListener("click",cu),Bo()});})();
/*! Bundled license information:

crypto-js/ripemd160.js:
  (** @preserve
  	(c) 2012 by Cdric Mesnil. All rights reserved.
  
  	Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
  
  	    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
  	    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
  
  	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  	*)

crypto-js/mode-ctr-gladman.js:
  (** @preserve
   * Counter block mode compatible with  Dr Brian Gladman fileenc.c
   * derived from CryptoJS.mode.CTR
   * Jan Hruby jhruby.web@gmail.com
   *)

@noble/ed25519/index.js:
  (*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=raw-packets-bundle.js.map
